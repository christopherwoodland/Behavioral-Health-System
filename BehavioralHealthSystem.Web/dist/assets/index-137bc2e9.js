var Ys=Object.defineProperty;var Zs=(s,t,r)=>t in s?Ys(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var ae=(s,t,r)=>(Zs(s,typeof t!="symbol"?t+"":t,r),r);import{j as e,u as js,Q as Qs,a as Xs}from"./query-e4af0201.js";import{a as et,r as c,u as st,L as ee,b as tt,c as ks,R as Ns,B as rt,d as at,e as he}from"./vendor-99a90158.js";import{F as it,t as ds,f as nt}from"./ffmpeg-c0c62554.js";import{B as lt}from"./azure-a3a2de5a.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const x of d)if(x.type==="childList")for(const l of x.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(d){const x={};return d.integrity&&(x.integrity=d.integrity),d.referrerPolicy&&(x.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?x.credentials="include":d.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function a(d){if(d.ep)return;d.ep=!0;const x=r(d);fetch(d.href,x)}})();var Xe={},os=et;Xe.createRoot=os.createRoot,Xe.hydrateRoot=os.hydrateRoot;let Oe;const dt=new Uint8Array(16);function ot(){if(!Oe&&(Oe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Oe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Oe(dt)}const Z=[];for(let s=0;s<256;++s)Z.push((s+256).toString(16).slice(1));function ct(s,t=0){return Z[s[t+0]]+Z[s[t+1]]+Z[s[t+2]]+Z[s[t+3]]+"-"+Z[s[t+4]]+Z[s[t+5]]+"-"+Z[s[t+6]]+Z[s[t+7]]+"-"+Z[s[t+8]]+Z[s[t+9]]+"-"+Z[s[t+10]]+Z[s[t+11]]+Z[s[t+12]]+Z[s[t+13]]+Z[s[t+14]]+Z[s[t+15]]}const mt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),cs={randomUUID:mt};function vs(s,t,r){if(cs.randomUUID&&!t&&!s)return cs.randomUUID();s=s||{};const a=s.random||(s.rng||ot)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,t){r=r||0;for(let d=0;d<16;++d)t[r+d]=a[d];return t}return ct(a)}const ke={api:{baseUrl:"https://cwbhieastus001.azurewebsites.net/api"},azure:{blobSasUrl:"https://aistgvi.blob.core.windows.net/?sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiyx&se=2026-06-26T11:43:55Z&st=2025-09-06T03:28:55Z&spr=https&sig=jlfi75igY6qW805u%2FWErZpEu7AZSll5hJOdvSJU35%2Bo%3D",containerName:"audio-uploads"},polling:{intervalMs:parseInt("3000",10),maxAttempts:60,backoffFactor:1.2},features:{enableFFmpegWorker:!0,enableDebugLogging:!0},audio:{acceptedFormats:[".wav",".mp3",".m4a",".aac",".flac"],maxFileSizeMB:100,targetSampleRate:44100,targetChannels:1}},pe={USER_ID:"bh_user_id",THEME:"bh_theme",UPLOAD_SESSIONS:"bh_upload_sessions",PROCESSING_MODE:"bh_processing_mode",USER_ID_CUSTOM:"bh_user_id_custom"},Ae={HEALTH:"/health",SESSIONS_INITIATE:"/sessions/initiate",PREDICTIONS_SUBMIT:"/predictions/submit",PREDICTIONS_BY_USER:"/predictions",PREDICTIONS_BY_SESSION:"/predictions/sessions"},Ce={SKIP_TO_CONTENT_ID:"main-content",ANNOUNCEMENTS_ID:"a11y-announcements",FOCUS_TIMEOUT:100,DEBOUNCE_MS:300},Re=()=>{let s=localStorage.getItem(pe.USER_ID);return(!s||s.trim().length===0)&&(s=vs(),localStorage.setItem(pe.USER_ID,s)),s},xt=s=>{if(!s||s.trim().length===0)throw new Error("User ID cannot be empty");localStorage.setItem(pe.USER_ID,s.trim())},ms=()=>{const s=vs();return localStorage.setItem(pe.USER_ID,s),s},gt=()=>localStorage.getItem("bh_user_id_custom")==="true",ht=s=>{localStorage.setItem("bh_user_id_custom",s.toString())},ut=()=>{const s=localStorage.getItem(pe.THEME);return s==="light"||s==="dark"?s:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},xs=s=>{localStorage.setItem(pe.THEME,s),s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},pt=()=>{const s=localStorage.getItem(pe.PROCESSING_MODE);return s==="true"||s==="false"?s==="true":!1},yt=s=>{localStorage.setItem(pe.PROCESSING_MODE,s.toString())},_e=s=>{const t=new Date,r=new Date(s),a=t.getTime()-r.getTime(),d=Math.floor(a/(1e3*60)),x=Math.floor(a/(1e3*60*60)),l=Math.floor(a/(1e3*60*60*24));return d<1?"Just now":d<60?`${d}m ago`:x<24?`${x}h ago`:l<7?`${l}d ago`:r.toLocaleDateString()},Ne=s=>new Date(s).toLocaleString(),ce=(s,t,r)=>({code:s,message:t,details:r,timestamp:new Date().toISOString()}),bt=s=>s instanceof TypeError&&s.message.includes("fetch")?!0:s instanceof Error?s.message.includes("Network")||s.message.includes("connection")||s.message.includes("timeout"):!1,ft=(s,t="polite")=>{const r=document.createElement("div");r.setAttribute("aria-live",t),r.setAttribute("aria-atomic","true"),r.className="sr-only",r.textContent=s,document.body.appendChild(r),setTimeout(()=>{document.body.removeChild(r)},1e3)},jt=(s,t=100)=>{setTimeout(()=>{const r=document.getElementById(s);r&&r.focus()},t)},ws=c.createContext(void 0),kt=()=>{const s=c.useContext(ws);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},Nt=({children:s})=>{const[t,r]=c.useState(ut),a=l=>{r(l),xs(l)},d=()=>{a(t==="light"?"dark":"light")};c.useEffect(()=>{xs(t)},[t]),c.useEffect(()=>{const l=window.matchMedia("(prefers-color-scheme: dark)"),j=k=>{localStorage.getItem("bh_theme")||r(k.matches?"dark":"light")};return l.addEventListener("change",j),()=>l.removeEventListener("change",j)},[]);const x={theme:t,toggleTheme:d,setTheme:a};return e.jsx(ws.Provider,{value:x,children:s})},Ss=()=>{const s=c.useCallback((a,d="polite")=>{ft(a,d)},[]),t=c.useCallback(a=>{s(a,"assertive")},[s]),r=c.useCallback(a=>{s(a,"polite")},[s]);return{announce:s,announceError:t,announceSuccess:r}},vt=()=>{const s=c.useCallback(r=>{const a=d=>{d.key==="Escape"&&(d.preventDefault(),r())};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[]),t=c.useCallback(r=>a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),r())},[]);return{handleEscape:s,handleEnterSpace:t}},wt=()=>({skipToMain:c.useCallback(()=>{jt(Ce.SKIP_TO_CONTENT_ID,Ce.FOCUS_TIMEOUT)},[])}),St=({className:s=""})=>{const{theme:t,toggleTheme:r}=kt(),a=st(),{handleEnterSpace:d}=vt(),[x,l]=c.useState(!1),j=[{path:"/",label:"Dashboard",icon:"ðŸ "},{path:"/upload",label:"Upload & Analyze",icon:"ðŸ“¤"},{path:"/sessions",label:"Sessions",icon:"ðŸ“Š"},{path:"/predictions",label:"My Predictions",icon:"ðŸ“ˆ"},{path:"/control-panel",label:"Control Panel",icon:"âš™ï¸"},{path:"/health",label:"System Health",icon:"ðŸ¥"}],k=D=>D==="/"?a.pathname==="/":a.pathname.startsWith(D),u=()=>{l(!x)},b=()=>{l(!1)};return c.useEffect(()=>{l(!1)},[a.pathname]),e.jsx("header",{className:`bg-surface-light dark:bg-surface-dark border-b border-gray-200 dark:border-gray-700 ${s}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(ee,{to:"/",className:"flex items-center space-x-3 text-xl font-bold text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 rounded-md px-2 py-1","aria-label":"Behavioral Health System - Go to Dashboard",children:[e.jsx("span",{className:"text-2xl",role:"img","aria-label":"Brain icon",children:"ðŸ§ "}),e.jsx("span",{className:"hidden sm:block",children:"Behavioral Health System"}),e.jsx("span",{className:"sm:hidden",children:"BHS"})]})}),e.jsx("nav",{className:"hidden md:flex space-x-1",role:"navigation","aria-label":"Main navigation",children:j.map(({path:D,label:v,icon:$})=>e.jsxs(ee,{to:D,className:`
                  flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors
                  focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                  ${k(D)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                `,"aria-current":k(D)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:$}),e.jsx("span",{children:v})]},D))}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:r,onKeyDown:d(r),className:`\r
                p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":`Switch to ${t==="light"?"dark":"light"} mode`,type:"button",children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:t==="light"?"ðŸŒ™":"â˜€ï¸"})}),e.jsx("button",{onClick:u,onKeyDown:d(u),className:`\r
                md:hidden p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":x?"Close mobile menu":"Open mobile menu",type:"button",...x?{"aria-expanded":!0}:{"aria-expanded":!1},children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:x?"âœ•":"â˜°"})})]})]}),x&&e.jsx("div",{className:"md:hidden border-t border-gray-200 dark:border-gray-700 pt-4 pb-3",children:e.jsx("nav",{className:"space-y-1",role:"navigation","aria-label":"Mobile navigation",children:j.map(({path:D,label:v,icon:$})=>e.jsxs(ee,{to:D,onClick:b,className:`
                    flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium transition-colors
                    focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                    ${k(D)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                  `,"aria-current":k(D)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:$}),e.jsx("span",{children:v})]},D))})})]})})},At=({size:s=20,className:t="",...r})=>e.jsxs("svg",{width:s,height:s,viewBox:"0 0 23 23",className:t,"aria-label":"Microsoft",...r,children:[e.jsx("rect",{x:"1",y:"1",width:"10",height:"10",fill:"#f25022"}),e.jsx("rect",{x:"12",y:"1",width:"10",height:"10",fill:"#7fba00"}),e.jsx("rect",{x:"1",y:"12",width:"10",height:"10",fill:"#00a4ef"}),e.jsx("rect",{x:"12",y:"12",width:"10",height:"10",fill:"#ffb900"})]}),Ct=({children:s,className:t=""})=>{const{skipToMain:r}=wt();return e.jsxs("div",{className:"min-h-screen bg-background-light dark:bg-background-dark",children:[e.jsx("a",{href:`#${Ce.SKIP_TO_CONTENT_ID}`,className:"skip-link",onClick:a=>{a.preventDefault(),r()},children:"Skip to main content"}),e.jsx(St,{}),e.jsx("main",{id:Ce.SKIP_TO_CONTENT_ID,className:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 ${t}`,tabIndex:-1,children:s}),e.jsx("div",{id:Ce.ANNOUNCEMENTS_ID,className:"sr-only","aria-live":"polite","aria-atomic":"true"}),e.jsx("footer",{className:"bg-surface-light dark:bg-surface-dark border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(At,{size:24,className:"opacity-80"}),e.jsx("span",{className:"text-sm text-text-muted-light dark:text-text-muted-dark font-medium",children:"Powered by Microsoft"})]}),e.jsxs("div",{className:"text-center text-sm text-text-muted-light dark:text-text-muted-dark",children:[e.jsxs("p",{children:["Behavioral Health System Â© ",new Date().getFullYear()]}),e.jsx("p",{className:"mt-1",children:"WCAG 2.2 AA Compliant â€¢ Section 508 Compliant"})]})]})})})]})};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),It=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),gs=s=>{const t=It(s);return t.charAt(0).toUpperCase()+t.slice(1)},As=(...s)=>s.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),Dt=s=>{for(const t in s)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Rt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=c.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:d="",children:x,iconNode:l,...j},k)=>c.createElement("svg",{ref:k,...Rt,width:t,height:t,stroke:s,strokeWidth:a?Number(r)*24/Number(t):r,className:As("lucide",d),...!x&&!Dt(j)&&{"aria-hidden":"true"},...j},[...l.map(([u,b])=>c.createElement(u,b)),...Array.isArray(x)?x:[x]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=(s,t)=>{const r=c.forwardRef(({className:a,...d},x)=>c.createElement(Mt,{ref:x,iconNode:t,className:As(`lucide-${_t(gs(s))}`,`lucide-${s}`,a),...d}));return r.displayName=gs(s),r};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Ie=E("activity",Et);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ft=E("arrow-left",$t);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],ue=E("brain",Tt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Cs=E("calendar",Ot);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],hs=E("chart-column",Ut);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Pt=E("chart-pie",Lt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],_s=E("chevron-down",zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Is=E("chevron-up",Bt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],de=E("circle-alert",Ht);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],oe=E("circle-check-big",qt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ge=E("circle-x",Vt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ye=E("clock",Gt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],We=E("download",Wt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Kt=E("eye-off",Jt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],De=E("eye",Yt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]],Qt=E("file-audio",Zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],er=E("file-text",Xt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],tr=E("file",sr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=[["path",{d:"M15 2a2 2 0 0 1 1.414.586l4 4A2 2 0 0 1 21 8v7a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z",key:"1vo8kb"}],["path",{d:"M15 2v4a2 2 0 0 0 2 2h4",key:"sud9ri"}],["path",{d:"M5 7a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 1.732-1",key:"l4dndm"}]],ar=E("files",rr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ds=E("funnel",ir);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],as=E("heart",nr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],es=E("info",lr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],or=E("lightbulb",dr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],mr=E("loader-circle",cr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],ss=E("pause",xr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],je=E("play",gr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],us=E("plus",hr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],J=E("refresh-cw",ur);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],yr=E("search",pr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],ts=E("shield-alert",br);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Rs=E("target",fr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ve=E("trash-2",jr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Ms=E("trending-down",kr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Je=E("trending-up",Nr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Es=E("triangle-alert",vr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Sr=E("upload",wr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ps=E("user",Ar);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],$s=E("users",Cr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],ys=E("volume-2",_r);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ue=E("x",Ir);class Dr{constructor(t){ae(this,"baseUrl");this.baseUrl=t}async handleResponse(t){if(!t.ok){const r=await t.json().catch(()=>({}));throw ce(`HTTP_${t.status}`,r.message||`HTTP ${t.status}: ${t.statusText}`,{status:t.status,statusText:t.statusText,data:r})}return t.json()}async request(t,r={}){try{const a=this.baseUrl.endsWith("/")?this.baseUrl.slice(0,-1):this.baseUrl,d=t.startsWith("/")?t:`/${t}`,x=`${a}${d}`,l={"Content-Type":"application/json",...r.headers},j=await fetch(x,{...r,headers:l});return this.handleResponse(j)}catch(a){throw bt(a)?ce("NETWORK_ERROR","Unable to connect to the server. Please check your internet connection.",{originalError:a}):a instanceof Error&&"code"in a?a:ce("UNKNOWN_ERROR","An unexpected error occurred",{originalError:a})}}async get(t){return this.request(t,{method:"GET"})}async post(t,r){return this.request(t,{method:"POST",body:r?JSON.stringify(r):void 0})}async put(t,r){return this.request(t,{method:"PUT",body:r?JSON.stringify(r):void 0})}async delete(t){return this.request(t,{method:"DELETE"})}}const ie=new Dr(ke.api.baseUrl),W={async checkHealth(){return ie.get(Ae.HEALTH)},async initiateSession(s){return ie.post(Ae.SESSIONS_INITIATE,s)},async submitPrediction(s){return ie.post(Ae.PREDICTIONS_SUBMIT,s)},async getPredictionBySessionId(s){return ie.get(`${Ae.PREDICTIONS_BY_SESSION}/${s}`)},async getUserPredictions(s){return ie.get(`${Ae.PREDICTIONS_BY_USER}/${s}`)},async saveSessionData(s){return ie.post("sessions",s)},async getSessionData(s){return ie.get(`sessions/${s}`)},async getUserSessions(s){return ie.get(`sessions/users/${s}`)},async getAllSessions(){return ie.get("sessions/all")},async updateSessionData(s,t){return ie.put(`sessions/${s}`,t)},async deleteSessionData(s){return ie.delete(`sessions/${s}`)},async testConnection(){try{return await this.checkHealth(),{success:!0,message:"API connection successful"}}catch(s){return{success:!1,message:s.message||"Connection test failed"}}},async generateRiskAssessment(s){return ie.post(`sessions/${s}/risk-assessment`)},async getRiskAssessment(s){return ie.get(`sessions/${s}/risk-assessment`)}};class bs{constructor(t,r={}){ae(this,"sessionId");ae(this,"intervalMs");ae(this,"maxAttempts");ae(this,"backoffFactor");ae(this,"currentAttempt",0);ae(this,"timeoutId",null);ae(this,"isPolling",!1);this.sessionId=t,this.intervalMs=r.intervalMs||ke.polling.intervalMs,this.maxAttempts=r.maxAttempts||ke.polling.maxAttempts,this.backoffFactor=r.backoffFactor||ke.polling.backoffFactor}async start(t,r,a){if(this.isPolling)return;this.isPolling=!0,this.currentAttempt=0;const d=async()=>{try{const x=await W.getPredictionBySessionId(this.sessionId);if(t(x),x.status==="succeeded"||x.status==="success"||x.status==="failed"){this.stop(),r(x);return}if(this.currentAttempt++,this.currentAttempt>=this.maxAttempts){this.stop(),a(ce("POLLING_TIMEOUT","Prediction polling timed out. Please check the session manually.",{sessionId:this.sessionId,attempts:this.currentAttempt}));return}const l=this.intervalMs*Math.pow(this.backoffFactor,this.currentAttempt);this.timeoutId=window.setTimeout(d,l)}catch(x){this.stop(),a(x)}};await d()}stop(){this.isPolling=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}getStatus(){return{isPolling:this.isPolling,attempt:this.currentAttempt,maxAttempts:this.maxAttempts}}}const Fs={health:["health"],userPredictions:s=>["predictions","user",s],sessionPrediction:s=>["predictions","session",s],userSessions:s=>["sessions","user",s]},Ts=()=>js({queryKey:Fs.health,queryFn:()=>W.checkHealth(),retry:2,staleTime:3e4,refetchOnWindowFocus:!1}),Rr=s=>{const t=s||Re();return js({queryKey:Fs.userSessions(t),queryFn:()=>W.getUserSessions(t),enabled:!!t,staleTime:3e4,refetchOnWindowFocus:!1})},Mr=()=>{const s=Re(),{announce:t}=Ss(),{data:r,isLoading:a,error:d}=Ts(),{data:x,isLoading:l}=Rr(s);c.useEffect(()=>{t("Dashboard page loaded","polite")},[t]);const j=[{title:"Upload & Analyze",description:"Upload audio files for behavioral health analysis",href:"/upload",icon:"ðŸ“¤",color:"primary"},{title:"View Sessions",description:"Browse all analysis sessions and their results",href:"/sessions",icon:"ðŸ“Š",color:"secondary"},{title:"My Predictions",description:"View your complete prediction history",href:"/predictions",icon:"ðŸ“ˆ",color:"accent"},{title:"System Health",description:"Check API status and system connectivity",href:"/health",icon:"ðŸ¥",color:"warning"}],k=u=>{const b="block p-6 rounded-lg border-2 transition-all hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2";switch(u){case"primary":return`${b} border-primary-200 bg-primary-50 hover:border-primary-300 hover:bg-primary-100 dark:border-primary-800 dark:bg-primary-900 dark:hover:border-primary-700 dark:hover:bg-primary-800 focus:ring-primary-500`;case"secondary":return`${b} border-secondary-200 bg-secondary-50 hover:border-secondary-300 hover:bg-secondary-100 dark:border-secondary-800 dark:bg-secondary-900 dark:hover:border-secondary-700 dark:hover:bg-secondary-800 focus:ring-secondary-500`;case"accent":return`${b} border-accent-200 bg-accent-50 hover:border-accent-300 hover:bg-accent-100 dark:border-accent-800 dark:bg-accent-900 dark:hover:border-accent-700 dark:hover:bg-accent-800 focus:ring-accent-500`;case"warning":return`${b} border-warning-200 bg-warning-50 hover:border-warning-300 hover:bg-warning-100 dark:border-teal-600 dark:bg-teal-800 dark:hover:border-teal-500 dark:hover:bg-teal-700 focus:ring-warning-500`;default:return`${b} border-gray-200 bg-gray-50 hover:border-gray-300 hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700 focus:ring-gray-500`}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-text-primary-light dark:text-text-primary-dark",children:"Behavioral Health System"}),e.jsx("p",{className:"mt-2 text-lg text-text-secondary-light dark:text-text-secondary-dark",children:"Audio-based mental health prediction and analysis"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:"Your User ID"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded-md",children:e.jsx("code",{className:"text-sm font-mono text-text-primary-light dark:text-text-primary-dark break-all",children:s})}),e.jsx("p",{className:"mt-2 text-sm text-text-muted-light dark:text-text-muted-dark",children:"This ID is automatically generated and stored locally to track your sessions."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-6",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:j.map(u=>e.jsx(ee,{to:u.href,className:k(u.color),"aria-label":`${u.title}: ${u.description}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-3",role:"img","aria-hidden":"true",children:u.icon}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:u.title}),e.jsx("p",{className:"text-sm text-text-secondary-light dark:text-text-secondary-dark",children:u.description})]})},u.href))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Recent Activity"}),l?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Loading recent sessions..."})]}):!(x!=null&&x.sessions)||x.sessions.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",role:"img","aria-label":"No data",children:"ðŸ“­"}),e.jsxs("p",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:["No sessions yet.",e.jsx(ee,{to:"/upload",className:"text-primary-600 dark:text-primary-400 hover:underline ml-1",children:"Upload your first audio file"})," to get started."]})]}):e.jsxs("div",{className:"space-y-3",children:[x.sessions.slice(0,3).map(u=>{var b,D;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`status-${u.status||"completed"}`,children:u.status||"completed"}),e.jsx("span",{className:"text-text-primary-light dark:text-text-primary-dark",children:u.audioFileName||((b=u.sessionId)==null?void 0:b.slice(0,8))||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",title:u.createdAt,children:u.createdAt?new Date(u.createdAt).toLocaleString():""})]}),e.jsx(ee,{to:`/sessions/${u.sessionId||""}`,className:"text-primary-600 dark:text-primary-400 hover:underline text-sm flex items-center gap-1",title:"View session details","aria-label":`View details for session ${u.audioFileName||((D=u.sessionId)==null?void 0:D.slice(0,8))||"Unknown"}`,children:e.jsx(De,{className:"w-4 h-4","aria-hidden":"true"})})]},u.sessionId)}),x.sessions.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs(ee,{to:"/sessions",className:"text-primary-600 dark:text-primary-400 hover:underline",children:["View all ",x.sessions.length," sessions â†’"]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"System Status"}),a?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Checking system health..."})]}):d?e.jsxs("div",{className:"flex items-center space-x-2 text-error-600 dark:text-error-400",children:[e.jsx("span",{role:"img","aria-label":"Error",children:"âš ï¸"}),e.jsx("span",{children:"System health check failed"})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-success-600 dark:text-success-400",children:[e.jsx("span",{role:"img","aria-label":"Healthy",children:"âœ…"}),e.jsx("span",{children:"All systems operational"}),(r==null?void 0:r.checks)&&e.jsxs("span",{className:"text-text-muted-light dark:text-text-muted-dark",children:["(",Object.keys(r.checks).length," services checked)"]})]})]})]})};class Er{constructor(){ae(this,"ffmpeg",null);ae(this,"isLoaded",!1);ae(this,"loadingPromise",null);this.ffmpeg=new it}async loadFFmpeg(){if(!this.isLoaded)return this.loadingPromise?this.loadingPromise:(this.loadingPromise=this.doLoadFFmpeg(),this.loadingPromise)}async doLoadFFmpeg(){if(!this.ffmpeg)throw ce("FFMPEG_INIT_ERROR","Failed to initialize FFmpeg");try{const t="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";await this.ffmpeg.load({coreURL:await ds(`${t}/ffmpeg-core.js`,"text/javascript"),wasmURL:await ds(`${t}/ffmpeg-core.wasm`,"application/wasm")}),this.isLoaded=!0}catch(t){throw this.loadingPromise=null,ce("FFMPEG_LOAD_ERROR","Failed to load FFmpeg. Please check your internet connection and try again.",{originalError:t})}}async convertAudio(t,r={outputFormat:"wav",sampleRate:44100,channels:1},a){try{if(a==null||a({stage:"loading",progress:0,message:"Loading audio processor..."}),await this.loadFFmpeg(),!this.ffmpeg)throw ce("FFMPEG_NOT_LOADED","FFmpeg not properly loaded");this.ffmpeg.on("progress",({progress:b})=>{a==null||a({stage:"converting",progress:Math.round(b*100),message:`Converting audio... ${Math.round(b*100)}%`})}),a==null||a({stage:"converting",progress:0,message:"Preparing audio file..."});const d="input."+this.getFileExtension(t.name);await this.ffmpeg.writeFile(d,await nt(t));const x=`output.${r.outputFormat}`,l=["-i",d,"-ac",r.channels.toString(),"-ar",r.sampleRate.toString(),"-f",r.outputFormat,x];await this.ffmpeg.exec(l);const j=await this.ffmpeg.readFile(x),k=new Blob([j],{type:`audio/${r.outputFormat}`}),u=new File([k],`${this.getFileNameWithoutExtension(t.name)}.${r.outputFormat}`,{type:`audio/${r.outputFormat}`});return await this.ffmpeg.deleteFile(d),await this.ffmpeg.deleteFile(x),a==null||a({stage:"completed",progress:100,message:"Audio conversion completed"}),u}catch(d){throw ce("AUDIO_CONVERSION_ERROR","Failed to convert audio file. Please try with a different file.",{originalError:d,fileName:t.name,fileSize:t.size,fileType:t.type})}}getFileExtension(t){const r=t.lastIndexOf(".");return r!==-1?t.slice(r+1).toLowerCase():""}getFileNameWithoutExtension(t){const r=t.lastIndexOf(".");return r!==-1?t.slice(0,r):t}async isFormatSupported(t){try{await this.loadFFmpeg();const r=["wav","mp3","mp4","m4a","aac","flac","ogg"],a=this.getFileExtension(t.name);return r.includes(a)}catch{return!1}}dispose(){this.ffmpeg&&(this.ffmpeg.terminate(),this.ffmpeg=null),this.isLoaded=!1,this.loadingPromise=null}}let Ke=null;const $r=()=>(Ke||(Ke=new Er),Ke),Ye=async(s,t)=>{const a=await $r().convertAudio(s,{outputFormat:"wav",sampleRate:44100,channels:1},t?d=>t(d.progress):void 0);return new Blob([a],{type:"audio/wav"})};class Fr{constructor(t){ae(this,"containerClient",null);ae(this,"sasUrl");if(this.sasUrl=t||ke.azure.blobSasUrl,!this.sasUrl)throw ce("AZURE_CONFIG_ERROR","Azure Blob Storage SAS URL not configured")}getContainerClient(){if(!this.containerClient)try{const t=new lt(this.sasUrl);this.containerClient=t.getContainerClient(ke.azure.containerName)}catch(t){throw ce("AZURE_CLIENT_ERROR","Failed to initialize Azure Blob Storage client",{originalError:t})}return this.containerClient}async uploadFile(t,r,a){try{a==null||a({progress:0,stage:"preparing",message:"Preparing upload..."});const d=this.getContainerClient(),x=r||this.generateBlobName(t.name),l=d.getBlockBlobClient(x);a==null||a({progress:10,stage:"uploading",message:"Starting upload..."}),await l.uploadData(t,{blobHTTPHeaders:{blobContentType:t.type},onProgress:k=>{const u=k.loadedBytes&&t.size?Math.round(k.loadedBytes/t.size*90)+10:50;a==null||a({progress:u,stage:"uploading",message:`Uploading... ${u}%`})}});const j=l.url;return a==null||a({progress:100,stage:"completed",message:"Upload completed"}),{url:j,fileName:x,size:t.size}}catch(d){throw ce("UPLOAD_ERROR","Failed to upload file to Azure Blob Storage",{originalError:d,fileName:t.name,fileSize:t.size})}}generateBlobName(t){const r=new Date().toISOString().replace(/[:.]/g,"-"),a=Math.random().toString(36).substring(2,8),d=t.split(".").pop()||"wav";return`audio/${r}-${a}.${d}`}async testConnection(){try{return await this.getContainerClient().getProperties(),{success:!0,message:"Azure Blob Storage connection successful"}}catch{return{success:!1,message:"Failed to connect to Azure Blob Storage. Please check your SAS URL configuration."}}}async deleteFile(t){try{await this.getContainerClient().getBlockBlobClient(t).deleteIfExists()}catch(r){throw ce("DELETE_ERROR","Failed to delete file from Azure Blob Storage",{originalError:r,fileName:t})}}}let Le=null;const Tr=s=>((!Le||s&&s!==Le.sasUrl)&&(Le=new Fr(s)),Le),Ze=async(s,t,r)=>{const a=Tr(),d=s instanceof File?s:new File([s],t,{type:s.type});return(await a.uploadFile(d,t,r?l=>r(l.progress):void 0)).url},ve=()=>{const s=c.useRef(null),t=c.useCallback(j=>{if(!s.current){const k=document.createElement("div");k.setAttribute("aria-live","polite"),k.setAttribute("aria-atomic","true"),k.style.position="absolute",k.style.left="-10000px",k.style.width="1px",k.style.height="1px",k.style.overflow="hidden",document.body.appendChild(k),s.current=k}s.current.textContent="",setTimeout(()=>{s.current&&(s.current.textContent=j)},100)},[]),r={focusById:j=>{const k=document.getElementById(j);k&&k.focus()},focusFirstInContainer:j=>{const u=j.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];u&&u.focus()},trapFocus:j=>{const k=j.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),u=k[0],b=k[k.length-1],D=v=>{v.key==="Tab"&&(v.shiftKey?document.activeElement===u&&(b.focus(),v.preventDefault()):document.activeElement===b&&(u.focus(),v.preventDefault()))};return j.addEventListener("keydown",D),()=>{j.removeEventListener("keydown",D)}}},a={handleArrowNavigation:(j,k,u,b)=>{var v;let D=u;switch(j.key){case"ArrowDown":j.preventDefault(),D=u<k.length-1?u+1:0;break;case"ArrowUp":j.preventDefault(),D=u>0?u-1:k.length-1;break;case"Home":j.preventDefault(),D=0;break;case"End":j.preventDefault(),D=k.length-1;break;default:return}b(D),(v=k[D])==null||v.focus()},handleEscape:(j,k)=>{j.key==="Escape"&&(j.preventDefault(),k())}},d=c.useCallback((j="element")=>`${j}-${Math.random().toString(36).substr(2,9)}`,[]),x=c.useCallback(()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),l=c.useCallback((j,k,u)=>{const b={};return j||(b["aria-invalid"]="true",k&&u&&(b["aria-describedby"]=u)),b},[]);return{announceToScreenReader:t,focusManagement:r,keyboardNavigation:a,generateId:d,prefersReducedMotion:x,getValidationAttributes:l}},Or=()=>{const[s,t]=c.useState([]),[r,a]=c.useState(()=>pt()),[d,x]=c.useState({}),[l,j]=c.useState({}),[k,u]=c.useState({}),[b,D]=c.useState(!1),[v,$]=c.useState(null),[C,_]=c.useState({stage:"idle",progress:0,message:""}),[y,M]=c.useState(null),[q,V]=c.useState(!1),[se,te]=c.useState(0),[p,o]=c.useState(null),[n,f]=c.useState({age:"",gender:"",race:"",ethnicity:"",language:"",weight:"",zipcode:"",sessionNotes:""}),[m,g]=c.useState(null),[S,P]=c.useState([]),[K,xe]=c.useState(()=>gt()),[Y,Q]=c.useState(""),[T,z]=c.useState(null),A=Re(),G=c.useRef(null),ne=c.useRef(null),{announceToScreenReader:L}=ve(),O=c.useCallback((i,h,N)=>{const w=Date.now().toString()+Math.random().toString(36).substr(2,9),R={id:w,type:i,title:h,message:N,timestamp:Date.now()};P(B=>[...B,R]),setTimeout(()=>{P(B=>B.filter(X=>X.id!==w))},i==="error"?8e3:5e3)},[]),Me=c.useCallback(i=>{P(h=>h.filter(N=>N.id!==i))},[]),be=c.useCallback(()=>{t([]),$(null),_({stage:"idle",progress:0,message:""}),M(null),j({}),x({}),g(null),V(!1),te(0),o(null),D(!1)},[]),we=c.useCallback(()=>{xe(i=>{const h=!i;if(ht(h),z(null),h)Q(A),L("Switched to custom User ID mode");else{Q("");const N=ms();L(`Switched to auto-generated mode. New User ID: ${N}`)}return h})},[A,L]),Os=c.useCallback(i=>{Q(i),z(null)},[]),Us=c.useCallback(()=>{const i=Y.trim();if(!i){z("User ID cannot be empty");return}if(i.length<3){z("User ID must be at least 3 characters long");return}if(i.length>100){z("User ID must be less than 100 characters");return}if(/[<>"/\\|?*\x00-\x1f]/.test(i)){z('User ID contains invalid characters. Please avoid special characters like < > " / \\ | ? *');return}try{xt(i),z(null),L(`Custom User ID applied: ${i}`),window.location.reload()}catch(N){const w=N instanceof Error?N.message:"Failed to set User ID";z(w)}},[Y,L]),Ls=c.useCallback(()=>{const i=ms();L(`New User ID generated: ${i}`),window.location.reload()},[L]),Ps=()=>Date.now().toString()+Math.random().toString(36).substr(2,9),is=c.useCallback(i=>{const h=Ps(),N=URL.createObjectURL(i),w={id:h,file:i,url:N};r?(t(I=>[...I,w]),u(I=>({...I,[h]:"ready"})),x(I=>({...I,[h]:{stage:"idle",progress:0,message:"Ready to process"}}))):$(w),L(`Audio file selected: ${i.name}`);const R=new Audio(N);R.addEventListener("loadedmetadata",()=>{r?t(I=>I.map(B=>B.id===h?{...B,duration:R.duration}:B)):$(I=>I?{...I,duration:R.duration}:null)})},[r,L]),zs=c.useCallback(i=>{r&&(t(h=>{const N=h.find(w=>w.id===i);return N&&URL.revokeObjectURL(N.url),h.filter(w=>w.id!==i)}),x(h=>{const{[i]:N,...w}=h;return w}),j(h=>{const{[i]:N,...w}=h;return w}),u(h=>{const{[i]:N,...w}=h;return w}))},[r]),Ee=c.useCallback(i=>{const h=i.target.files;!h||h.length===0||Array.from(h).forEach(N=>{const w=["audio/wav","audio/wave","audio/x-wav","audio/mp3","audio/mpeg","audio/mp4","audio/m4a","audio/x-m4a","audio/mp4a-latm","audio/aac","audio/x-aac","audio/flac","audio/x-flac"],R=N.name.toLowerCase(),B=[".wav",".mp3",".m4a",".aac",".flac"].some(me=>R.endsWith(me));if(!w.includes(N.type)&&!B){g(`Unsupported file type for ${N.name}. Please select supported audio files (WAV, MP3, M4A, AAC, or FLAC)`),O("error","Unsupported File",`${N.name} is not a supported audio file format`),L(`Error: Unsupported file format selected for ${N.name}`);return}const le=50*1024*1024;if(N.size>le){g(`File ${N.name} is too large. File size must be less than 50MB`),O("error","File Too Large",`${N.name} size must be less than 50MB`),L(`Error: File ${N.name} is too large`);return}is(N),g(null)})},[L,is,O]),Bs=c.useCallback(i=>{i.preventDefault()},[]),Hs=c.useCallback(i=>{i.preventDefault();const h=i.dataTransfer.files;h.length>0&&Ee({target:{files:h}})},[Ee]),qs=c.useCallback(()=>{a(i=>{const h=!i;return yt(h),be(),h})},[be]),Vs=c.useCallback(()=>{G.current&&(q?(G.current.pause(),V(!1),L("Audio paused")):(G.current.play(),V(!0),L("Audio playing")))},[q,L]),Gs=c.useCallback(()=>{G.current&&te(G.current.currentTime)},[]),$e=c.useCallback(i=>{const h=Math.floor(i/60),N=Math.floor(i%60);return`${h}:${N.toString().padStart(2,"0")}`},[]),fe=c.useCallback(()=>{const i=[];if(n.age){const h=parseInt(n.age);(isNaN(h)||h<18||h>130)&&i.push("Age must be between 18 and 130")}if(n.gender&&(["male","female","non-binary","transgender female","transgender male","other","prefer"].includes(n.gender)||i.push("Invalid gender. Must be: male, female, non-binary, transgender female, transgender male, other, or prefer")),n.race&&(["white","black or african-american","asian","american indian or alaskan native","native Hawaiian or pacific islander","two or more races","other","prefer not to say"].includes(n.race)||i.push("Invalid race. Must be: white, black or african-american, asian, american indian or alaskan native, native Hawaiian or pacific islander, two or more races, other, prefer not to say")),n.ethnicity&&(["Hispanic, Latino, or Spanish Origin","Not Hispanic, Latino, or Spanish Origin"].includes(n.ethnicity)||i.push("Invalid ethnicity. Must be: Hispanic, Latino, or Spanish Origin | Not Hispanic, Latino, or Spanish Origin")),n.zipcode&&(/^[a-zA-Z0-9]{1,10}$/.test(n.zipcode)||i.push("Zipcode must be alphanumeric and contain no more than 10 characters")),n.weight){const h=parseInt(n.weight);(isNaN(h)||h<10||h>1e3)&&i.push("Weight must be between 10 and 1000 pounds (lbs)")}return i},[n]),Fe=c.useCallback(()=>{const i={};let h=!1;return n.age&&(i.age=parseInt(n.age),h=!0),n.gender&&(i.gender=n.gender,h=!0),n.race&&(i.race=n.race,h=!0),n.ethnicity&&(i.ethnicity=n.ethnicity,h=!0),(n.language==="true"||n.language==="false")&&(i.language=n.language==="true",h=!0),n.weight&&(i.weight=parseInt(n.weight),h=!0),n.zipcode&&(i.zipcode=n.zipcode,h=!0),h?i:void 0},[n]),Ws=c.useCallback(async()=>{if(r){if(s.length===0||!A.trim()){g("Please select audio files. User ID is automatically generated."),O("error","Missing Information","Please select audio files. User ID is automatically generated.");return}await ns()}else{if(!v||!A.trim()){g("Please select an audio file. User ID is automatically generated."),O("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}await Ks()}},[v,s,A,r]),Te=c.useCallback(async(i,h)=>{try{x(H=>({...H,[i]:{stage:"initiating",progress:5,message:"Initiating session..."}}));const N=Fe(),w={userid:A.trim(),is_initiated:!0};N&&(w.metadata=N);const R=await W.initiateSession(w),I={sessionId:R.sessionId,userId:A.trim()};x(H=>({...H,[i]:{stage:"initiating",progress:10,message:"Saving session data..."}}));const B={sessionId:R.sessionId,userId:A.trim(),userMetadata:N,audioFileName:h.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await W.saveSessionData(B)}catch{}x(H=>({...H,[i]:{stage:"converting",progress:15,message:"Converting audio to required format..."}}));const X=await Ye(h.file,H=>{x(F=>({...F,[i]:{stage:"converting",progress:15+H*.25,message:`Converting audio... ${Math.round(H)}%`}}))});x(H=>({...H,[i]:{stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}}));const le=`${A}_${I.sessionId}_${Date.now()}.wav`,me=await Ze(X,le,H=>{x(F=>({...F,[i]:{stage:"uploading",progress:40+H*.25,message:`Uploading... ${Math.round(H)}%`}}))});x(H=>({...H,[i]:{stage:"submitting",progress:65,message:"Submitting for analysis..."}}));try{const H={...B,audioUrl:me,audioFileName:le,status:"processing",updatedAt:new Date().toISOString()};await W.updateSessionData(I.sessionId,H)}catch(H){console.warn("Failed to update session data with audio info:",H)}await W.submitPrediction({userId:A.trim(),sessionid:I.sessionId,audioFileUrl:me,audioFileName:le}),x(H=>({...H,[i]:{stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}}));const re=new bs(I.sessionId);await new Promise((H,F)=>{re.start(U=>{const Se=U.status==="processing"?80:U.status==="success"?95:70;x(ge=>({...ge,[i]:{stage:"analyzing",progress:Se,message:`Analysis ${U.status}...`}})),U.predictError&&O("error","Prediction Error",`${U.predictError.error}: ${U.predictError.message}`)},U=>{if(U.predictError){O("error","Analysis Failed",`The analysis completed with an error: ${U.predictError.error} - ${U.predictError.message}`),x(ge=>({...ge,[i]:{stage:"error",progress:0,message:"Analysis failed with errors"}})),F(new Error(`Prediction error: ${U.predictError.error}`));return}const Se={sessionId:I.sessionId,depressionScore:U.predictedScoreDepression?parseFloat(U.predictedScoreDepression):0,riskLevel:U.predictedScoreDepression&&parseFloat(U.predictedScoreDepression)>.7?"high":U.predictedScoreDepression&&parseFloat(U.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",U.predictedScoreDepression?`Depression score: ${U.predictedScoreDepression}`:"",U.predictedScoreAnxiety?`Anxiety score: ${U.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(ge=>ge.trim()!==""),timestamp:U.updatedAt,audioUrl:me,rawApiResponse:U};x(ge=>({...ge,[i]:{stage:"complete",progress:100,message:"Analysis complete!"}})),j(ge=>({...ge,[i]:Se})),H()},U=>{F(U)})})}catch(N){console.error(`Error processing file ${i}:`,N);let w="UNKNOWN_ERROR",R="An unexpected error occurred",I={};N&&typeof N=="object"?("code"in N&&typeof N.code=="string"&&(w=N.code),"message"in N&&typeof N.message=="string"&&(R=N.message),"details"in N&&typeof N.details=="object"&&(I=N.details)):N instanceof Error&&(R=N.message,w=N.name||"ERROR");try{const B=d[i];if(B&&(B.stage==="uploading"||B.stage==="submitting"||B.stage==="analyzing")){const X=`${A}_*_*.wav`;console.log(`Attempting cleanup for file pattern: ${X}`)}}catch(B){console.warn("Error during cleanup attempt:",B)}throw x(B=>({...B,[i]:{stage:"error",progress:0,message:"Processing failed",error:{code:w,message:R,details:I}}})),N}},[A,Fe,W,Ze,Ye,O]),ns=c.useCallback(async()=>{D(!0),g(null);const i=fe();if(i.length>0){g(`Validation error: ${i.join(", ")}`),O("error","Validation Error",i.join(", ")),D(!1);return}const h=s.filter(R=>k[R.id]==="ready");if(h.length===0){O("info","No Files Ready","No files are ready to process"),D(!1);return}const N=h.length;let w=0;try{for(const R of h){w++,O("info","Processing File",`Processing ${R.file.name} (${w}/${N})`),u(I=>({...I,[R.id]:"processing"}));try{await Te(R.id,R),u(I=>({...I,[R.id]:"complete"})),O("success","File Complete",`${R.file.name} processed successfully`)}catch(I){let B="FILE_PROCESSING_ERROR",X="An unexpected error occurred",le={};I&&typeof I=="object"?("code"in I&&typeof I.code=="string"&&(B=I.code),"message"in I&&typeof I.message=="string"&&(X=I.message),"details"in I&&typeof I.details=="object"&&(le=I.details)):I instanceof Error&&(X=I.message,B=I.name||"ERROR"),O("error","File Failed",`Failed to process ${R.file.name}: ${X}`),u(me=>({...me,[R.id]:"error"})),x(me=>({...me,[R.id]:{stage:"error",progress:0,message:`Failed: ${X}`,error:{code:B,message:X,details:le}}}))}}O("success","Batch Complete",`Processed ${w} file${w!==1?"s":""}`),L(`Batch processing complete. ${w} files processed.`)}catch(R){const I=R instanceof Error?R.message:"An unexpected error occurred";g(I),O("error","Batch Failed",I),L(`Error: ${I}`)}finally{D(!1)}},[s,k,fe,O,L,Te]),Js=c.useCallback(async i=>{const h=s.find(w=>w.id===i);if(!h)return;const N=fe();if(N.length>0){g(`Validation error: ${N.join(", ")}`),O("error","Validation Error",N.join(", "));return}u(w=>({...w,[i]:"processing"}));try{await Te(i,h),u(w=>({...w,[i]:"complete"})),O("success","File Complete",`${h.file.name} processed successfully`)}catch(w){console.error(`Error processing ${h.file.name}:`,w);const R=w instanceof Error?w.message:"An unexpected error occurred";O("error","File Failed",`Failed to process ${h.file.name}: ${R}`),u(I=>({...I,[i]:"error"})),x(I=>({...I,[i]:{stage:"error",progress:0,message:`Failed: ${R}`}}))}},[s,fe,O,Te]),Ks=c.useCallback(async()=>{if(!v||!A.trim()){g("Please select an audio file. User ID is automatically generated."),O("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}const i=fe();if(i.length>0){g(`Validation error: ${i.join(", ")}`),O("error","Validation Error",i.join(", "));return}try{g(null),_({stage:"initiating",progress:5,message:"Initiating session..."}),L("Starting analysis process - initiating session");const h=Fe(),N={userid:A.trim(),is_initiated:!0};h&&(N.metadata=h);const w=await W.initiateSession(N),R={sessionId:w.sessionId,userId:A.trim()};_({stage:"initiating",progress:10,message:"Saving session data..."});const I={sessionId:w.sessionId,userId:A.trim(),userMetadata:h,audioFileName:v.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await W.saveSessionData(I)}catch{}_({stage:"converting",progress:15,message:"Converting audio to required format..."}),L("Session created successfully, now converting audio");const B=await Ye(v.file,re=>{_({stage:"converting",progress:15+re*.25,message:`Converting audio... ${Math.round(re)}%`})});_({stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}),L("Audio converted successfully, now uploading");const X=`${A}_${R.sessionId}_${Date.now()}.wav`,le=await Ze(B,X,re=>{_({stage:"uploading",progress:40+re*.25,message:`Uploading... ${Math.round(re)}%`})});_({stage:"submitting",progress:65,message:"Submitting for analysis..."}),L("Upload complete, submitting for behavioral health analysis");try{const re={...I,audioUrl:le,audioFileName:X,status:"processing",updatedAt:new Date().toISOString()};await W.updateSessionData(R.sessionId,re)}catch(re){console.warn("Failed to update session data with audio info:",re)}await W.submitPrediction({userId:A.trim(),sessionid:R.sessionId,audioFileUrl:le,audioFileName:X}),_({stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}),L("Prediction submitted, analysis in progress");const me=new bs(R.sessionId);await new Promise((re,H)=>{me.start(F=>{const U=F.status==="processing"?80:F.status==="success"?95:70;_({stage:"analyzing",progress:U,message:`Analysis ${F.status}...`}),F.predictError&&O("error","Prediction Error",`${F.predictError.error}: ${F.predictError.message}`)},F=>{if(F.predictError){O("error","Analysis Failed",`The analysis completed with an error: ${F.predictError.error} - ${F.predictError.message}`),_({stage:"error",progress:0,message:"Analysis failed with errors"}),H(new Error(`Prediction error: ${F.predictError.error}`));return}const U={sessionId:R.sessionId,depressionScore:F.predictedScoreDepression?parseFloat(F.predictedScoreDepression):0,riskLevel:F.predictedScoreDepression&&parseFloat(F.predictedScoreDepression)>.7?"high":F.predictedScoreDepression&&parseFloat(F.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",F.predictedScoreDepression?`Depression score: ${F.predictedScoreDepression}`:"",F.predictedScoreAnxiety?`Anxiety score: ${F.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(Se=>Se.trim()!==""),timestamp:F.updatedAt,audioUrl:le,rawApiResponse:F};_({stage:"complete",progress:100,message:"Analysis complete!"}),M(U),O("success","Analysis Complete","Your behavioral health analysis has been completed successfully."),L("Behavioral health analysis completed successfully"),re()},F=>{O("error","Analysis Error",F.message||"An unexpected error occurred during analysis."),H(F)})})}catch(h){console.error("Processing error:",h);const N=h instanceof Error?h.message:"An unexpected error occurred";g(N),_({stage:"error",progress:0,message:"Processing failed"}),O("error","Processing Failed",N),L(`Error: ${N}`)}},[v,A,L,fe,Fe]),ls=c.useCallback(i=>{switch(i){case"error":return"processing-progress__fill--error";case"complete":return"processing-progress__fill--success";default:return""}},[]);return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Processing Mode:"}),e.jsxs("div",{className:"relative inline-flex items-center",children:[e.jsx("button",{type:"button",onClick:qs,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 ${r?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500"}`,"aria-label":`Switch to ${r?"single file":"multi-file"} mode`,children:e.jsx("span",{className:`inline-flex h-6 w-6 transform rounded-full bg-white items-center justify-center transition-transform ${r?"translate-x-9":"translate-x-1"}`,children:r?e.jsx(ar,{className:"h-3 w-3 text-blue-600"}):e.jsx(tr,{className:"h-3 w-3 text-gray-600"})})}),e.jsxs("div",{className:"ml-3 flex items-center space-x-4",children:[e.jsx("span",{className:`text-sm font-medium ${r?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:"Single"}),e.jsx("span",{className:`text-sm font-medium ${r?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"}`,children:"Multi"})]})]})]}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${r?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:r?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),"Batch Processing"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v8H4V6z",clipRule:"evenodd"})}),"Single File"]})})]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Upload & Analyze Audio"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Upload ",r?"multiple audio files":"an audio file"," for behavioral health analysis using AI-powered speech pattern recognition"]}),e.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-lg text-sm ${r?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:r?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M9 12a1 1 0 000 2h2a1 1 0 100-2H9z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 0v12h8V4H6z",clipRule:"evenodd"})]}),"Process multiple files with individual controls and batch options"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Upload and analyze one file at a time with detailed progress tracking"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Patient Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 lg:col-span-3 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"User ID Management"}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 p-4 rounded-md border space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current User ID:"}),e.jsx("code",{className:"text-sm font-mono text-gray-900 dark:text-gray-100 break-all block bg-white dark:bg-gray-800 p-2 rounded border",children:A})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:we,className:"px-3 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors","aria-describedby":"user-id-mode-help",children:K?"Switch to Auto-Generated":"Use Custom User ID"}),!K&&e.jsx("button",{type:"button",onClick:Ls,className:"px-3 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800 transition-colors",title:"Generate a new random User ID",children:"Generate New ID"})]}),K&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:Y,onChange:i=>Os(i.target.value),placeholder:"Enter custom User ID (any unique string)",className:"flex-1 px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-describedby":"custom-user-id-help","aria-invalid":T?"true":"false"}),e.jsx("button",{type:"button",onClick:Us,disabled:!Y.trim(),className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Apply"})]}),T&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",role:"alert",children:T}),e.jsx("p",{id:"custom-user-id-help",className:"text-xs text-gray-500 dark:text-gray-400",children:'Any unique string (3-100 characters). Examples: "patient-001", "john.doe@clinic", "study-participant-42"'})]}),e.jsx("p",{id:"user-id-mode-help",className:"text-xs text-gray-500 dark:text-gray-400",children:K?"Custom mode: Use any unique identifier for tracking (e.g., patient ID, username, study code)":"Auto mode: System generates unique UUIDs automatically"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age (Optional)"}),e.jsx("input",{type:"number",id:"age",value:n.age,onChange:i=>f(h=>({...h,age:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Age in years",min:"1",max:"150"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight (Optional)"}),e.jsx("input",{type:"number",id:"weight",value:n.weight,onChange:i=>f(h=>({...h,weight:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Weight in lbs",min:"1",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender (Optional)"}),e.jsxs("select",{id:"gender",value:n.gender,onChange:i=>f(h=>({...h,gender:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"non-binary",children:"Non-binary"}),e.jsx("option",{value:"transgender female",children:"Transgender female"}),e.jsx("option",{value:"transgender male",children:"Transgender male"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer",children:"Prefer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"race",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race (Optional)"}),e.jsxs("select",{id:"race",value:n.race,onChange:i=>f(h=>({...h,race:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select race"}),e.jsx("option",{value:"white",children:"White"}),e.jsx("option",{value:"black or african-american",children:"Black or African-American"}),e.jsx("option",{value:"asian",children:"Asian"}),e.jsx("option",{value:"american indian or alaskan native",children:"American Indian or Alaskan Native"}),e.jsx("option",{value:"native Hawaiian or pacific islander",children:"Native Hawaiian or Pacific Islander"}),e.jsx("option",{value:"two or more races",children:"Two or more races"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer not to say",children:"Prefer not to say"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ethnicity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity (Optional)"}),e.jsxs("select",{id:"ethnicity",value:n.ethnicity,onChange:i=>f(h=>({...h,ethnicity:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select ethnicity"}),e.jsx("option",{value:"Hispanic, Latino, or Spanish Origin",children:"Hispanic, Latino, or Spanish Origin"}),e.jsx("option",{value:"Not Hispanic, Latino, or Spanish Origin",children:"Not Hispanic, Latino, or Spanish Origin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language (Optional)"}),e.jsxs("select",{id:"language",value:n.language,onChange:i=>f(h=>({...h,language:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select language"}),e.jsx("option",{value:"true",children:"English"}),e.jsx("option",{value:"false",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"zipcode",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code (Optional)"}),e.jsx("input",{type:"text",id:"zipcode",value:n.zipcode,onChange:i=>f(h=>({...h,zipcode:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter ZIP code",pattern:"[0-9]{5}(-[0-9]{4})?",title:"Enter a valid ZIP code (e.g., 12345 or 12345-6789)"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{htmlFor:"sessionNotes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes (Optional)"}),e.jsx("textarea",{id:"sessionNotes",value:n.sessionNotes,onChange:i=>f(h=>({...h,sessionNotes:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",rows:3,placeholder:"Additional notes about this session or patient context"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Audio File Upload ",r&&e.jsx("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:"(Multi-File Mode)"})]}),!r&&!v||r&&s.length===0?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors",onDragOver:Bs,onDrop:Hs,children:[e.jsx(Sr,{className:"mx-auto h-12 w-12 text-gray-400 mb-4","aria-hidden":"true"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{type:"button",onClick:()=>{var i;return(i=ne.current)==null?void 0:i.click()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Select Audio File",r?"s":""]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["or drag and drop ",r?"files":"file"," here"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Supported formats: WAV, MP3, M4A, AAC, FLAC (max 50MB each)",r&&e.jsx("br",{}),r&&"You can select multiple files at once"]}),e.jsx("input",{ref:ne,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:Ee,multiple:r,"aria-label":`Select audio file${r?"s":""} for analysis`})]}):e.jsxs("div",{className:"space-y-4",children:[!r&&v&&e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ys,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:v.file.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(v.file.size/1024/1024).toFixed(2)," MB",v.duration&&` â€¢ ${$e(v.duration)}`]})]})]}),e.jsx("button",{type:"button",onClick:be,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Remove selected file",children:e.jsx(Ue,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:Vs,className:"flex items-center justify-center w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800","aria-label":q?"Pause audio":"Play audio",children:q?e.jsx(ss,{className:"h-5 w-5","aria-hidden":"true"}):e.jsx(je,{className:"h-5 w-5 ml-0.5","aria-hidden":"true"})}),e.jsx("div",{className:"flex-1",children:v.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[$e(se)," / ",$e(v.duration)]})})]}),v.duration&&e.jsx("div",{className:"audio-progress",children:e.jsx("div",{className:"audio-progress__fill progress-animated",style:{width:`${se/v.duration*100}%`},role:"progressbar","aria-label":"Audio playback progress","aria-valuenow":se,"aria-valuemin":0,"aria-valuemax":v.duration})})]}),e.jsx("audio",{ref:G,src:v.url,onTimeUpdate:Gs,onEnded:()=>V(!1),onPlay:()=>V(!0),onPause:()=>V(!1),className:"hidden"})]}),r&&s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Selected Files (",s.length,")"]}),e.jsxs("button",{type:"button",onClick:()=>{var i;return(i=ne.current)==null?void 0:i.click()},className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Add More Files"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(i=>{const h=k[i.id]||"ready",N=d[i.id];return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[e.jsx(ys,{className:"h-4 w-4 text-blue-500 flex-shrink-0","aria-hidden":"true"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:i.file.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(i.file.size/1024/1024).toFixed(2)," MB",i.duration&&` â€¢ ${$e(i.duration)}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h==="ready"&&e.jsxs("button",{type:"button",onClick:()=>Js(i.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-offset-gray-800","aria-label":`Start processing ${i.file.name}`,children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),"Start"]}),h==="processing"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"Processing..."}),h==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Complete"]}),h==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]}),e.jsx("button",{type:"button",onClick:()=>zs(i.id),className:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400","aria-label":`Remove ${i.file.name}`,children:e.jsx(Ve,{className:"h-4 w-4"})})]})]}),N&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:N.message}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[Math.round(N.progress),"%"]})]}),e.jsx("div",{className:"processing-progress mt-1",children:e.jsx("div",{className:`processing-progress__fill progress-animated ${ls(N.stage)}`,style:{width:`${N.progress}%`}})})]})]},i.id)})}),e.jsx("input",{ref:ne,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:Ee,multiple:r,"aria-label":"Select additional audio files for analysis"})]})]})]}),m&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",role:"alert",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"h-5 w-5 text-red-500 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-red-700 dark:text-red-300",children:m})]})}),!r&&C.stage!=="idle"&&!y&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Processing Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:C.message}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[Math.round(C.progress),"%"]})]}),e.jsx("div",{className:"processing-progress",children:e.jsx("div",{className:`processing-progress__fill progress-animated ${ls(C.stage)}`,style:{width:`${C.progress}%`},role:"progressbar","aria-label":"Processing progress","aria-valuenow":C.progress,"aria-valuemin":0,"aria-valuemax":100})}),C.stage==="analyzing"&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(mr,{className:"h-4 w-4 animate-spin mr-2","aria-hidden":"true"}),"This may take a few minutes..."]})]})]}),y&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(oe,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Analysis Results"})]}),y.rawApiResponse&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"API Response Details"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Predicted Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:y.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:y.rawApiResponse.predicted_score_anxiety||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`font-mono ${y.rawApiResponse.status==="success"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:y.rawApiResponse.status||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Model Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Category:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:y.rawApiResponse.model_category||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Granularity:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:y.rawApiResponse.model_granularity||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Calibrated:"}),e.jsx("span",{className:`font-mono ${y.rawApiResponse.is_calibrated?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"}`,children:y.rawApiResponse.is_calibrated?"Yes":"No"})]})]})]}),y.rawApiResponse.actual_score&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Clinical Assessment Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[y.rawApiResponse.actual_score.depression_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:y.rawApiResponse.actual_score.depression_binary||"N/A"})]}),y.rawApiResponse.actual_score.anxiety_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:y.rawApiResponse.actual_score.anxiety_binary||"N/A"})]}),y.rawApiResponse.actual_score.phq_9&&y.rawApiResponse.actual_score.phq_9.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-9:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",y.rawApiResponse.actual_score.phq_9.join(", "),"]"]})]}),y.rawApiResponse.actual_score.phq_2&&y.rawApiResponse.actual_score.phq_2.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-2:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",y.rawApiResponse.actual_score.phq_2.join(", "),"]"]})]}),y.rawApiResponse.actual_score.gad_7&&y.rawApiResponse.actual_score.gad_7.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"GAD-7:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",y.rawApiResponse.actual_score.gad_7.join(", "),"]"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Created:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:y.rawApiResponse.created_at?new Date(y.rawApiResponse.created_at).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Updated:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:y.rawApiResponse.updated_at?new Date(y.rawApiResponse.updated_at).toLocaleString():"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Session Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:y.sessionId})]})})]}),y.rawApiResponse.predict_error&&e.jsxs("div",{className:"border-l-4 border-red-400 bg-red-50 dark:bg-red-900/20 p-3",children:[e.jsx("h5",{className:"text-sm font-medium text-red-700 dark:text-red-300 mb-1",children:"Prediction Error"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Error Type:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100",children:y.rawApiResponse.predict_error.error})]}),e.jsxs("div",{className:"text-red-700 dark:text-red-300",children:[e.jsx("span",{className:"font-medium",children:"Message:"})," ",y.rawApiResponse.predict_error.message]})]})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(y.rawApiResponse,null,2)})})]})]})})]}),y.insights&&y.insights.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Clinical Insights"}),e.jsx("ul",{className:"space-y-1",children:y.insights.map((i,h)=>e.jsxs("li",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["â€¢ ",i]},h))})]}),e.jsx("div",{className:"mt-6 flex space-x-3",children:e.jsx("button",{type:"button",onClick:be,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:"Analyze Another File"})})]}),(r&&s.length>0||!r&&v)&&!y&&Object.keys(l).length===0&&C.stage==="idle"&&!b&&e.jsx("div",{className:"text-center",children:r?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:e.jsxs("button",{type:"button",onClick:ns,disabled:s.length===0||!A.trim()||!s.some(i=>k[i.id]==="ready"),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start All Ready Files",s.filter(i=>k[i.id]==="ready").length>0&&` (${s.filter(i=>k[i.id]==="ready").length})`]})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'Use individual "Start" buttons on each file for selective processing, or "Start All" to process all ready files sequentially'})]}):e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:Ws,disabled:!v||!A.trim(),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start Analysis"]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"This will convert, upload, and analyze your audio file"})]})}),r&&Object.keys(l).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(oe,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Batch Analysis Results (",Object.keys(l).length," files)"]})]}),e.jsx("div",{className:"space-y-6",children:Object.entries(l).map(([i,h])=>{const N=s.find(R=>R.id===i),w=d[i];return e.jsxs("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:(N==null?void 0:N.file.name)||`File ${i}`}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(w==null?void 0:w.stage)==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Complete"]}),(w==null?void 0:w.stage)==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]})]})]}),(w==null?void 0:w.stage)==="error"&&(w==null?void 0:w.error)&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mt-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(de,{className:"h-5 w-5 text-red-500 mr-3 mt-0.5 flex-shrink-0","aria-hidden":"true"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-red-800 dark:text-red-200 mb-2",children:"Error Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 font-medium",children:"Error Code:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100",children:w.error.code})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 font-medium",children:"Error Message:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100 text-right",children:w.error.message})]})]}),w.error.details&&Object.keys(w.error.details).length>0&&e.jsxs("details",{className:"mt-3",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-red-700 dark:text-red-300 hover:text-red-900 dark:hover:text-red-100",children:"View Additional Error Details"}),e.jsx("div",{className:"mt-2 bg-red-100 dark:bg-red-900/40 rounded p-3 overflow-auto max-h-32",children:e.jsx("pre",{className:"text-xs text-red-800 dark:text-red-200 whitespace-pre-wrap",children:JSON.stringify(w.error.details,null,2)})})]})]})]})]})}),h.rawApiResponse&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3 border",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:h.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:h.rawApiResponse.predicted_score_anxiety||"N/A"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:h.sessionId})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:h.rawApiResponse.status||"N/A"})]})]})}),e.jsxs("details",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto max-h-64",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(h.rawApiResponse,null,2)})})]})]}),N&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{const R=document.getElementById(`audio-${i}`);R.paused?(document.querySelectorAll("audio").forEach(I=>I.pause()),o(i),R.play()):(R.pause(),o(null))},className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900","aria-label":p===i?"Pause audio":"Play audio",children:p===i?e.jsx(ss,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[N.file.name," â€¢ ",N.duration?`${Math.round(N.duration)}s`:"Duration unknown"]})]}),e.jsx("audio",{id:`audio-${i}`,src:N.url,onEnded:()=>o(null),className:"hidden"})]})]},i)})})]}),S.length>0&&e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:S.map(i=>e.jsx("div",{className:`max-w-sm w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg border-l-4 p-4 transition-all duration-300 transform ${i.type==="error"?"border-red-500":i.type==="warning"?"border-yellow-500":i.type==="success"?"border-green-500":"border-blue-500"}`,role:"alert",children:e.jsxs("div",{className:"flex items-start",children:[e.jsxs("div",{className:"flex-shrink-0",children:[i.type==="error"&&e.jsx(de,{className:"h-5 w-5 text-red-500","aria-hidden":"true"}),i.type==="warning"&&e.jsx(de,{className:"h-5 w-5 text-yellow-500","aria-hidden":"true"}),i.type==="success"&&e.jsx(oe,{className:"h-5 w-5 text-green-500","aria-hidden":"true"}),i.type==="info"&&e.jsx(de,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"})]}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:i.message})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{type:"button",onClick:()=>Me(i.id),className:"inline-flex text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close notification",children:e.jsx(Ue,{className:"h-4 w-4"})})})]})},i.id))})]})},Pe={queued:{color:"yellow",icon:ye,label:"Queued"},running:{color:"blue",icon:J,label:"Processing"},processing:{color:"blue",icon:J,label:"Processing"},succeeded:{color:"green",icon:oe,label:"Completed"},success:{color:"green",icon:oe,label:"Completed"},failed:{color:"red",icon:Ge,label:"Failed"},error:{color:"red",icon:Ge,label:"Error"}},ze=s=>s?s.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()):"â€”",Be=s=>{if(!s)return 0;switch(s.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},Ur=()=>{const[s,t]=c.useState([]),[r,a]=c.useState(!0),[d,x]=c.useState(null),[l,j]=c.useState(new Set),[k,u]=c.useState(!1),[b,D]=c.useState({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),{announceToScreenReader:v}=ve(),$=c.useCallback(async()=>{try{a(!0),x(null);const p=Re(),n=(await W.getUserSessions(p)).sessions.map(f=>{var g;const m=f.prediction;return{...f,uploadedAt:f.createdAt,fileName:f.audioFileName||`Audio_${f.sessionId.slice(-8)}.wav`,fileSize:Math.floor(Math.random()*5e6)+1e6,riskLevel:((g=f.analysisResults)==null?void 0:g.riskLevel)||"unknown",depressionScore:(m==null?void 0:m.predicted_score_depression)||(m==null?void 0:m.predictedScoreDepression)||void 0,anxietyScore:(m==null?void 0:m.predicted_score_anxiety)||(m==null?void 0:m.predictedScoreAnxiety)||void 0}});t(n),v(`${n.length} sessions loaded successfully`)}catch(p){const o=p;x(o),v(`Error loading sessions: ${o.message}`)}finally{a(!1)}},[v]);c.useEffect(()=>{$()},[$]);const C=c.useMemo(()=>{let p=s;if(b.search){const o=b.search.toLowerCase();p=p.filter(n=>{var f,m;return n.sessionId.toLowerCase().includes(o)||((f=n.fileName)==null?void 0:f.toLowerCase().includes(o))||((m=Pe[n.status])==null?void 0:m.label.toLowerCase().includes(o))})}if(b.status!=="all"&&(p=p.filter(o=>o.status===b.status)),b.dateRange!=="all"){const o=new Date,n=new Date;switch(b.dateRange){case"today":n.setHours(0,0,0,0);break;case"week":n.setDate(o.getDate()-7);break;case"month":n.setMonth(o.getMonth()-1);break;case"year":n.setFullYear(o.getFullYear()-1);break}p=p.filter(f=>new Date(f.uploadedAt)>=n)}return p.sort((o,n)=>{let f=0;switch(b.sortBy){case"date":f=new Date(o.uploadedAt).getTime()-new Date(n.uploadedAt).getTime();break;case"status":f=o.status.localeCompare(n.status);break;case"depressionScore":const m=Be(o.depressionScore),g=Be(n.depressionScore);f=m-g;break;case"anxietyScore":const S=Be(o.anxietyScore),P=Be(n.anxietyScore);f=S-P;break}return b.sortOrder==="desc"?-f:f}),p},[s,b]),_=c.useCallback((p,o)=>{D(n=>({...n,[p]:o})),v(`Filter ${p} changed to ${o}`)},[v]),y=c.useCallback(p=>{j(o=>{const n=new Set(o);return n.has(p)?(n.delete(p),v("Session deselected")):(n.add(p),v("Session selected")),n})},[v]),M=c.useCallback(()=>{l.size===C.length?(j(new Set),v("All sessions deselected")):(j(new Set(C.map(o=>o.sessionId))),v(`All ${C.length} sessions selected`))},[l.size,C,v]),q=c.useCallback(async p=>{if(window.confirm("Are you sure you want to delete this session? This action cannot be undone."))try{await W.deleteSessionData(p),t(n=>n.filter(f=>f.sessionId!==p)),j(n=>{const f=new Set(n);return f.delete(p),f}),v("Session deleted successfully")}catch(n){const f=n;v(`Error deleting session: ${f.message}`),alert(`Failed to delete session: ${f.message}`)}},[v]),V=c.useCallback(async()=>{if(l.size===0||!window.confirm(`Are you sure you want to delete ${l.size} session(s)? This action cannot be undone.`))return;const o=Array.from(l);let n=0,f=[];for(const m of o)try{await W.deleteSessionData(m),n++}catch(g){const S=g;f.push(m),console.error(`Failed to delete session ${m}:`,S.message)}if(n>0&&t(m=>m.filter(g=>!(l.has(g.sessionId)&&!f.includes(g.sessionId)))),j(new Set),f.length===0)v(`${n} sessions deleted successfully`);else{const m=`${n} sessions deleted successfully, ${f.length} failed`;v(m),alert(`${m}. Failed sessions: ${f.join(", ")}`)}},[l,v]),se=p=>{if(p===0)return"0 B";const o=1024,n=["B","KB","MB","GB"],f=Math.floor(Math.log(p)/Math.log(o));return`${parseFloat((p/Math.pow(o,f)).toFixed(1))} ${n[f]}`},te=({status:p})=>{const o=p.toLowerCase();let n=Pe[p];n||(o.includes("error")||o.includes("fail")?n=Pe.error:n=Pe.failed);const f=n.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":n.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":n.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${n.label}`,children:[e.jsx(f,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),n.label]})};return r?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(J,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading sessions..."})]})}):d?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Sessions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:d.message}),e.jsx("button",{type:"button",onClick:$,className:"mt-4 btn btn--primary","aria-label":"Retry loading sessions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Analysis Sessions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"View and manage your audio analysis sessions"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:$,disabled:r,className:"btn btn--secondary","aria-label":"Refresh sessions list",children:[e.jsx(J,{className:`w-4 h-4 mr-2 ${r?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsx(ee,{to:"/upload",className:"btn btn--primary","aria-label":"Start new analysis session",children:"New Analysis"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{htmlFor:"search-sessions",className:"sr-only",children:"Search sessions"}),e.jsxs("div",{className:"relative",children:[e.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400","aria-hidden":"true"}),e.jsx("input",{id:"search-sessions",type:"text",placeholder:"Search by session ID, filename, or status...",value:b.search,onChange:p=>_("search",p.target.value),className:"form__input w-full pl-10 pr-4 py-2","aria-describedby":"search-help"})]}),e.jsx("p",{id:"search-help",className:"sr-only",children:"Search through your analysis sessions by ID, filename, or status"})]}),e.jsxs("button",{type:"button",onClick:()=>u(!k),className:"btn btn--secondary flex items-center","aria-expanded":k?"true":"false","aria-controls":"filter-panel","aria-label":`${k?"Hide":"Show"} filter options`,children:[e.jsx(Ds,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",k?e.jsx(Is,{className:"w-4 h-4 ml-2","aria-hidden":"true"}):e.jsx(_s,{className:"w-4 h-4 ml-2","aria-hidden":"true"})]})]}),k&&e.jsxs("div",{id:"filter-panel",className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{id:"status-filter",value:b.status,onChange:p=>_("status",p.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"queued",children:"Queued"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"succeeded",children:"Completed"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-filter",value:b.dateRange,onChange:p=>_("dateRange",p.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-by",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort By"}),e.jsxs("select",{id:"sort-by",value:b.sortBy,onChange:p=>_("sortBy",p.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"status",children:"Status"}),e.jsx("option",{value:"depressionScore",children:"Depression Score"}),e.jsx("option",{value:"anxietyScore",children:"Anxiety Score"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-order",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort Order"}),e.jsxs("select",{id:"sort-order",value:b.sortOrder,onChange:p=>_("sortOrder",p.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]}),C.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[C.length," of ",s.length," sessions",l.size>0&&` â€¢ ${l.size} selected`]})}),l.size>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{type:"button",onClick:V,className:"btn btn--danger","aria-label":`Delete ${l.size} selected sessions`,children:[e.jsx(Ve,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Delete Selected"]})})]}),C.length>0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",role:"table","aria-label":"Analysis sessions",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:l.size===C.length,onChange:M,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":"Select all sessions"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Session"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Depression Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Anxiety Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:C.map(p=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:l.has(p.sessionId),onChange:()=>y(p.sessionId),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${p.sessionId}`})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:p.fileName}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID: ",p.sessionId.slice(-12)]}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:se(p.fileSize||0)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(te,{status:p.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:p.depressionScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:ze(p.depressionScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:p.anxietyScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:ze(p.anxietyScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:_e(p.uploadedAt)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ne(p.uploadedAt)})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(ee,{to:`/sessions/${p.sessionId}`,className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300","aria-label":`View details for session ${p.sessionId}`,children:e.jsx(De,{className:"w-4 h-4","aria-hidden":"true"})}),p.status==="succeeded"&&e.jsx("button",{type:"button",className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300","aria-label":`Download results for session ${p.sessionId}`,children:e.jsx(We,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx("button",{type:"button",onClick:()=>q(p.sessionId),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300","aria-label":`Delete session ${p.sessionId}`,children:e.jsx(Ve,{className:"w-4 h-4","aria-hidden":"true"})})]})})]},p.sessionId))})]})}),e.jsx("div",{className:"md:hidden space-y-4 p-4",children:C.map(p=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:l.has(p.sessionId),onChange:()=>y(p.sessionId),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${p.sessionId}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:p.fileName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",p.sessionId.slice(-12)]})]})]}),e.jsx(te,{status:p.status})]}),(p.depressionScore||p.anxietyScore)&&e.jsxs("div",{className:"text-sm",children:[p.depressionScore&&e.jsxs("div",{children:["Depression: ",ze(p.depressionScore)]}),p.anxietyScore&&e.jsxs("div",{children:["Anxiety: ",ze(p.anxietyScore)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:_e(p.uploadedAt)}),e.jsx("span",{children:se(p.fileSize||0)})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[e.jsxs(ee,{to:`/sessions/${p.sessionId}`,className:"btn btn--secondary text-xs","aria-label":`View details for session ${p.sessionId}`,children:[e.jsx(De,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"View"]}),p.status==="succeeded"&&e.jsxs("button",{type:"button",className:"btn btn--secondary text-xs","aria-label":`Download results for session ${p.sessionId}`,children:[e.jsx(We,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Download"]}),e.jsxs("button",{type:"button",onClick:()=>q(p.sessionId),className:"btn btn--danger text-xs","aria-label":`Delete session ${p.sessionId}`,children:[e.jsx(Ve,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Delete"]})]})]},p.sessionId))})]}):e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No sessions found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't created any analysis sessions yet.":"No sessions match your current filters."}),s.length===0?e.jsx(ee,{to:"/upload",className:"btn btn--primary",children:"Start Your First Analysis"}):e.jsx("button",{type:"button",onClick:()=>D({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),className:"btn btn--secondary",children:"Clear Filters"})]})]})},Lr={low:{color:"green",label:"Low Risk",icon:oe,description:"Low likelihood of immediate concerns"},moderate:{color:"yellow",label:"Moderate Risk",icon:Es,description:"Some concerns that warrant attention"},high:{color:"red",label:"High Risk",icon:ts,description:"Significant concerns requiring immediate attention"},critical:{color:"red",label:"Critical Risk",icon:ts,description:"Urgent intervention required"}},Pr=({sessionId:s,existingAssessment:t,onAssessmentUpdated:r})=>{const{announceToScreenReader:a}=ve(),[d,x]=c.useState(t||null),[l,j]=c.useState(!1),[k,u]=c.useState(!1),[b,D]=c.useState(null),v=c.useCallback(async()=>{try{j(!0),D(null),a("Generating AI risk assessment...");const _=await W.generateRiskAssessment(s);if(_.success&&_.riskAssessment)x(_.riskAssessment),r==null||r(_.riskAssessment),a("Risk assessment generated successfully");else throw new Error(_.message||"Failed to generate risk assessment")}catch(_){const y=_;D(y),a(`Error generating assessment: ${y.message}`)}finally{j(!1)}},[s,r,a]),$=c.useCallback(async()=>{try{u(!0),D(null);const _=await W.getRiskAssessment(s);_.success&&_.riskAssessment&&(x(_.riskAssessment),r==null||r(_.riskAssessment))}catch(_){D(_)}finally{u(!1)}},[s,r]),C=({riskLevel:_,riskScore:y})=>{const M=Lr[_.toLowerCase()];if(!M)return null;const q=M.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium ${M.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":M.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Risk level: ${M.label}`,children:[e.jsx(q,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),M.label,y&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded text-xs font-bold",children:[y,"/10"]})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:M.description})]})};return!d&&!l&&!k?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ue,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Risk Assessment Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Generate an AI-powered risk assessment based on session data and clinical insights."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{type:"button",onClick:v,className:"btn btn--primary","aria-label":"Generate AI risk assessment",children:[e.jsx(ue,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Generate AI Risk Assessment"]}),e.jsxs("button",{type:"button",onClick:$,className:"btn btn--secondary","aria-label":"Check for existing assessment",children:[e.jsx(J,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Check for Existing Assessment"]})]}),b&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:b.message})})]})]}):l||k?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ue,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(J,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:l?"Generating AI risk assessment...":"Loading assessment..."})]}),l&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This may take a few moments as AI analyzes the session data..."})})]}):d?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(ue,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsx("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:e.jsxs("button",{type:"button",onClick:v,disabled:l,className:"btn btn--secondary text-xs","aria-label":"Regenerate risk assessment",children:[e.jsx(J,{className:`w-3 h-3 mr-1 ${l?"animate-spin":""}`,"aria-hidden":"true"}),"Regenerate"]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Overall Risk Level"}),e.jsx(C,{riskLevel:d.overallRiskLevel,riskScore:d.riskScore})]}),d.generatedAt&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(Cs,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Generated"]}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ne(d.generatedAt)})]})]}),d.summary&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(er,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Summary"]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsx("p",{className:"text-blue-900 dark:text-blue-100 text-sm leading-relaxed",children:d.summary})})]}),d.keyFactors&&d.keyFactors.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Es,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Key Risk Factors"]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:d.keyFactors.map((_,y)=>e.jsxs("li",{className:"text-yellow-900 dark:text-yellow-100 text-sm flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-3 flex-shrink-0","aria-hidden":"true"}),_]},y))})})]}),d.recommendations&&d.recommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(or,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recommendations"]}),e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:e.jsx("ul",{className:"space-y-2",children:d.recommendations.map((_,y)=>e.jsxs("li",{className:"text-green-900 dark:text-green-100 text-sm flex items-start",children:[e.jsx(oe,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),_]},y))})})]}),d.immediateActions&&d.immediateActions.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Rs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Immediate Actions Required"]}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:e.jsx("ul",{className:"space-y-2",children:d.immediateActions.map((_,y)=>e.jsxs("li",{className:"text-red-900 dark:text-red-100 text-sm flex items-start",children:[e.jsx(ts,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),_]},y))})})]}),d.followUpRecommendations&&d.followUpRecommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Je,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Follow-up Recommendations"]}),e.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:e.jsx("ul",{className:"space-y-2",children:d.followUpRecommendations.map((_,y)=>e.jsxs("li",{className:"text-purple-900 dark:text-purple-100 text-sm flex items-start",children:[e.jsx(ye,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),_]},y))})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(ye,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),"Generated: ",Ne(d.generatedAt),d.modelVersion&&e.jsxs("span",{className:"ml-4",children:["Model: ",d.modelVersion]})]})})]}),b&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:b.message})})]}):null},Qe={queued:{color:"yellow",icon:ye,label:"Queued",description:"Waiting to be processed"},initiated:{color:"blue",icon:ye,label:"Initiated",description:"Session has been created"},running:{color:"blue",icon:J,label:"Processing",description:"Audio is being analyzed"},processing:{color:"blue",icon:J,label:"Processing",description:"Analysis in progress"},succeeded:{color:"green",icon:oe,label:"Completed",description:"Analysis completed successfully"},success:{color:"green",icon:oe,label:"Completed",description:"Analysis completed successfully"},failed:{color:"red",icon:Ge,label:"Failed",description:"Analysis encountered an error"},error:{color:"red",icon:Ge,label:"Error",description:"An error occurred during processing"}},zr=()=>{var p,o,n,f,m,g,S,P,K,xe,Y,Q;const{sessionId:s}=tt(),t=ks(),{announceToScreenReader:r}=ve(),[a,d]=c.useState(null),[x,l]=c.useState(!0),[j,k]=c.useState(null),[u,b]=c.useState(!1),[D,v]=c.useState(!1),[$,C]=c.useState(!1),_=c.useRef(null),y=c.useCallback(async()=>{if(s)try{l(!0),k(null);const T=await W.getSessionData(s);d(T),r(`Session ${s} loaded successfully`)}catch(T){const z=T;k(z),r(`Error loading session: ${z.message}`)}finally{l(!1)}},[s,r]),M=c.useCallback(async()=>{v(!0),await y(),v(!1),r("Session data refreshed")},[y,r]);c.useEffect(()=>{y()},[y]);const q=c.useCallback(()=>{b(T=>{const z=!T;return r(`Raw JSON view ${z?"enabled":"disabled"}`),z})},[r]),V=c.useCallback(()=>{_.current&&($?(_.current.pause(),C(!1),r("Audio paused")):(_.current.play().catch(()=>{r("Failed to play audio")}),C(!0),r("Audio playing")))},[$,r]),se=c.useCallback(()=>{if(!a)return;const T=JSON.stringify(a,null,2),z=new Blob([T],{type:"application/json"}),A=URL.createObjectURL(z),G=document.createElement("a");G.href=A,G.download=`session-${a.sessionId}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL(A),r("Session data download started")},[a,r]),te=({status:T})=>{const z=T.toLowerCase();let A=Qe[T];A||(z.includes("error")||z.includes("fail")?A=Qe.error:A=Qe.failed);const G=A.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${A.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":A.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":A.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${A.label}`,children:[e.jsx(G,{className:`w-4 h-4 mr-2 ${A.color==="blue"&&T==="processing"?"animate-spin":""}`,"aria-hidden":"true"}),A.label]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:A.description})]})};return x?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(J,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading session details..."})]})}):j?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Session"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:j.message}),e.jsxs("div",{className:"mt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:y,className:"btn btn--primary","aria-label":"Retry loading session",children:"Try Again"}),e.jsx(ee,{to:"/sessions",className:"btn btn--secondary",children:"Back to Sessions"})]})]})]})})}):a?e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{type:"button",onClick:()=>t("/sessions"),className:"btn btn--secondary","aria-label":"Back to sessions list",children:[e.jsx(Ft,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Back to Sessions"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Session Details"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:["ID: ",a.sessionId]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:q,className:"btn btn--secondary","aria-label":`${u?"Hide":"Show"} raw JSON data`,children:[u?e.jsx(Kt,{className:"w-4 h-4 mr-2"}):e.jsx(De,{className:"w-4 h-4 mr-2"}),u?"Hide JSON":"Show JSON"]}),e.jsxs("button",{type:"button",onClick:M,disabled:D,className:"btn btn--secondary","aria-label":"Refresh session data",children:[e.jsx(J,{className:`w-4 h-4 mr-2 ${D?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{type:"button",onClick:se,className:"btn btn--primary","aria-label":"Download session data as JSON",children:[e.jsx(We,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),u&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(es,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Raw Session Data"]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 overflow-auto",children:e.jsx("pre",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap break-all",children:JSON.stringify(a,null,2)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(es,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Basic Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsx(te,{status:a.status})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(Cs,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Created"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:_e(a.createdAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(a.createdAt)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(ye,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Last Updated"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:_e(a.updatedAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(a.updatedAt)})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(ps,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"User ID"]}),e.jsx("div",{className:"font-mono text-sm bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded border break-all",children:a.userId})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Qt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Audio Information"]}),e.jsxs("div",{className:"space-y-4",children:[a.audioFileName&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"File Name"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-medium",children:a.audioFileName})]}),a.audioUrl&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Audio File"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:V,className:"btn btn--secondary","aria-label":`${$?"Pause":"Play"} audio`,children:$?e.jsx(ss,{className:"w-4 h-4"}):e.jsx(je,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:$?"Playing audio...":"Audio playback available"})]}),e.jsx("audio",{ref:_,src:a.audioUrl,onPlay:()=>C(!0),onPause:()=>C(!1),onEnded:()=>C(!1),onError:()=>{C(!1),r("Audio playback failed - file may not be accessible")},className:"hidden",preload:"metadata"})]})]})]})]}),a.userMetadata&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ps,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Patient Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.userMetadata.age&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[a.userMetadata.age," years"]})]}),a.userMetadata.gender&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:a.userMetadata.gender.replace(/[_-]/g," ")})]}),a.userMetadata.weight&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[a.userMetadata.weight," lbs"]})]}),a.userMetadata.race&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:a.userMetadata.race})]}),a.userMetadata.ethnicity&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:a.userMetadata.ethnicity})]}),a.userMetadata.zipcode&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-mono",children:a.userMetadata.zipcode})]}),a.userMetadata.language!==void 0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language English"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:a.userMetadata.language?"Yes":"No"})]}),a.userMetadata.sessionNotes&&e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded border",children:a.userMetadata.sessionNotes})]})]})]}),(a.analysisResults||a.prediction)&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ie,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Analysis Results"]}),e.jsxs("div",{className:"space-y-6",children:[(a.analysisResults||a.prediction)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(ue,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Mental Health Scores"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(((p=a.analysisResults)==null?void 0:p.depressionScore)||((o=a.prediction)==null?void 0:o.predicted_score_depression))&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Depression Score"}),e.jsx(Je,{className:"w-4 h-4 text-blue-600 dark:text-blue-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:((f=(n=a.analysisResults)==null?void 0:n.depressionScore)==null?void 0:f.toFixed(2))||((m=a.prediction)!=null&&m.predicted_score_depression?a.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,T=>T.toUpperCase()):"N/A")})]}),(((g=a.analysisResults)==null?void 0:g.anxietyScore)||((S=a.prediction)==null?void 0:S.predicted_score_anxiety))&&e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Anxiety Score"}),e.jsx(as,{className:"w-4 h-4 text-purple-600 dark:text-purple-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:((K=(P=a.analysisResults)==null?void 0:P.anxietyScore)==null?void 0:K.toFixed(2))||((xe=a.prediction)!=null&&xe.predicted_score_anxiety?a.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,T=>T.toUpperCase()):"N/A")})]})]})]}),((Y=a.analysisResults)==null?void 0:Y.insights)&&a.analysisResults.insights.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Clinical Insights"}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:a.analysisResults.insights.map((T,z)=>e.jsxs("li",{className:"text-sm text-yellow-800 dark:text-yellow-200 flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-2 flex-shrink-0","aria-hidden":"true"}),T]},z))})})]}),((Q=a.analysisResults)==null?void 0:Q.completedAt)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Analysis Completion"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(oe,{className:"w-4 h-4 text-green-600 dark:text-green-400 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 mr-2",children:"Completed:"}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Ne(a.analysisResults.completedAt)})]})})]})]})]}),e.jsx(Pr,{sessionId:a.sessionId,existingAssessment:a.riskAssessment||null,onAssessmentUpdated:T=>{d(z=>z?{...z,riskAssessment:T}:null)}})]}):e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Session Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"The requested session could not be found."}),e.jsx(ee,{to:"/sessions",className:"btn btn--primary",children:"Back to Sessions"})]})})},Br=()=>{const[s,t]=c.useState([]),[r,a]=c.useState(!0),[d,x]=c.useState(null),[l,j]=c.useState({dateRange:"all",scoreType:"all",showTrends:!0}),[k,u]=c.useState(!1),{announceToScreenReader:b}=ve(),D=ks(),v=c.useCallback(o=>{D(`/sessions/${o}`),b(`Navigating to session ${o} details`)},[D,b]),$=c.useCallback(async()=>{try{a(!0),x(null);const o=Re(),f=(await W.getUserSessions(o)).sessions.filter(m=>m.analysisResults||m.prediction);t(f),b(`${f.length} prediction sessions loaded`)}catch(o){const n=o;x(n),b(`Error loading predictions: ${n.message}`)}finally{a(!1)}},[b]);c.useEffect(()=>{$()},[$]);const C=c.useMemo(()=>{if(l.dateRange==="all")return s;const o=new Date,n=new Date;switch(l.dateRange){case"week":n.setDate(o.getDate()-7);break;case"month":n.setMonth(o.getMonth()-1);break;case"quarter":n.setMonth(o.getMonth()-3);break;case"year":n.setFullYear(o.getFullYear()-1);break}return s.filter(f=>new Date(f.createdAt)>=n)},[s,l.dateRange]),_=c.useMemo(()=>C.map(o=>{var g,S;const n=P=>{if(!P)return null;switch(P.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return null}},f=n((g=o.prediction)==null?void 0:g.predicted_score_depression),m=n((S=o.prediction)==null?void 0:S.predicted_score_anxiety);return{date:o.createdAt,depression:f,anxiety:m,overall:null,sessionId:o.sessionId}}).sort((o,n)=>new Date(o.date).getTime()-new Date(n.date).getTime()),[C]),y=c.useMemo(()=>{const o={depression:[],anxiety:[]},n=[{category:"no_to_mild",label:"No to Mild",color:"bg-green-400"},{category:"mild_to_moderate",label:"Mild to Moderate",color:"bg-yellow-500"},{category:"moderate_to_severe",label:"Moderate to Severe",color:"bg-red-600"},{category:"no_or_minimal",label:"No or Minimal",color:"bg-green-400"},{category:"moderate",label:"Moderate",color:"bg-orange-500"},{category:"moderately_severe",label:"Moderately Severe",color:"bg-red-500"},{category:"severe",label:"Severe",color:"bg-red-700"}],f=C.map(g=>{var S;return(S=g.prediction)==null?void 0:S.predicted_score_depression}).filter(g=>g!==void 0);n.forEach(g=>{const S=f.filter(K=>K===g.category).length,P=f.length>0?S/f.length*100:0;S>0&&o.depression.push({category:g.label,count:S,percentage:P,color:g.color})});const m=C.map(g=>{var S;return(S=g.prediction)==null?void 0:S.predicted_score_anxiety}).filter(g=>g!==void 0);return n.forEach(g=>{const S=m.filter(K=>K===g.category).length,P=m.length>0?S/m.length*100:0;S>0&&o.anxiety.push({category:g.label,count:S,percentage:P,color:g.color})}),o},[C]),M=c.useMemo(()=>{const o={},n=g=>{if(!g)return 0;switch(g.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},f=C.map(g=>{var S;return(S=g.prediction)==null?void 0:S.predicted_score_depression}).filter(g=>g!==void 0);if(f.length<2)o.depression={direction:"stable",change:0,period:"insufficient data"};else{const g=f.map(n),S=g.slice(0,Math.floor(g.length/2)),P=g.slice(Math.floor(g.length/2)),K=S.reduce((Q,T)=>Q+T,0)/S.length,Y=P.reduce((Q,T)=>Q+T,0)/P.length-K;o.depression={direction:Math.abs(Y)<.5?"stable":Y<0?"improving":"worsening",change:Math.abs(Y),period:`${C.length} sessions`}}const m=C.map(g=>{var S;return(S=g.prediction)==null?void 0:S.predicted_score_anxiety}).filter(g=>g!==void 0);if(m.length<2)o.anxiety={direction:"stable",change:0,period:"insufficient data"};else{const g=m.map(n),S=g.slice(0,Math.floor(g.length/2)),P=g.slice(Math.floor(g.length/2)),K=S.reduce((Q,T)=>Q+T,0)/S.length,Y=P.reduce((Q,T)=>Q+T,0)/P.length-K;o.anxiety={direction:Math.abs(Y)<.5?"stable":Y<0?"improving":"worsening",change:Math.abs(Y),period:`${C.length} sessions`}}return o.overall={direction:"stable",change:0,period:"coming soon"},o},[C]),q=c.useMemo(()=>{const o={totalSessions:C.length,avgDepression:0,avgAnxiety:0,avgOverall:0,latestSession:null,improvementSessions:0};if(C.length===0)return o;const n=C.map(m=>{var g;return(g=m.prediction)==null?void 0:g.predictedScoreDepression}).filter(m=>m!==void 0),f=C.map(m=>{var g;return(g=m.prediction)==null?void 0:g.predictedScoreAnxiety}).filter(m=>m!==void 0);if(n.length>0){const m={};n.forEach(S=>{m[S]=(m[S]||0)+1});const g=Object.entries(m).sort(([,S],[,P])=>P-S)[0][0];o.avgDepression=m[g]}if(f.length>0){const m={};f.forEach(S=>{m[S]=(m[S]||0)+1});const g=Object.entries(m).sort(([,S],[,P])=>P-S)[0][0];o.avgAnxiety=m[g]}return o.latestSession=C.sort((m,g)=>new Date(g.createdAt).getTime()-new Date(m.createdAt).getTime())[0],o.improvementSessions=0,o},[C]),V=c.useCallback((o,n)=>{j(f=>({...f,[o]:n})),b(`Filter ${o} changed to ${n}`)},[b]),se=c.useCallback(()=>{const o=JSON.stringify(C,null,2),n=new Blob([o],{type:"application/json"}),f=URL.createObjectURL(n),m=document.createElement("a");m.href=f,m.download=`predictions-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(f),b("Predictions data download started")},[C,b]),te=({trend:o,label:n})=>{const f=o.direction==="improving"?Ms:o.direction==="worsening"?Je:Ie,m=o.direction==="improving"?"text-green-600 dark:text-green-400":o.direction==="worsening"?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400";return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{className:`w-4 h-4 ${m}`,"aria-hidden":"true"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:n}),e.jsxs("span",{className:`text-sm font-medium ${m} capitalize`,children:[o.direction,o.period==="insufficient data"?" (need more sessions)":o.period==="coming soon"?" (analysis coming soon)":` (${o.period})`]})]})},p=({data:o,type:n,onBarClick:f})=>{const m=o.map(A=>A[n]).filter(A=>A!==null);if(m.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No data available"});const g=Math.max(...m),S=Math.min(...m),P=g-S||1,K=A=>{switch(A){case 1:return"No to Mild / No or Minimal";case 2:return"Mild to Moderate / Moderate";case 3:return"Moderate to Severe / Moderately Severe";case 4:return"Severe";default:return"Unknown"}},xe=(A,G)=>{if(G==="depression")switch(A){case 1:return"bg-blue-400";case 2:return"bg-blue-600";case 3:return"bg-blue-800";default:return"bg-blue-500"}else if(G==="anxiety")switch(A){case 1:return"bg-purple-400";case 2:return"bg-purple-600";case 3:return"bg-purple-700";case 4:return"bg-purple-900";default:return"bg-purple-500"}else switch(A){case 1:return"bg-green-400";case 2:return"bg-green-600";case 3:return"bg-green-700";case 4:return"bg-green-800";default:return"bg-green-500"}},Y=A=>[{score:1,label:"No/Minimal"},{score:2,label:"Mild"},{score:3,label:"Moderate"},{score:4,label:"Mod-Severe"},{score:5,label:"Severe"}].map(ne=>({...ne,color:xe(ne.score,A)})),Q=new Set(m),z=Y(n).filter(A=>Q.has(A.score));return e.jsxs("div",{children:[e.jsx("div",{className:"h-32 flex items-end space-x-1 px-4 py-2 mb-4",children:o.map((A,G)=>{const ne=A[n];if(ne===null)return null;const L=(ne-S)/P*100,O=xe(ne,n),Me=K(ne),be=new Date(A.date).toLocaleDateString();return e.jsx("div",{className:`flex-1 ${O} opacity-70 hover:opacity-100 hover:scale-105 transition-all duration-200 rounded-t cursor-pointer relative group chart-bar-dynamic`,style:{"--chart-height":`${Math.max(L,8)}%`},onClick:()=>f(A.sessionId),role:"button",tabIndex:0,onKeyDown:we=>{(we.key==="Enter"||we.key===" ")&&(we.preventDefault(),f(A.sessionId))},"aria-label":`View session details for ${Me} score on ${be}`,children:e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-medium",children:Me}),e.jsx("div",{className:"text-gray-300",children:be}),e.jsxs("div",{className:"text-gray-300",children:["Session: ",A.sessionId.slice(-8)]}),e.jsx("div",{className:"text-gray-400 text-xs mt-1",children:"Click to view details"}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"})]})},G)})}),z.length>0&&e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"Legend:"}),z.map(A=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-3 h-3 ${A.color} rounded`}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:A.label})]},A.score))]})})]})};return r?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(J,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading predictions..."})]})}):d?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Predictions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:d.message}),e.jsx("button",{type:"button",onClick:$,className:"mt-4 btn btn--primary","aria-label":"Retry loading predictions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Predictions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Analyze your mental health trends and insights over time"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>u(!k),className:"btn btn--secondary","aria-expanded":k?"true":"false","aria-label":`${k?"Hide":"Show"} filter options`,children:[e.jsx(Ds,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",k?e.jsx(Is,{className:"w-4 h-4 ml-2"}):e.jsx(_s,{className:"w-4 h-4 ml-2"})]}),e.jsxs("button",{type:"button",onClick:$,className:"btn btn--secondary","aria-label":"Refresh predictions data",children:[e.jsx(J,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{type:"button",onClick:se,className:"btn btn--primary",disabled:C.length===0,"aria-label":"Download predictions data",children:[e.jsx(We,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),k&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-range",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-range",value:l.dateRange,onChange:o=>V("dateRange",o.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"quarter",children:"Past Quarter"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"score-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Focus Score"}),e.jsxs("select",{id:"score-type",value:l.scoreType,onChange:o=>V("scoreType",o.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Scores"}),e.jsx("option",{value:"depression",children:"Depression"}),e.jsx("option",{value:"anxiety",children:"Anxiety"}),e.jsx("option",{value:"overall",children:"Overall"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:l.showTrends,onChange:o=>V("showTrends",o.target.checked),className:"form__input form__input--checkbox rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show trend analysis"})]})})]})}),C.length===0?e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Prediction Data Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't completed any analysis sessions yet.":"No sessions found for the selected date range."}),e.jsx(ee,{to:"/upload",className:"btn btn--primary",children:"Start Your First Analysis"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ie,{className:"w-8 h-8 text-blue-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:q.totalSessions})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ue,{className:"w-8 h-8 text-purple-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Depression (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const o=C.map(m=>{var g;return(g=m.prediction)==null?void 0:g.predicted_score_depression}).filter(m=>m!==void 0);if(o.length===0)return"â€”";const n={};return o.forEach(m=>{n[m]=(n[m]||0)+1}),Object.entries(n).sort(([,m],[,g])=>g-m)[0][0].replace(/_/g," ").replace(/\b\w/g,m=>m.toUpperCase())})()})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(as,{className:"w-8 h-8 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Anxiety (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const o=C.map(m=>{var g;return(g=m.prediction)==null?void 0:g.predicted_score_anxiety}).filter(m=>m!==void 0);if(o.length===0)return"â€”";const n={};return o.forEach(m=>{n[m]=(n[m]||0)+1}),Object.entries(n).sort(([,m],[,g])=>g-m)[0][0].replace(/_/g," ").replace(/\b\w/g,m=>m.toUpperCase())})()})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(l.scoreType==="all"||l.scoreType==="depression")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(hs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Depression Score Trend"]}),e.jsx(p,{data:_,type:"depression",onBarClick:v}),l.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(te,{trend:M.depression,label:"Trend:"})})]}),(l.scoreType==="all"||l.scoreType==="anxiety")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Pt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Anxiety Score Trend"]}),e.jsx(p,{data:_,type:"anxiety",onBarClick:v}),l.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(te,{trend:M.anxiety,label:"Trend:"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(hs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Score Distribution"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(y).map(([o,n])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 capitalize",children:[o," Scores"]}),e.jsx("div",{className:"space-y-2",children:n.map(f=>e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:f.category}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[f.count," (",f.percentage.toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${f.color} progress-dynamic progress-animated`,style:{"--progress-width":`${f.percentage}%`}})})]})},f.category))})]},o))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(ye,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recent Analysis Sessions"]}),e.jsx(ee,{to:"/sessions",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 text-sm",children:"View All Sessions â†’"})]}),e.jsx("div",{className:"space-y-4",children:C.slice(0,5).map(o=>{var n,f;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${o.status==="succeeded"?"bg-green-500":o.status==="processing"?"bg-blue-500":o.status==="failed"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:o.audioFileName||`Session ${o.sessionId.slice(-8)}`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:_e(o.createdAt)})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[((n=o.prediction)==null?void 0:n.predicted_score_depression)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Depression"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:o.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,m=>m.toUpperCase())})]}),((f=o.prediction)==null?void 0:f.predicted_score_anxiety)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Anxiety"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:o.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,m=>m.toUpperCase())})]}),e.jsx(ee,{to:`/sessions/${o.sessionId}`,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400","aria-label":`View session ${o.sessionId}`,children:e.jsx(De,{className:"w-4 h-4","aria-hidden":"true"})})]})]},o.sessionId)})})]})]})]})},rs=(s,t)=>t>0?Math.round(s/t*100):0,Hr=s=>{const t=s.length,r=new Set(s.map(y=>y.userId)).size,a=s.filter(y=>y.status==="succeeded"&&y.prediction),d=s.filter(y=>y.status==="failed"),x=s.filter(y=>y.status==="processing"),l=rs(a.length,t),j=r>0?Math.round(t/r*10)/10:0,k=new Date(Date.now()-24*60*60*1e3),u=s.filter(y=>new Date(y.createdAt)>k).length,b={low:0,medium:0,high:0,unknown:0};s.forEach(y=>{var q;const M=((q=y.analysisResults)==null?void 0:q.riskLevel)||"unknown";M in b&&b[M]++});const D={no_to_mild:0,mild_to_moderate:0,moderate_to_severe:0,severe:0},v={no_or_minimal:0,mild:0,moderate:0,moderately_severe:0,severe:0};a.forEach(y=>{if(y.prediction){const M=y.prediction.predictedScoreDepression;M&&M in D&&D[M]++;const q=y.prediction.predictedScoreAnxiety;q&&q in v&&v[q]++}});const $=[];for(let y=6;y>=0;y--){const M=new Date;M.setDate(M.getDate()-y);const q=M.toISOString().split("T")[0],V=s.filter(se=>se.createdAt.split("T")[0]===q).length;$.push({date:q,count:V})}const C=new Map;s.forEach(y=>{C.has(y.userId)||C.set(y.userId,{totalSessions:0,successfulSessions:0,sessions:[]});const M=C.get(y.userId);M.totalSessions++,M.sessions.push(y),y.status==="succeeded"&&y.prediction&&M.successfulSessions++});const _=Array.from(C.entries()).map(([y,M])=>{var f;const q=rs(M.successfulSessions,M.totalSessions),V=M.sessions.filter(m=>{var g;return m.status==="succeeded"&&m.prediction&&((g=m.analysisResults)==null?void 0:g.confidence)}),se=V.length>0?V.reduce((m,g)=>{var S;return m+(((S=g.analysisResults)==null?void 0:S.confidence)||0)},0)/V.length:0,te={low:0,medium:0,high:0,unknown:0};M.sessions.forEach(m=>{var S;const g=((S=m.analysisResults)==null?void 0:S.riskLevel)||"unknown";g in te&&te[g]++});const p={no_to_mild:0,mild_to_moderate:0,moderate_to_severe:0,severe:0},o={no_or_minimal:0,mild:0,moderate:0,moderately_severe:0,severe:0};V.forEach(m=>{if(m.prediction){const g=m.prediction.predictedScoreDepression;g&&g in p&&p[g]++;const S=m.prediction.predictedScoreAnxiety;S&&S in o&&o[S]++}});const n=M.sessions.reduce((m,g)=>new Date(g.updatedAt)>new Date(m)?g.updatedAt:m,((f=M.sessions[0])==null?void 0:f.updatedAt)||new Date().toISOString());return{userId:y,totalSessions:M.totalSessions,successfulSessions:M.successfulSessions,successRate:q,avgConfidence:Math.round(se*100)/100,riskDistribution:te,lastActivity:n,depressionScores:p,anxietyScores:o}}).sort((y,M)=>M.totalSessions-y.totalSessions);return{overview:{totalSessions:t,uniqueUsers:r,successRate:l,avgSessionsPerUser:j,recentActivity:u},sessionStatus:{succeeded:a.length,failed:d.length,processing:x.length,total:t},riskLevels:{...b,total:t},predictions:{depression:{...D,total:a.length},anxiety:{...v,total:a.length}},timeData:$,riskDistribution:b,userStats:_}},He=({title:s,value:t,subtitle:r,icon:a,trend:d,color:x="text-blue-600"})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:s}),e.jsx("p",{className:`text-2xl font-bold ${x} dark:text-white mt-1`,children:t}),r&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:r})]}),e.jsx("div",{className:`p-3 rounded-full bg-gray-100 dark:bg-gray-700 ${x}`,children:a})]}),d&&e.jsxs("div",{className:"flex items-center mt-4",children:[d==="up"&&e.jsx(Je,{className:"h-4 w-4 text-green-500 mr-1"}),d==="down"&&e.jsx(Ms,{className:"h-4 w-4 text-red-500 mr-1"}),e.jsx("span",{className:`text-sm ${d==="up"?"text-green-600":d==="down"?"text-red-600":"text-gray-500"}`,children:d==="up"?"Trending up":d==="down"?"Trending down":"Stable"})]})]}),qe=({title:s,data:t,total:r})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:s}),e.jsx("div",{className:"space-y-3",children:t.map((a,d)=>{const x=rs(a.value,r);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:a.label}),e.jsxs("span",{className:"text-gray-900 dark:text-white font-medium",children:[a.value," (",x,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${a.color}`,style:{width:`${x}%`},role:"progressbar","aria-label":`${a.label}: ${a.value} (${x}%)`})})]},d)})})]}),qr=({title:s,data:t})=>{const r=Math.max(...t.map(x=>x.count),1),a=0,d=r-a||1;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-6",children:s}),e.jsx("div",{className:"relative h-48",children:e.jsxs("svg",{className:"absolute inset-0 w-full h-full",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[e.jsxs("defs",{children:[e.jsx("pattern",{id:"grid",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:"rgb(229 231 235)",strokeWidth:"0.5",className:"dark:stroke-gray-600"})}),e.jsxs("linearGradient",{id:"barGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"rgb(59 130 246)",stopOpacity:"0.8"}),e.jsx("stop",{offset:"100%",stopColor:"rgb(59 130 246)",stopOpacity:"0.6"})]})]}),e.jsx("rect",{width:"100",height:"100",fill:"url(#grid)"}),t.map((x,l)=>{const j=80/t.length,k=l/(t.length-1)*(100-j)+j/2,u=(x.count-a)/d*95,b=100-u;return e.jsx("rect",{x:k-j/2,y:b,width:j*.6,height:u,fill:"url(#barGradient)",stroke:"rgb(59 130 246)",strokeWidth:"0.2",className:"transition-all duration-300 hover:opacity-80",rx:"0.5"},l)})]})}),e.jsx("div",{className:"flex items-center justify-between mt-4 px-2",children:t.map((x,l)=>{const j=new Date(x.date),k=j.toLocaleDateString("en-US",{weekday:"short"}),u=j.toLocaleDateString("en-US",{month:"short",day:"numeric"});return e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 dark:text-white",children:k}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:u}),e.jsx("div",{className:"text-xs font-bold text-blue-600 dark:text-blue-400 mt-1",children:x.count})]},l)})})]})},Vr=({title:s,depressionData:t,anxietyData:r})=>{const a=[{depression:t.no_to_mild,anxiety:r.no_or_minimal,severity:"Low",label:"Minimal/None"},{depression:t.mild_to_moderate,anxiety:r.mild,severity:"Mild",label:"Mild"},{depression:t.moderate_to_severe,anxiety:r.moderate,severity:"Moderate",label:"Moderate"},{depression:t.severe,anxiety:r.moderately_severe+r.severe,severity:"High",label:"Severe"}],d=Math.max(...a.map(l=>Math.max(l.depression,l.anxiety)),10),x=l=>{switch(l){case"Low":return"fill-green-500 stroke-green-600";case"Mild":return"fill-yellow-500 stroke-yellow-600";case"Moderate":return"fill-orange-500 stroke-orange-600";case"High":return"fill-red-500 stroke-red-600";default:return"fill-gray-500 stroke-gray-600"}};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-6",children:s}),e.jsx("div",{className:"relative h-96",children:e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 400 300",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"correlationGrid",width:"40",height:"30",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 40 0 L 0 0 0 30",fill:"none",stroke:"rgb(229 231 235)",strokeWidth:"0.5",className:"dark:stroke-gray-600"})})}),e.jsx("rect",{width:"400",height:"300",fill:"url(#correlationGrid)"}),e.jsx("line",{x1:"50",y1:"270",x2:"370",y2:"270",stroke:"rgb(107 114 128)",strokeWidth:"2"}),e.jsx("line",{x1:"50",y1:"270",x2:"50",y2:"30",stroke:"rgb(107 114 128)",strokeWidth:"2"}),a.map((l,j)=>{const k=50+l.depression/d*320,u=270-l.anxiety/d*240,b=Math.max(Math.sqrt(l.depression+l.anxiety)*2.5,8);return e.jsxs("g",{children:[e.jsx("circle",{cx:k,cy:u,r:b,className:`${x(l.severity)} opacity-70 hover:opacity-90 transition-opacity`,strokeWidth:"2"}),e.jsx("text",{x:k,y:u+4,textAnchor:"middle",className:"text-xs fill-white font-bold",children:l.depression+l.anxiety})]},j)}),e.jsx("text",{x:"210",y:"295",textAnchor:"middle",className:"text-sm font-medium fill-gray-700 dark:fill-gray-300",children:"Depression Cases â†’"}),e.jsx("text",{x:"30",y:"150",textAnchor:"middle",transform:"rotate(-90 30 150)",className:"text-sm font-medium fill-gray-700 dark:fill-gray-300",children:"â† Anxiety Cases"})]})}),e.jsx("div",{className:"mt-4 flex justify-center space-x-4",children:a.map((l,j)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${x(l.severity).replace("fill-","bg-").replace("stroke-","border-").replace(" stroke-gray-600","").replace(" stroke-green-600","").replace(" stroke-yellow-600","").replace(" stroke-orange-600","").replace(" stroke-red-600","")}`}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.label})]},j))})]})},Gr=({title:s,sessionStatus:t})=>{const r=[{label:"Total Sessions",value:t.total,color:"bg-blue-500"},{label:"In Processing",value:t.processing,color:"bg-yellow-500"},{label:"Completed",value:t.succeeded,color:"bg-green-500"},{label:"Failed",value:t.failed,color:"bg-red-500"}],a=t.total||1;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-6",children:s}),e.jsx("div",{className:"space-y-4",children:r.map((d,x)=>{const l=d.value/a*100,j=x>0?(d.value/r[0].value*100).toFixed(1):"100.0";return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:d.label}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:d.value}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",j,"%)"]})]})]}),e.jsxs("div",{className:"relative h-8 bg-gray-200 dark:bg-gray-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:`h-full ${d.color} transition-all duration-700 ease-out flex items-center justify-center relative`,style:{width:`${l}%`},children:l>20&&e.jsx("span",{className:"text-xs font-medium text-white",children:d.value})}),x<r.length-1&&e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]},x)})}),e.jsx("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[(t.succeeded/t.total*100).toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Success Rate"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:[(t.failed/t.total*100).toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Failure Rate"})]})]})})]})},Wr=({userStats:s})=>{const t=l=>new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),r=(l,j)=>{if(j===0)return"text-gray-400";switch(l){case"low":return"text-green-600";case"medium":return"text-yellow-600";case"high":return"text-red-600";default:return"text-gray-600"}},a=s.length,d=a>0?Math.round(s.reduce((l,j)=>l+j.totalSessions,0)/a*10)/10:0,x=s.length>0?s.reduce((l,j)=>j.successRate>l.successRate?j:l,s[0]):null;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[e.jsx($s,{className:"h-5 w-5 mr-2 text-blue-500"}),"Per-User Analytics"]}),e.jsxs("div",{className:"flex space-x-6 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:a}),e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Total Users"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:d}),e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Avg Sessions"})]}),x&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-semibold text-green-600",children:[x.successRate,"%"]}),e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Best Job Success Rate"})]})]})]}),s.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"No user data available"}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:"Risk Distribution Legend:"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded text-xs font-medium",children:"L"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Low Risk"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 rounded text-xs font-medium",children:"M"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Medium Risk"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200 rounded text-xs font-medium",children:"H"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"High Risk"})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-2 font-medium text-gray-900 dark:text-white",children:"User ID"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium text-gray-900 dark:text-white",children:"Sessions"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium text-gray-900 dark:text-white",children:"Job Success Rate"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium text-gray-900 dark:text-white",children:"Avg Confidence"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium text-gray-900 dark:text-white",children:"Risk Distribution"}),e.jsx("th",{className:"text-right py-3 px-2 font-medium text-gray-900 dark:text-white",children:"Last Activity"})]})}),e.jsx("tbody",{children:s.map((l,j)=>e.jsxs("tr",{className:`border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors ${j%2===0?"bg-gray-50 dark:bg-gray-800":"bg-white dark:bg-gray-900"}`,children:[e.jsx("td",{className:"py-3 px-2",children:e.jsx("div",{className:"font-mono text-sm text-gray-900 dark:text-white",children:e.jsxs("div",{className:"truncate max-w-[120px]",title:l.userId,children:[l.userId.substring(0,8),"..."]})})}),e.jsxs("td",{className:"py-3 px-2 text-center",children:[e.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:l.totalSessions}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[l.successfulSessions," successful"]})]}),e.jsx("td",{className:"py-3 px-2 text-center",children:e.jsxs("div",{className:`font-medium ${l.successRate>=80?"text-green-600":l.successRate>=60?"text-yellow-600":"text-red-600"}`,children:[l.successRate,"%"]})}),e.jsx("td",{className:"py-3 px-2 text-center",children:e.jsxs("div",{className:"text-gray-900 dark:text-white font-medium",children:[(l.avgConfidence*100).toFixed(1),"%"]})}),e.jsx("td",{className:"py-3 px-2 text-center",children:e.jsxs("div",{className:"flex justify-center space-x-2 text-xs",children:[e.jsxs("span",{className:`px-1 py-0.5 rounded ${r("low",l.riskDistribution.low)}`,children:["L:",l.riskDistribution.low]}),e.jsxs("span",{className:`px-1 py-0.5 rounded ${r("medium",l.riskDistribution.medium)}`,children:["M:",l.riskDistribution.medium]}),e.jsxs("span",{className:`px-1 py-0.5 rounded ${r("high",l.riskDistribution.high)}`,children:["H:",l.riskDistribution.high]})]})}),e.jsx("td",{className:"py-3 px-2 text-right",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:t(l.lastActivity)})})]},l.userId))})]})})]})]})},Jr=()=>{const[s,t]=c.useState(null),[r,a]=c.useState(!1),[d,x]=c.useState(null),[l,j]=c.useState(new Date),{announceToScreenReader:k}=ve(),u=parseInt("69")*1e3,b=c.useCallback(async()=>{try{a(!0),x(null);let v=[];try{v=(await W.getAllSessions()).sessions}catch(C){console.warn("getAllSessions endpoint not available, using mock data for demonstration:",C),v=[{sessionId:"demo-session-1",userId:"a8b7c6d5-e4f3-4a2b-9c8d-7e6f5a4b3c2d",status:"succeeded",createdAt:new Date(Date.now()-1e3*60*60*2).toISOString(),updatedAt:new Date().toISOString(),audioFileName:"session_1.wav",prediction:{sessionId:"demo-session-1",status:"succeeded",predictedScoreDepression:"mild_to_moderate",predictedScoreAnxiety:"no_or_minimal",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},analysisResults:{riskLevel:"medium",confidence:.85,insights:["Analysis completed"],completedAt:new Date().toISOString()}},{sessionId:"demo-session-2",userId:"f1e2d3c4-b5a6-4c7d-8e9f-0a1b2c3d4e5f",status:"succeeded",createdAt:new Date(Date.now()-1e3*60*60*6).toISOString(),updatedAt:new Date().toISOString(),audioFileName:"session_2.wav",prediction:{sessionId:"demo-session-2",status:"succeeded",predictedScoreDepression:"no_to_mild",predictedScoreAnxiety:"moderate",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},analysisResults:{riskLevel:"low",confidence:.92,insights:["Analysis completed"],completedAt:new Date().toISOString()}},{sessionId:"demo-session-3",userId:"9d8c7b6a-5e4f-4392-8a1b-0c9d8e7f6a5b",status:"failed",createdAt:new Date(Date.now()-1e3*60*60*12).toISOString(),updatedAt:new Date().toISOString(),audioFileName:"session_3.wav",analysisResults:{riskLevel:"unknown",confidence:0,insights:["Processing failed"],completedAt:new Date().toISOString()}},{sessionId:"demo-session-4",userId:"a8b7c6d5-e4f3-4a2b-9c8d-7e6f5a4b3c2d",status:"succeeded",createdAt:new Date(Date.now()-1e3*60*60*24).toISOString(),updatedAt:new Date().toISOString(),audioFileName:"session_4.wav",prediction:{sessionId:"demo-session-4",status:"succeeded",predictedScoreDepression:"moderate_to_severe",predictedScoreAnxiety:"moderately_severe",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},analysisResults:{riskLevel:"high",confidence:.78,insights:["Analysis completed"],completedAt:new Date().toISOString()}},{sessionId:"demo-session-5",userId:"4c3b2a19-8e7f-4d6c-5b4a-392817f6e5d4",status:"processing",createdAt:new Date(Date.now()-1e3*60*30).toISOString(),updatedAt:new Date().toISOString(),audioFileName:"session_5.wav",analysisResults:{riskLevel:"unknown",confidence:0,insights:["Processing in progress"],completedAt:new Date().toISOString()}},{sessionId:"demo-session-6",userId:"f1e2d3c4-b5a6-4c7d-8e9f-0a1b2c3d4e5f",status:"succeeded",createdAt:new Date(Date.now()-1e3*60*60*36).toISOString(),updatedAt:new Date().toISOString(),audioFileName:"session_6.wav",prediction:{sessionId:"demo-session-6",status:"succeeded",predictedScoreDepression:"no_to_mild",predictedScoreAnxiety:"mild",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},analysisResults:{riskLevel:"low",confidence:.89,insights:["Analysis completed"],completedAt:new Date().toISOString()}},{sessionId:"demo-session-7",userId:"7f6e5d4c-3b2a-4190-8e7f-6d5c4b3a2918",status:"succeeded",createdAt:new Date(Date.now()-1e3*60*60*48).toISOString(),updatedAt:new Date().toISOString(),audioFileName:"session_7.wav",prediction:{sessionId:"demo-session-7",status:"succeeded",predictedScoreDepression:"mild_to_moderate",predictedScoreAnxiety:"moderate",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},analysisResults:{riskLevel:"medium",confidence:.82,insights:["Analysis completed"],completedAt:new Date().toISOString()}}]}const $=Hr(v);t($),j(new Date),k("Control panel data loaded successfully")}catch(v){const $=v;x($),k(`Error loading control panel data: ${$.message}`)}finally{a(!1)}},[k]);c.useEffect(()=>{b()},[b]),c.useEffect(()=>{const v=setInterval(()=>{r||b()},u);return()=>clearInterval(v)},[b,r,u]);const D=c.useCallback(()=>{x(null),b()},[b]);return r?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"h-6 w-6 animate-spin text-blue-500"}),e.jsx("span",{className:"text-lg text-gray-600 dark:text-gray-300",children:"Loading control panel data..."})]})})})}):d?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(de,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Error Loading Control Panel"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:d.message}),e.jsxs("button",{onClick:D,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Retry"]})]})})})}):s?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Control Panel"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"System-wide analytics and insights dashboard"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Last updated: ",l.toLocaleTimeString()]}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Auto-refresh: ",u/1e3,"s intervals"]})]}),e.jsxs("button",{onClick:b,disabled:r,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors","aria-label":"Refresh control panel data",children:[e.jsx(J,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"Refresh"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(He,{title:"Total Sessions",value:s.overview.totalSessions,subtitle:"All time",icon:e.jsx(Ie,{className:"h-6 w-6"}),color:"text-blue-600"}),e.jsx(He,{title:"Unique Users",value:s.overview.uniqueUsers,subtitle:"Active users",icon:e.jsx($s,{className:"h-6 w-6"}),color:"text-green-600"}),e.jsx(He,{title:"Job Success Rate",value:`${s.overview.successRate}%`,subtitle:"Completed analyses",icon:e.jsx(Rs,{className:"h-6 w-6"}),color:"text-purple-600",trend:s.overview.successRate>75?"up":s.overview.successRate<50?"down":"neutral"}),e.jsx(He,{title:"Recent Activity",value:s.overview.recentActivity,subtitle:"Last 24 hours",icon:e.jsx(ye,{className:"h-6 w-6"}),color:"text-orange-600",trend:s.overview.recentActivity>5?"up":s.overview.recentActivity===0?"down":"neutral"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(qe,{title:"Session Status Distribution",data:[{label:"Succeeded",value:s.sessionStatus.succeeded,color:"bg-green-500"},{label:"Processing",value:s.sessionStatus.processing,color:"bg-yellow-500"},{label:"Failed",value:s.sessionStatus.failed,color:"bg-red-500"}],total:s.sessionStatus.total}),e.jsx(qe,{title:"Risk Level Distribution",data:[{label:"Low Risk",value:s.riskLevels.low,color:"bg-green-500"},{label:"Medium Risk",value:s.riskLevels.medium,color:"bg-yellow-500"},{label:"High Risk",value:s.riskLevels.high,color:"bg-red-500"},{label:"Unknown",value:s.riskLevels.unknown,color:"bg-gray-500"}],total:s.riskLevels.total})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(qe,{title:"Depression Score Distribution",data:[{label:"No to Mild",value:s.predictions.depression.no_to_mild,color:"bg-green-500"},{label:"Mild to Moderate",value:s.predictions.depression.mild_to_moderate,color:"bg-yellow-500"},{label:"Moderate to Severe",value:s.predictions.depression.moderate_to_severe,color:"bg-orange-500"},{label:"Severe",value:s.predictions.depression.severe,color:"bg-red-500"}],total:s.predictions.depression.total}),e.jsx(qe,{title:"Anxiety Score Distribution",data:[{label:"No or Minimal",value:s.predictions.anxiety.no_or_minimal,color:"bg-green-500"},{label:"Mild",value:s.predictions.anxiety.mild,color:"bg-yellow-500"},{label:"Moderate",value:s.predictions.anxiety.moderate,color:"bg-orange-500"},{label:"Moderately Severe",value:s.predictions.anxiety.moderately_severe,color:"bg-red-500"},{label:"Severe",value:s.predictions.anxiety.severe,color:"bg-red-700"}],total:s.predictions.anxiety.total})]}),e.jsx("div",{className:"mb-8",children:e.jsx(Wr,{userStats:s.userStats})}),e.jsx("div",{className:"mb-8",children:e.jsx(Vr,{title:"Depression vs Anxiety Correlation",depressionData:s.predictions.depression,anxietyData:s.predictions.anxiety})}),e.jsx("div",{className:"mb-8",children:e.jsx(Gr,{title:"Session Completion Funnel",sessionStatus:s.sessionStatus})}),e.jsx("div",{className:"mb-8",children:e.jsx(qr,{title:"Sessions Over Time (7 Days)",data:s.timeData})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(as,{className:"h-5 w-5 mr-2 text-red-500"}),"System Health Overview"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[s.overview.successRate,"%"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Job Success Rate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:s.overview.totalSessions}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Sessions"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:s.sessionStatus.processing}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Processing"})]})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("span",{className:"text-lg text-gray-600 dark:text-gray-300",children:"No data available"})})})})},Kr=()=>{const{data:s,isLoading:t,error:r,refetch:a}=Ts(),{announce:d}=Ss();Ns.useEffect(()=>{d("System Health page loaded","polite")},[d]);const x=u=>{if(!u)return"Just now";try{const b=new Date(u);return isNaN(b.getTime())?"Just now":b.toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return"Just now"}},l=u=>{switch(u==null?void 0:u.toLowerCase()){case"healthy":return"text-green-600 dark:text-green-400";case"degraded":return"text-yellow-600 dark:text-yellow-400";case"unhealthy":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},j=u=>{switch(u==null?void 0:u.toLowerCase()){case"healthy":return"âœ…";case"degraded":return"âš ï¸";case"unhealthy":return"âŒ";default:return"â“"}},k=u=>{const b="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium";switch(u==null?void 0:u.toLowerCase()){case"healthy":return`${b} bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200`;case"degraded":return`${b} bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200`;case"unhealthy":return`${b} bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200`;default:return`${b} bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200`}};return e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"System Health"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Monitor API status and system connectivity"})]}),e.jsxs("button",{type:"button",onClick:()=>a(),disabled:t,className:"btn btn--secondary flex items-center space-x-2","aria-label":"Refresh system health status",children:[e.jsx(J,{className:`w-4 h-4 ${t?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),t&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"w-6 h-6 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Checking system health..."})]})}),r&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-6 h-6 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Health Check Failed"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:r.message||"Unable to retrieve system health status"}),e.jsx("button",{type:"button",onClick:()=>a(),className:"mt-3 text-sm text-red-800 dark:text-red-200 hover:text-red-900 dark:hover:text-red-100 underline",children:"Try again"})]})]})}),s&&!t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Overall System Status"}),e.jsxs("div",{className:k(s.status),children:[e.jsx("span",{className:"mr-1",children:j(s.status)}),s.status]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:j(s.status)}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Status"}),e.jsx("div",{className:`font-medium ${l(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"â±ï¸"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Response Time"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:s.totalDuration?`${s.totalDuration}ms`:"N/A"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“…"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last Checked"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:x(s.timestamp)})]})]})]}),s.checks&&Object.keys(s.checks).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ie,{className:"w-5 h-5 mr-2"}),"Service Details"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.checks).map(([u,b])=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:j(b.status)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white capitalize",children:u.replace(/-/g," ")}),b.description&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:b.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[b.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[b.duration,"ms"]}),e.jsx("div",{className:k(b.status),children:b.status})]})]},u))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(es,{className:"w-5 h-5 mr-2"}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"API Endpoints"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Health Check:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/health"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Sessions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/sessions"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Predictions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/predictions"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Connection Status"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"API Connected"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Real-time Updates"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Auto-refresh Enabled"})]})]})]})]})]})]})]})},Yr=()=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Page Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"The page you're looking for doesn't exist."}),e.jsx("a",{href:"/",className:"btn btn--primary",children:"Go to Dashboard"})]}),Zr=new Qs({defaultOptions:{queries:{retry:(s,t)=>{if(t&&typeof t=="object"&&"code"in t){const r=t.code;if(r!=null&&r.startsWith("HTTP_4")&&r!=="HTTP_408")return!1}return s<3},staleTime:5*60*1e3,refetchOnWindowFocus:!1},mutations:{retry:1}}});function Qr(){return e.jsxs(Xs,{client:Zr,children:[e.jsx(Nt,{children:e.jsx(rt,{children:e.jsx(Ct,{children:e.jsxs(at,{children:[e.jsx(he,{path:"/",element:e.jsx(Mr,{})}),e.jsx(he,{path:"/upload",element:e.jsx(Or,{})}),e.jsx(he,{path:"/sessions",element:e.jsx(Ur,{})}),e.jsx(he,{path:"/sessions/:sessionId",element:e.jsx(zr,{})}),e.jsx(he,{path:"/predictions",element:e.jsx(Br,{})}),e.jsx(he,{path:"/control-panel",element:e.jsx(Jr,{})}),e.jsx(he,{path:"/health",element:e.jsx(Kr,{})}),e.jsx(he,{path:"*",element:e.jsx(Yr,{})})]})})})}),!1]})}const fs=localStorage.getItem("bh_theme"),Xr=window.matchMedia("(prefers-color-scheme: dark)").matches,ea=fs==="dark"||!fs&&Xr;ea?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");Xe.createRoot(document.getElementById("root")).render(e.jsx(Ns.StrictMode,{children:e.jsx(Qr,{})}));
//# sourceMappingURL=index-137bc2e9.js.map
