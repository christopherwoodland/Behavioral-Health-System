var qs=Object.defineProperty;var Vs=(s,t,a)=>t in s?qs(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var te=(s,t,a)=>(Vs(s,typeof t!="symbol"?t+"":t,a),a);import{j as e,u as hs,Q as Gs,a as Ws}from"./query-e4af0201.js";import{a as Ks,r as o,u as Ys,L as Z,b as Js,c as us,R as ps,B as Zs,d as Qs,e as ye}from"./vendor-99a90158.js";import{F as Xs,t as ss,f as et}from"./ffmpeg-c0c62554.js";import{B as st}from"./azure-a3a2de5a.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const p of h.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function a(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function r(c){if(c.ep)return;c.ep=!0;const h=a(c);fetch(c.href,h)}})();var We={},ts=Ks;We.createRoot=ts.createRoot,We.hydrateRoot=ts.hydrateRoot;let Te;const tt=new Uint8Array(16);function at(){if(!Te&&(Te=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Te))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Te(tt)}const Y=[];for(let s=0;s<256;++s)Y.push((s+256).toString(16).slice(1));function rt(s,t=0){return Y[s[t+0]]+Y[s[t+1]]+Y[s[t+2]]+Y[s[t+3]]+"-"+Y[s[t+4]]+Y[s[t+5]]+"-"+Y[s[t+6]]+Y[s[t+7]]+"-"+Y[s[t+8]]+Y[s[t+9]]+"-"+Y[s[t+10]]+Y[s[t+11]]+Y[s[t+12]]+Y[s[t+13]]+Y[s[t+14]]+Y[s[t+15]]}const it=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),as={randomUUID:it};function ys(s,t,a){if(as.randomUUID&&!t&&!s)return as.randomUUID();s=s||{};const r=s.random||(s.rng||at)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){a=a||0;for(let c=0;c<16;++c)t[a+c]=r[c];return t}return rt(r)}const ke={api:{baseUrl:"http://localhost:7071/api"},azure:{blobSasUrl:"https://aistgvi.blob.core.windows.net/?sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiyx&se=2026-06-26T11:43:55Z&st=2025-09-06T03:28:55Z&spr=https&sig=jlfi75igY6qW805u%2FWErZpEu7AZSll5hJOdvSJU35%2Bo%3D",containerName:"audio-uploads"},polling:{intervalMs:parseInt("3000",10),maxAttempts:60,backoffFactor:1.2},features:{enableFFmpegWorker:!0,enableDebugLogging:!0},audio:{acceptedFormats:[".wav",".mp3",".m4a",".aac",".flac"],maxFileSizeMB:100,targetSampleRate:44100,targetChannels:1}},he={USER_ID:"bh_user_id",THEME:"bh_theme",UPLOAD_SESSIONS:"bh_upload_sessions",PROCESSING_MODE:"bh_processing_mode",USER_ID_CUSTOM:"bh_user_id_custom"},Se={HEALTH:"/health",SESSIONS_INITIATE:"/sessions/initiate",PREDICTIONS_SUBMIT:"/predictions/submit",PREDICTIONS_BY_USER:"/predictions",PREDICTIONS_BY_SESSION:"/predictions/sessions"},Ae={SKIP_TO_CONTENT_ID:"main-content",ANNOUNCEMENTS_ID:"a11y-announcements",FOCUS_TIMEOUT:100,DEBOUNCE_MS:300},Ie=()=>{let s=localStorage.getItem(he.USER_ID);return(!s||s.trim().length===0)&&(s=ys(),localStorage.setItem(he.USER_ID,s)),s},nt=s=>{if(!s||s.trim().length===0)throw new Error("User ID cannot be empty");localStorage.setItem(he.USER_ID,s.trim())},rs=()=>{const s=ys();return localStorage.setItem(he.USER_ID,s),s},lt=()=>localStorage.getItem("bh_user_id_custom")==="true",ot=s=>{localStorage.setItem("bh_user_id_custom",s.toString())},dt=()=>{const s=localStorage.getItem(he.THEME);return s==="light"||s==="dark"?s:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},is=s=>{localStorage.setItem(he.THEME,s),s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},ct=()=>{const s=localStorage.getItem(he.PROCESSING_MODE);return s==="true"||s==="false"?s==="true":!1},mt=s=>{localStorage.setItem(he.PROCESSING_MODE,s.toString())},Ce=s=>{const t=new Date,a=new Date(s),r=t.getTime()-a.getTime(),c=Math.floor(r/(1e3*60)),h=Math.floor(r/(1e3*60*60)),p=Math.floor(r/(1e3*60*60*24));return c<1?"Just now":c<60?`${c}m ago`:h<24?`${h}h ago`:p<7?`${p}d ago`:a.toLocaleDateString()},Ne=s=>new Date(s).toLocaleString(),le=(s,t,a)=>({code:s,message:t,details:a,timestamp:new Date().toISOString()}),xt=s=>s instanceof TypeError&&s.message.includes("fetch")?!0:s instanceof Error?s.message.includes("Network")||s.message.includes("connection")||s.message.includes("timeout"):!1,gt=(s,t="polite")=>{const a=document.createElement("div");a.setAttribute("aria-live",t),a.setAttribute("aria-atomic","true"),a.className="sr-only",a.textContent=s,document.body.appendChild(a),setTimeout(()=>{document.body.removeChild(a)},1e3)},ht=(s,t=100)=>{setTimeout(()=>{const a=document.getElementById(s);a&&a.focus()},t)},bs=o.createContext(void 0),ut=()=>{const s=o.useContext(bs);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},pt=({children:s})=>{const[t,a]=o.useState(dt),r=p=>{a(p),is(p)},c=()=>{r(t==="light"?"dark":"light")};o.useEffect(()=>{is(t)},[t]),o.useEffect(()=>{const p=window.matchMedia("(prefers-color-scheme: dark)"),b=f=>{localStorage.getItem("bh_theme")||a(f.matches?"dark":"light")};return p.addEventListener("change",b),()=>p.removeEventListener("change",b)},[]);const h={theme:t,toggleTheme:c,setTheme:r};return e.jsx(bs.Provider,{value:h,children:s})},fs=()=>{const s=o.useCallback((r,c="polite")=>{gt(r,c)},[]),t=o.useCallback(r=>{s(r,"assertive")},[s]),a=o.useCallback(r=>{s(r,"polite")},[s]);return{announce:s,announceError:t,announceSuccess:a}},yt=()=>{const s=o.useCallback(a=>{const r=c=>{c.key==="Escape"&&(c.preventDefault(),a())};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),t=o.useCallback(a=>r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),a())},[]);return{handleEscape:s,handleEnterSpace:t}},bt=()=>({skipToMain:o.useCallback(()=>{ht(Ae.SKIP_TO_CONTENT_ID,Ae.FOCUS_TIMEOUT)},[])}),ft=({className:s=""})=>{const{theme:t,toggleTheme:a}=ut(),r=Ys(),{handleEnterSpace:c}=yt(),h=[{path:"/",label:"Dashboard",icon:"ðŸ "},{path:"/upload",label:"Upload & Analyze",icon:"ðŸ“¤"},{path:"/sessions",label:"Sessions",icon:"ðŸ“Š"},{path:"/predictions",label:"My Predictions",icon:"ðŸ“ˆ"},{path:"/health",label:"System Health",icon:"ðŸ¥"}],p=b=>b==="/"?r.pathname==="/":r.pathname.startsWith(b);return e.jsx("header",{className:`bg-surface-light dark:bg-surface-dark border-b border-gray-200 dark:border-gray-700 ${s}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(Z,{to:"/",className:"flex items-center space-x-3 text-xl font-bold text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 rounded-md px-2 py-1","aria-label":"Behavioral Health System - Go to Dashboard",children:[e.jsx("span",{className:"text-2xl",role:"img","aria-label":"Brain icon",children:"ðŸ§ "}),e.jsx("span",{className:"hidden sm:block",children:"Behavioral Health System"}),e.jsx("span",{className:"sm:hidden",children:"BHS"})]})}),e.jsx("nav",{className:"hidden md:flex space-x-1",role:"navigation","aria-label":"Main navigation",children:h.map(({path:b,label:f,icon:x})=>e.jsxs(Z,{to:b,className:`
                  flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors
                  focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                  ${p(b)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                `,"aria-current":p(b)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:x}),e.jsx("span",{children:f})]},b))}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:a,onKeyDown:c(a),className:`\r
                p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":`Switch to ${t==="light"?"dark":"light"} mode`,type:"button",children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:t==="light"?"ðŸŒ™":"â˜€ï¸"})}),e.jsx("button",{className:`\r
                md:hidden p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":"Open mobile menu",type:"button","aria-expanded":"false",children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:"â˜°"})})]})]}),e.jsx("div",{className:"md:hidden border-t border-gray-200 dark:border-gray-700 pt-4 pb-3",children:e.jsx("nav",{className:"space-y-1",role:"navigation","aria-label":"Mobile navigation",children:h.map(({path:b,label:f,icon:x})=>e.jsxs(Z,{to:b,className:`
                  flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium transition-colors
                  focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                  ${p(b)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                `,"aria-current":p(b)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:x}),e.jsx("span",{children:f})]},b))})})]})})},jt=({children:s,className:t=""})=>{const{skipToMain:a}=bt();return e.jsxs("div",{className:"min-h-screen bg-background-light dark:bg-background-dark",children:[e.jsx("a",{href:`#${Ae.SKIP_TO_CONTENT_ID}`,className:"skip-link",onClick:r=>{r.preventDefault(),a()},children:"Skip to main content"}),e.jsx(ft,{}),e.jsx("main",{id:Ae.SKIP_TO_CONTENT_ID,className:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 ${t}`,tabIndex:-1,children:s}),e.jsx("div",{id:Ae.ANNOUNCEMENTS_ID,className:"sr-only","aria-live":"polite","aria-atomic":"true"}),e.jsx("footer",{className:"bg-surface-light dark:bg-surface-dark border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"text-center text-sm text-text-muted-light dark:text-text-muted-dark",children:[e.jsxs("p",{children:["Behavioral Health System Â© ",new Date().getFullYear()]}),e.jsx("p",{className:"mt-1",children:"WCAG 2.2 AA Compliant â€¢ Section 508 Compliant"})]})})})]})};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Nt=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,r)=>r?r.toUpperCase():a.toLowerCase()),ns=s=>{const t=Nt(s);return t.charAt(0).toUpperCase()+t.slice(1)},js=(...s)=>s.filter((t,a,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===a).join(" ").trim(),vt=s=>{for(const t in s)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=o.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:c="",children:h,iconNode:p,...b},f)=>o.createElement("svg",{ref:f,...wt,width:t,height:t,stroke:s,strokeWidth:r?Number(a)*24/Number(t):a,className:js("lucide",c),...!h&&!vt(b)&&{"aria-hidden":"true"},...b},[...p.map(([x,y])=>o.createElement(x,y)),...Array.isArray(h)?h:[h]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=(s,t)=>{const a=o.forwardRef(({className:r,...c},h)=>o.createElement(St,{ref:h,iconNode:t,className:js(`lucide-${kt(ns(s))}`,`lucide-${s}`,r),...c}));return a.displayName=ns(s),a};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],ze=E("activity",At);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],_t=E("arrow-left",Ct);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],ge=E("brain",It);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ks=E("calendar",Rt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ls=E("chart-column",Mt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],$t=E("chart-pie",Et);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ns=E("chevron-down",Ft);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],vs=E("chevron-up",Dt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],de=E("circle-alert",Tt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ne=E("circle-check-big",Ut);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ws=E("circle-x",Lt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],be=E("clock",Ot);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Be=E("download",Pt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Bt=E("eye-off",zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_e=E("eye",Ht);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]],Vt=E("file-audio",qt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Wt=E("file-text",Gt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Yt=E("file",Kt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["path",{d:"M15 2a2 2 0 0 1 1.414.586l4 4A2 2 0 0 1 21 8v7a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z",key:"1vo8kb"}],["path",{d:"M15 2v4a2 2 0 0 0 2 2h4",key:"sud9ri"}],["path",{d:"M5 7a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 1.732-1",key:"l4dndm"}]],Zt=E("files",Jt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ss=E("funnel",Qt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],As=E("heart",Xt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ke=E("info",ea);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],ta=E("lightbulb",sa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ra=E("loader-circle",aa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Ye=E("pause",ia);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],je=E("play",na);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],os=E("plus",la);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],se=E("refresh-cw",oa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ca=E("search",da);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Je=E("shield-alert",ma);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ga=E("target",xa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Cs=E("trash-2",ha);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],pa=E("trending-down",ua);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Ze=E("trending-up",ya);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],_s=E("triangle-alert",ba);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ja=E("upload",fa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ds=E("user",ka);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],cs=E("volume-2",Na);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ue=E("x",va);class wa{constructor(t){te(this,"baseUrl");this.baseUrl=t}async handleResponse(t){if(!t.ok){const a=await t.json().catch(()=>({}));throw le(`HTTP_${t.status}`,a.message||`HTTP ${t.status}: ${t.statusText}`,{status:t.status,statusText:t.statusText,data:a})}return t.json()}async request(t,a={}){try{const r=this.baseUrl.endsWith("/")?this.baseUrl.slice(0,-1):this.baseUrl,c=t.startsWith("/")?t:`/${t}`,h=`${r}${c}`,p={"Content-Type":"application/json",...a.headers},b=await fetch(h,{...a,headers:p});return this.handleResponse(b)}catch(r){throw xt(r)?le("NETWORK_ERROR","Unable to connect to the server. Please check your internet connection.",{originalError:r}):r instanceof Error&&"code"in r?r:le("UNKNOWN_ERROR","An unexpected error occurred",{originalError:r})}}async get(t){return this.request(t,{method:"GET"})}async post(t,a){return this.request(t,{method:"POST",body:a?JSON.stringify(a):void 0})}async put(t,a){return this.request(t,{method:"PUT",body:a?JSON.stringify(a):void 0})}async delete(t){return this.request(t,{method:"DELETE"})}}const ae=new wa(ke.api.baseUrl),B={async checkHealth(){return ae.get(Se.HEALTH)},async initiateSession(s){return ae.post(Se.SESSIONS_INITIATE,s)},async submitPrediction(s){return ae.post(Se.PREDICTIONS_SUBMIT,s)},async getPredictionBySessionId(s){return ae.get(`${Se.PREDICTIONS_BY_SESSION}/${s}`)},async getUserPredictions(s){return ae.get(`${Se.PREDICTIONS_BY_USER}/${s}`)},async saveSessionData(s){return ae.post("sessions",s)},async getSessionData(s){return ae.get(`sessions/${s}`)},async getUserSessions(s){return ae.get(`sessions/users/${s}`)},async updateSessionData(s,t){return ae.put(`sessions/${s}`,t)},async deleteSessionData(s){return ae.delete(`sessions/${s}`)},async testConnection(){try{return await this.checkHealth(),{success:!0,message:"API connection successful"}}catch(s){return{success:!1,message:s.message||"Connection test failed"}}},async submitKintsugiWorkflow(s){return ae.post("/kintsugiworkflow",s)},async generateRiskAssessment(s){return ae.post(`sessions/${s}/risk-assessment`)},async getRiskAssessment(s){return ae.get(`sessions/${s}/risk-assessment`)}};class ms{constructor(t,a={}){te(this,"sessionId");te(this,"intervalMs");te(this,"maxAttempts");te(this,"backoffFactor");te(this,"currentAttempt",0);te(this,"timeoutId",null);te(this,"isPolling",!1);this.sessionId=t,this.intervalMs=a.intervalMs||ke.polling.intervalMs,this.maxAttempts=a.maxAttempts||ke.polling.maxAttempts,this.backoffFactor=a.backoffFactor||ke.polling.backoffFactor}async start(t,a,r){if(this.isPolling)return;this.isPolling=!0,this.currentAttempt=0;const c=async()=>{try{const h=await B.getPredictionBySessionId(this.sessionId);if(t(h),h.status==="succeeded"||h.status==="success"||h.status==="failed"){this.stop(),a(h);return}if(this.currentAttempt++,this.currentAttempt>=this.maxAttempts){this.stop(),r(le("POLLING_TIMEOUT","Prediction polling timed out. Please check the session manually.",{sessionId:this.sessionId,attempts:this.currentAttempt}));return}const p=this.intervalMs*Math.pow(this.backoffFactor,this.currentAttempt);this.timeoutId=window.setTimeout(c,p)}catch(h){this.stop(),r(h)}};await c()}stop(){this.isPolling=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}getStatus(){return{isPolling:this.isPolling,attempt:this.currentAttempt,maxAttempts:this.maxAttempts}}}B.submitKintsugiWorkflow.bind(B);const Is={health:["health"],userPredictions:s=>["predictions","user",s],sessionPrediction:s=>["predictions","session",s],userSessions:s=>["sessions","user",s]},Rs=()=>hs({queryKey:Is.health,queryFn:()=>B.checkHealth(),retry:2,staleTime:3e4,refetchOnWindowFocus:!1}),Sa=s=>{const t=s||Ie();return hs({queryKey:Is.userSessions(t),queryFn:()=>B.getUserSessions(t),enabled:!!t,staleTime:3e4,refetchOnWindowFocus:!1})},Aa=()=>{const s=Ie(),{announce:t}=fs(),{data:a,isLoading:r,error:c}=Rs(),{data:h,isLoading:p}=Sa(s);o.useEffect(()=>{t("Dashboard page loaded","polite")},[t]);const b=[{title:"Upload & Analyze",description:"Upload audio files for behavioral health analysis",href:"/upload",icon:"ðŸ“¤",color:"primary"},{title:"View Sessions",description:"Browse all analysis sessions and their results",href:"/sessions",icon:"ðŸ“Š",color:"secondary"},{title:"My Predictions",description:"View your complete prediction history",href:"/predictions",icon:"ðŸ“ˆ",color:"accent"},{title:"System Health",description:"Check API status and system connectivity",href:"/health",icon:"ðŸ¥",color:"warning"}],f=x=>{const y="block p-6 rounded-lg border-2 transition-all hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2";switch(x){case"primary":return`${y} border-primary-200 bg-primary-50 hover:border-primary-300 hover:bg-primary-100 dark:border-primary-800 dark:bg-primary-900 dark:hover:border-primary-700 dark:hover:bg-primary-800 focus:ring-primary-500`;case"secondary":return`${y} border-secondary-200 bg-secondary-50 hover:border-secondary-300 hover:bg-secondary-100 dark:border-secondary-800 dark:bg-secondary-900 dark:hover:border-secondary-700 dark:hover:bg-secondary-800 focus:ring-secondary-500`;case"accent":return`${y} border-accent-200 bg-accent-50 hover:border-accent-300 hover:bg-accent-100 dark:border-accent-800 dark:bg-accent-900 dark:hover:border-accent-700 dark:hover:bg-accent-800 focus:ring-accent-500`;case"warning":return`${y} border-warning-200 bg-warning-50 hover:border-warning-300 hover:bg-warning-100 dark:border-teal-600 dark:bg-teal-800 dark:hover:border-teal-500 dark:hover:bg-teal-700 focus:ring-warning-500`;default:return`${y} border-gray-200 bg-gray-50 hover:border-gray-300 hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700 focus:ring-gray-500`}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-text-primary-light dark:text-text-primary-dark",children:"Behavioral Health System"}),e.jsx("p",{className:"mt-2 text-lg text-text-secondary-light dark:text-text-secondary-dark",children:"Audio-based mental health prediction and analysis"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:"Your User ID"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded-md",children:e.jsx("code",{className:"text-sm font-mono text-text-primary-light dark:text-text-primary-dark break-all",children:s})}),e.jsx("p",{className:"mt-2 text-sm text-text-muted-light dark:text-text-muted-dark",children:"This ID is automatically generated and stored locally to track your sessions."})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"System Status"}),r?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Checking system health..."})]}):c?e.jsxs("div",{className:"flex items-center space-x-2 text-error-600 dark:text-error-400",children:[e.jsx("span",{role:"img","aria-label":"Error",children:"âš ï¸"}),e.jsx("span",{children:"System health check failed"})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-success-600 dark:text-success-400",children:[e.jsx("span",{role:"img","aria-label":"Healthy",children:"âœ…"}),e.jsx("span",{children:"All systems operational"}),(a==null?void 0:a.checks)&&e.jsxs("span",{className:"text-text-muted-light dark:text-text-muted-dark",children:["(",Object.keys(a.checks).length," services checked)"]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-6",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:b.map(x=>e.jsx(Z,{to:x.href,className:f(x.color),"aria-label":`${x.title}: ${x.description}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-3",role:"img","aria-hidden":"true",children:x.icon}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:x.title}),e.jsx("p",{className:"text-sm text-text-secondary-light dark:text-text-secondary-dark",children:x.description})]})},x.href))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Recent Activity"}),p?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Loading recent sessions..."})]}):!(h!=null&&h.sessions)||h.sessions.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",role:"img","aria-label":"No data",children:"ðŸ“­"}),e.jsxs("p",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:["No sessions yet.",e.jsx(Z,{to:"/upload",className:"text-primary-600 dark:text-primary-400 hover:underline ml-1",children:"Upload your first audio file"})," to get started."]})]}):e.jsxs("div",{className:"space-y-3",children:[h.sessions.slice(0,3).map(x=>{var y,F;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`status-${x.status||"completed"}`,children:x.status||"completed"}),e.jsx("span",{className:"text-text-primary-light dark:text-text-primary-dark",children:x.audioFileName||((y=x.sessionId)==null?void 0:y.slice(0,8))||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",title:x.createdAt,children:x.createdAt?new Date(x.createdAt).toLocaleString():""})]}),e.jsx(Z,{to:`/sessions/${x.sessionId||""}`,className:"text-primary-600 dark:text-primary-400 hover:underline text-sm flex items-center gap-1",title:"View session details","aria-label":`View details for session ${x.audioFileName||((F=x.sessionId)==null?void 0:F.slice(0,8))||"Unknown"}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})})]},x.sessionId)}),h.sessions.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs(Z,{to:"/sessions",className:"text-primary-600 dark:text-primary-400 hover:underline",children:["View all ",h.sessions.length," sessions â†’"]})})]})]})]})};class Ca{constructor(){te(this,"ffmpeg",null);te(this,"isLoaded",!1);te(this,"loadingPromise",null);this.ffmpeg=new Xs}async loadFFmpeg(){if(!this.isLoaded)return this.loadingPromise?this.loadingPromise:(this.loadingPromise=this.doLoadFFmpeg(),this.loadingPromise)}async doLoadFFmpeg(){if(!this.ffmpeg)throw le("FFMPEG_INIT_ERROR","Failed to initialize FFmpeg");try{const t="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";await this.ffmpeg.load({coreURL:await ss(`${t}/ffmpeg-core.js`,"text/javascript"),wasmURL:await ss(`${t}/ffmpeg-core.wasm`,"application/wasm")}),this.isLoaded=!0}catch(t){throw this.loadingPromise=null,le("FFMPEG_LOAD_ERROR","Failed to load FFmpeg. Please check your internet connection and try again.",{originalError:t})}}async convertAudio(t,a={outputFormat:"wav",sampleRate:44100,channels:1},r){try{if(r==null||r({stage:"loading",progress:0,message:"Loading audio processor..."}),await this.loadFFmpeg(),!this.ffmpeg)throw le("FFMPEG_NOT_LOADED","FFmpeg not properly loaded");this.ffmpeg.on("progress",({progress:y})=>{r==null||r({stage:"converting",progress:Math.round(y*100),message:`Converting audio... ${Math.round(y*100)}%`})}),r==null||r({stage:"converting",progress:0,message:"Preparing audio file..."});const c="input."+this.getFileExtension(t.name);await this.ffmpeg.writeFile(c,await et(t));const h=`output.${a.outputFormat}`,p=["-i",c,"-ac",a.channels.toString(),"-ar",a.sampleRate.toString(),"-f",a.outputFormat,h];await this.ffmpeg.exec(p);const b=await this.ffmpeg.readFile(h),f=new Blob([b],{type:`audio/${a.outputFormat}`}),x=new File([f],`${this.getFileNameWithoutExtension(t.name)}.${a.outputFormat}`,{type:`audio/${a.outputFormat}`});return await this.ffmpeg.deleteFile(c),await this.ffmpeg.deleteFile(h),r==null||r({stage:"completed",progress:100,message:"Audio conversion completed"}),x}catch(c){throw le("AUDIO_CONVERSION_ERROR","Failed to convert audio file. Please try with a different file.",{originalError:c,fileName:t.name,fileSize:t.size,fileType:t.type})}}getFileExtension(t){const a=t.lastIndexOf(".");return a!==-1?t.slice(a+1).toLowerCase():""}getFileNameWithoutExtension(t){const a=t.lastIndexOf(".");return a!==-1?t.slice(0,a):t}async isFormatSupported(t){try{await this.loadFFmpeg();const a=["wav","mp3","mp4","m4a","aac","flac","ogg"],r=this.getFileExtension(t.name);return a.includes(r)}catch{return!1}}dispose(){this.ffmpeg&&(this.ffmpeg.terminate(),this.ffmpeg=null),this.isLoaded=!1,this.loadingPromise=null}}let He=null;const _a=()=>(He||(He=new Ca),He),qe=async(s,t)=>{const r=await _a().convertAudio(s,{outputFormat:"wav",sampleRate:44100,channels:1},t?c=>t(c.progress):void 0);return new Blob([r],{type:"audio/wav"})};class Ia{constructor(t){te(this,"containerClient",null);te(this,"sasUrl");if(this.sasUrl=t||ke.azure.blobSasUrl,!this.sasUrl)throw le("AZURE_CONFIG_ERROR","Azure Blob Storage SAS URL not configured")}getContainerClient(){if(!this.containerClient)try{const t=new st(this.sasUrl);this.containerClient=t.getContainerClient(ke.azure.containerName)}catch(t){throw le("AZURE_CLIENT_ERROR","Failed to initialize Azure Blob Storage client",{originalError:t})}return this.containerClient}async uploadFile(t,a,r){try{r==null||r({progress:0,stage:"preparing",message:"Preparing upload..."});const c=this.getContainerClient(),h=a||this.generateBlobName(t.name),p=c.getBlockBlobClient(h);r==null||r({progress:10,stage:"uploading",message:"Starting upload..."}),await p.uploadData(t,{blobHTTPHeaders:{blobContentType:t.type},onProgress:f=>{const x=f.loadedBytes&&t.size?Math.round(f.loadedBytes/t.size*90)+10:50;r==null||r({progress:x,stage:"uploading",message:`Uploading... ${x}%`})}});const b=p.url;return r==null||r({progress:100,stage:"completed",message:"Upload completed"}),{url:b,fileName:h,size:t.size}}catch(c){throw le("UPLOAD_ERROR","Failed to upload file to Azure Blob Storage",{originalError:c,fileName:t.name,fileSize:t.size})}}generateBlobName(t){const a=new Date().toISOString().replace(/[:.]/g,"-"),r=Math.random().toString(36).substring(2,8),c=t.split(".").pop()||"wav";return`audio/${a}-${r}.${c}`}async testConnection(){try{return await this.getContainerClient().getProperties(),{success:!0,message:"Azure Blob Storage connection successful"}}catch{return{success:!1,message:"Failed to connect to Azure Blob Storage. Please check your SAS URL configuration."}}}async deleteFile(t){try{await this.getContainerClient().getBlockBlobClient(t).deleteIfExists()}catch(a){throw le("DELETE_ERROR","Failed to delete file from Azure Blob Storage",{originalError:a,fileName:t})}}}let Le=null;const Ra=s=>((!Le||s&&s!==Le.sasUrl)&&(Le=new Ia(s)),Le),Ve=async(s,t,a)=>{const r=Ra(),c=s instanceof File?s:new File([s],t,{type:s.type});return(await r.uploadFile(c,t,a?p=>a(p.progress):void 0)).url},Re=()=>{const s=o.useRef(null),t=o.useCallback(b=>{if(!s.current){const f=document.createElement("div");f.setAttribute("aria-live","polite"),f.setAttribute("aria-atomic","true"),f.style.position="absolute",f.style.left="-10000px",f.style.width="1px",f.style.height="1px",f.style.overflow="hidden",document.body.appendChild(f),s.current=f}s.current.textContent="",setTimeout(()=>{s.current&&(s.current.textContent=b)},100)},[]),a={focusById:b=>{const f=document.getElementById(b);f&&f.focus()},focusFirstInContainer:b=>{const x=b.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];x&&x.focus()},trapFocus:b=>{const f=b.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),x=f[0],y=f[f.length-1],F=A=>{A.key==="Tab"&&(A.shiftKey?document.activeElement===x&&(y.focus(),A.preventDefault()):document.activeElement===y&&(x.focus(),A.preventDefault()))};return b.addEventListener("keydown",F),()=>{b.removeEventListener("keydown",F)}}},r={handleArrowNavigation:(b,f,x,y)=>{var A;let F=x;switch(b.key){case"ArrowDown":b.preventDefault(),F=x<f.length-1?x+1:0;break;case"ArrowUp":b.preventDefault(),F=x>0?x-1:f.length-1;break;case"Home":b.preventDefault(),F=0;break;case"End":b.preventDefault(),F=f.length-1;break;default:return}y(F),(A=f[F])==null||A.focus()},handleEscape:(b,f)=>{b.key==="Escape"&&(b.preventDefault(),f())}},c=o.useCallback((b="element")=>`${b}-${Math.random().toString(36).substr(2,9)}`,[]),h=o.useCallback(()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),p=o.useCallback((b,f,x)=>{const y={};return b||(y["aria-invalid"]="true",f&&x&&(y["aria-describedby"]=x)),y},[]);return{announceToScreenReader:t,focusManagement:a,keyboardNavigation:r,generateId:c,prefersReducedMotion:h,getValidationAttributes:p}},Ma=()=>{const[s,t]=o.useState([]),[a,r]=o.useState(()=>ct()),[c,h]=o.useState({}),[p,b]=o.useState({}),[f,x]=o.useState({}),[y,F]=o.useState(!1),[A,z]=o.useState(null),[_,w]=o.useState({stage:"idle",progress:0,message:""}),[N,q]=o.useState(null),[re,Q]=o.useState(!1),[oe,u]=o.useState(0),[I,n]=o.useState(null),[l,v]=o.useState({age:"",gender:"",race:"",ethnicity:"",language:"",weight:"",zipcode:"",sessionNotes:""}),[g,m]=o.useState(null),[S,P]=o.useState([]),[V,ce]=o.useState(()=>lt()),[G,J]=o.useState(""),[X,D]=o.useState(null),k=Ie(),W=o.useRef(null),H=o.useRef(null),{announceToScreenReader:L}=Re(),T=o.useCallback((i,d,j)=>{const C=Date.now().toString()+Math.random().toString(36).substr(2,9),R={id:C,type:i,title:d,message:j,timestamp:Date.now()};P(K=>[...K,R]),setTimeout(()=>{P(K=>K.filter(ie=>ie.id!==C))},i==="error"?8e3:5e3)},[]),Me=o.useCallback(i=>{P(d=>d.filter(j=>j.id!==i))},[]),ue=o.useCallback(()=>{t([]),z(null),w({stage:"idle",progress:0,message:""}),q(null),b({}),h({}),m(null),Q(!1),u(0),n(null),F(!1)},[]),ve=o.useCallback(()=>{ce(i=>{const d=!i;if(ot(d),D(null),d)J(k),L("Switched to custom User ID mode");else{J("");const j=rs();L(`Switched to auto-generated mode. New User ID: ${j}`)}return d})},[k,L]),Ms=o.useCallback(i=>{J(i),D(null)},[]),Es=o.useCallback(()=>{const i=G.trim();if(!i){D("User ID cannot be empty");return}if(i.length<3){D("User ID must be at least 3 characters long");return}if(i.length>100){D("User ID must be less than 100 characters");return}if(/[<>"/\\|?*\x00-\x1f]/.test(i)){D('User ID contains invalid characters. Please avoid special characters like < > " / \\ | ? *');return}try{nt(i),D(null),L(`Custom User ID applied: ${i}`),window.location.reload()}catch(j){console.error("Error setting User ID:",j);const C=j instanceof Error?j.message:"Failed to set User ID";D(C)}},[G,L]),$s=o.useCallback(()=>{const i=rs();L(`New User ID generated: ${i}`),window.location.reload()},[L]),Fs=()=>Date.now().toString()+Math.random().toString(36).substr(2,9),Qe=o.useCallback(i=>{const d=Fs(),j=URL.createObjectURL(i),C={id:d,file:i,url:j};a?(t(M=>[...M,C]),x(M=>({...M,[d]:"ready"})),h(M=>({...M,[d]:{stage:"idle",progress:0,message:"Ready to process"}}))):z(C),L(`Audio file selected: ${i.name}`);const R=new Audio(j);R.addEventListener("loadedmetadata",()=>{a?t(M=>M.map(K=>K.id===d?{...K,duration:R.duration}:K)):z(M=>M?{...M,duration:R.duration}:null)})},[a,L]),Ds=o.useCallback(i=>{a&&(t(d=>{const j=d.find(C=>C.id===i);return j&&URL.revokeObjectURL(j.url),d.filter(C=>C.id!==i)}),h(d=>{const{[i]:j,...C}=d;return C}),b(d=>{const{[i]:j,...C}=d;return C}),x(d=>{const{[i]:j,...C}=d;return C}))},[a]),Ee=o.useCallback(i=>{const d=i.target.files;!d||d.length===0||Array.from(d).forEach(j=>{const C=["audio/wav","audio/wave","audio/x-wav","audio/mp3","audio/mpeg","audio/mp4","audio/m4a","audio/x-m4a","audio/mp4a-latm","audio/aac","audio/x-aac","audio/flac","audio/x-flac"],R=j.name.toLowerCase(),K=[".wav",".mp3",".m4a",".aac",".flac"].some(pe=>R.endsWith(pe));if(!C.includes(j.type)&&!K){console.log(`File validation failed for ${j.name}: MIME type="${j.type}", Extension check failed`),m(`Unsupported file type for ${j.name}. Please select supported audio files (WAV, MP3, M4A, AAC, or FLAC)`),T("error","Unsupported File",`${j.name} is not a supported audio file format`),L(`Error: Unsupported file format selected for ${j.name}`);return}const me=50*1024*1024;if(j.size>me){m(`File ${j.name} is too large. File size must be less than 50MB`),T("error","File Too Large",`${j.name} size must be less than 50MB`),L(`Error: File ${j.name} is too large`);return}Qe(j),m(null)})},[L,Qe,T]),Ts=o.useCallback(i=>{i.preventDefault()},[]),Us=o.useCallback(i=>{i.preventDefault();const d=i.dataTransfer.files;d.length>0&&Ee({target:{files:d}})},[Ee]),Ls=o.useCallback(()=>{r(i=>{const d=!i;return mt(d),ue(),d})},[ue]),Os=o.useCallback(()=>{W.current&&(re?(W.current.pause(),Q(!1),L("Audio paused")):(W.current.play(),Q(!0),L("Audio playing")))},[re,L]),Ps=o.useCallback(()=>{W.current&&u(W.current.currentTime)},[]),$e=o.useCallback(i=>{const d=Math.floor(i/60),j=Math.floor(i%60);return`${d}:${j.toString().padStart(2,"0")}`},[]),fe=o.useCallback(()=>{const i=[];if(l.age){const d=parseInt(l.age);(isNaN(d)||d<18||d>130)&&i.push("Age must be between 18 and 130")}if(l.gender&&(["male","female","non-binary","transgender female","transgender male","other","prefer"].includes(l.gender)||i.push("Invalid gender. Must be: male, female, non-binary, transgender female, transgender male, other, or prefer")),l.race&&(["white","black or african-american","asian","american indian or alaskan native","native Hawaiian or pacific islander","two or more races","other","prefer not to say"].includes(l.race)||i.push("Invalid race. Must be: white, black or african-american, asian, american indian or alaskan native, native Hawaiian or pacific islander, two or more races, other, prefer not to say")),l.ethnicity&&(["Hispanic, Latino, or Spanish Origin","Not Hispanic, Latino, or Spanish Origin"].includes(l.ethnicity)||i.push("Invalid ethnicity. Must be: Hispanic, Latino, or Spanish Origin | Not Hispanic, Latino, or Spanish Origin")),l.zipcode&&(/^[a-zA-Z0-9]{1,10}$/.test(l.zipcode)||i.push("Zipcode must be alphanumeric and contain no more than 10 characters")),l.weight){const d=parseInt(l.weight);(isNaN(d)||d<10||d>1e3)&&i.push("Weight must be between 10 and 1000 pounds (lbs)")}return i},[l]),Fe=o.useCallback(()=>{const i={};let d=!1;return l.age&&(i.age=parseInt(l.age),d=!0),l.gender&&(i.gender=l.gender,d=!0),l.race&&(i.race=l.race,d=!0),l.ethnicity&&(i.ethnicity=l.ethnicity,d=!0),(l.language==="true"||l.language==="false")&&(i.language=l.language==="true",d=!0),l.weight&&(i.weight=parseInt(l.weight),d=!0),l.zipcode&&(i.zipcode=l.zipcode,d=!0),d?i:void 0},[l]),zs=o.useCallback(async()=>{if(a){if(s.length===0||!k.trim()){m("Please select audio files. User ID is automatically generated."),T("error","Missing Information","Please select audio files. User ID is automatically generated.");return}await Xe()}else{if(!A||!k.trim()){m("Please select an audio file. User ID is automatically generated."),T("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}await Hs()}},[A,s,k,a]),De=o.useCallback(async(i,d)=>{try{h(O=>({...O,[i]:{stage:"initiating",progress:5,message:"Initiating session..."}}));const j=Fe(),C={userid:k.trim(),is_initiated:!0};j&&(C.metadata=j);const R=await B.initiateSession(C),M={sessionId:R.sessionId,userId:k.trim()};h(O=>({...O,[i]:{stage:"initiating",progress:10,message:"Saving session data..."}}));const K={sessionId:R.sessionId,userId:k.trim(),userMetadata:j,audioFileName:d.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await B.saveSessionData(K)}catch(O){console.warn("Failed to save initial session data:",O)}h(O=>({...O,[i]:{stage:"converting",progress:15,message:"Converting audio to required format..."}}));const ie=await qe(d.file,O=>{h($=>({...$,[i]:{stage:"converting",progress:15+O*.25,message:`Converting audio... ${Math.round(O)}%`}}))});h(O=>({...O,[i]:{stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}}));const me=`${k}_${M.sessionId}_${Date.now()}.wav`,pe=await Ve(ie,me,O=>{h($=>({...$,[i]:{stage:"uploading",progress:40+O*.25,message:`Uploading... ${Math.round(O)}%`}}))});h(O=>({...O,[i]:{stage:"submitting",progress:65,message:"Submitting for analysis..."}}));try{const O={...K,audioUrl:pe,audioFileName:me,status:"processing",updatedAt:new Date().toISOString()};await B.updateSessionData(M.sessionId,O)}catch(O){console.warn("Failed to update session data with audio info:",O)}await B.submitPrediction({userId:k.trim(),sessionid:M.sessionId,audioFileUrl:pe,audioFileName:me}),h(O=>({...O,[i]:{stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}}));const ee=new ms(M.sessionId);await new Promise((O,$)=>{ee.start(U=>{const we=U.status==="processing"?80:U.status==="success"?95:70;h(xe=>({...xe,[i]:{stage:"analyzing",progress:we,message:`Analysis ${U.status}...`}})),U.predictError&&T("error","Prediction Error",`${U.predictError.error}: ${U.predictError.message}`)},U=>{if(U.predictError){T("error","Analysis Failed",`The analysis completed with an error: ${U.predictError.error} - ${U.predictError.message}`),h(xe=>({...xe,[i]:{stage:"error",progress:0,message:"Analysis failed with errors"}})),$(new Error(`Prediction error: ${U.predictError.error}`));return}const we={sessionId:M.sessionId,depressionScore:U.predictedScoreDepression?parseFloat(U.predictedScoreDepression):0,riskLevel:U.predictedScoreDepression&&parseFloat(U.predictedScoreDepression)>.7?"high":U.predictedScoreDepression&&parseFloat(U.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",U.predictedScoreDepression?`Depression score: ${U.predictedScoreDepression}`:"",U.predictedScoreAnxiety?`Anxiety score: ${U.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(xe=>xe.trim()!==""),timestamp:U.updatedAt,audioUrl:pe,rawApiResponse:U};h(xe=>({...xe,[i]:{stage:"complete",progress:100,message:"Analysis complete!"}})),b(xe=>({...xe,[i]:we})),O()},U=>{$(U)})})}catch(j){throw console.error(`Processing error for file ${i}:`,j),h(C=>({...C,[i]:{stage:"error",progress:0,message:"Processing failed"}})),j}},[k,Fe,B,Ve,qe,T]),Xe=o.useCallback(async()=>{F(!0),m(null);const i=fe();if(i.length>0){m(`Validation error: ${i.join(", ")}`),T("error","Validation Error",i.join(", ")),F(!1);return}const d=s.filter(R=>f[R.id]==="ready");if(d.length===0){T("info","No Files Ready","No files are ready to process"),F(!1);return}const j=d.length;let C=0;try{for(const R of d){C++,T("info","Processing File",`Processing ${R.file.name} (${C}/${j})`),x(M=>({...M,[R.id]:"processing"}));try{await De(R.id,R),x(M=>({...M,[R.id]:"complete"})),T("success","File Complete",`${R.file.name} processed successfully`)}catch(M){console.error(`Error processing ${R.file.name}:`,M);const K=M instanceof Error?M.message:"An unexpected error occurred";T("error","File Failed",`Failed to process ${R.file.name}: ${K}`),x(ie=>({...ie,[R.id]:"error"})),h(ie=>({...ie,[R.id]:{stage:"error",progress:0,message:`Failed: ${K}`}}))}}T("success","Batch Complete",`Processed ${C} file${C!==1?"s":""}`),L(`Batch processing complete. ${C} files processed.`)}catch(R){console.error("Batch processing error:",R);const M=R instanceof Error?R.message:"An unexpected error occurred";m(M),T("error","Batch Failed",M),L(`Error: ${M}`)}finally{F(!1)}},[s,f,fe,T,L,De]),Bs=o.useCallback(async i=>{const d=s.find(C=>C.id===i);if(!d)return;const j=fe();if(j.length>0){m(`Validation error: ${j.join(", ")}`),T("error","Validation Error",j.join(", "));return}x(C=>({...C,[i]:"processing"}));try{await De(i,d),x(C=>({...C,[i]:"complete"})),T("success","File Complete",`${d.file.name} processed successfully`)}catch(C){console.error(`Error processing ${d.file.name}:`,C);const R=C instanceof Error?C.message:"An unexpected error occurred";T("error","File Failed",`Failed to process ${d.file.name}: ${R}`),x(M=>({...M,[i]:"error"})),h(M=>({...M,[i]:{stage:"error",progress:0,message:`Failed: ${R}`}}))}},[s,fe,T,De]),Hs=o.useCallback(async()=>{if(!A||!k.trim()){m("Please select an audio file. User ID is automatically generated."),T("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}const i=fe();if(i.length>0){m(`Validation error: ${i.join(", ")}`),T("error","Validation Error",i.join(", "));return}try{m(null),w({stage:"initiating",progress:5,message:"Initiating session..."}),L("Starting analysis process - initiating session");const d=Fe(),j={userid:k.trim(),is_initiated:!0};d&&(j.metadata=d);const C=await B.initiateSession(j),R={sessionId:C.sessionId,userId:k.trim()};w({stage:"initiating",progress:10,message:"Saving session data..."});const M={sessionId:C.sessionId,userId:k.trim(),userMetadata:d,audioFileName:A.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await B.saveSessionData(M)}catch(ee){console.warn("Failed to save initial session data:",ee)}w({stage:"converting",progress:15,message:"Converting audio to required format..."}),L("Session created successfully, now converting audio");const K=await qe(A.file,ee=>{w({stage:"converting",progress:15+ee*.25,message:`Converting audio... ${Math.round(ee)}%`})});w({stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}),L("Audio converted successfully, now uploading");const ie=`${k}_${R.sessionId}_${Date.now()}.wav`,me=await Ve(K,ie,ee=>{w({stage:"uploading",progress:40+ee*.25,message:`Uploading... ${Math.round(ee)}%`})});w({stage:"submitting",progress:65,message:"Submitting for analysis..."}),L("Upload complete, submitting for behavioral health analysis");try{const ee={...M,audioUrl:me,audioFileName:ie,status:"processing",updatedAt:new Date().toISOString()};await B.updateSessionData(R.sessionId,ee)}catch(ee){console.warn("Failed to update session data with audio info:",ee)}await B.submitPrediction({userId:k.trim(),sessionid:R.sessionId,audioFileUrl:me,audioFileName:ie}),w({stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}),L("Prediction submitted, analysis in progress");const pe=new ms(R.sessionId);await new Promise((ee,O)=>{pe.start($=>{const U=$.status==="processing"?80:$.status==="success"?95:70;w({stage:"analyzing",progress:U,message:`Analysis ${$.status}...`}),$.predictError&&T("error","Prediction Error",`${$.predictError.error}: ${$.predictError.message}`)},$=>{if($.predictError){T("error","Analysis Failed",`The analysis completed with an error: ${$.predictError.error} - ${$.predictError.message}`),w({stage:"error",progress:0,message:"Analysis failed with errors"}),O(new Error(`Prediction error: ${$.predictError.error}`));return}const U={sessionId:R.sessionId,depressionScore:$.predictedScoreDepression?parseFloat($.predictedScoreDepression):0,riskLevel:$.predictedScoreDepression&&parseFloat($.predictedScoreDepression)>.7?"high":$.predictedScoreDepression&&parseFloat($.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",$.predictedScoreDepression?`Depression score: ${$.predictedScoreDepression}`:"",$.predictedScoreAnxiety?`Anxiety score: ${$.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(we=>we.trim()!==""),timestamp:$.updatedAt,audioUrl:me,rawApiResponse:$};w({stage:"complete",progress:100,message:"Analysis complete!"}),q(U),T("success","Analysis Complete","Your behavioral health analysis has been completed successfully."),L("Behavioral health analysis completed successfully"),ee()},$=>{T("error","Analysis Error",$.message||"An unexpected error occurred during analysis."),O($)})})}catch(d){console.error("Processing error:",d);const j=d instanceof Error?d.message:"An unexpected error occurred";m(j),w({stage:"error",progress:0,message:"Processing failed"}),T("error","Processing Failed",j),L(`Error: ${j}`)}},[A,k,L,fe,Fe]),es=o.useCallback(i=>{switch(i){case"error":return"bg-red-500";case"complete":return"bg-green-500";default:return"bg-blue-500"}},[]);return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Processing Mode:"}),e.jsxs("div",{className:"relative inline-flex items-center",children:[e.jsx("button",{onClick:Ls,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 ${a?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500"}`,"aria-label":`Switch to ${a?"single file":"multi-file"} mode`,children:e.jsx("span",{className:`inline-flex h-6 w-6 transform rounded-full bg-white items-center justify-center transition-transform ${a?"translate-x-9":"translate-x-1"}`,children:a?e.jsx(Zt,{className:"h-3 w-3 text-blue-600"}):e.jsx(Yt,{className:"h-3 w-3 text-gray-600"})})}),e.jsxs("div",{className:"ml-3 flex items-center space-x-4",children:[e.jsx("span",{className:`text-sm font-medium ${a?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:"Single"}),e.jsx("span",{className:`text-sm font-medium ${a?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"}`,children:"Multi"})]})]})]}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${a?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),"Batch Processing"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v8H4V6z",clipRule:"evenodd"})}),"Single File"]})})]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Upload & Analyze Audio"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Upload ",a?"multiple audio files":"an audio file"," for behavioral health analysis using AI-powered speech pattern recognition"]}),e.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-lg text-sm ${a?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M9 12a1 1 0 000 2h2a1 1 0 100-2H9z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 0v12h8V4H6z",clipRule:"evenodd"})]}),"Process multiple files with individual controls and batch options"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Upload and analyze one file at a time with detailed progress tracking"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Patient Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 lg:col-span-3 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"User ID Management"}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 p-4 rounded-md border space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current User ID:"}),e.jsx("code",{className:"text-sm font-mono text-gray-900 dark:text-gray-100 break-all block bg-white dark:bg-gray-800 p-2 rounded border",children:k})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:ve,className:"px-3 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors","aria-describedby":"user-id-mode-help",children:V?"Switch to Auto-Generated":"Use Custom User ID"}),!V&&e.jsx("button",{onClick:$s,className:"px-3 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800 transition-colors",title:"Generate a new random User ID",children:"Generate New ID"})]}),V&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:G,onChange:i=>Ms(i.target.value),placeholder:"Enter custom User ID (any unique string)",className:"flex-1 px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-describedby":"custom-user-id-help","aria-invalid":X?"true":"false"}),e.jsx("button",{onClick:Es,disabled:!G.trim(),className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Apply"})]}),X&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",role:"alert",children:X}),e.jsx("p",{id:"custom-user-id-help",className:"text-xs text-gray-500 dark:text-gray-400",children:'Any unique string (3-100 characters). Examples: "patient-001", "john.doe@clinic", "study-participant-42"'})]}),e.jsx("p",{id:"user-id-mode-help",className:"text-xs text-gray-500 dark:text-gray-400",children:V?"Custom mode: Use any unique identifier for tracking (e.g., patient ID, username, study code)":"Auto mode: System generates unique UUIDs automatically"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age (Optional)"}),e.jsx("input",{type:"number",id:"age",value:l.age,onChange:i=>v(d=>({...d,age:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Age in years",min:"1",max:"150"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight (Optional)"}),e.jsx("input",{type:"number",id:"weight",value:l.weight,onChange:i=>v(d=>({...d,weight:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Weight in lbs",min:"1",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender (Optional)"}),e.jsxs("select",{id:"gender",value:l.gender,onChange:i=>v(d=>({...d,gender:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"non-binary",children:"Non-binary"}),e.jsx("option",{value:"transgender female",children:"Transgender female"}),e.jsx("option",{value:"transgender male",children:"Transgender male"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer",children:"Prefer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"race",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race (Optional)"}),e.jsxs("select",{id:"race",value:l.race,onChange:i=>v(d=>({...d,race:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select race"}),e.jsx("option",{value:"white",children:"White"}),e.jsx("option",{value:"black or african-american",children:"Black or African-American"}),e.jsx("option",{value:"asian",children:"Asian"}),e.jsx("option",{value:"american indian or alaskan native",children:"American Indian or Alaskan Native"}),e.jsx("option",{value:"native Hawaiian or pacific islander",children:"Native Hawaiian or Pacific Islander"}),e.jsx("option",{value:"two or more races",children:"Two or more races"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer not to say",children:"Prefer not to say"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ethnicity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity (Optional)"}),e.jsxs("select",{id:"ethnicity",value:l.ethnicity,onChange:i=>v(d=>({...d,ethnicity:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select ethnicity"}),e.jsx("option",{value:"Hispanic, Latino, or Spanish Origin",children:"Hispanic, Latino, or Spanish Origin"}),e.jsx("option",{value:"Not Hispanic, Latino, or Spanish Origin",children:"Not Hispanic, Latino, or Spanish Origin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language (Optional)"}),e.jsxs("select",{id:"language",value:l.language,onChange:i=>v(d=>({...d,language:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select language"}),e.jsx("option",{value:"true",children:"English"}),e.jsx("option",{value:"false",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"zipcode",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code (Optional)"}),e.jsx("input",{type:"text",id:"zipcode",value:l.zipcode,onChange:i=>v(d=>({...d,zipcode:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter ZIP code",pattern:"[0-9]{5}(-[0-9]{4})?",title:"Enter a valid ZIP code (e.g., 12345 or 12345-6789)"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{htmlFor:"sessionNotes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes (Optional)"}),e.jsx("textarea",{id:"sessionNotes",value:l.sessionNotes,onChange:i=>v(d=>({...d,sessionNotes:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",rows:3,placeholder:"Additional notes about this session or patient context"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Audio File Upload ",a&&e.jsx("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:"(Multi-File Mode)"})]}),!a&&!A||a&&s.length===0?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors",onDragOver:Ts,onDrop:Us,children:[e.jsx(ja,{className:"mx-auto h-12 w-12 text-gray-400 mb-4","aria-hidden":"true"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{type:"button",onClick:()=>{var i;return(i=H.current)==null?void 0:i.click()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Select Audio File",a?"s":""]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["or drag and drop ",a?"files":"file"," here"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Supported formats: WAV, MP3, M4A, AAC, FLAC (max 50MB each)",a&&e.jsx("br",{}),a&&"You can select multiple files at once"]}),e.jsx("input",{ref:H,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:Ee,multiple:a,"aria-label":`Select audio file${a?"s":""} for analysis`})]}):e.jsxs("div",{className:"space-y-4",children:[!a&&A&&e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(cs,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:A.file.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(A.file.size/1024/1024).toFixed(2)," MB",A.duration&&` â€¢ ${$e(A.duration)}`]})]})]}),e.jsx("button",{type:"button",onClick:ue,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Remove selected file",children:e.jsx(Ue,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:Os,className:"flex items-center justify-center w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800","aria-label":re?"Pause audio":"Play audio",children:re?e.jsx(Ye,{className:"h-5 w-5","aria-hidden":"true"}):e.jsx(je,{className:"h-5 w-5 ml-0.5","aria-hidden":"true"})}),e.jsx("div",{className:"flex-1",children:A.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[$e(oe)," / ",$e(A.duration)]})})]}),A.duration&&e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-200",style:{width:`${oe/A.duration*100}%`},role:"progressbar","aria-label":"Audio playback progress","aria-valuenow":oe,"aria-valuemin":0,"aria-valuemax":A.duration})})]}),e.jsx("audio",{ref:W,src:A.url,onTimeUpdate:Ps,onEnded:()=>Q(!1),onPlay:()=>Q(!0),onPause:()=>Q(!1),className:"hidden"})]}),a&&s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Selected Files (",s.length,")"]}),e.jsxs("button",{type:"button",onClick:()=>{var i;return(i=H.current)==null?void 0:i.click()},className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Add More Files"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(i=>{const d=f[i.id]||"ready",j=c[i.id];return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[e.jsx(cs,{className:"h-4 w-4 text-blue-500 flex-shrink-0","aria-hidden":"true"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:i.file.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(i.file.size/1024/1024).toFixed(2)," MB",i.duration&&` â€¢ ${$e(i.duration)}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d==="ready"&&e.jsxs("button",{type:"button",onClick:()=>Bs(i.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-offset-gray-800","aria-label":`Start processing ${i.file.name}`,children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),"Start"]}),d==="processing"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"Processing..."}),d==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Complete"]}),d==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]}),e.jsx("button",{type:"button",onClick:()=>Ds(i.id),className:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400","aria-label":`Remove ${i.file.name}`,children:e.jsx(Cs,{className:"h-4 w-4"})})]})]}),j&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:j.message}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[Math.round(j.progress),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 mt-1",children:e.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${es(j.stage)}`,style:{width:`${j.progress}%`}})})]})]},i.id)})}),e.jsx("input",{ref:H,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:Ee,multiple:a,"aria-label":"Select additional audio files for analysis"})]})]})]}),g&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",role:"alert",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"h-5 w-5 text-red-500 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-red-700 dark:text-red-300",children:g})]})}),!a&&_.stage!=="idle"&&!N&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Processing Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:_.message}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[Math.round(_.progress),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${es(_.stage)}`,style:{width:`${_.progress}%`},role:"progressbar","aria-label":"Processing progress","aria-valuenow":_.progress,"aria-valuemin":0,"aria-valuemax":100})}),_.stage==="analyzing"&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(ra,{className:"h-4 w-4 animate-spin mr-2","aria-hidden":"true"}),"This may take a few minutes..."]})]})]}),N&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ne,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Analysis Results"})]}),N.rawApiResponse&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"API Response Details"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Predicted Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.predicted_score_anxiety||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`font-mono ${N.rawApiResponse.status==="success"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:N.rawApiResponse.status||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Model Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Category:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.model_category||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Granularity:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.model_granularity||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Calibrated:"}),e.jsx("span",{className:`font-mono ${N.rawApiResponse.is_calibrated?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"}`,children:N.rawApiResponse.is_calibrated?"Yes":"No"})]})]})]}),N.rawApiResponse.actual_score&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Clinical Assessment Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[N.rawApiResponse.actual_score.depression_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.actual_score.depression_binary||"N/A"})]}),N.rawApiResponse.actual_score.anxiety_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.actual_score.anxiety_binary||"N/A"})]}),N.rawApiResponse.actual_score.phq_9&&N.rawApiResponse.actual_score.phq_9.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-9:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",N.rawApiResponse.actual_score.phq_9.join(", "),"]"]})]}),N.rawApiResponse.actual_score.phq_2&&N.rawApiResponse.actual_score.phq_2.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-2:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",N.rawApiResponse.actual_score.phq_2.join(", "),"]"]})]}),N.rawApiResponse.actual_score.gad_7&&N.rawApiResponse.actual_score.gad_7.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"GAD-7:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",N.rawApiResponse.actual_score.gad_7.join(", "),"]"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Created:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:N.rawApiResponse.created_at?new Date(N.rawApiResponse.created_at).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Updated:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:N.rawApiResponse.updated_at?new Date(N.rawApiResponse.updated_at).toLocaleString():"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Session Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:N.sessionId})]})})]}),N.rawApiResponse.predict_error&&e.jsxs("div",{className:"border-l-4 border-red-400 bg-red-50 dark:bg-red-900/20 p-3",children:[e.jsx("h5",{className:"text-sm font-medium text-red-700 dark:text-red-300 mb-1",children:"Prediction Error"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Error Type:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100",children:N.rawApiResponse.predict_error.error})]}),e.jsxs("div",{className:"text-red-700 dark:text-red-300",children:[e.jsx("span",{className:"font-medium",children:"Message:"})," ",N.rawApiResponse.predict_error.message]})]})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(N.rawApiResponse,null,2)})})]})]})})]}),N.insights&&N.insights.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Clinical Insights"}),e.jsx("ul",{className:"space-y-1",children:N.insights.map((i,d)=>e.jsxs("li",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["â€¢ ",i]},d))})]}),e.jsx("div",{className:"mt-6 flex space-x-3",children:e.jsx("button",{type:"button",onClick:ue,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:"Analyze Another File"})})]}),(a&&s.length>0||!a&&A)&&!N&&Object.keys(p).length===0&&_.stage==="idle"&&!y&&e.jsx("div",{className:"text-center",children:a?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:e.jsxs("button",{type:"button",onClick:Xe,disabled:s.length===0||!k.trim()||!s.some(i=>f[i.id]==="ready"),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start All Ready Files",s.filter(i=>f[i.id]==="ready").length>0&&` (${s.filter(i=>f[i.id]==="ready").length})`]})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'Use individual "Start" buttons on each file for selective processing, or "Start All" to process all ready files sequentially'})]}):e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:zs,disabled:!A||!k.trim(),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start Analysis"]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"This will convert, upload, and analyze your audio file"})]})}),a&&Object.keys(p).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ne,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Batch Analysis Results (",Object.keys(p).length," files)"]})]}),e.jsx("div",{className:"space-y-6",children:Object.entries(p).map(([i,d])=>{const j=s.find(R=>R.id===i),C=c[i];return e.jsxs("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:(j==null?void 0:j.file.name)||`File ${i}`}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(C==null?void 0:C.stage)==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Complete"]}),(C==null?void 0:C.stage)==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]})]})]}),d.rawApiResponse&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3 border",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.predicted_score_anxiety||"N/A"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.sessionId})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.status||"N/A"})]})]})}),e.jsxs("details",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto max-h-64",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(d.rawApiResponse,null,2)})})]})]}),j&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>{const R=document.getElementById(`audio-${i}`);R.paused?(document.querySelectorAll("audio").forEach(M=>M.pause()),n(i),R.play()):(R.pause(),n(null))},className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900","aria-label":I===i?"Pause audio":"Play audio",children:I===i?e.jsx(Ye,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[j.file.name," â€¢ ",j.duration?`${Math.round(j.duration)}s`:"Duration unknown"]})]}),e.jsx("audio",{id:`audio-${i}`,src:j.url,onEnded:()=>n(null),className:"hidden"})]})]},i)})})]}),S.length>0&&e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:S.map(i=>e.jsx("div",{className:`max-w-sm w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg border-l-4 p-4 transition-all duration-300 transform ${i.type==="error"?"border-red-500":i.type==="warning"?"border-yellow-500":i.type==="success"?"border-green-500":"border-blue-500"}`,role:"alert",children:e.jsxs("div",{className:"flex items-start",children:[e.jsxs("div",{className:"flex-shrink-0",children:[i.type==="error"&&e.jsx(de,{className:"h-5 w-5 text-red-500","aria-hidden":"true"}),i.type==="warning"&&e.jsx(de,{className:"h-5 w-5 text-yellow-500","aria-hidden":"true"}),i.type==="success"&&e.jsx(ne,{className:"h-5 w-5 text-green-500","aria-hidden":"true"}),i.type==="info"&&e.jsx(de,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"})]}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:i.message})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{type:"button",onClick:()=>Me(i.id),className:"inline-flex text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close notification",children:e.jsx(Ue,{className:"h-4 w-4"})})})]})},i.id))})]})},Ge={queued:{color:"yellow",icon:be,label:"Queued"},running:{color:"blue",icon:se,label:"Processing"},processing:{color:"blue",icon:se,label:"Processing"},succeeded:{color:"green",icon:ne,label:"Completed"},success:{color:"green",icon:ne,label:"Completed"},failed:{color:"red",icon:ws,label:"Failed"}},Oe=s=>s?s.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()):"â€”",Pe=s=>{if(!s)return 0;switch(s.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},Ea=()=>{const[s,t]=o.useState([]),[a,r]=o.useState(!0),[c,h]=o.useState(null),[p,b]=o.useState(new Set),[f,x]=o.useState(!1),[y,F]=o.useState({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),{announceToScreenReader:A}=Re(),z=o.useCallback(async()=>{var u,I;try{r(!0),h(null);const n=Ie(),l=await B.getUserSessions(n);console.log("Raw sessions response:",l),l.sessions&&l.sessions.length>0&&(console.log("First session prediction:",(u=l.sessions[0])==null?void 0:u.prediction),console.log("First session analysisResults:",(I=l.sessions[0])==null?void 0:I.analysisResults));const v=l.sessions.map(g=>{var S;const m=g.prediction;return{...g,uploadedAt:g.createdAt,fileName:g.audioFileName||`Audio_${g.sessionId.slice(-8)}.wav`,fileSize:Math.floor(Math.random()*5e6)+1e6,riskLevel:((S=g.analysisResults)==null?void 0:S.riskLevel)||"unknown",depressionScore:(m==null?void 0:m.predicted_score_depression)||(m==null?void 0:m.predictedScoreDepression)||void 0,anxietyScore:(m==null?void 0:m.predicted_score_anxiety)||(m==null?void 0:m.predictedScoreAnxiety)||void 0}});t(v),A(`${v.length} sessions loaded successfully`)}catch(n){const l=n;h(l),A(`Error loading sessions: ${l.message}`)}finally{r(!1)}},[A]);o.useEffect(()=>{z()},[z]);const _=o.useMemo(()=>{let u=s;if(y.search){const I=y.search.toLowerCase();u=u.filter(n=>{var l,v;return n.sessionId.toLowerCase().includes(I)||((l=n.fileName)==null?void 0:l.toLowerCase().includes(I))||((v=Ge[n.status])==null?void 0:v.label.toLowerCase().includes(I))})}if(y.status!=="all"&&(u=u.filter(I=>I.status===y.status)),y.dateRange!=="all"){const I=new Date,n=new Date;switch(y.dateRange){case"today":n.setHours(0,0,0,0);break;case"week":n.setDate(I.getDate()-7);break;case"month":n.setMonth(I.getMonth()-1);break;case"year":n.setFullYear(I.getFullYear()-1);break}u=u.filter(l=>new Date(l.uploadedAt)>=n)}return u.sort((I,n)=>{let l=0;switch(y.sortBy){case"date":l=new Date(I.uploadedAt).getTime()-new Date(n.uploadedAt).getTime();break;case"status":l=I.status.localeCompare(n.status);break;case"depressionScore":const v=Pe(I.depressionScore),g=Pe(n.depressionScore);l=v-g;break;case"anxietyScore":const m=Pe(I.anxietyScore),S=Pe(n.anxietyScore);l=m-S;break}return y.sortOrder==="desc"?-l:l}),u},[s,y]),w=o.useCallback((u,I)=>{F(n=>({...n,[u]:I})),A(`Filter ${u} changed to ${I}`)},[A]),N=o.useCallback(u=>{b(I=>{const n=new Set(I);return n.has(u)?(n.delete(u),A("Session deselected")):(n.add(u),A("Session selected")),n})},[A]),q=o.useCallback(()=>{p.size===_.length?(b(new Set),A("All sessions deselected")):(b(new Set(_.map(I=>I.sessionId))),A(`All ${_.length} sessions selected`))},[p.size,_,A]),re=o.useCallback(async()=>{p.size===0||!window.confirm(`Are you sure you want to delete ${p.size} session(s)?`)||(t(I=>I.filter(n=>!p.has(n.sessionId))),b(new Set),A(`${p.size} sessions deleted`))},[p,A]),Q=u=>{if(u===0)return"0 B";const I=1024,n=["B","KB","MB","GB"],l=Math.floor(Math.log(u)/Math.log(I));return`${parseFloat((u/Math.pow(I,l)).toFixed(1))} ${n[l]}`},oe=({status:u})=>{const I=Ge[u]||Ge.failed,n=I.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":I.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":I.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${I.label}`,children:[e.jsx(n,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),I.label]})};return a?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(se,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading sessions..."})]})}):c?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Sessions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:c.message}),e.jsx("button",{onClick:z,className:"mt-4 btn-primary","aria-label":"Retry loading sessions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Analysis Sessions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"View and manage your audio analysis sessions"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:z,disabled:a,className:"btn-secondary","aria-label":"Refresh sessions list",children:[e.jsx(se,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsx(Z,{to:"/upload",className:"btn-primary","aria-label":"Start new analysis session",children:"New Analysis"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{htmlFor:"search-sessions",className:"sr-only",children:"Search sessions"}),e.jsxs("div",{className:"relative",children:[e.jsx(ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400","aria-hidden":"true"}),e.jsx("input",{id:"search-sessions",type:"text",placeholder:"Search by session ID, filename, or status...",value:y.search,onChange:u=>w("search",u.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent","aria-describedby":"search-help"})]}),e.jsx("p",{id:"search-help",className:"sr-only",children:"Search through your analysis sessions by ID, filename, or status"})]}),e.jsxs("button",{onClick:()=>x(!f),className:"btn-secondary flex items-center","aria-expanded":f,"aria-controls":"filter-panel","aria-label":`${f?"Hide":"Show"} filter options`,children:[e.jsx(Ss,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",f?e.jsx(vs,{className:"w-4 h-4 ml-2","aria-hidden":"true"}):e.jsx(Ns,{className:"w-4 h-4 ml-2","aria-hidden":"true"})]})]}),f&&e.jsxs("div",{id:"filter-panel",className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{id:"status-filter",value:y.status,onChange:u=>w("status",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"queued",children:"Queued"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"succeeded",children:"Completed"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-filter",value:y.dateRange,onChange:u=>w("dateRange",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-by",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort By"}),e.jsxs("select",{id:"sort-by",value:y.sortBy,onChange:u=>w("sortBy",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"status",children:"Status"}),e.jsx("option",{value:"depressionScore",children:"Depression Score"}),e.jsx("option",{value:"anxietyScore",children:"Anxiety Score"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-order",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort Order"}),e.jsxs("select",{id:"sort-order",value:y.sortOrder,onChange:u=>w("sortOrder",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]}),_.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[_.length," of ",s.length," sessions",p.size>0&&` â€¢ ${p.size} selected`]})}),p.size>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:re,className:"btn-danger","aria-label":`Delete ${p.size} selected sessions`,children:[e.jsx(Cs,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Delete Selected"]})})]}),_.length>0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",role:"table","aria-label":"Analysis sessions",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:p.size===_.length,onChange:q,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":"Select all sessions"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Session"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Depression Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Anxiety Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:_.map(u=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:p.has(u.sessionId),onChange:()=>N(u.sessionId),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${u.sessionId}`})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u.fileName}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID: ",u.sessionId.slice(-12)]}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:Q(u.fileSize||0)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(oe,{status:u.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:u.depressionScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Oe(u.depressionScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:u.anxietyScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Oe(u.anxietyScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ce(u.uploadedAt)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ne(u.uploadedAt)})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(Z,{to:`/sessions/${u.sessionId}`,className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300","aria-label":`View details for session ${u.sessionId}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})}),u.status==="succeeded"&&e.jsx("button",{className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300","aria-label":`Download results for session ${u.sessionId}`,children:e.jsx(Be,{className:"w-4 h-4","aria-hidden":"true"})})]})})]},u.sessionId))})]})}),e.jsx("div",{className:"md:hidden space-y-4 p-4",children:_.map(u=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:p.has(u.sessionId),onChange:()=>N(u.sessionId),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${u.sessionId}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u.fileName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",u.sessionId.slice(-12)]})]})]}),e.jsx(oe,{status:u.status})]}),(u.depressionScore||u.anxietyScore)&&e.jsxs("div",{className:"text-sm",children:[u.depressionScore&&e.jsxs("div",{children:["Depression: ",Oe(u.depressionScore)]}),u.anxietyScore&&e.jsxs("div",{children:["Anxiety: ",Oe(u.anxietyScore)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:Ce(u.uploadedAt)}),e.jsx("span",{children:Q(u.fileSize||0)})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[e.jsxs(Z,{to:`/sessions/${u.sessionId}`,className:"btn-secondary text-xs","aria-label":`View details for session ${u.sessionId}`,children:[e.jsx(_e,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"View"]}),u.status==="succeeded"&&e.jsxs("button",{className:"btn-secondary text-xs","aria-label":`Download results for session ${u.sessionId}`,children:[e.jsx(Be,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Download"]})]})]},u.sessionId))})]}):e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No sessions found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't created any analysis sessions yet.":"No sessions match your current filters."}),s.length===0?e.jsx(Z,{to:"/upload",className:"btn-primary",children:"Start Your First Analysis"}):e.jsx("button",{onClick:()=>F({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),className:"btn-secondary",children:"Clear Filters"})]})]})},$a={low:{color:"green",label:"Low Risk",icon:ne,description:"Low likelihood of immediate concerns"},moderate:{color:"yellow",label:"Moderate Risk",icon:_s,description:"Some concerns that warrant attention"},high:{color:"red",label:"High Risk",icon:Je,description:"Significant concerns requiring immediate attention"},critical:{color:"red",label:"Critical Risk",icon:Je,description:"Urgent intervention required"}},Fa=({sessionId:s,existingAssessment:t,onAssessmentUpdated:a})=>{const{announceToScreenReader:r}=Re(),[c,h]=o.useState(t||null),[p,b]=o.useState(!1),[f,x]=o.useState(!1),[y,F]=o.useState(null),A=o.useCallback(async()=>{try{b(!0),F(null),r("Generating AI risk assessment...");const w=await B.generateRiskAssessment(s);if(w.success&&w.riskAssessment)h(w.riskAssessment),a==null||a(w.riskAssessment),r("Risk assessment generated successfully");else throw new Error(w.message||"Failed to generate risk assessment")}catch(w){const N=w;F(N),r(`Error generating assessment: ${N.message}`)}finally{b(!1)}},[s,a,r]),z=o.useCallback(async()=>{try{x(!0),F(null);const w=await B.getRiskAssessment(s);w.success&&w.riskAssessment&&(h(w.riskAssessment),a==null||a(w.riskAssessment))}catch(w){F(w)}finally{x(!1)}},[s,a]),_=({riskLevel:w,riskScore:N})=>{const q=$a[w.toLowerCase()];if(!q)return null;const re=q.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium ${q.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":q.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Risk level: ${q.label}`,children:[e.jsx(re,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),q.label,N&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded text-xs font-bold",children:[N,"/10"]})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:q.description})]})};return!c&&!p&&!f?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Risk Assessment Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Generate an AI-powered risk assessment based on session data and clinical insights."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:A,className:"btn-primary","aria-label":"Generate AI risk assessment",children:[e.jsx(ge,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Generate AI Risk Assessment"]}),e.jsxs("button",{onClick:z,className:"btn-secondary","aria-label":"Check for existing assessment",children:[e.jsx(se,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Check for Existing Assessment"]})]}),y&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:y.message})})]})]}):p||f?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(se,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:p?"Generating AI risk assessment...":"Loading assessment..."})]}),p&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This may take a few moments as AI analyzes the session data..."})})]}):c?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:[c.confidenceLevel&&e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Confidence: ",(c.confidenceLevel*100).toFixed(0),"%"]}),e.jsxs("button",{onClick:A,disabled:p,className:"btn-secondary text-xs","aria-label":"Regenerate risk assessment",children:[e.jsx(se,{className:`w-3 h-3 mr-1 ${p?"animate-spin":""}`,"aria-hidden":"true"}),"Regenerate"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Overall Risk Level"}),e.jsx(_,{riskLevel:c.overallRiskLevel,riskScore:c.riskScore})]}),c.generatedAt&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(ks,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Generated"]}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ne(c.generatedAt)})]})]}),c.summary&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Wt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Summary"]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsx("p",{className:"text-blue-900 dark:text-blue-100 text-sm leading-relaxed",children:c.summary})})]}),c.keyFactors&&c.keyFactors.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(_s,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Key Risk Factors"]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:c.keyFactors.map((w,N)=>e.jsxs("li",{className:"text-yellow-900 dark:text-yellow-100 text-sm flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-3 flex-shrink-0","aria-hidden":"true"}),w]},N))})})]}),c.recommendations&&c.recommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(ta,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recommendations"]}),e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:e.jsx("ul",{className:"space-y-2",children:c.recommendations.map((w,N)=>e.jsxs("li",{className:"text-green-900 dark:text-green-100 text-sm flex items-start",children:[e.jsx(ne,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),w]},N))})})]}),c.immediateActions&&c.immediateActions.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(ga,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Immediate Actions Required"]}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:e.jsx("ul",{className:"space-y-2",children:c.immediateActions.map((w,N)=>e.jsxs("li",{className:"text-red-900 dark:text-red-100 text-sm flex items-start",children:[e.jsx(Je,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),w]},N))})})]}),c.followUpRecommendations&&c.followUpRecommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Follow-up Recommendations"]}),e.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:e.jsx("ul",{className:"space-y-2",children:c.followUpRecommendations.map((w,N)=>e.jsxs("li",{className:"text-purple-900 dark:text-purple-100 text-sm flex items-start",children:[e.jsx(be,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),w]},N))})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(be,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),"Generated: ",Ne(c.generatedAt),c.modelVersion&&e.jsxs("span",{className:"ml-4",children:["Model: ",c.modelVersion]})]})})]}),y&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:y.message})})]}):null},xs={queued:{color:"yellow",icon:be,label:"Queued",description:"Waiting to be processed"},initiated:{color:"blue",icon:be,label:"Initiated",description:"Session has been created"},running:{color:"blue",icon:se,label:"Processing",description:"Audio is being analyzed"},processing:{color:"blue",icon:se,label:"Processing",description:"Analysis in progress"},succeeded:{color:"green",icon:ne,label:"Completed",description:"Analysis completed successfully"},success:{color:"green",icon:ne,label:"Completed",description:"Analysis completed successfully"},failed:{color:"red",icon:ws,label:"Failed",description:"Analysis encountered an error"}},Da=()=>{var u,I,n,l,v,g,m,S,P,V,ce,G,J,X;const{sessionId:s}=Js(),t=us(),{announceToScreenReader:a}=Re(),[r,c]=o.useState(null),[h,p]=o.useState(!0),[b,f]=o.useState(null),[x,y]=o.useState(!1),[F,A]=o.useState(!1),[z,_]=o.useState(!1),w=o.useCallback(async()=>{if(s)try{p(!0),f(null);const D=await B.getSessionData(s);c(D),a(`Session ${s} loaded successfully`)}catch(D){const k=D;f(k),a(`Error loading session: ${k.message}`)}finally{p(!1)}},[s,a]),N=o.useCallback(async()=>{A(!0),await w(),A(!1),a("Session data refreshed")},[w,a]);o.useEffect(()=>{w()},[w]);const q=o.useCallback(()=>{y(D=>{const k=!D;return a(`Raw JSON view ${k?"enabled":"disabled"}`),k})},[a]),re=o.useCallback(()=>{_(D=>!D),a(`Audio ${z?"paused":"playing"}`)},[z,a]),Q=o.useCallback(()=>{if(!r)return;const D=JSON.stringify(r,null,2),k=new Blob([D],{type:"application/json"}),W=URL.createObjectURL(k),H=document.createElement("a");H.href=W,H.download=`session-${r.sessionId}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(W),a("Session data download started")},[r,a]),oe=({status:D})=>{const k=xs[D]||xs.failed,W=k.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${k.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":k.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":k.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${k.label}`,children:[e.jsx(W,{className:`w-4 h-4 mr-2 ${k.color==="blue"&&D==="processing"?"animate-spin":""}`,"aria-hidden":"true"}),k.label]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:k.description})]})};return h?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(se,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading session details..."})]})}):b?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Session"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:b.message}),e.jsxs("div",{className:"mt-4 space-x-3",children:[e.jsx("button",{onClick:w,className:"btn-primary","aria-label":"Retry loading session",children:"Try Again"}),e.jsx(Z,{to:"/sessions",className:"btn-secondary",children:"Back to Sessions"})]})]})]})})}):r?e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>t("/sessions"),className:"btn-secondary","aria-label":"Back to sessions list",children:[e.jsx(_t,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Back to Sessions"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Session Details"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:["ID: ",r.sessionId]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:q,className:"btn-secondary","aria-label":`${x?"Hide":"Show"} raw JSON data`,children:[x?e.jsx(Bt,{className:"w-4 h-4 mr-2"}):e.jsx(_e,{className:"w-4 h-4 mr-2"}),x?"Hide JSON":"Show JSON"]}),e.jsxs("button",{onClick:N,disabled:F,className:"btn-secondary","aria-label":"Refresh session data",children:[e.jsx(se,{className:`w-4 h-4 mr-2 ${F?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{onClick:Q,className:"btn-primary","aria-label":"Download session data as JSON",children:[e.jsx(Be,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),x&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ke,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Raw Session Data"]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 overflow-auto",children:e.jsx("pre",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap break-all",children:JSON.stringify(r,null,2)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ke,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Basic Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsx(oe,{status:r.status})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(ks,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Created"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:Ce(r.createdAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(r.createdAt)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(be,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Last Updated"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:Ce(r.updatedAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(r.updatedAt)})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(ds,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"User ID"]}),e.jsx("div",{className:"font-mono text-sm bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded border break-all",children:r.userId})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Vt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Audio Information"]}),e.jsxs("div",{className:"space-y-4",children:[r.audioFileName&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"File Name"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-medium",children:r.audioFileName})]}),r.audioUrl&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Audio File"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:re,className:"btn-secondary","aria-label":`${z?"Pause":"Play"} audio`,children:z?e.jsx(Ye,{className:"w-4 h-4"}):e.jsx(je,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Audio playback available"})]})]})]})]})]}),r.userMetadata&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ds,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Patient Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.userMetadata.age&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[r.userMetadata.age," years"]})]}),r.userMetadata.gender&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:r.userMetadata.gender.replace(/[_-]/g," ")})]}),r.userMetadata.weight&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[r.userMetadata.weight," lbs"]})]}),r.userMetadata.race&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:r.userMetadata.race})]}),r.userMetadata.ethnicity&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:r.userMetadata.ethnicity})]}),r.userMetadata.zipcode&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-mono",children:r.userMetadata.zipcode})]}),r.userMetadata.language!==void 0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language English"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:r.userMetadata.language?"Yes":"No"})]}),r.userMetadata.sessionNotes&&e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded border",children:r.userMetadata.sessionNotes})]})]})]}),(r.analysisResults||r.prediction)&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ze,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Analysis Results"]}),e.jsxs("div",{className:"space-y-6",children:[(r.analysisResults||r.prediction)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Mental Health Scores"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(((u=r.analysisResults)==null?void 0:u.depressionScore)||((I=r.prediction)==null?void 0:I.predicted_score_depression))&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Depression Score"}),e.jsx(Ze,{className:"w-4 h-4 text-blue-600 dark:text-blue-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:((l=(n=r.analysisResults)==null?void 0:n.depressionScore)==null?void 0:l.toFixed(2))||((v=r.prediction)!=null&&v.predicted_score_depression?r.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase()):"N/A")}),((g=r.analysisResults)==null?void 0:g.confidence)&&e.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["Confidence: ",(r.analysisResults.confidence*100).toFixed(1),"%"]})]}),(((m=r.analysisResults)==null?void 0:m.anxietyScore)||((S=r.prediction)==null?void 0:S.predicted_score_anxiety))&&e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Anxiety Score"}),e.jsx(As,{className:"w-4 h-4 text-purple-600 dark:text-purple-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:((V=(P=r.analysisResults)==null?void 0:P.anxietyScore)==null?void 0:V.toFixed(2))||((ce=r.prediction)!=null&&ce.predicted_score_anxiety?r.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase()):"N/A")}),((G=r.analysisResults)==null?void 0:G.confidence)&&e.jsxs("div",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1",children:["Confidence: ",(r.analysisResults.confidence*100).toFixed(1),"%"]})]})]})]}),((J=r.analysisResults)==null?void 0:J.insights)&&r.analysisResults.insights.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Clinical Insights"}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:r.analysisResults.insights.map((D,k)=>e.jsxs("li",{className:"text-sm text-yellow-800 dark:text-yellow-200 flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-2 flex-shrink-0","aria-hidden":"true"}),D]},k))})})]}),((X=r.analysisResults)==null?void 0:X.completedAt)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Analysis Completion"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ne,{className:"w-4 h-4 text-green-600 dark:text-green-400 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 mr-2",children:"Completed:"}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Ne(r.analysisResults.completedAt)})]})})]})]})]}),e.jsx(Fa,{sessionId:r.sessionId,existingAssessment:r.riskAssessment||null,onAssessmentUpdated:D=>{c(k=>k?{...k,riskAssessment:D}:null)}})]}):e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Session Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"The requested session could not be found."}),e.jsx(Z,{to:"/sessions",className:"btn-primary",children:"Back to Sessions"})]})})},Ta=()=>{const[s,t]=o.useState([]),[a,r]=o.useState(!0),[c,h]=o.useState(null),[p,b]=o.useState({dateRange:"all",scoreType:"all",showTrends:!0}),[f,x]=o.useState(!1),{announceToScreenReader:y}=Re(),F=us(),A=o.useCallback(n=>{F(`/sessions/${n}`),y(`Navigating to session ${n} details`)},[F,y]),z=o.useCallback(async()=>{try{r(!0),h(null);const n=Ie();console.log("Loading predictions for user:",n);const l=await B.getUserSessions(n);console.log("Raw sessions response:",l);const v=l.sessions.filter(g=>(console.log("Session:",g.sessionId,"has prediction:",!!g.prediction,"has analysisResults:",!!g.analysisResults),g.analysisResults||g.prediction));console.log("Filtered sessions with predictions:",v),t(v),y(`${v.length} prediction sessions loaded`)}catch(n){const l=n;console.error("Error loading predictions:",l),h(l),y(`Error loading predictions: ${l.message}`)}finally{r(!1)}},[y]);o.useEffect(()=>{z()},[z]);const _=o.useMemo(()=>{if(p.dateRange==="all")return s;const n=new Date,l=new Date;switch(p.dateRange){case"week":l.setDate(n.getDate()-7);break;case"month":l.setMonth(n.getMonth()-1);break;case"quarter":l.setMonth(n.getMonth()-3);break;case"year":l.setFullYear(n.getFullYear()-1);break}return s.filter(v=>new Date(v.createdAt)>=l)},[s,p.dateRange]),w=o.useMemo(()=>_.map(n=>{var m,S;const l=P=>{if(!P)return null;switch(P.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return null}},v=l((m=n.prediction)==null?void 0:m.predicted_score_depression),g=l((S=n.prediction)==null?void 0:S.predicted_score_anxiety);return{date:n.createdAt,depression:v,anxiety:g,overall:null,sessionId:n.sessionId}}).sort((n,l)=>new Date(n.date).getTime()-new Date(l.date).getTime()),[_]),N=o.useMemo(()=>{const n={depression:[],anxiety:[],overall:[]},l=[{category:"no_to_mild",label:"No to Mild",color:"bg-green-400"},{category:"mild_to_moderate",label:"Mild to Moderate",color:"bg-yellow-500"},{category:"moderate_to_severe",label:"Moderate to Severe",color:"bg-red-600"},{category:"no_or_minimal",label:"No or Minimal",color:"bg-green-400"},{category:"moderate",label:"Moderate",color:"bg-orange-500"},{category:"moderately_severe",label:"Moderately Severe",color:"bg-red-500"},{category:"severe",label:"Severe",color:"bg-red-700"}],v=_.map(m=>{var S;return(S=m.prediction)==null?void 0:S.predicted_score_depression}).filter(m=>m!==void 0);l.forEach(m=>{const S=v.filter(V=>V===m.category).length,P=v.length>0?S/v.length*100:0;S>0&&n.depression.push({category:m.label,count:S,percentage:P,color:m.color})});const g=_.map(m=>{var S;return(S=m.prediction)==null?void 0:S.predicted_score_anxiety}).filter(m=>m!==void 0);return l.forEach(m=>{const S=g.filter(V=>V===m.category).length,P=g.length>0?S/g.length*100:0;S>0&&n.anxiety.push({category:m.label,count:S,percentage:P,color:m.color})}),n},[_]),q=o.useMemo(()=>{const n={},l=m=>{if(!m)return 0;switch(m.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},v=_.map(m=>{var S;return(S=m.prediction)==null?void 0:S.predicted_score_depression}).filter(m=>m!==void 0);if(v.length<2)n.depression={direction:"stable",change:0,period:"insufficient data"};else{const m=v.map(l),S=m.slice(0,Math.floor(m.length/2)),P=m.slice(Math.floor(m.length/2)),V=S.reduce((J,X)=>J+X,0)/S.length,G=P.reduce((J,X)=>J+X,0)/P.length-V;n.depression={direction:Math.abs(G)<.5?"stable":G<0?"improving":"worsening",change:Math.abs(G),period:`${_.length} sessions`}}const g=_.map(m=>{var S;return(S=m.prediction)==null?void 0:S.predicted_score_anxiety}).filter(m=>m!==void 0);if(g.length<2)n.anxiety={direction:"stable",change:0,period:"insufficient data"};else{const m=g.map(l),S=m.slice(0,Math.floor(m.length/2)),P=m.slice(Math.floor(m.length/2)),V=S.reduce((J,X)=>J+X,0)/S.length,G=P.reduce((J,X)=>J+X,0)/P.length-V;n.anxiety={direction:Math.abs(G)<.5?"stable":G<0?"improving":"worsening",change:Math.abs(G),period:`${_.length} sessions`}}return n.overall={direction:"stable",change:0,period:"coming soon"},n},[_]),re=o.useMemo(()=>{const n={totalSessions:_.length,avgDepression:0,avgAnxiety:0,avgOverall:0,latestSession:null,improvementSessions:0};if(_.length===0)return n;const l=_.map(g=>{var m;return(m=g.prediction)==null?void 0:m.predictedScoreDepression}).filter(g=>g!==void 0),v=_.map(g=>{var m;return(m=g.prediction)==null?void 0:m.predictedScoreAnxiety}).filter(g=>g!==void 0);if(l.length>0){const g={};l.forEach(S=>{g[S]=(g[S]||0)+1});const m=Object.entries(g).sort(([,S],[,P])=>P-S)[0][0];n.avgDepression=g[m]}if(v.length>0){const g={};v.forEach(S=>{g[S]=(g[S]||0)+1});const m=Object.entries(g).sort(([,S],[,P])=>P-S)[0][0];n.avgAnxiety=g[m]}return n.latestSession=_.sort((g,m)=>new Date(m.createdAt).getTime()-new Date(g.createdAt).getTime())[0],n.improvementSessions=0,n},[_]),Q=o.useCallback((n,l)=>{b(v=>({...v,[n]:l})),y(`Filter ${n} changed to ${l}`)},[y]),oe=o.useCallback(()=>{const n=JSON.stringify(_,null,2),l=new Blob([n],{type:"application/json"}),v=URL.createObjectURL(l),g=document.createElement("a");g.href=v,g.download=`predictions-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(v),y("Predictions data download started")},[_,y]),u=({trend:n,label:l})=>{const v=n.direction==="improving"?pa:n.direction==="worsening"?Ze:ze,g=n.direction==="improving"?"text-green-600 dark:text-green-400":n.direction==="worsening"?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400";return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:`w-4 h-4 ${g}`,"aria-hidden":"true"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:l}),e.jsxs("span",{className:`text-sm font-medium ${g} capitalize`,children:[n.direction,n.period==="insufficient data"?" (need more sessions)":n.period==="coming soon"?" (analysis coming soon)":` (${n.period})`]})]})},I=({data:n,type:l,onBarClick:v})=>{const g=n.map(k=>k[l]).filter(k=>k!==null);if(g.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No data available"});const m=Math.max(...g),S=Math.min(...g),P=m-S||1,V=k=>{switch(k){case 1:return"No to Mild / No or Minimal";case 2:return"Mild to Moderate / Moderate";case 3:return"Moderate to Severe / Moderately Severe";case 4:return"Severe";default:return"Unknown"}},ce=(k,W)=>{if(W==="depression")switch(k){case 1:return"bg-blue-400";case 2:return"bg-blue-600";case 3:return"bg-blue-800";default:return"bg-blue-500"}else if(W==="anxiety")switch(k){case 1:return"bg-purple-400";case 2:return"bg-purple-600";case 3:return"bg-purple-700";case 4:return"bg-purple-900";default:return"bg-purple-500"}else switch(k){case 1:return"bg-green-400";case 2:return"bg-green-600";case 3:return"bg-green-700";case 4:return"bg-green-800";default:return"bg-green-500"}},G=k=>[{score:1,label:"No/Minimal"},{score:2,label:"Mild"},{score:3,label:"Moderate"},{score:4,label:"Mod-Severe"},{score:5,label:"Severe"}].map(H=>({...H,color:ce(H.score,k)})),J=new Set(g),D=G(l).filter(k=>J.has(k.score));return e.jsxs("div",{children:[e.jsx("div",{className:"h-32 flex items-end space-x-1 px-4 py-2 mb-4",children:n.map((k,W)=>{const H=k[l];if(H===null)return null;const L=(H-S)/P*100,T=ce(H,l),Me=V(H),ue=new Date(k.date).toLocaleDateString();return e.jsx("div",{className:`flex-1 ${T} opacity-70 hover:opacity-100 hover:scale-105 transition-all duration-200 rounded-t cursor-pointer relative group`,style:{height:`${Math.max(L,8)}%`},onClick:()=>v(k.sessionId),role:"button",tabIndex:0,onKeyDown:ve=>{(ve.key==="Enter"||ve.key===" ")&&(ve.preventDefault(),v(k.sessionId))},"aria-label":`View session details for ${Me} score on ${ue}`,children:e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-medium",children:Me}),e.jsx("div",{className:"text-gray-300",children:ue}),e.jsxs("div",{className:"text-gray-300",children:["Session: ",k.sessionId.slice(-8)]}),e.jsx("div",{className:"text-gray-400 text-xs mt-1",children:"Click to view details"}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"})]})},W)})}),D.length>0&&e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"Legend:"}),D.map(k=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-3 h-3 ${k.color} rounded`}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:k.label})]},k.score))]})})]})};return a?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(se,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading predictions..."})]})}):c?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Predictions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:c.message}),e.jsx("button",{onClick:z,className:"mt-4 btn-primary","aria-label":"Retry loading predictions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Predictions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Analyze your mental health trends and insights over time"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>x(!f),className:"btn-secondary","aria-expanded":f,"aria-label":`${f?"Hide":"Show"} filter options`,children:[e.jsx(Ss,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",f?e.jsx(vs,{className:"w-4 h-4 ml-2"}):e.jsx(Ns,{className:"w-4 h-4 ml-2"})]}),e.jsxs("button",{onClick:z,className:"btn-secondary","aria-label":"Refresh predictions data",children:[e.jsx(se,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{onClick:oe,className:"btn-primary",disabled:_.length===0,"aria-label":"Download predictions data",children:[e.jsx(Be,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),f&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-range",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-range",value:p.dateRange,onChange:n=>Q("dateRange",n.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"quarter",children:"Past Quarter"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"score-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Focus Score"}),e.jsxs("select",{id:"score-type",value:p.scoreType,onChange:n=>Q("scoreType",n.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Scores"}),e.jsx("option",{value:"depression",children:"Depression"}),e.jsx("option",{value:"anxiety",children:"Anxiety"}),e.jsx("option",{value:"overall",children:"Overall"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:p.showTrends,onChange:n=>Q("showTrends",n.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show trend analysis"})]})})]})}),_.length===0?e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Prediction Data Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't completed any analysis sessions yet.":"No sessions found for the selected date range."}),e.jsx(Z,{to:"/upload",className:"btn-primary",children:"Start Your First Analysis"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ze,{className:"w-8 h-8 text-blue-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:re.totalSessions})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ge,{className:"w-8 h-8 text-purple-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Depression (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const n=_.map(g=>{var m;return(m=g.prediction)==null?void 0:m.predicted_score_depression}).filter(g=>g!==void 0);if(n.length===0)return"â€”";const l={};return n.forEach(g=>{l[g]=(l[g]||0)+1}),Object.entries(l).sort(([,g],[,m])=>m-g)[0][0].replace(/_/g," ").replace(/\b\w/g,g=>g.toUpperCase())})()})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(As,{className:"w-8 h-8 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Anxiety (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const n=_.map(g=>{var m;return(m=g.prediction)==null?void 0:m.predicted_score_anxiety}).filter(g=>g!==void 0);if(n.length===0)return"â€”";const l={};return n.forEach(g=>{l[g]=(l[g]||0)+1}),Object.entries(l).sort(([,g],[,m])=>m-g)[0][0].replace(/_/g," ").replace(/\b\w/g,g=>g.toUpperCase())})()})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(p.scoreType==="all"||p.scoreType==="depression")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ls,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Depression Score Trend"]}),e.jsx(I,{data:w,type:"depression",onBarClick:A}),p.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(u,{trend:q.depression,label:"Trend:"})})]}),(p.scoreType==="all"||p.scoreType==="anxiety")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx($t,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Anxiety Score Trend"]}),e.jsx(I,{data:w,type:"anxiety",onBarClick:A}),p.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(u,{trend:q.anxiety,label:"Trend:"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ls,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Score Distribution"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Object.entries(N).map(([n,l])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 capitalize",children:[n," Scores"]}),e.jsx("div",{className:"space-y-2",children:l.map(v=>e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:v.category}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[v.count," (",v.percentage.toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${v.color}`,style:{width:`${v.percentage}%`}})})]})},v.category))})]},n))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(be,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recent Analysis Sessions"]}),e.jsx(Z,{to:"/sessions",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 text-sm",children:"View All Sessions â†’"})]}),e.jsx("div",{className:"space-y-4",children:_.slice(0,5).map(n=>{var l,v;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${n.status==="succeeded"?"bg-green-500":n.status==="processing"?"bg-blue-500":n.status==="failed"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n.audioFileName||`Session ${n.sessionId.slice(-8)}`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ce(n.createdAt)})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[((l=n.prediction)==null?void 0:l.predicted_score_depression)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Depression"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,g=>g.toUpperCase())})]}),((v=n.prediction)==null?void 0:v.predicted_score_anxiety)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Anxiety"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,g=>g.toUpperCase())})]}),e.jsx(Z,{to:`/sessions/${n.sessionId}`,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400","aria-label":`View session ${n.sessionId}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})})]})]},n.sessionId)})})]})]})]})},Ua=()=>{const{data:s,isLoading:t,error:a,refetch:r}=Rs(),{announce:c}=fs();ps.useEffect(()=>{c("System Health page loaded","polite")},[c]);const h=x=>{if(!x)return"Just now";try{const y=new Date(x);return isNaN(y.getTime())?"Just now":y.toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(y){return console.warn("Failed to parse timestamp:",x,y),"Just now"}},p=x=>{switch(x==null?void 0:x.toLowerCase()){case"healthy":return"text-green-600 dark:text-green-400";case"degraded":return"text-yellow-600 dark:text-yellow-400";case"unhealthy":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},b=x=>{switch(x==null?void 0:x.toLowerCase()){case"healthy":return"âœ…";case"degraded":return"âš ï¸";case"unhealthy":return"âŒ";default:return"â“"}},f=x=>{const y="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium";switch(x==null?void 0:x.toLowerCase()){case"healthy":return`${y} bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200`;case"degraded":return`${y} bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200`;case"unhealthy":return`${y} bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200`;default:return`${y} bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200`}};return e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"System Health"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Monitor API status and system connectivity"})]}),e.jsxs("button",{onClick:()=>r(),disabled:t,className:"btn-secondary flex items-center space-x-2","aria-label":"Refresh system health status",children:[e.jsx(se,{className:`w-4 h-4 ${t?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),t&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(se,{className:"w-6 h-6 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Checking system health..."})]})}),a&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-6 h-6 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Health Check Failed"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:a.message||"Unable to retrieve system health status"}),e.jsx("button",{onClick:()=>r(),className:"mt-3 text-sm text-red-800 dark:text-red-200 hover:text-red-900 dark:hover:text-red-100 underline",children:"Try again"})]})]})}),s&&!t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Overall System Status"}),e.jsxs("div",{className:f(s.status),children:[e.jsx("span",{className:"mr-1",children:b(s.status)}),s.status]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:b(s.status)}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Status"}),e.jsx("div",{className:`font-medium ${p(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"â±ï¸"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Response Time"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:s.totalDuration?`${s.totalDuration}ms`:"N/A"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“…"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last Checked"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:h(s.timestamp)})]})]})]}),s.checks&&Object.keys(s.checks).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ze,{className:"w-5 h-5 mr-2"}),"Service Details"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.checks).map(([x,y])=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:b(y.status)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white capitalize",children:x.replace(/-/g," ")}),y.description&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[y.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[y.duration,"ms"]}),e.jsx("div",{className:f(y.status),children:y.status})]})]},x))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ke,{className:"w-5 h-5 mr-2"}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"API Endpoints"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Health Check:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/health"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Sessions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/sessions"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Predictions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/predictions"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Connection Status"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"API Connected"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Real-time Updates"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Auto-refresh Enabled"})]})]})]})]})]})]})]})},La=()=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Page Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"The page you're looking for doesn't exist."}),e.jsx("a",{href:"/",className:"btn-primary",children:"Go to Dashboard"})]}),Oa=new Gs({defaultOptions:{queries:{retry:(s,t)=>{if(t&&typeof t=="object"&&"code"in t){const a=t.code;if(a!=null&&a.startsWith("HTTP_4")&&a!=="HTTP_408")return!1}return s<3},staleTime:5*60*1e3,refetchOnWindowFocus:!1},mutations:{retry:1}}});function Pa(){return e.jsxs(Ws,{client:Oa,children:[e.jsx(pt,{children:e.jsx(Zs,{children:e.jsx(jt,{children:e.jsxs(Qs,{children:[e.jsx(ye,{path:"/",element:e.jsx(Aa,{})}),e.jsx(ye,{path:"/upload",element:e.jsx(Ma,{})}),e.jsx(ye,{path:"/sessions",element:e.jsx(Ea,{})}),e.jsx(ye,{path:"/sessions/:sessionId",element:e.jsx(Da,{})}),e.jsx(ye,{path:"/predictions",element:e.jsx(Ta,{})}),e.jsx(ye,{path:"/health",element:e.jsx(Ua,{})}),e.jsx(ye,{path:"*",element:e.jsx(La,{})})]})})})}),!1]})}const gs=localStorage.getItem("bh_theme"),za=window.matchMedia("(prefers-color-scheme: dark)").matches,Ba=gs==="dark"||!gs&&za;Ba?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");We.createRoot(document.getElementById("root")).render(e.jsx(ps.StrictMode,{children:e.jsx(Pa,{})}));
//# sourceMappingURL=index-150d29ae.js.map
