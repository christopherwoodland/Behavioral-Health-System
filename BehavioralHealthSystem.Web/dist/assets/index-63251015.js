var qs=Object.defineProperty;var Vs=(s,t,r)=>t in s?qs(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var se=(s,t,r)=>(Vs(s,typeof t!="symbol"?t+"":t,r),r);import{j as e,u as ps,Q as Gs,a as Ws}from"./query-e4af0201.js";import{a as Ks,r as o,u as Ys,L as Z,b as Js,c as ys,R as bs,B as Zs,d as Qs,e as ye}from"./vendor-99a90158.js";import{F as Xs,t as as,f as et}from"./ffmpeg-c0c62554.js";import{B as st}from"./azure-a3a2de5a.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))a(m);new MutationObserver(m=>{for(const h of m)if(h.type==="childList")for(const b of h.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&a(b)}).observe(document,{childList:!0,subtree:!0});function r(m){const h={};return m.integrity&&(h.integrity=m.integrity),m.referrerPolicy&&(h.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?h.credentials="include":m.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function a(m){if(m.ep)return;m.ep=!0;const h=r(m);fetch(m.href,h)}})();var Je={},ns=Ks;Je.createRoot=ns.createRoot,Je.hydrateRoot=ns.hydrateRoot;let Te;const tt=new Uint8Array(16);function rt(){if(!Te&&(Te=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Te))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Te(tt)}const K=[];for(let s=0;s<256;++s)K.push((s+256).toString(16).slice(1));function at(s,t=0){return K[s[t+0]]+K[s[t+1]]+K[s[t+2]]+K[s[t+3]]+"-"+K[s[t+4]]+K[s[t+5]]+"-"+K[s[t+6]]+K[s[t+7]]+"-"+K[s[t+8]]+K[s[t+9]]+"-"+K[s[t+10]]+K[s[t+11]]+K[s[t+12]]+K[s[t+13]]+K[s[t+14]]+K[s[t+15]]}const nt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),is={randomUUID:nt};function fs(s,t,r){if(is.randomUUID&&!t&&!s)return is.randomUUID();s=s||{};const a=s.random||(s.rng||rt)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,t){r=r||0;for(let m=0;m<16;++m)t[r+m]=a[m];return t}return at(a)}const ke={api:{baseUrl:"https://cwbhieastus001.azurewebsites.net/api"},azure:{blobSasUrl:"https://aistgvi.blob.core.windows.net/?sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiyx&se=2026-06-26T11:43:55Z&st=2025-09-06T03:28:55Z&spr=https&sig=jlfi75igY6qW805u%2FWErZpEu7AZSll5hJOdvSJU35%2Bo%3D",containerName:"audio-uploads"},polling:{intervalMs:parseInt("3000",10),maxAttempts:60,backoffFactor:1.2},features:{enableFFmpegWorker:!0,enableDebugLogging:!0},audio:{acceptedFormats:[".wav",".mp3",".m4a",".aac",".flac"],maxFileSizeMB:100,targetSampleRate:44100,targetChannels:1}},ue={USER_ID:"bh_user_id",THEME:"bh_theme",UPLOAD_SESSIONS:"bh_upload_sessions",PROCESSING_MODE:"bh_processing_mode",USER_ID_CUSTOM:"bh_user_id_custom"},Se={HEALTH:"/health",SESSIONS_INITIATE:"/sessions/initiate",PREDICTIONS_SUBMIT:"/predictions/submit",PREDICTIONS_BY_USER:"/predictions",PREDICTIONS_BY_SESSION:"/predictions/sessions"},Ae={SKIP_TO_CONTENT_ID:"main-content",ANNOUNCEMENTS_ID:"a11y-announcements",FOCUS_TIMEOUT:100,DEBOUNCE_MS:300},Ie=()=>{let s=localStorage.getItem(ue.USER_ID);return(!s||s.trim().length===0)&&(s=fs(),localStorage.setItem(ue.USER_ID,s)),s},it=s=>{if(!s||s.trim().length===0)throw new Error("User ID cannot be empty");localStorage.setItem(ue.USER_ID,s.trim())},ls=()=>{const s=fs();return localStorage.setItem(ue.USER_ID,s),s},lt=()=>localStorage.getItem("bh_user_id_custom")==="true",ot=s=>{localStorage.setItem("bh_user_id_custom",s.toString())},dt=()=>{const s=localStorage.getItem(ue.THEME);return s==="light"||s==="dark"?s:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},os=s=>{localStorage.setItem(ue.THEME,s),s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},ct=()=>{const s=localStorage.getItem(ue.PROCESSING_MODE);return s==="true"||s==="false"?s==="true":!1},mt=s=>{localStorage.setItem(ue.PROCESSING_MODE,s.toString())},Ce=s=>{const t=new Date,r=new Date(s),a=t.getTime()-r.getTime(),m=Math.floor(a/(1e3*60)),h=Math.floor(a/(1e3*60*60)),b=Math.floor(a/(1e3*60*60*24));return m<1?"Just now":m<60?`${m}m ago`:h<24?`${h}h ago`:b<7?`${b}d ago`:r.toLocaleDateString()},Ne=s=>new Date(s).toLocaleString(),le=(s,t,r)=>({code:s,message:t,details:r,timestamp:new Date().toISOString()}),xt=s=>s instanceof TypeError&&s.message.includes("fetch")?!0:s instanceof Error?s.message.includes("Network")||s.message.includes("connection")||s.message.includes("timeout"):!1,gt=(s,t="polite")=>{const r=document.createElement("div");r.setAttribute("aria-live",t),r.setAttribute("aria-atomic","true"),r.className="sr-only",r.textContent=s,document.body.appendChild(r),setTimeout(()=>{document.body.removeChild(r)},1e3)},ht=(s,t=100)=>{setTimeout(()=>{const r=document.getElementById(s);r&&r.focus()},t)},js=o.createContext(void 0),ut=()=>{const s=o.useContext(js);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},pt=({children:s})=>{const[t,r]=o.useState(dt),a=b=>{r(b),os(b)},m=()=>{a(t==="light"?"dark":"light")};o.useEffect(()=>{os(t)},[t]),o.useEffect(()=>{const b=window.matchMedia("(prefers-color-scheme: dark)"),w=j=>{localStorage.getItem("bh_theme")||r(j.matches?"dark":"light")};return b.addEventListener("change",w),()=>b.removeEventListener("change",w)},[]);const h={theme:t,toggleTheme:m,setTheme:a};return e.jsx(js.Provider,{value:h,children:s})},ks=()=>{const s=o.useCallback((a,m="polite")=>{gt(a,m)},[]),t=o.useCallback(a=>{s(a,"assertive")},[s]),r=o.useCallback(a=>{s(a,"polite")},[s]);return{announce:s,announceError:t,announceSuccess:r}},yt=()=>{const s=o.useCallback(r=>{const a=m=>{m.key==="Escape"&&(m.preventDefault(),r())};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[]),t=o.useCallback(r=>a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),r())},[]);return{handleEscape:s,handleEnterSpace:t}},bt=()=>({skipToMain:o.useCallback(()=>{ht(Ae.SKIP_TO_CONTENT_ID,Ae.FOCUS_TIMEOUT)},[])}),ft=({className:s=""})=>{const{theme:t,toggleTheme:r}=ut(),a=Ys(),{handleEnterSpace:m}=yt(),[h,b]=o.useState(!1),w=[{path:"/",label:"Dashboard",icon:"ðŸ "},{path:"/upload",label:"Upload & Analyze",icon:"ðŸ“¤"},{path:"/sessions",label:"Sessions",icon:"ðŸ“Š"},{path:"/predictions",label:"My Predictions",icon:"ðŸ“ˆ"},{path:"/health",label:"System Health",icon:"ðŸ¥"}],j=M=>M==="/"?a.pathname==="/":a.pathname.startsWith(M),p=()=>{b(!h)},f=()=>{b(!1)};return o.useEffect(()=>{b(!1)},[a.pathname]),e.jsx("header",{className:`bg-surface-light dark:bg-surface-dark border-b border-gray-200 dark:border-gray-700 ${s}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(Z,{to:"/",className:"flex items-center space-x-3 text-xl font-bold text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 rounded-md px-2 py-1","aria-label":"Behavioral Health System - Go to Dashboard",children:[e.jsx("span",{className:"text-2xl",role:"img","aria-label":"Brain icon",children:"ðŸ§ "}),e.jsx("span",{className:"hidden sm:block",children:"Behavioral Health System"}),e.jsx("span",{className:"sm:hidden",children:"BHS"})]})}),e.jsx("nav",{className:"hidden md:flex space-x-1",role:"navigation","aria-label":"Main navigation",children:w.map(({path:M,label:S,icon:B})=>e.jsxs(Z,{to:M,className:`
                  flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors
                  focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                  ${j(M)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                `,"aria-current":j(M)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:B}),e.jsx("span",{children:S})]},M))}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:r,onKeyDown:m(r),className:`\r
                p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":`Switch to ${t==="light"?"dark":"light"} mode`,type:"button",children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:t==="light"?"ðŸŒ™":"â˜€ï¸"})}),e.jsx("button",{onClick:p,onKeyDown:m(p),className:`\r
                md:hidden p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":h?"Close mobile menu":"Open mobile menu",type:"button",...h?{"aria-expanded":!0}:{"aria-expanded":!1},children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:h?"âœ•":"â˜°"})})]})]}),h&&e.jsx("div",{className:"md:hidden border-t border-gray-200 dark:border-gray-700 pt-4 pb-3",children:e.jsx("nav",{className:"space-y-1",role:"navigation","aria-label":"Mobile navigation",children:w.map(({path:M,label:S,icon:B})=>e.jsxs(Z,{to:M,onClick:f,className:`
                    flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium transition-colors
                    focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                    ${j(M)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                  `,"aria-current":j(M)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:B}),e.jsx("span",{children:S})]},M))})})]})})},jt=({size:s=20,className:t="",...r})=>e.jsxs("svg",{width:s,height:s,viewBox:"0 0 23 23",className:t,"aria-label":"Microsoft",...r,children:[e.jsx("rect",{x:"1",y:"1",width:"10",height:"10",fill:"#f25022"}),e.jsx("rect",{x:"12",y:"1",width:"10",height:"10",fill:"#7fba00"}),e.jsx("rect",{x:"1",y:"12",width:"10",height:"10",fill:"#00a4ef"}),e.jsx("rect",{x:"12",y:"12",width:"10",height:"10",fill:"#ffb900"})]}),kt=({children:s,className:t=""})=>{const{skipToMain:r}=bt();return e.jsxs("div",{className:"min-h-screen bg-background-light dark:bg-background-dark",children:[e.jsx("a",{href:`#${Ae.SKIP_TO_CONTENT_ID}`,className:"skip-link",onClick:a=>{a.preventDefault(),r()},children:"Skip to main content"}),e.jsx(ft,{}),e.jsx("main",{id:Ae.SKIP_TO_CONTENT_ID,className:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 ${t}`,tabIndex:-1,children:s}),e.jsx("div",{id:Ae.ANNOUNCEMENTS_ID,className:"sr-only","aria-live":"polite","aria-atomic":"true"}),e.jsx("footer",{className:"bg-surface-light dark:bg-surface-dark border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(jt,{size:24,className:"opacity-80"}),e.jsx("span",{className:"text-sm text-text-muted-light dark:text-text-muted-dark font-medium",children:"Powered by Microsoft"})]}),e.jsxs("div",{className:"text-center text-sm text-text-muted-light dark:text-text-muted-dark",children:[e.jsxs("p",{children:["Behavioral Health System Â© ",new Date().getFullYear()]}),e.jsx("p",{className:"mt-1",children:"WCAG 2.2 AA Compliant â€¢ Section 508 Compliant"})]})]})})})]})};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),wt=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),ds=s=>{const t=wt(s);return t.charAt(0).toUpperCase()+t.slice(1)},Ns=(...s)=>s.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),vt=s=>{for(const t in s)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var St={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=o.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:m="",children:h,iconNode:b,...w},j)=>o.createElement("svg",{ref:j,...St,width:t,height:t,stroke:s,strokeWidth:a?Number(r)*24/Number(t):r,className:Ns("lucide",m),...!h&&!vt(w)&&{"aria-hidden":"true"},...w},[...b.map(([p,f])=>o.createElement(p,f)),...Array.isArray(h)?h:[h]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=(s,t)=>{const r=o.forwardRef(({className:a,...m},h)=>o.createElement(At,{ref:h,iconNode:t,className:Ns(`lucide-${Nt(ds(s))}`,`lucide-${s}`,a),...m}));return r.displayName=ds(s),r};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],He=E("activity",Ct);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],It=E("arrow-left",_t);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],he=E("brain",Mt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ws=E("calendar",Rt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],cs=E("chart-column",Et);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Dt=E("chart-pie",$t);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],vs=E("chevron-down",Ft);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ss=E("chevron-up",Tt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],de=E("circle-alert",Ut);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ie=E("circle-check-big",Ot);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],qe=E("circle-x",Lt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],be=E("clock",Pt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ve=E("download",zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Ht=E("eye-off",Bt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_e=E("eye",qt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]],Gt=E("file-audio",Vt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Kt=E("file-text",Wt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Jt=E("file",Yt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"M15 2a2 2 0 0 1 1.414.586l4 4A2 2 0 0 1 21 8v7a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z",key:"1vo8kb"}],["path",{d:"M15 2v4a2 2 0 0 0 2 2h4",key:"sud9ri"}],["path",{d:"M5 7a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 1.732-1",key:"l4dndm"}]],Qt=E("files",Zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],As=E("funnel",Xt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Cs=E("heart",er);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ze=E("info",sr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],rr=E("lightbulb",tr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],nr=E("loader-circle",ar);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Qe=E("pause",ir);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],je=E("play",lr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ms=E("plus",or);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Q=E("refresh-cw",dr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],mr=E("search",cr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Xe=E("shield-alert",xr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],hr=E("target",gr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Be=E("trash-2",ur);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],yr=E("trending-down",pr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],es=E("trending-up",br);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],_s=E("triangle-alert",fr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],kr=E("upload",jr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],xs=E("user",Nr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],gs=E("volume-2",wr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ue=E("x",vr);class Sr{constructor(t){se(this,"baseUrl");this.baseUrl=t}async handleResponse(t){if(!t.ok){const r=await t.json().catch(()=>({}));throw le(`HTTP_${t.status}`,r.message||`HTTP ${t.status}: ${t.statusText}`,{status:t.status,statusText:t.statusText,data:r})}return t.json()}async request(t,r={}){try{const a=this.baseUrl.endsWith("/")?this.baseUrl.slice(0,-1):this.baseUrl,m=t.startsWith("/")?t:`/${t}`,h=`${a}${m}`,b={"Content-Type":"application/json",...r.headers},w=await fetch(h,{...r,headers:b});return this.handleResponse(w)}catch(a){throw xt(a)?le("NETWORK_ERROR","Unable to connect to the server. Please check your internet connection.",{originalError:a}):a instanceof Error&&"code"in a?a:le("UNKNOWN_ERROR","An unexpected error occurred",{originalError:a})}}async get(t){return this.request(t,{method:"GET"})}async post(t,r){return this.request(t,{method:"POST",body:r?JSON.stringify(r):void 0})}async put(t,r){return this.request(t,{method:"PUT",body:r?JSON.stringify(r):void 0})}async delete(t){return this.request(t,{method:"DELETE"})}}const ne=new Sr(ke.api.baseUrl),q={async checkHealth(){return ne.get(Se.HEALTH)},async initiateSession(s){return ne.post(Se.SESSIONS_INITIATE,s)},async submitPrediction(s){return ne.post(Se.PREDICTIONS_SUBMIT,s)},async getPredictionBySessionId(s){return ne.get(`${Se.PREDICTIONS_BY_SESSION}/${s}`)},async getUserPredictions(s){return ne.get(`${Se.PREDICTIONS_BY_USER}/${s}`)},async saveSessionData(s){return ne.post("sessions",s)},async getSessionData(s){return ne.get(`sessions/${s}`)},async getUserSessions(s){return ne.get(`sessions/users/${s}`)},async updateSessionData(s,t){return ne.put(`sessions/${s}`,t)},async deleteSessionData(s){return ne.delete(`sessions/${s}`)},async testConnection(){try{return await this.checkHealth(),{success:!0,message:"API connection successful"}}catch(s){return{success:!1,message:s.message||"Connection test failed"}}},async generateRiskAssessment(s){return ne.post(`sessions/${s}/risk-assessment`)},async getRiskAssessment(s){return ne.get(`sessions/${s}/risk-assessment`)}};class hs{constructor(t,r={}){se(this,"sessionId");se(this,"intervalMs");se(this,"maxAttempts");se(this,"backoffFactor");se(this,"currentAttempt",0);se(this,"timeoutId",null);se(this,"isPolling",!1);this.sessionId=t,this.intervalMs=r.intervalMs||ke.polling.intervalMs,this.maxAttempts=r.maxAttempts||ke.polling.maxAttempts,this.backoffFactor=r.backoffFactor||ke.polling.backoffFactor}async start(t,r,a){if(this.isPolling)return;this.isPolling=!0,this.currentAttempt=0;const m=async()=>{try{const h=await q.getPredictionBySessionId(this.sessionId);if(t(h),h.status==="succeeded"||h.status==="success"||h.status==="failed"){this.stop(),r(h);return}if(this.currentAttempt++,this.currentAttempt>=this.maxAttempts){this.stop(),a(le("POLLING_TIMEOUT","Prediction polling timed out. Please check the session manually.",{sessionId:this.sessionId,attempts:this.currentAttempt}));return}const b=this.intervalMs*Math.pow(this.backoffFactor,this.currentAttempt);this.timeoutId=window.setTimeout(m,b)}catch(h){this.stop(),a(h)}};await m()}stop(){this.isPolling=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}getStatus(){return{isPolling:this.isPolling,attempt:this.currentAttempt,maxAttempts:this.maxAttempts}}}const Is={health:["health"],userPredictions:s=>["predictions","user",s],sessionPrediction:s=>["predictions","session",s],userSessions:s=>["sessions","user",s]},Ms=()=>ps({queryKey:Is.health,queryFn:()=>q.checkHealth(),retry:2,staleTime:3e4,refetchOnWindowFocus:!1}),Ar=s=>{const t=s||Ie();return ps({queryKey:Is.userSessions(t),queryFn:()=>q.getUserSessions(t),enabled:!!t,staleTime:3e4,refetchOnWindowFocus:!1})},Cr=()=>{const s=Ie(),{announce:t}=ks(),{data:r,isLoading:a,error:m}=Ms(),{data:h,isLoading:b}=Ar(s);o.useEffect(()=>{t("Dashboard page loaded","polite")},[t]);const w=[{title:"Upload & Analyze",description:"Upload audio files for behavioral health analysis",href:"/upload",icon:"ðŸ“¤",color:"primary"},{title:"View Sessions",description:"Browse all analysis sessions and their results",href:"/sessions",icon:"ðŸ“Š",color:"secondary"},{title:"My Predictions",description:"View your complete prediction history",href:"/predictions",icon:"ðŸ“ˆ",color:"accent"},{title:"System Health",description:"Check API status and system connectivity",href:"/health",icon:"ðŸ¥",color:"warning"}],j=p=>{const f="block p-6 rounded-lg border-2 transition-all hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2";switch(p){case"primary":return`${f} border-primary-200 bg-primary-50 hover:border-primary-300 hover:bg-primary-100 dark:border-primary-800 dark:bg-primary-900 dark:hover:border-primary-700 dark:hover:bg-primary-800 focus:ring-primary-500`;case"secondary":return`${f} border-secondary-200 bg-secondary-50 hover:border-secondary-300 hover:bg-secondary-100 dark:border-secondary-800 dark:bg-secondary-900 dark:hover:border-secondary-700 dark:hover:bg-secondary-800 focus:ring-secondary-500`;case"accent":return`${f} border-accent-200 bg-accent-50 hover:border-accent-300 hover:bg-accent-100 dark:border-accent-800 dark:bg-accent-900 dark:hover:border-accent-700 dark:hover:bg-accent-800 focus:ring-accent-500`;case"warning":return`${f} border-warning-200 bg-warning-50 hover:border-warning-300 hover:bg-warning-100 dark:border-teal-600 dark:bg-teal-800 dark:hover:border-teal-500 dark:hover:bg-teal-700 focus:ring-warning-500`;default:return`${f} border-gray-200 bg-gray-50 hover:border-gray-300 hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700 focus:ring-gray-500`}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-text-primary-light dark:text-text-primary-dark",children:"Behavioral Health System"}),e.jsx("p",{className:"mt-2 text-lg text-text-secondary-light dark:text-text-secondary-dark",children:"Audio-based mental health prediction and analysis"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:"Your User ID"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded-md",children:e.jsx("code",{className:"text-sm font-mono text-text-primary-light dark:text-text-primary-dark break-all",children:s})}),e.jsx("p",{className:"mt-2 text-sm text-text-muted-light dark:text-text-muted-dark",children:"This ID is automatically generated and stored locally to track your sessions."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-6",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:w.map(p=>e.jsx(Z,{to:p.href,className:j(p.color),"aria-label":`${p.title}: ${p.description}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-3",role:"img","aria-hidden":"true",children:p.icon}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:p.title}),e.jsx("p",{className:"text-sm text-text-secondary-light dark:text-text-secondary-dark",children:p.description})]})},p.href))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Recent Activity"}),b?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Loading recent sessions..."})]}):!(h!=null&&h.sessions)||h.sessions.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",role:"img","aria-label":"No data",children:"ðŸ“­"}),e.jsxs("p",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:["No sessions yet.",e.jsx(Z,{to:"/upload",className:"text-primary-600 dark:text-primary-400 hover:underline ml-1",children:"Upload your first audio file"})," to get started."]})]}):e.jsxs("div",{className:"space-y-3",children:[h.sessions.slice(0,3).map(p=>{var f,M;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`status-${p.status||"completed"}`,children:p.status||"completed"}),e.jsx("span",{className:"text-text-primary-light dark:text-text-primary-dark",children:p.audioFileName||((f=p.sessionId)==null?void 0:f.slice(0,8))||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",title:p.createdAt,children:p.createdAt?new Date(p.createdAt).toLocaleString():""})]}),e.jsx(Z,{to:`/sessions/${p.sessionId||""}`,className:"text-primary-600 dark:text-primary-400 hover:underline text-sm flex items-center gap-1",title:"View session details","aria-label":`View details for session ${p.audioFileName||((M=p.sessionId)==null?void 0:M.slice(0,8))||"Unknown"}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})})]},p.sessionId)}),h.sessions.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs(Z,{to:"/sessions",className:"text-primary-600 dark:text-primary-400 hover:underline",children:["View all ",h.sessions.length," sessions â†’"]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"System Status"}),a?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Checking system health..."})]}):m?e.jsxs("div",{className:"flex items-center space-x-2 text-error-600 dark:text-error-400",children:[e.jsx("span",{role:"img","aria-label":"Error",children:"âš ï¸"}),e.jsx("span",{children:"System health check failed"})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-success-600 dark:text-success-400",children:[e.jsx("span",{role:"img","aria-label":"Healthy",children:"âœ…"}),e.jsx("span",{children:"All systems operational"}),(r==null?void 0:r.checks)&&e.jsxs("span",{className:"text-text-muted-light dark:text-text-muted-dark",children:["(",Object.keys(r.checks).length," services checked)"]})]})]})]})};class _r{constructor(){se(this,"ffmpeg",null);se(this,"isLoaded",!1);se(this,"loadingPromise",null);this.ffmpeg=new Xs}async loadFFmpeg(){if(!this.isLoaded)return this.loadingPromise?this.loadingPromise:(this.loadingPromise=this.doLoadFFmpeg(),this.loadingPromise)}async doLoadFFmpeg(){if(!this.ffmpeg)throw le("FFMPEG_INIT_ERROR","Failed to initialize FFmpeg");try{const t="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";await this.ffmpeg.load({coreURL:await as(`${t}/ffmpeg-core.js`,"text/javascript"),wasmURL:await as(`${t}/ffmpeg-core.wasm`,"application/wasm")}),this.isLoaded=!0}catch(t){throw this.loadingPromise=null,le("FFMPEG_LOAD_ERROR","Failed to load FFmpeg. Please check your internet connection and try again.",{originalError:t})}}async convertAudio(t,r={outputFormat:"wav",sampleRate:44100,channels:1},a){try{if(a==null||a({stage:"loading",progress:0,message:"Loading audio processor..."}),await this.loadFFmpeg(),!this.ffmpeg)throw le("FFMPEG_NOT_LOADED","FFmpeg not properly loaded");this.ffmpeg.on("progress",({progress:f})=>{a==null||a({stage:"converting",progress:Math.round(f*100),message:`Converting audio... ${Math.round(f*100)}%`})}),a==null||a({stage:"converting",progress:0,message:"Preparing audio file..."});const m="input."+this.getFileExtension(t.name);await this.ffmpeg.writeFile(m,await et(t));const h=`output.${r.outputFormat}`,b=["-i",m,"-ac",r.channels.toString(),"-ar",r.sampleRate.toString(),"-f",r.outputFormat,h];await this.ffmpeg.exec(b);const w=await this.ffmpeg.readFile(h),j=new Blob([w],{type:`audio/${r.outputFormat}`}),p=new File([j],`${this.getFileNameWithoutExtension(t.name)}.${r.outputFormat}`,{type:`audio/${r.outputFormat}`});return await this.ffmpeg.deleteFile(m),await this.ffmpeg.deleteFile(h),a==null||a({stage:"completed",progress:100,message:"Audio conversion completed"}),p}catch(m){throw le("AUDIO_CONVERSION_ERROR","Failed to convert audio file. Please try with a different file.",{originalError:m,fileName:t.name,fileSize:t.size,fileType:t.type})}}getFileExtension(t){const r=t.lastIndexOf(".");return r!==-1?t.slice(r+1).toLowerCase():""}getFileNameWithoutExtension(t){const r=t.lastIndexOf(".");return r!==-1?t.slice(0,r):t}async isFormatSupported(t){try{await this.loadFFmpeg();const r=["wav","mp3","mp4","m4a","aac","flac","ogg"],a=this.getFileExtension(t.name);return r.includes(a)}catch{return!1}}dispose(){this.ffmpeg&&(this.ffmpeg.terminate(),this.ffmpeg=null),this.isLoaded=!1,this.loadingPromise=null}}let Ge=null;const Ir=()=>(Ge||(Ge=new _r),Ge),We=async(s,t)=>{const a=await Ir().convertAudio(s,{outputFormat:"wav",sampleRate:44100,channels:1},t?m=>t(m.progress):void 0);return new Blob([a],{type:"audio/wav"})};class Mr{constructor(t){se(this,"containerClient",null);se(this,"sasUrl");if(this.sasUrl=t||ke.azure.blobSasUrl,!this.sasUrl)throw le("AZURE_CONFIG_ERROR","Azure Blob Storage SAS URL not configured")}getContainerClient(){if(!this.containerClient)try{const t=new st(this.sasUrl);this.containerClient=t.getContainerClient(ke.azure.containerName)}catch(t){throw le("AZURE_CLIENT_ERROR","Failed to initialize Azure Blob Storage client",{originalError:t})}return this.containerClient}async uploadFile(t,r,a){try{a==null||a({progress:0,stage:"preparing",message:"Preparing upload..."});const m=this.getContainerClient(),h=r||this.generateBlobName(t.name),b=m.getBlockBlobClient(h);a==null||a({progress:10,stage:"uploading",message:"Starting upload..."}),await b.uploadData(t,{blobHTTPHeaders:{blobContentType:t.type},onProgress:j=>{const p=j.loadedBytes&&t.size?Math.round(j.loadedBytes/t.size*90)+10:50;a==null||a({progress:p,stage:"uploading",message:`Uploading... ${p}%`})}});const w=b.url;return a==null||a({progress:100,stage:"completed",message:"Upload completed"}),{url:w,fileName:h,size:t.size}}catch(m){throw le("UPLOAD_ERROR","Failed to upload file to Azure Blob Storage",{originalError:m,fileName:t.name,fileSize:t.size})}}generateBlobName(t){const r=new Date().toISOString().replace(/[:.]/g,"-"),a=Math.random().toString(36).substring(2,8),m=t.split(".").pop()||"wav";return`audio/${r}-${a}.${m}`}async testConnection(){try{return await this.getContainerClient().getProperties(),{success:!0,message:"Azure Blob Storage connection successful"}}catch{return{success:!1,message:"Failed to connect to Azure Blob Storage. Please check your SAS URL configuration."}}}async deleteFile(t){try{await this.getContainerClient().getBlockBlobClient(t).deleteIfExists()}catch(r){throw le("DELETE_ERROR","Failed to delete file from Azure Blob Storage",{originalError:r,fileName:t})}}}let Oe=null;const Rr=s=>((!Oe||s&&s!==Oe.sasUrl)&&(Oe=new Mr(s)),Oe),Ke=async(s,t,r)=>{const a=Rr(),m=s instanceof File?s:new File([s],t,{type:s.type});return(await a.uploadFile(m,t,r?b=>r(b.progress):void 0)).url},Me=()=>{const s=o.useRef(null),t=o.useCallback(w=>{if(!s.current){const j=document.createElement("div");j.setAttribute("aria-live","polite"),j.setAttribute("aria-atomic","true"),j.style.position="absolute",j.style.left="-10000px",j.style.width="1px",j.style.height="1px",j.style.overflow="hidden",document.body.appendChild(j),s.current=j}s.current.textContent="",setTimeout(()=>{s.current&&(s.current.textContent=w)},100)},[]),r={focusById:w=>{const j=document.getElementById(w);j&&j.focus()},focusFirstInContainer:w=>{const p=w.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];p&&p.focus()},trapFocus:w=>{const j=w.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),p=j[0],f=j[j.length-1],M=S=>{S.key==="Tab"&&(S.shiftKey?document.activeElement===p&&(f.focus(),S.preventDefault()):document.activeElement===f&&(p.focus(),S.preventDefault()))};return w.addEventListener("keydown",M),()=>{w.removeEventListener("keydown",M)}}},a={handleArrowNavigation:(w,j,p,f)=>{var S;let M=p;switch(w.key){case"ArrowDown":w.preventDefault(),M=p<j.length-1?p+1:0;break;case"ArrowUp":w.preventDefault(),M=p>0?p-1:j.length-1;break;case"Home":w.preventDefault(),M=0;break;case"End":w.preventDefault(),M=j.length-1;break;default:return}f(M),(S=j[M])==null||S.focus()},handleEscape:(w,j)=>{w.key==="Escape"&&(w.preventDefault(),j())}},m=o.useCallback((w="element")=>`${w}-${Math.random().toString(36).substr(2,9)}`,[]),h=o.useCallback(()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),b=o.useCallback((w,j,p)=>{const f={};return w||(f["aria-invalid"]="true",j&&p&&(f["aria-describedby"]=p)),f},[]);return{announceToScreenReader:t,focusManagement:r,keyboardNavigation:a,generateId:m,prefersReducedMotion:h,getValidationAttributes:b}},Er=()=>{const[s,t]=o.useState([]),[r,a]=o.useState(()=>ct()),[m,h]=o.useState({}),[b,w]=o.useState({}),[j,p]=o.useState({}),[f,M]=o.useState(!1),[S,B]=o.useState(null),[C,_]=o.useState({stage:"idle",progress:0,message:""}),[k,V]=o.useState(null),[te,X]=o.useState(!1),[ce,me]=o.useState(0),[x,l]=o.useState(null),[i,u]=o.useState({age:"",gender:"",race:"",ethnicity:"",language:"",weight:"",zipcode:"",sessionNotes:""}),[c,g]=o.useState(null),[I,O]=o.useState([]),[G,xe]=o.useState(()=>lt()),[W,Y]=o.useState(""),[D,L]=o.useState(null),v=Ie(),H=o.useRef(null),re=o.useRef(null),{announceToScreenReader:U}=Me(),F=o.useCallback((n,d,y)=>{const N=Date.now().toString()+Math.random().toString(36).substr(2,9),R={id:N,type:n,title:d,message:y,timestamp:Date.now()};O(P=>[...P,R]),setTimeout(()=>{O(P=>P.filter(J=>J.id!==N))},n==="error"?8e3:5e3)},[]),Re=o.useCallback(n=>{O(d=>d.filter(y=>y.id!==n))},[]),pe=o.useCallback(()=>{t([]),B(null),_({stage:"idle",progress:0,message:""}),V(null),w({}),h({}),g(null),X(!1),me(0),l(null),M(!1)},[]),we=o.useCallback(()=>{xe(n=>{const d=!n;if(ot(d),L(null),d)Y(v),U("Switched to custom User ID mode");else{Y("");const y=ls();U(`Switched to auto-generated mode. New User ID: ${y}`)}return d})},[v,U]),Rs=o.useCallback(n=>{Y(n),L(null)},[]),Es=o.useCallback(()=>{const n=W.trim();if(!n){L("User ID cannot be empty");return}if(n.length<3){L("User ID must be at least 3 characters long");return}if(n.length>100){L("User ID must be less than 100 characters");return}if(/[<>"/\\|?*\x00-\x1f]/.test(n)){L('User ID contains invalid characters. Please avoid special characters like < > " / \\ | ? *');return}try{it(n),L(null),U(`Custom User ID applied: ${n}`),window.location.reload()}catch(y){const N=y instanceof Error?y.message:"Failed to set User ID";L(N)}},[W,U]),$s=o.useCallback(()=>{const n=ls();U(`New User ID generated: ${n}`),window.location.reload()},[U]),Ds=()=>Date.now().toString()+Math.random().toString(36).substr(2,9),ss=o.useCallback(n=>{const d=Ds(),y=URL.createObjectURL(n),N={id:d,file:n,url:y};r?(t(A=>[...A,N]),p(A=>({...A,[d]:"ready"})),h(A=>({...A,[d]:{stage:"idle",progress:0,message:"Ready to process"}}))):B(N),U(`Audio file selected: ${n.name}`);const R=new Audio(y);R.addEventListener("loadedmetadata",()=>{r?t(A=>A.map(P=>P.id===d?{...P,duration:R.duration}:P)):B(A=>A?{...A,duration:R.duration}:null)})},[r,U]),Fs=o.useCallback(n=>{r&&(t(d=>{const y=d.find(N=>N.id===n);return y&&URL.revokeObjectURL(y.url),d.filter(N=>N.id!==n)}),h(d=>{const{[n]:y,...N}=d;return N}),w(d=>{const{[n]:y,...N}=d;return N}),p(d=>{const{[n]:y,...N}=d;return N}))},[r]),Ee=o.useCallback(n=>{const d=n.target.files;!d||d.length===0||Array.from(d).forEach(y=>{const N=["audio/wav","audio/wave","audio/x-wav","audio/mp3","audio/mpeg","audio/mp4","audio/m4a","audio/x-m4a","audio/mp4a-latm","audio/aac","audio/x-aac","audio/flac","audio/x-flac"],R=y.name.toLowerCase(),P=[".wav",".mp3",".m4a",".aac",".flac"].some(oe=>R.endsWith(oe));if(!N.includes(y.type)&&!P){g(`Unsupported file type for ${y.name}. Please select supported audio files (WAV, MP3, M4A, AAC, or FLAC)`),F("error","Unsupported File",`${y.name} is not a supported audio file format`),U(`Error: Unsupported file format selected for ${y.name}`);return}const ae=50*1024*1024;if(y.size>ae){g(`File ${y.name} is too large. File size must be less than 50MB`),F("error","File Too Large",`${y.name} size must be less than 50MB`),U(`Error: File ${y.name} is too large`);return}ss(y),g(null)})},[U,ss,F]),Ts=o.useCallback(n=>{n.preventDefault()},[]),Us=o.useCallback(n=>{n.preventDefault();const d=n.dataTransfer.files;d.length>0&&Ee({target:{files:d}})},[Ee]),Os=o.useCallback(()=>{a(n=>{const d=!n;return mt(d),pe(),d})},[pe]),Ls=o.useCallback(()=>{H.current&&(te?(H.current.pause(),X(!1),U("Audio paused")):(H.current.play(),X(!0),U("Audio playing")))},[te,U]),Ps=o.useCallback(()=>{H.current&&me(H.current.currentTime)},[]),$e=o.useCallback(n=>{const d=Math.floor(n/60),y=Math.floor(n%60);return`${d}:${y.toString().padStart(2,"0")}`},[]),fe=o.useCallback(()=>{const n=[];if(i.age){const d=parseInt(i.age);(isNaN(d)||d<18||d>130)&&n.push("Age must be between 18 and 130")}if(i.gender&&(["male","female","non-binary","transgender female","transgender male","other","prefer"].includes(i.gender)||n.push("Invalid gender. Must be: male, female, non-binary, transgender female, transgender male, other, or prefer")),i.race&&(["white","black or african-american","asian","american indian or alaskan native","native Hawaiian or pacific islander","two or more races","other","prefer not to say"].includes(i.race)||n.push("Invalid race. Must be: white, black or african-american, asian, american indian or alaskan native, native Hawaiian or pacific islander, two or more races, other, prefer not to say")),i.ethnicity&&(["Hispanic, Latino, or Spanish Origin","Not Hispanic, Latino, or Spanish Origin"].includes(i.ethnicity)||n.push("Invalid ethnicity. Must be: Hispanic, Latino, or Spanish Origin | Not Hispanic, Latino, or Spanish Origin")),i.zipcode&&(/^[a-zA-Z0-9]{1,10}$/.test(i.zipcode)||n.push("Zipcode must be alphanumeric and contain no more than 10 characters")),i.weight){const d=parseInt(i.weight);(isNaN(d)||d<10||d>1e3)&&n.push("Weight must be between 10 and 1000 pounds (lbs)")}return n},[i]),De=o.useCallback(()=>{const n={};let d=!1;return i.age&&(n.age=parseInt(i.age),d=!0),i.gender&&(n.gender=i.gender,d=!0),i.race&&(n.race=i.race,d=!0),i.ethnicity&&(n.ethnicity=i.ethnicity,d=!0),(i.language==="true"||i.language==="false")&&(n.language=i.language==="true",d=!0),i.weight&&(n.weight=parseInt(i.weight),d=!0),i.zipcode&&(n.zipcode=i.zipcode,d=!0),d?n:void 0},[i]),zs=o.useCallback(async()=>{if(r){if(s.length===0||!v.trim()){g("Please select audio files. User ID is automatically generated."),F("error","Missing Information","Please select audio files. User ID is automatically generated.");return}await ts()}else{if(!S||!v.trim()){g("Please select an audio file. User ID is automatically generated."),F("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}await Hs()}},[S,s,v,r]),Fe=o.useCallback(async(n,d)=>{try{h(z=>({...z,[n]:{stage:"initiating",progress:5,message:"Initiating session..."}}));const y=De(),N={userid:v.trim(),is_initiated:!0};y&&(N.metadata=y);const R=await q.initiateSession(N),A={sessionId:R.sessionId,userId:v.trim()};h(z=>({...z,[n]:{stage:"initiating",progress:10,message:"Saving session data..."}}));const P={sessionId:R.sessionId,userId:v.trim(),userMetadata:y,audioFileName:d.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await q.saveSessionData(P)}catch{}h(z=>({...z,[n]:{stage:"converting",progress:15,message:"Converting audio to required format..."}}));const J=await We(d.file,z=>{h($=>({...$,[n]:{stage:"converting",progress:15+z*.25,message:`Converting audio... ${Math.round(z)}%`}}))});h(z=>({...z,[n]:{stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}}));const ae=`${v}_${A.sessionId}_${Date.now()}.wav`,oe=await Ke(J,ae,z=>{h($=>({...$,[n]:{stage:"uploading",progress:40+z*.25,message:`Uploading... ${Math.round(z)}%`}}))});h(z=>({...z,[n]:{stage:"submitting",progress:65,message:"Submitting for analysis..."}}));try{const z={...P,audioUrl:oe,audioFileName:ae,status:"processing",updatedAt:new Date().toISOString()};await q.updateSessionData(A.sessionId,z)}catch(z){console.warn("Failed to update session data with audio info:",z)}await q.submitPrediction({userId:v.trim(),sessionid:A.sessionId,audioFileUrl:oe,audioFileName:ae}),h(z=>({...z,[n]:{stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}}));const ee=new hs(A.sessionId);await new Promise((z,$)=>{ee.start(T=>{const ve=T.status==="processing"?80:T.status==="success"?95:70;h(ge=>({...ge,[n]:{stage:"analyzing",progress:ve,message:`Analysis ${T.status}...`}})),T.predictError&&F("error","Prediction Error",`${T.predictError.error}: ${T.predictError.message}`)},T=>{if(T.predictError){F("error","Analysis Failed",`The analysis completed with an error: ${T.predictError.error} - ${T.predictError.message}`),h(ge=>({...ge,[n]:{stage:"error",progress:0,message:"Analysis failed with errors"}})),$(new Error(`Prediction error: ${T.predictError.error}`));return}const ve={sessionId:A.sessionId,depressionScore:T.predictedScoreDepression?parseFloat(T.predictedScoreDepression):0,riskLevel:T.predictedScoreDepression&&parseFloat(T.predictedScoreDepression)>.7?"high":T.predictedScoreDepression&&parseFloat(T.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",T.predictedScoreDepression?`Depression score: ${T.predictedScoreDepression}`:"",T.predictedScoreAnxiety?`Anxiety score: ${T.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(ge=>ge.trim()!==""),timestamp:T.updatedAt,audioUrl:oe,rawApiResponse:T};h(ge=>({...ge,[n]:{stage:"complete",progress:100,message:"Analysis complete!"}})),w(ge=>({...ge,[n]:ve})),z()},T=>{$(T)})})}catch(y){console.error(`Error processing file ${n}:`,y);let N="UNKNOWN_ERROR",R="An unexpected error occurred",A={};y&&typeof y=="object"?("code"in y&&typeof y.code=="string"&&(N=y.code),"message"in y&&typeof y.message=="string"&&(R=y.message),"details"in y&&typeof y.details=="object"&&(A=y.details)):y instanceof Error&&(R=y.message,N=y.name||"ERROR");try{const P=m[n];if(P&&(P.stage==="uploading"||P.stage==="submitting"||P.stage==="analyzing")){const J=`${v}_*_*.wav`;console.log(`Attempting cleanup for file pattern: ${J}`)}}catch(P){console.warn("Error during cleanup attempt:",P)}throw h(P=>({...P,[n]:{stage:"error",progress:0,message:"Processing failed",error:{code:N,message:R,details:A}}})),y}},[v,De,q,Ke,We,F]),ts=o.useCallback(async()=>{M(!0),g(null);const n=fe();if(n.length>0){g(`Validation error: ${n.join(", ")}`),F("error","Validation Error",n.join(", ")),M(!1);return}const d=s.filter(R=>j[R.id]==="ready");if(d.length===0){F("info","No Files Ready","No files are ready to process"),M(!1);return}const y=d.length;let N=0;try{for(const R of d){N++,F("info","Processing File",`Processing ${R.file.name} (${N}/${y})`),p(A=>({...A,[R.id]:"processing"}));try{await Fe(R.id,R),p(A=>({...A,[R.id]:"complete"})),F("success","File Complete",`${R.file.name} processed successfully`)}catch(A){let P="FILE_PROCESSING_ERROR",J="An unexpected error occurred",ae={};A&&typeof A=="object"?("code"in A&&typeof A.code=="string"&&(P=A.code),"message"in A&&typeof A.message=="string"&&(J=A.message),"details"in A&&typeof A.details=="object"&&(ae=A.details)):A instanceof Error&&(J=A.message,P=A.name||"ERROR"),F("error","File Failed",`Failed to process ${R.file.name}: ${J}`),p(oe=>({...oe,[R.id]:"error"})),h(oe=>({...oe,[R.id]:{stage:"error",progress:0,message:`Failed: ${J}`,error:{code:P,message:J,details:ae}}}))}}F("success","Batch Complete",`Processed ${N} file${N!==1?"s":""}`),U(`Batch processing complete. ${N} files processed.`)}catch(R){const A=R instanceof Error?R.message:"An unexpected error occurred";g(A),F("error","Batch Failed",A),U(`Error: ${A}`)}finally{M(!1)}},[s,j,fe,F,U,Fe]),Bs=o.useCallback(async n=>{const d=s.find(N=>N.id===n);if(!d)return;const y=fe();if(y.length>0){g(`Validation error: ${y.join(", ")}`),F("error","Validation Error",y.join(", "));return}p(N=>({...N,[n]:"processing"}));try{await Fe(n,d),p(N=>({...N,[n]:"complete"})),F("success","File Complete",`${d.file.name} processed successfully`)}catch(N){console.error(`Error processing ${d.file.name}:`,N);const R=N instanceof Error?N.message:"An unexpected error occurred";F("error","File Failed",`Failed to process ${d.file.name}: ${R}`),p(A=>({...A,[n]:"error"})),h(A=>({...A,[n]:{stage:"error",progress:0,message:`Failed: ${R}`}}))}},[s,fe,F,Fe]),Hs=o.useCallback(async()=>{if(!S||!v.trim()){g("Please select an audio file. User ID is automatically generated."),F("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}const n=fe();if(n.length>0){g(`Validation error: ${n.join(", ")}`),F("error","Validation Error",n.join(", "));return}try{g(null),_({stage:"initiating",progress:5,message:"Initiating session..."}),U("Starting analysis process - initiating session");const d=De(),y={userid:v.trim(),is_initiated:!0};d&&(y.metadata=d);const N=await q.initiateSession(y),R={sessionId:N.sessionId,userId:v.trim()};_({stage:"initiating",progress:10,message:"Saving session data..."});const A={sessionId:N.sessionId,userId:v.trim(),userMetadata:d,audioFileName:S.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await q.saveSessionData(A)}catch{}_({stage:"converting",progress:15,message:"Converting audio to required format..."}),U("Session created successfully, now converting audio");const P=await We(S.file,ee=>{_({stage:"converting",progress:15+ee*.25,message:`Converting audio... ${Math.round(ee)}%`})});_({stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}),U("Audio converted successfully, now uploading");const J=`${v}_${R.sessionId}_${Date.now()}.wav`,ae=await Ke(P,J,ee=>{_({stage:"uploading",progress:40+ee*.25,message:`Uploading... ${Math.round(ee)}%`})});_({stage:"submitting",progress:65,message:"Submitting for analysis..."}),U("Upload complete, submitting for behavioral health analysis");try{const ee={...A,audioUrl:ae,audioFileName:J,status:"processing",updatedAt:new Date().toISOString()};await q.updateSessionData(R.sessionId,ee)}catch(ee){console.warn("Failed to update session data with audio info:",ee)}await q.submitPrediction({userId:v.trim(),sessionid:R.sessionId,audioFileUrl:ae,audioFileName:J}),_({stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}),U("Prediction submitted, analysis in progress");const oe=new hs(R.sessionId);await new Promise((ee,z)=>{oe.start($=>{const T=$.status==="processing"?80:$.status==="success"?95:70;_({stage:"analyzing",progress:T,message:`Analysis ${$.status}...`}),$.predictError&&F("error","Prediction Error",`${$.predictError.error}: ${$.predictError.message}`)},$=>{if($.predictError){F("error","Analysis Failed",`The analysis completed with an error: ${$.predictError.error} - ${$.predictError.message}`),_({stage:"error",progress:0,message:"Analysis failed with errors"}),z(new Error(`Prediction error: ${$.predictError.error}`));return}const T={sessionId:R.sessionId,depressionScore:$.predictedScoreDepression?parseFloat($.predictedScoreDepression):0,riskLevel:$.predictedScoreDepression&&parseFloat($.predictedScoreDepression)>.7?"high":$.predictedScoreDepression&&parseFloat($.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",$.predictedScoreDepression?`Depression score: ${$.predictedScoreDepression}`:"",$.predictedScoreAnxiety?`Anxiety score: ${$.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(ve=>ve.trim()!==""),timestamp:$.updatedAt,audioUrl:ae,rawApiResponse:$};_({stage:"complete",progress:100,message:"Analysis complete!"}),V(T),F("success","Analysis Complete","Your behavioral health analysis has been completed successfully."),U("Behavioral health analysis completed successfully"),ee()},$=>{F("error","Analysis Error",$.message||"An unexpected error occurred during analysis."),z($)})})}catch(d){console.error("Processing error:",d);const y=d instanceof Error?d.message:"An unexpected error occurred";g(y),_({stage:"error",progress:0,message:"Processing failed"}),F("error","Processing Failed",y),U(`Error: ${y}`)}},[S,v,U,fe,De]),rs=o.useCallback(n=>{switch(n){case"error":return"processing-progress__fill--error";case"complete":return"processing-progress__fill--success";default:return""}},[]);return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Processing Mode:"}),e.jsxs("div",{className:"relative inline-flex items-center",children:[e.jsx("button",{type:"button",onClick:Os,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 ${r?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500"}`,"aria-label":`Switch to ${r?"single file":"multi-file"} mode`,children:e.jsx("span",{className:`inline-flex h-6 w-6 transform rounded-full bg-white items-center justify-center transition-transform ${r?"translate-x-9":"translate-x-1"}`,children:r?e.jsx(Qt,{className:"h-3 w-3 text-blue-600"}):e.jsx(Jt,{className:"h-3 w-3 text-gray-600"})})}),e.jsxs("div",{className:"ml-3 flex items-center space-x-4",children:[e.jsx("span",{className:`text-sm font-medium ${r?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:"Single"}),e.jsx("span",{className:`text-sm font-medium ${r?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"}`,children:"Multi"})]})]})]}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${r?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:r?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),"Batch Processing"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v8H4V6z",clipRule:"evenodd"})}),"Single File"]})})]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Upload & Analyze Audio"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Upload ",r?"multiple audio files":"an audio file"," for behavioral health analysis using AI-powered speech pattern recognition"]}),e.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-lg text-sm ${r?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:r?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M9 12a1 1 0 000 2h2a1 1 0 100-2H9z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 0v12h8V4H6z",clipRule:"evenodd"})]}),"Process multiple files with individual controls and batch options"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Upload and analyze one file at a time with detailed progress tracking"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Patient Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 lg:col-span-3 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"User ID Management"}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 p-4 rounded-md border space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current User ID:"}),e.jsx("code",{className:"text-sm font-mono text-gray-900 dark:text-gray-100 break-all block bg-white dark:bg-gray-800 p-2 rounded border",children:v})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:we,className:"px-3 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors","aria-describedby":"user-id-mode-help",children:G?"Switch to Auto-Generated":"Use Custom User ID"}),!G&&e.jsx("button",{type:"button",onClick:$s,className:"px-3 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800 transition-colors",title:"Generate a new random User ID",children:"Generate New ID"})]}),G&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:W,onChange:n=>Rs(n.target.value),placeholder:"Enter custom User ID (any unique string)",className:"flex-1 px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-describedby":"custom-user-id-help","aria-invalid":D?"true":"false"}),e.jsx("button",{type:"button",onClick:Es,disabled:!W.trim(),className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Apply"})]}),D&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",role:"alert",children:D}),e.jsx("p",{id:"custom-user-id-help",className:"text-xs text-gray-500 dark:text-gray-400",children:'Any unique string (3-100 characters). Examples: "patient-001", "john.doe@clinic", "study-participant-42"'})]}),e.jsx("p",{id:"user-id-mode-help",className:"text-xs text-gray-500 dark:text-gray-400",children:G?"Custom mode: Use any unique identifier for tracking (e.g., patient ID, username, study code)":"Auto mode: System generates unique UUIDs automatically"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age (Optional)"}),e.jsx("input",{type:"number",id:"age",value:i.age,onChange:n=>u(d=>({...d,age:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Age in years",min:"1",max:"150"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight (Optional)"}),e.jsx("input",{type:"number",id:"weight",value:i.weight,onChange:n=>u(d=>({...d,weight:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Weight in lbs",min:"1",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender (Optional)"}),e.jsxs("select",{id:"gender",value:i.gender,onChange:n=>u(d=>({...d,gender:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"non-binary",children:"Non-binary"}),e.jsx("option",{value:"transgender female",children:"Transgender female"}),e.jsx("option",{value:"transgender male",children:"Transgender male"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer",children:"Prefer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"race",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race (Optional)"}),e.jsxs("select",{id:"race",value:i.race,onChange:n=>u(d=>({...d,race:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select race"}),e.jsx("option",{value:"white",children:"White"}),e.jsx("option",{value:"black or african-american",children:"Black or African-American"}),e.jsx("option",{value:"asian",children:"Asian"}),e.jsx("option",{value:"american indian or alaskan native",children:"American Indian or Alaskan Native"}),e.jsx("option",{value:"native Hawaiian or pacific islander",children:"Native Hawaiian or Pacific Islander"}),e.jsx("option",{value:"two or more races",children:"Two or more races"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer not to say",children:"Prefer not to say"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ethnicity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity (Optional)"}),e.jsxs("select",{id:"ethnicity",value:i.ethnicity,onChange:n=>u(d=>({...d,ethnicity:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select ethnicity"}),e.jsx("option",{value:"Hispanic, Latino, or Spanish Origin",children:"Hispanic, Latino, or Spanish Origin"}),e.jsx("option",{value:"Not Hispanic, Latino, or Spanish Origin",children:"Not Hispanic, Latino, or Spanish Origin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language (Optional)"}),e.jsxs("select",{id:"language",value:i.language,onChange:n=>u(d=>({...d,language:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select language"}),e.jsx("option",{value:"true",children:"English"}),e.jsx("option",{value:"false",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"zipcode",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code (Optional)"}),e.jsx("input",{type:"text",id:"zipcode",value:i.zipcode,onChange:n=>u(d=>({...d,zipcode:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter ZIP code",pattern:"[0-9]{5}(-[0-9]{4})?",title:"Enter a valid ZIP code (e.g., 12345 or 12345-6789)"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{htmlFor:"sessionNotes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes (Optional)"}),e.jsx("textarea",{id:"sessionNotes",value:i.sessionNotes,onChange:n=>u(d=>({...d,sessionNotes:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",rows:3,placeholder:"Additional notes about this session or patient context"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Audio File Upload ",r&&e.jsx("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:"(Multi-File Mode)"})]}),!r&&!S||r&&s.length===0?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors",onDragOver:Ts,onDrop:Us,children:[e.jsx(kr,{className:"mx-auto h-12 w-12 text-gray-400 mb-4","aria-hidden":"true"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{type:"button",onClick:()=>{var n;return(n=re.current)==null?void 0:n.click()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Select Audio File",r?"s":""]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["or drag and drop ",r?"files":"file"," here"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Supported formats: WAV, MP3, M4A, AAC, FLAC (max 50MB each)",r&&e.jsx("br",{}),r&&"You can select multiple files at once"]}),e.jsx("input",{ref:re,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:Ee,multiple:r,"aria-label":`Select audio file${r?"s":""} for analysis`})]}):e.jsxs("div",{className:"space-y-4",children:[!r&&S&&e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(gs,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:S.file.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(S.file.size/1024/1024).toFixed(2)," MB",S.duration&&` â€¢ ${$e(S.duration)}`]})]})]}),e.jsx("button",{type:"button",onClick:pe,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Remove selected file",children:e.jsx(Ue,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:Ls,className:"flex items-center justify-center w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800","aria-label":te?"Pause audio":"Play audio",children:te?e.jsx(Qe,{className:"h-5 w-5","aria-hidden":"true"}):e.jsx(je,{className:"h-5 w-5 ml-0.5","aria-hidden":"true"})}),e.jsx("div",{className:"flex-1",children:S.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[$e(ce)," / ",$e(S.duration)]})})]}),S.duration&&e.jsx("div",{className:"audio-progress",children:e.jsx("div",{className:"audio-progress__fill progress-animated",style:{width:`${ce/S.duration*100}%`},role:"progressbar","aria-label":"Audio playback progress","aria-valuenow":ce,"aria-valuemin":0,"aria-valuemax":S.duration})})]}),e.jsx("audio",{ref:H,src:S.url,onTimeUpdate:Ps,onEnded:()=>X(!1),onPlay:()=>X(!0),onPause:()=>X(!1),className:"hidden"})]}),r&&s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Selected Files (",s.length,")"]}),e.jsxs("button",{type:"button",onClick:()=>{var n;return(n=re.current)==null?void 0:n.click()},className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Add More Files"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(n=>{const d=j[n.id]||"ready",y=m[n.id];return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[e.jsx(gs,{className:"h-4 w-4 text-blue-500 flex-shrink-0","aria-hidden":"true"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:n.file.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(n.file.size/1024/1024).toFixed(2)," MB",n.duration&&` â€¢ ${$e(n.duration)}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d==="ready"&&e.jsxs("button",{type:"button",onClick:()=>Bs(n.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-offset-gray-800","aria-label":`Start processing ${n.file.name}`,children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),"Start"]}),d==="processing"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"Processing..."}),d==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),"Complete"]}),d==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]}),e.jsx("button",{type:"button",onClick:()=>Fs(n.id),className:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400","aria-label":`Remove ${n.file.name}`,children:e.jsx(Be,{className:"h-4 w-4"})})]})]}),y&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:y.message}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[Math.round(y.progress),"%"]})]}),e.jsx("div",{className:"processing-progress mt-1",children:e.jsx("div",{className:`processing-progress__fill progress-animated ${rs(y.stage)}`,style:{width:`${y.progress}%`}})})]})]},n.id)})}),e.jsx("input",{ref:re,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:Ee,multiple:r,"aria-label":"Select additional audio files for analysis"})]})]})]}),c&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",role:"alert",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"h-5 w-5 text-red-500 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-red-700 dark:text-red-300",children:c})]})}),!r&&C.stage!=="idle"&&!k&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Processing Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:C.message}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[Math.round(C.progress),"%"]})]}),e.jsx("div",{className:"processing-progress",children:e.jsx("div",{className:`processing-progress__fill progress-animated ${rs(C.stage)}`,style:{width:`${C.progress}%`},role:"progressbar","aria-label":"Processing progress","aria-valuenow":C.progress,"aria-valuemin":0,"aria-valuemax":100})}),C.stage==="analyzing"&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(nr,{className:"h-4 w-4 animate-spin mr-2","aria-hidden":"true"}),"This may take a few minutes..."]})]})]}),k&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ie,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Analysis Results"})]}),k.rawApiResponse&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"API Response Details"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Predicted Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.predicted_score_anxiety||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`font-mono ${k.rawApiResponse.status==="success"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:k.rawApiResponse.status||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Model Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Category:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.model_category||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Granularity:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.model_granularity||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Calibrated:"}),e.jsx("span",{className:`font-mono ${k.rawApiResponse.is_calibrated?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"}`,children:k.rawApiResponse.is_calibrated?"Yes":"No"})]})]})]}),k.rawApiResponse.actual_score&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Clinical Assessment Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[k.rawApiResponse.actual_score.depression_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.actual_score.depression_binary||"N/A"})]}),k.rawApiResponse.actual_score.anxiety_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.actual_score.anxiety_binary||"N/A"})]}),k.rawApiResponse.actual_score.phq_9&&k.rawApiResponse.actual_score.phq_9.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-9:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",k.rawApiResponse.actual_score.phq_9.join(", "),"]"]})]}),k.rawApiResponse.actual_score.phq_2&&k.rawApiResponse.actual_score.phq_2.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-2:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",k.rawApiResponse.actual_score.phq_2.join(", "),"]"]})]}),k.rawApiResponse.actual_score.gad_7&&k.rawApiResponse.actual_score.gad_7.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"GAD-7:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",k.rawApiResponse.actual_score.gad_7.join(", "),"]"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Created:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:k.rawApiResponse.created_at?new Date(k.rawApiResponse.created_at).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Updated:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:k.rawApiResponse.updated_at?new Date(k.rawApiResponse.updated_at).toLocaleString():"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Session Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:k.sessionId})]})})]}),k.rawApiResponse.predict_error&&e.jsxs("div",{className:"border-l-4 border-red-400 bg-red-50 dark:bg-red-900/20 p-3",children:[e.jsx("h5",{className:"text-sm font-medium text-red-700 dark:text-red-300 mb-1",children:"Prediction Error"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Error Type:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100",children:k.rawApiResponse.predict_error.error})]}),e.jsxs("div",{className:"text-red-700 dark:text-red-300",children:[e.jsx("span",{className:"font-medium",children:"Message:"})," ",k.rawApiResponse.predict_error.message]})]})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(k.rawApiResponse,null,2)})})]})]})})]}),k.insights&&k.insights.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Clinical Insights"}),e.jsx("ul",{className:"space-y-1",children:k.insights.map((n,d)=>e.jsxs("li",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["â€¢ ",n]},d))})]}),e.jsx("div",{className:"mt-6 flex space-x-3",children:e.jsx("button",{type:"button",onClick:pe,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:"Analyze Another File"})})]}),(r&&s.length>0||!r&&S)&&!k&&Object.keys(b).length===0&&C.stage==="idle"&&!f&&e.jsx("div",{className:"text-center",children:r?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:e.jsxs("button",{type:"button",onClick:ts,disabled:s.length===0||!v.trim()||!s.some(n=>j[n.id]==="ready"),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start All Ready Files",s.filter(n=>j[n.id]==="ready").length>0&&` (${s.filter(n=>j[n.id]==="ready").length})`]})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'Use individual "Start" buttons on each file for selective processing, or "Start All" to process all ready files sequentially'})]}):e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:zs,disabled:!S||!v.trim(),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start Analysis"]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"This will convert, upload, and analyze your audio file"})]})}),r&&Object.keys(b).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ie,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Batch Analysis Results (",Object.keys(b).length," files)"]})]}),e.jsx("div",{className:"space-y-6",children:Object.entries(b).map(([n,d])=>{const y=s.find(R=>R.id===n),N=m[n];return e.jsxs("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:(y==null?void 0:y.file.name)||`File ${n}`}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(N==null?void 0:N.stage)==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),"Complete"]}),(N==null?void 0:N.stage)==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]})]})]}),(N==null?void 0:N.stage)==="error"&&(N==null?void 0:N.error)&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mt-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(de,{className:"h-5 w-5 text-red-500 mr-3 mt-0.5 flex-shrink-0","aria-hidden":"true"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-red-800 dark:text-red-200 mb-2",children:"Error Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 font-medium",children:"Error Code:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100",children:N.error.code})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 font-medium",children:"Error Message:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100 text-right",children:N.error.message})]})]}),N.error.details&&Object.keys(N.error.details).length>0&&e.jsxs("details",{className:"mt-3",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-red-700 dark:text-red-300 hover:text-red-900 dark:hover:text-red-100",children:"View Additional Error Details"}),e.jsx("div",{className:"mt-2 bg-red-100 dark:bg-red-900/40 rounded p-3 overflow-auto max-h-32",children:e.jsx("pre",{className:"text-xs text-red-800 dark:text-red-200 whitespace-pre-wrap",children:JSON.stringify(N.error.details,null,2)})})]})]})]})]})}),d.rawApiResponse&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3 border",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.predicted_score_anxiety||"N/A"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.sessionId})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.status||"N/A"})]})]})}),e.jsxs("details",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto max-h-64",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(d.rawApiResponse,null,2)})})]})]}),y&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{const R=document.getElementById(`audio-${n}`);R.paused?(document.querySelectorAll("audio").forEach(A=>A.pause()),l(n),R.play()):(R.pause(),l(null))},className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900","aria-label":x===n?"Pause audio":"Play audio",children:x===n?e.jsx(Qe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[y.file.name," â€¢ ",y.duration?`${Math.round(y.duration)}s`:"Duration unknown"]})]}),e.jsx("audio",{id:`audio-${n}`,src:y.url,onEnded:()=>l(null),className:"hidden"})]})]},n)})})]}),I.length>0&&e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:I.map(n=>e.jsx("div",{className:`max-w-sm w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg border-l-4 p-4 transition-all duration-300 transform ${n.type==="error"?"border-red-500":n.type==="warning"?"border-yellow-500":n.type==="success"?"border-green-500":"border-blue-500"}`,role:"alert",children:e.jsxs("div",{className:"flex items-start",children:[e.jsxs("div",{className:"flex-shrink-0",children:[n.type==="error"&&e.jsx(de,{className:"h-5 w-5 text-red-500","aria-hidden":"true"}),n.type==="warning"&&e.jsx(de,{className:"h-5 w-5 text-yellow-500","aria-hidden":"true"}),n.type==="success"&&e.jsx(ie,{className:"h-5 w-5 text-green-500","aria-hidden":"true"}),n.type==="info"&&e.jsx(de,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"})]}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:n.message})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{type:"button",onClick:()=>Re(n.id),className:"inline-flex text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close notification",children:e.jsx(Ue,{className:"h-4 w-4"})})})]})},n.id))})]})},Le={queued:{color:"yellow",icon:be,label:"Queued"},running:{color:"blue",icon:Q,label:"Processing"},processing:{color:"blue",icon:Q,label:"Processing"},succeeded:{color:"green",icon:ie,label:"Completed"},success:{color:"green",icon:ie,label:"Completed"},failed:{color:"red",icon:qe,label:"Failed"},error:{color:"red",icon:qe,label:"Error"}},Pe=s=>s?s.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()):"â€”",ze=s=>{if(!s)return 0;switch(s.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},$r=()=>{const[s,t]=o.useState([]),[r,a]=o.useState(!0),[m,h]=o.useState(null),[b,w]=o.useState(new Set),[j,p]=o.useState(!1),[f,M]=o.useState({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),{announceToScreenReader:S}=Me(),B=o.useCallback(async()=>{try{a(!0),h(null);const x=Ie(),i=(await q.getUserSessions(x)).sessions.map(u=>{var g;const c=u.prediction;return{...u,uploadedAt:u.createdAt,fileName:u.audioFileName||`Audio_${u.sessionId.slice(-8)}.wav`,fileSize:Math.floor(Math.random()*5e6)+1e6,riskLevel:((g=u.analysisResults)==null?void 0:g.riskLevel)||"unknown",depressionScore:(c==null?void 0:c.predicted_score_depression)||(c==null?void 0:c.predictedScoreDepression)||void 0,anxietyScore:(c==null?void 0:c.predicted_score_anxiety)||(c==null?void 0:c.predictedScoreAnxiety)||void 0}});t(i),S(`${i.length} sessions loaded successfully`)}catch(x){const l=x;h(l),S(`Error loading sessions: ${l.message}`)}finally{a(!1)}},[S]);o.useEffect(()=>{B()},[B]);const C=o.useMemo(()=>{let x=s;if(f.search){const l=f.search.toLowerCase();x=x.filter(i=>{var u,c;return i.sessionId.toLowerCase().includes(l)||((u=i.fileName)==null?void 0:u.toLowerCase().includes(l))||((c=Le[i.status])==null?void 0:c.label.toLowerCase().includes(l))})}if(f.status!=="all"&&(x=x.filter(l=>l.status===f.status)),f.dateRange!=="all"){const l=new Date,i=new Date;switch(f.dateRange){case"today":i.setHours(0,0,0,0);break;case"week":i.setDate(l.getDate()-7);break;case"month":i.setMonth(l.getMonth()-1);break;case"year":i.setFullYear(l.getFullYear()-1);break}x=x.filter(u=>new Date(u.uploadedAt)>=i)}return x.sort((l,i)=>{let u=0;switch(f.sortBy){case"date":u=new Date(l.uploadedAt).getTime()-new Date(i.uploadedAt).getTime();break;case"status":u=l.status.localeCompare(i.status);break;case"depressionScore":const c=ze(l.depressionScore),g=ze(i.depressionScore);u=c-g;break;case"anxietyScore":const I=ze(l.anxietyScore),O=ze(i.anxietyScore);u=I-O;break}return f.sortOrder==="desc"?-u:u}),x},[s,f]),_=o.useCallback((x,l)=>{M(i=>({...i,[x]:l})),S(`Filter ${x} changed to ${l}`)},[S]),k=o.useCallback(x=>{w(l=>{const i=new Set(l);return i.has(x)?(i.delete(x),S("Session deselected")):(i.add(x),S("Session selected")),i})},[S]),V=o.useCallback(()=>{b.size===C.length?(w(new Set),S("All sessions deselected")):(w(new Set(C.map(l=>l.sessionId))),S(`All ${C.length} sessions selected`))},[b.size,C,S]),te=o.useCallback(async x=>{if(window.confirm("Are you sure you want to delete this session? This action cannot be undone."))try{await q.deleteSessionData(x),t(i=>i.filter(u=>u.sessionId!==x)),w(i=>{const u=new Set(i);return u.delete(x),u}),S("Session deleted successfully")}catch(i){const u=i;S(`Error deleting session: ${u.message}`),alert(`Failed to delete session: ${u.message}`)}},[S]),X=o.useCallback(async()=>{if(b.size===0||!window.confirm(`Are you sure you want to delete ${b.size} session(s)? This action cannot be undone.`))return;const l=Array.from(b);let i=0,u=[];for(const c of l)try{await q.deleteSessionData(c),i++}catch(g){const I=g;u.push(c),console.error(`Failed to delete session ${c}:`,I.message)}if(i>0&&t(c=>c.filter(g=>!(b.has(g.sessionId)&&!u.includes(g.sessionId)))),w(new Set),u.length===0)S(`${i} sessions deleted successfully`);else{const c=`${i} sessions deleted successfully, ${u.length} failed`;S(c),alert(`${c}. Failed sessions: ${u.join(", ")}`)}},[b,S]),ce=x=>{if(x===0)return"0 B";const l=1024,i=["B","KB","MB","GB"],u=Math.floor(Math.log(x)/Math.log(l));return`${parseFloat((x/Math.pow(l,u)).toFixed(1))} ${i[u]}`},me=({status:x})=>{const l=x.toLowerCase();let i=Le[x];i||(l.includes("error")||l.includes("fail")?i=Le.error:i=Le.failed);const u=i.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":i.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":i.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${i.label}`,children:[e.jsx(u,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),i.label]})};return r?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(Q,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading sessions..."})]})}):m?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Sessions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:m.message}),e.jsx("button",{type:"button",onClick:B,className:"mt-4 btn btn--primary","aria-label":"Retry loading sessions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Analysis Sessions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"View and manage your audio analysis sessions"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:B,disabled:r,className:"btn btn--secondary","aria-label":"Refresh sessions list",children:[e.jsx(Q,{className:`w-4 h-4 mr-2 ${r?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsx(Z,{to:"/upload",className:"btn btn--primary","aria-label":"Start new analysis session",children:"New Analysis"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{htmlFor:"search-sessions",className:"sr-only",children:"Search sessions"}),e.jsxs("div",{className:"relative",children:[e.jsx(mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400","aria-hidden":"true"}),e.jsx("input",{id:"search-sessions",type:"text",placeholder:"Search by session ID, filename, or status...",value:f.search,onChange:x=>_("search",x.target.value),className:"form__input w-full pl-10 pr-4 py-2","aria-describedby":"search-help"})]}),e.jsx("p",{id:"search-help",className:"sr-only",children:"Search through your analysis sessions by ID, filename, or status"})]}),e.jsxs("button",{type:"button",onClick:()=>p(!j),className:"btn btn--secondary flex items-center","aria-expanded":j?"true":"false","aria-controls":"filter-panel","aria-label":`${j?"Hide":"Show"} filter options`,children:[e.jsx(As,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",j?e.jsx(Ss,{className:"w-4 h-4 ml-2","aria-hidden":"true"}):e.jsx(vs,{className:"w-4 h-4 ml-2","aria-hidden":"true"})]})]}),j&&e.jsxs("div",{id:"filter-panel",className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{id:"status-filter",value:f.status,onChange:x=>_("status",x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"queued",children:"Queued"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"succeeded",children:"Completed"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-filter",value:f.dateRange,onChange:x=>_("dateRange",x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-by",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort By"}),e.jsxs("select",{id:"sort-by",value:f.sortBy,onChange:x=>_("sortBy",x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"status",children:"Status"}),e.jsx("option",{value:"depressionScore",children:"Depression Score"}),e.jsx("option",{value:"anxietyScore",children:"Anxiety Score"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-order",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort Order"}),e.jsxs("select",{id:"sort-order",value:f.sortOrder,onChange:x=>_("sortOrder",x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]}),C.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[C.length," of ",s.length," sessions",b.size>0&&` â€¢ ${b.size} selected`]})}),b.size>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{type:"button",onClick:X,className:"btn btn--danger","aria-label":`Delete ${b.size} selected sessions`,children:[e.jsx(Be,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Delete Selected"]})})]}),C.length>0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",role:"table","aria-label":"Analysis sessions",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:b.size===C.length,onChange:V,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":"Select all sessions"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Session"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Depression Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Anxiety Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:C.map(x=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:b.has(x.sessionId),onChange:()=>k(x.sessionId),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${x.sessionId}`})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:x.fileName}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID: ",x.sessionId.slice(-12)]}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:ce(x.fileSize||0)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(me,{status:x.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:x.depressionScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Pe(x.depressionScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:x.anxietyScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Pe(x.anxietyScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ce(x.uploadedAt)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ne(x.uploadedAt)})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(Z,{to:`/sessions/${x.sessionId}`,className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300","aria-label":`View details for session ${x.sessionId}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})}),x.status==="succeeded"&&e.jsx("button",{type:"button",className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300","aria-label":`Download results for session ${x.sessionId}`,children:e.jsx(Ve,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx("button",{type:"button",onClick:()=>te(x.sessionId),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300","aria-label":`Delete session ${x.sessionId}`,children:e.jsx(Be,{className:"w-4 h-4","aria-hidden":"true"})})]})})]},x.sessionId))})]})}),e.jsx("div",{className:"md:hidden space-y-4 p-4",children:C.map(x=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:b.has(x.sessionId),onChange:()=>k(x.sessionId),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${x.sessionId}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:x.fileName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",x.sessionId.slice(-12)]})]})]}),e.jsx(me,{status:x.status})]}),(x.depressionScore||x.anxietyScore)&&e.jsxs("div",{className:"text-sm",children:[x.depressionScore&&e.jsxs("div",{children:["Depression: ",Pe(x.depressionScore)]}),x.anxietyScore&&e.jsxs("div",{children:["Anxiety: ",Pe(x.anxietyScore)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:Ce(x.uploadedAt)}),e.jsx("span",{children:ce(x.fileSize||0)})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[e.jsxs(Z,{to:`/sessions/${x.sessionId}`,className:"btn btn--secondary text-xs","aria-label":`View details for session ${x.sessionId}`,children:[e.jsx(_e,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"View"]}),x.status==="succeeded"&&e.jsxs("button",{type:"button",className:"btn btn--secondary text-xs","aria-label":`Download results for session ${x.sessionId}`,children:[e.jsx(Ve,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Download"]}),e.jsxs("button",{type:"button",onClick:()=>te(x.sessionId),className:"btn btn--danger text-xs","aria-label":`Delete session ${x.sessionId}`,children:[e.jsx(Be,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Delete"]})]})]},x.sessionId))})]}):e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No sessions found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't created any analysis sessions yet.":"No sessions match your current filters."}),s.length===0?e.jsx(Z,{to:"/upload",className:"btn btn--primary",children:"Start Your First Analysis"}):e.jsx("button",{type:"button",onClick:()=>M({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),className:"btn btn--secondary",children:"Clear Filters"})]})]})},Dr={low:{color:"green",label:"Low Risk",icon:ie,description:"Low likelihood of immediate concerns"},moderate:{color:"yellow",label:"Moderate Risk",icon:_s,description:"Some concerns that warrant attention"},high:{color:"red",label:"High Risk",icon:Xe,description:"Significant concerns requiring immediate attention"},critical:{color:"red",label:"Critical Risk",icon:Xe,description:"Urgent intervention required"}},Fr=({sessionId:s,existingAssessment:t,onAssessmentUpdated:r})=>{const{announceToScreenReader:a}=Me(),[m,h]=o.useState(t||null),[b,w]=o.useState(!1),[j,p]=o.useState(!1),[f,M]=o.useState(null),S=o.useCallback(async()=>{try{w(!0),M(null),a("Generating AI risk assessment...");const _=await q.generateRiskAssessment(s);if(_.success&&_.riskAssessment)h(_.riskAssessment),r==null||r(_.riskAssessment),a("Risk assessment generated successfully");else throw new Error(_.message||"Failed to generate risk assessment")}catch(_){const k=_;M(k),a(`Error generating assessment: ${k.message}`)}finally{w(!1)}},[s,r,a]),B=o.useCallback(async()=>{try{p(!0),M(null);const _=await q.getRiskAssessment(s);_.success&&_.riskAssessment&&(h(_.riskAssessment),r==null||r(_.riskAssessment))}catch(_){M(_)}finally{p(!1)}},[s,r]),C=({riskLevel:_,riskScore:k})=>{const V=Dr[_.toLowerCase()];if(!V)return null;const te=V.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium ${V.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":V.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Risk level: ${V.label}`,children:[e.jsx(te,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),V.label,k&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded text-xs font-bold",children:[k,"/10"]})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:V.description})]})};return!m&&!b&&!j?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(he,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(he,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Risk Assessment Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Generate an AI-powered risk assessment based on session data and clinical insights."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{type:"button",onClick:S,className:"btn btn--primary","aria-label":"Generate AI risk assessment",children:[e.jsx(he,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Generate AI Risk Assessment"]}),e.jsxs("button",{type:"button",onClick:B,className:"btn btn--secondary","aria-label":"Check for existing assessment",children:[e.jsx(Q,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Check for Existing Assessment"]})]}),f&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:f.message})})]})]}):b||j?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(he,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(Q,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:b?"Generating AI risk assessment...":"Loading assessment..."})]}),b&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This may take a few moments as AI analyzes the session data..."})})]}):m?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(he,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsx("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:e.jsxs("button",{type:"button",onClick:S,disabled:b,className:"btn btn--secondary text-xs","aria-label":"Regenerate risk assessment",children:[e.jsx(Q,{className:`w-3 h-3 mr-1 ${b?"animate-spin":""}`,"aria-hidden":"true"}),"Regenerate"]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Overall Risk Level"}),e.jsx(C,{riskLevel:m.overallRiskLevel,riskScore:m.riskScore})]}),m.generatedAt&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(ws,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Generated"]}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ne(m.generatedAt)})]})]}),m.summary&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Kt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Summary"]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsx("p",{className:"text-blue-900 dark:text-blue-100 text-sm leading-relaxed",children:m.summary})})]}),m.keyFactors&&m.keyFactors.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(_s,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Key Risk Factors"]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:m.keyFactors.map((_,k)=>e.jsxs("li",{className:"text-yellow-900 dark:text-yellow-100 text-sm flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-3 flex-shrink-0","aria-hidden":"true"}),_]},k))})})]}),m.recommendations&&m.recommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(rr,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recommendations"]}),e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:e.jsx("ul",{className:"space-y-2",children:m.recommendations.map((_,k)=>e.jsxs("li",{className:"text-green-900 dark:text-green-100 text-sm flex items-start",children:[e.jsx(ie,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),_]},k))})})]}),m.immediateActions&&m.immediateActions.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(hr,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Immediate Actions Required"]}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:e.jsx("ul",{className:"space-y-2",children:m.immediateActions.map((_,k)=>e.jsxs("li",{className:"text-red-900 dark:text-red-100 text-sm flex items-start",children:[e.jsx(Xe,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),_]},k))})})]}),m.followUpRecommendations&&m.followUpRecommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(es,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Follow-up Recommendations"]}),e.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:e.jsx("ul",{className:"space-y-2",children:m.followUpRecommendations.map((_,k)=>e.jsxs("li",{className:"text-purple-900 dark:text-purple-100 text-sm flex items-start",children:[e.jsx(be,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),_]},k))})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(be,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),"Generated: ",Ne(m.generatedAt),m.modelVersion&&e.jsxs("span",{className:"ml-4",children:["Model: ",m.modelVersion]})]})})]}),f&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:f.message})})]}):null},Ye={queued:{color:"yellow",icon:be,label:"Queued",description:"Waiting to be processed"},initiated:{color:"blue",icon:be,label:"Initiated",description:"Session has been created"},running:{color:"blue",icon:Q,label:"Processing",description:"Audio is being analyzed"},processing:{color:"blue",icon:Q,label:"Processing",description:"Analysis in progress"},succeeded:{color:"green",icon:ie,label:"Completed",description:"Analysis completed successfully"},success:{color:"green",icon:ie,label:"Completed",description:"Analysis completed successfully"},failed:{color:"red",icon:qe,label:"Failed",description:"Analysis encountered an error"},error:{color:"red",icon:qe,label:"Error",description:"An error occurred during processing"}},Tr=()=>{var x,l,i,u,c,g,I,O,G,xe,W,Y;const{sessionId:s}=Js(),t=ys(),{announceToScreenReader:r}=Me(),[a,m]=o.useState(null),[h,b]=o.useState(!0),[w,j]=o.useState(null),[p,f]=o.useState(!1),[M,S]=o.useState(!1),[B,C]=o.useState(!1),_=o.useRef(null),k=o.useCallback(async()=>{if(s)try{b(!0),j(null);const D=await q.getSessionData(s);m(D),r(`Session ${s} loaded successfully`)}catch(D){const L=D;j(L),r(`Error loading session: ${L.message}`)}finally{b(!1)}},[s,r]),V=o.useCallback(async()=>{S(!0),await k(),S(!1),r("Session data refreshed")},[k,r]);o.useEffect(()=>{k()},[k]);const te=o.useCallback(()=>{f(D=>{const L=!D;return r(`Raw JSON view ${L?"enabled":"disabled"}`),L})},[r]),X=o.useCallback(()=>{_.current&&(B?(_.current.pause(),C(!1),r("Audio paused")):(_.current.play().catch(()=>{r("Failed to play audio")}),C(!0),r("Audio playing")))},[B,r]),ce=o.useCallback(()=>{if(!a)return;const D=JSON.stringify(a,null,2),L=new Blob([D],{type:"application/json"}),v=URL.createObjectURL(L),H=document.createElement("a");H.href=v,H.download=`session-${a.sessionId}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(v),r("Session data download started")},[a,r]),me=({status:D})=>{const L=D.toLowerCase();let v=Ye[D];v||(L.includes("error")||L.includes("fail")?v=Ye.error:v=Ye.failed);const H=v.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${v.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":v.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":v.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${v.label}`,children:[e.jsx(H,{className:`w-4 h-4 mr-2 ${v.color==="blue"&&D==="processing"?"animate-spin":""}`,"aria-hidden":"true"}),v.label]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:v.description})]})};return h?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(Q,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading session details..."})]})}):w?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Session"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:w.message}),e.jsxs("div",{className:"mt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:k,className:"btn btn--primary","aria-label":"Retry loading session",children:"Try Again"}),e.jsx(Z,{to:"/sessions",className:"btn btn--secondary",children:"Back to Sessions"})]})]})]})})}):a?e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{type:"button",onClick:()=>t("/sessions"),className:"btn btn--secondary","aria-label":"Back to sessions list",children:[e.jsx(It,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Back to Sessions"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Session Details"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:["ID: ",a.sessionId]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:te,className:"btn btn--secondary","aria-label":`${p?"Hide":"Show"} raw JSON data`,children:[p?e.jsx(Ht,{className:"w-4 h-4 mr-2"}):e.jsx(_e,{className:"w-4 h-4 mr-2"}),p?"Hide JSON":"Show JSON"]}),e.jsxs("button",{type:"button",onClick:V,disabled:M,className:"btn btn--secondary","aria-label":"Refresh session data",children:[e.jsx(Q,{className:`w-4 h-4 mr-2 ${M?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{type:"button",onClick:ce,className:"btn btn--primary","aria-label":"Download session data as JSON",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),p&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Raw Session Data"]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 overflow-auto",children:e.jsx("pre",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap break-all",children:JSON.stringify(a,null,2)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Basic Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsx(me,{status:a.status})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(ws,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Created"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:Ce(a.createdAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(a.createdAt)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(be,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Last Updated"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:Ce(a.updatedAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(a.updatedAt)})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(xs,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"User ID"]}),e.jsx("div",{className:"font-mono text-sm bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded border break-all",children:a.userId})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Gt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Audio Information"]}),e.jsxs("div",{className:"space-y-4",children:[a.audioFileName&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"File Name"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-medium",children:a.audioFileName})]}),a.audioUrl&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Audio File"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:X,className:"btn btn--secondary","aria-label":`${B?"Pause":"Play"} audio`,children:B?e.jsx(Qe,{className:"w-4 h-4"}):e.jsx(je,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:B?"Playing audio...":"Audio playback available"})]}),e.jsx("audio",{ref:_,src:a.audioUrl,onPlay:()=>C(!0),onPause:()=>C(!1),onEnded:()=>C(!1),onError:()=>{C(!1),r("Audio playback failed - file may not be accessible")},className:"hidden",preload:"metadata"})]})]})]})]}),a.userMetadata&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(xs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Patient Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.userMetadata.age&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[a.userMetadata.age," years"]})]}),a.userMetadata.gender&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:a.userMetadata.gender.replace(/[_-]/g," ")})]}),a.userMetadata.weight&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[a.userMetadata.weight," lbs"]})]}),a.userMetadata.race&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:a.userMetadata.race})]}),a.userMetadata.ethnicity&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:a.userMetadata.ethnicity})]}),a.userMetadata.zipcode&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-mono",children:a.userMetadata.zipcode})]}),a.userMetadata.language!==void 0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language English"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:a.userMetadata.language?"Yes":"No"})]}),a.userMetadata.sessionNotes&&e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded border",children:a.userMetadata.sessionNotes})]})]})]}),(a.analysisResults||a.prediction)&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(He,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Analysis Results"]}),e.jsxs("div",{className:"space-y-6",children:[(a.analysisResults||a.prediction)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(he,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Mental Health Scores"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(((x=a.analysisResults)==null?void 0:x.depressionScore)||((l=a.prediction)==null?void 0:l.predicted_score_depression))&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Depression Score"}),e.jsx(es,{className:"w-4 h-4 text-blue-600 dark:text-blue-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:((u=(i=a.analysisResults)==null?void 0:i.depressionScore)==null?void 0:u.toFixed(2))||((c=a.prediction)!=null&&c.predicted_score_depression?a.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase()):"N/A")})]}),(((g=a.analysisResults)==null?void 0:g.anxietyScore)||((I=a.prediction)==null?void 0:I.predicted_score_anxiety))&&e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Anxiety Score"}),e.jsx(Cs,{className:"w-4 h-4 text-purple-600 dark:text-purple-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:((G=(O=a.analysisResults)==null?void 0:O.anxietyScore)==null?void 0:G.toFixed(2))||((xe=a.prediction)!=null&&xe.predicted_score_anxiety?a.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase()):"N/A")})]})]})]}),((W=a.analysisResults)==null?void 0:W.insights)&&a.analysisResults.insights.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Clinical Insights"}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:a.analysisResults.insights.map((D,L)=>e.jsxs("li",{className:"text-sm text-yellow-800 dark:text-yellow-200 flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-2 flex-shrink-0","aria-hidden":"true"}),D]},L))})})]}),((Y=a.analysisResults)==null?void 0:Y.completedAt)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Analysis Completion"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ie,{className:"w-4 h-4 text-green-600 dark:text-green-400 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 mr-2",children:"Completed:"}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Ne(a.analysisResults.completedAt)})]})})]})]})]}),e.jsx(Fr,{sessionId:a.sessionId,existingAssessment:a.riskAssessment||null,onAssessmentUpdated:D=>{m(L=>L?{...L,riskAssessment:D}:null)}})]}):e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Session Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"The requested session could not be found."}),e.jsx(Z,{to:"/sessions",className:"btn btn--primary",children:"Back to Sessions"})]})})},Ur=()=>{const[s,t]=o.useState([]),[r,a]=o.useState(!0),[m,h]=o.useState(null),[b,w]=o.useState({dateRange:"all",scoreType:"all",showTrends:!0}),[j,p]=o.useState(!1),{announceToScreenReader:f}=Me(),M=ys(),S=o.useCallback(l=>{M(`/sessions/${l}`),f(`Navigating to session ${l} details`)},[M,f]),B=o.useCallback(async()=>{try{a(!0),h(null);const l=Ie(),u=(await q.getUserSessions(l)).sessions.filter(c=>c.analysisResults||c.prediction);t(u),f(`${u.length} prediction sessions loaded`)}catch(l){const i=l;h(i),f(`Error loading predictions: ${i.message}`)}finally{a(!1)}},[f]);o.useEffect(()=>{B()},[B]);const C=o.useMemo(()=>{if(b.dateRange==="all")return s;const l=new Date,i=new Date;switch(b.dateRange){case"week":i.setDate(l.getDate()-7);break;case"month":i.setMonth(l.getMonth()-1);break;case"quarter":i.setMonth(l.getMonth()-3);break;case"year":i.setFullYear(l.getFullYear()-1);break}return s.filter(u=>new Date(u.createdAt)>=i)},[s,b.dateRange]),_=o.useMemo(()=>C.map(l=>{var g,I;const i=O=>{if(!O)return null;switch(O.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return null}},u=i((g=l.prediction)==null?void 0:g.predicted_score_depression),c=i((I=l.prediction)==null?void 0:I.predicted_score_anxiety);return{date:l.createdAt,depression:u,anxiety:c,overall:null,sessionId:l.sessionId}}).sort((l,i)=>new Date(l.date).getTime()-new Date(i.date).getTime()),[C]),k=o.useMemo(()=>{const l={depression:[],anxiety:[]},i=[{category:"no_to_mild",label:"No to Mild",color:"bg-green-400"},{category:"mild_to_moderate",label:"Mild to Moderate",color:"bg-yellow-500"},{category:"moderate_to_severe",label:"Moderate to Severe",color:"bg-red-600"},{category:"no_or_minimal",label:"No or Minimal",color:"bg-green-400"},{category:"moderate",label:"Moderate",color:"bg-orange-500"},{category:"moderately_severe",label:"Moderately Severe",color:"bg-red-500"},{category:"severe",label:"Severe",color:"bg-red-700"}],u=C.map(g=>{var I;return(I=g.prediction)==null?void 0:I.predicted_score_depression}).filter(g=>g!==void 0);i.forEach(g=>{const I=u.filter(G=>G===g.category).length,O=u.length>0?I/u.length*100:0;I>0&&l.depression.push({category:g.label,count:I,percentage:O,color:g.color})});const c=C.map(g=>{var I;return(I=g.prediction)==null?void 0:I.predicted_score_anxiety}).filter(g=>g!==void 0);return i.forEach(g=>{const I=c.filter(G=>G===g.category).length,O=c.length>0?I/c.length*100:0;I>0&&l.anxiety.push({category:g.label,count:I,percentage:O,color:g.color})}),l},[C]),V=o.useMemo(()=>{const l={},i=g=>{if(!g)return 0;switch(g.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},u=C.map(g=>{var I;return(I=g.prediction)==null?void 0:I.predicted_score_depression}).filter(g=>g!==void 0);if(u.length<2)l.depression={direction:"stable",change:0,period:"insufficient data"};else{const g=u.map(i),I=g.slice(0,Math.floor(g.length/2)),O=g.slice(Math.floor(g.length/2)),G=I.reduce((Y,D)=>Y+D,0)/I.length,W=O.reduce((Y,D)=>Y+D,0)/O.length-G;l.depression={direction:Math.abs(W)<.5?"stable":W<0?"improving":"worsening",change:Math.abs(W),period:`${C.length} sessions`}}const c=C.map(g=>{var I;return(I=g.prediction)==null?void 0:I.predicted_score_anxiety}).filter(g=>g!==void 0);if(c.length<2)l.anxiety={direction:"stable",change:0,period:"insufficient data"};else{const g=c.map(i),I=g.slice(0,Math.floor(g.length/2)),O=g.slice(Math.floor(g.length/2)),G=I.reduce((Y,D)=>Y+D,0)/I.length,W=O.reduce((Y,D)=>Y+D,0)/O.length-G;l.anxiety={direction:Math.abs(W)<.5?"stable":W<0?"improving":"worsening",change:Math.abs(W),period:`${C.length} sessions`}}return l.overall={direction:"stable",change:0,period:"coming soon"},l},[C]),te=o.useMemo(()=>{const l={totalSessions:C.length,avgDepression:0,avgAnxiety:0,avgOverall:0,latestSession:null,improvementSessions:0};if(C.length===0)return l;const i=C.map(c=>{var g;return(g=c.prediction)==null?void 0:g.predictedScoreDepression}).filter(c=>c!==void 0),u=C.map(c=>{var g;return(g=c.prediction)==null?void 0:g.predictedScoreAnxiety}).filter(c=>c!==void 0);if(i.length>0){const c={};i.forEach(I=>{c[I]=(c[I]||0)+1});const g=Object.entries(c).sort(([,I],[,O])=>O-I)[0][0];l.avgDepression=c[g]}if(u.length>0){const c={};u.forEach(I=>{c[I]=(c[I]||0)+1});const g=Object.entries(c).sort(([,I],[,O])=>O-I)[0][0];l.avgAnxiety=c[g]}return l.latestSession=C.sort((c,g)=>new Date(g.createdAt).getTime()-new Date(c.createdAt).getTime())[0],l.improvementSessions=0,l},[C]),X=o.useCallback((l,i)=>{w(u=>({...u,[l]:i})),f(`Filter ${l} changed to ${i}`)},[f]),ce=o.useCallback(()=>{const l=JSON.stringify(C,null,2),i=new Blob([l],{type:"application/json"}),u=URL.createObjectURL(i),c=document.createElement("a");c.href=u,c.download=`predictions-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(u),f("Predictions data download started")},[C,f]),me=({trend:l,label:i})=>{const u=l.direction==="improving"?yr:l.direction==="worsening"?es:He,c=l.direction==="improving"?"text-green-600 dark:text-green-400":l.direction==="worsening"?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400";return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{className:`w-4 h-4 ${c}`,"aria-hidden":"true"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i}),e.jsxs("span",{className:`text-sm font-medium ${c} capitalize`,children:[l.direction,l.period==="insufficient data"?" (need more sessions)":l.period==="coming soon"?" (analysis coming soon)":` (${l.period})`]})]})},x=({data:l,type:i,onBarClick:u})=>{const c=l.map(v=>v[i]).filter(v=>v!==null);if(c.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No data available"});const g=Math.max(...c),I=Math.min(...c),O=g-I||1,G=v=>{switch(v){case 1:return"No to Mild / No or Minimal";case 2:return"Mild to Moderate / Moderate";case 3:return"Moderate to Severe / Moderately Severe";case 4:return"Severe";default:return"Unknown"}},xe=(v,H)=>{if(H==="depression")switch(v){case 1:return"bg-blue-400";case 2:return"bg-blue-600";case 3:return"bg-blue-800";default:return"bg-blue-500"}else if(H==="anxiety")switch(v){case 1:return"bg-purple-400";case 2:return"bg-purple-600";case 3:return"bg-purple-700";case 4:return"bg-purple-900";default:return"bg-purple-500"}else switch(v){case 1:return"bg-green-400";case 2:return"bg-green-600";case 3:return"bg-green-700";case 4:return"bg-green-800";default:return"bg-green-500"}},W=v=>[{score:1,label:"No/Minimal"},{score:2,label:"Mild"},{score:3,label:"Moderate"},{score:4,label:"Mod-Severe"},{score:5,label:"Severe"}].map(re=>({...re,color:xe(re.score,v)})),Y=new Set(c),L=W(i).filter(v=>Y.has(v.score));return e.jsxs("div",{children:[e.jsx("div",{className:"h-32 flex items-end space-x-1 px-4 py-2 mb-4",children:l.map((v,H)=>{const re=v[i];if(re===null)return null;const U=(re-I)/O*100,F=xe(re,i),Re=G(re),pe=new Date(v.date).toLocaleDateString();return e.jsx("div",{className:`flex-1 ${F} opacity-70 hover:opacity-100 hover:scale-105 transition-all duration-200 rounded-t cursor-pointer relative group chart-bar-dynamic`,style:{"--chart-height":`${Math.max(U,8)}%`},onClick:()=>u(v.sessionId),role:"button",tabIndex:0,onKeyDown:we=>{(we.key==="Enter"||we.key===" ")&&(we.preventDefault(),u(v.sessionId))},"aria-label":`View session details for ${Re} score on ${pe}`,children:e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-medium",children:Re}),e.jsx("div",{className:"text-gray-300",children:pe}),e.jsxs("div",{className:"text-gray-300",children:["Session: ",v.sessionId.slice(-8)]}),e.jsx("div",{className:"text-gray-400 text-xs mt-1",children:"Click to view details"}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"})]})},H)})}),L.length>0&&e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"Legend:"}),L.map(v=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-3 h-3 ${v.color} rounded`}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:v.label})]},v.score))]})})]})};return r?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(Q,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading predictions..."})]})}):m?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Predictions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:m.message}),e.jsx("button",{type:"button",onClick:B,className:"mt-4 btn btn--primary","aria-label":"Retry loading predictions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Predictions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Analyze your mental health trends and insights over time"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>p(!j),className:"btn btn--secondary","aria-expanded":j?"true":"false","aria-label":`${j?"Hide":"Show"} filter options`,children:[e.jsx(As,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",j?e.jsx(Ss,{className:"w-4 h-4 ml-2"}):e.jsx(vs,{className:"w-4 h-4 ml-2"})]}),e.jsxs("button",{type:"button",onClick:B,className:"btn btn--secondary","aria-label":"Refresh predictions data",children:[e.jsx(Q,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{type:"button",onClick:ce,className:"btn btn--primary",disabled:C.length===0,"aria-label":"Download predictions data",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),j&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-range",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-range",value:b.dateRange,onChange:l=>X("dateRange",l.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"quarter",children:"Past Quarter"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"score-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Focus Score"}),e.jsxs("select",{id:"score-type",value:b.scoreType,onChange:l=>X("scoreType",l.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Scores"}),e.jsx("option",{value:"depression",children:"Depression"}),e.jsx("option",{value:"anxiety",children:"Anxiety"}),e.jsx("option",{value:"overall",children:"Overall"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:b.showTrends,onChange:l=>X("showTrends",l.target.checked),className:"form__input form__input--checkbox rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show trend analysis"})]})})]})}),C.length===0?e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(he,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Prediction Data Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't completed any analysis sessions yet.":"No sessions found for the selected date range."}),e.jsx(Z,{to:"/upload",className:"btn btn--primary",children:"Start Your First Analysis"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(He,{className:"w-8 h-8 text-blue-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:te.totalSessions})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(he,{className:"w-8 h-8 text-purple-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Depression (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const l=C.map(c=>{var g;return(g=c.prediction)==null?void 0:g.predicted_score_depression}).filter(c=>c!==void 0);if(l.length===0)return"â€”";const i={};return l.forEach(c=>{i[c]=(i[c]||0)+1}),Object.entries(i).sort(([,c],[,g])=>g-c)[0][0].replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase())})()})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Cs,{className:"w-8 h-8 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Anxiety (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const l=C.map(c=>{var g;return(g=c.prediction)==null?void 0:g.predicted_score_anxiety}).filter(c=>c!==void 0);if(l.length===0)return"â€”";const i={};return l.forEach(c=>{i[c]=(i[c]||0)+1}),Object.entries(i).sort(([,c],[,g])=>g-c)[0][0].replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase())})()})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(b.scoreType==="all"||b.scoreType==="depression")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(cs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Depression Score Trend"]}),e.jsx(x,{data:_,type:"depression",onBarClick:S}),b.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(me,{trend:V.depression,label:"Trend:"})})]}),(b.scoreType==="all"||b.scoreType==="anxiety")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Dt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Anxiety Score Trend"]}),e.jsx(x,{data:_,type:"anxiety",onBarClick:S}),b.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(me,{trend:V.anxiety,label:"Trend:"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(cs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Score Distribution"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(k).map(([l,i])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 capitalize",children:[l," Scores"]}),e.jsx("div",{className:"space-y-2",children:i.map(u=>e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:u.category}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[u.count," (",u.percentage.toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${u.color} progress-dynamic progress-animated`,style:{"--progress-width":`${u.percentage}%`}})})]})},u.category))})]},l))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(be,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recent Analysis Sessions"]}),e.jsx(Z,{to:"/sessions",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 text-sm",children:"View All Sessions â†’"})]}),e.jsx("div",{className:"space-y-4",children:C.slice(0,5).map(l=>{var i,u;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${l.status==="succeeded"?"bg-green-500":l.status==="processing"?"bg-blue-500":l.status==="failed"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:l.audioFileName||`Session ${l.sessionId.slice(-8)}`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ce(l.createdAt)})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[((i=l.prediction)==null?void 0:i.predicted_score_depression)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Depression"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:l.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase())})]}),((u=l.prediction)==null?void 0:u.predicted_score_anxiety)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Anxiety"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:l.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase())})]}),e.jsx(Z,{to:`/sessions/${l.sessionId}`,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400","aria-label":`View session ${l.sessionId}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})})]})]},l.sessionId)})})]})]})]})},Or=()=>{const{data:s,isLoading:t,error:r,refetch:a}=Ms(),{announce:m}=ks();bs.useEffect(()=>{m("System Health page loaded","polite")},[m]);const h=p=>{if(!p)return"Just now";try{const f=new Date(p);return isNaN(f.getTime())?"Just now":f.toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return"Just now"}},b=p=>{switch(p==null?void 0:p.toLowerCase()){case"healthy":return"text-green-600 dark:text-green-400";case"degraded":return"text-yellow-600 dark:text-yellow-400";case"unhealthy":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},w=p=>{switch(p==null?void 0:p.toLowerCase()){case"healthy":return"âœ…";case"degraded":return"âš ï¸";case"unhealthy":return"âŒ";default:return"â“"}},j=p=>{const f="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium";switch(p==null?void 0:p.toLowerCase()){case"healthy":return`${f} bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200`;case"degraded":return`${f} bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200`;case"unhealthy":return`${f} bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200`;default:return`${f} bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200`}};return e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"System Health"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Monitor API status and system connectivity"})]}),e.jsxs("button",{type:"button",onClick:()=>a(),disabled:t,className:"btn btn--secondary flex items-center space-x-2","aria-label":"Refresh system health status",children:[e.jsx(Q,{className:`w-4 h-4 ${t?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),t&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Q,{className:"w-6 h-6 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Checking system health..."})]})}),r&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-6 h-6 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Health Check Failed"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:r.message||"Unable to retrieve system health status"}),e.jsx("button",{type:"button",onClick:()=>a(),className:"mt-3 text-sm text-red-800 dark:text-red-200 hover:text-red-900 dark:hover:text-red-100 underline",children:"Try again"})]})]})}),s&&!t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Overall System Status"}),e.jsxs("div",{className:j(s.status),children:[e.jsx("span",{className:"mr-1",children:w(s.status)}),s.status]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:w(s.status)}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Status"}),e.jsx("div",{className:`font-medium ${b(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"â±ï¸"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Response Time"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:s.totalDuration?`${s.totalDuration}ms`:"N/A"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“…"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last Checked"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:h(s.timestamp)})]})]})]}),s.checks&&Object.keys(s.checks).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(He,{className:"w-5 h-5 mr-2"}),"Service Details"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.checks).map(([p,f])=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:w(f.status)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white capitalize",children:p.replace(/-/g," ")}),f.description&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:f.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[f.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[f.duration,"ms"]}),e.jsx("div",{className:j(f.status),children:f.status})]})]},p))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2"}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"API Endpoints"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Health Check:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/health"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Sessions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/sessions"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Predictions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/predictions"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Connection Status"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"API Connected"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Real-time Updates"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Auto-refresh Enabled"})]})]})]})]})]})]})]})},Lr=()=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Page Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"The page you're looking for doesn't exist."}),e.jsx("a",{href:"/",className:"btn btn--primary",children:"Go to Dashboard"})]}),Pr=new Gs({defaultOptions:{queries:{retry:(s,t)=>{if(t&&typeof t=="object"&&"code"in t){const r=t.code;if(r!=null&&r.startsWith("HTTP_4")&&r!=="HTTP_408")return!1}return s<3},staleTime:5*60*1e3,refetchOnWindowFocus:!1},mutations:{retry:1}}});function zr(){return e.jsxs(Ws,{client:Pr,children:[e.jsx(pt,{children:e.jsx(Zs,{children:e.jsx(kt,{children:e.jsxs(Qs,{children:[e.jsx(ye,{path:"/",element:e.jsx(Cr,{})}),e.jsx(ye,{path:"/upload",element:e.jsx(Er,{})}),e.jsx(ye,{path:"/sessions",element:e.jsx($r,{})}),e.jsx(ye,{path:"/sessions/:sessionId",element:e.jsx(Tr,{})}),e.jsx(ye,{path:"/predictions",element:e.jsx(Ur,{})}),e.jsx(ye,{path:"/health",element:e.jsx(Or,{})}),e.jsx(ye,{path:"*",element:e.jsx(Lr,{})})]})})})}),!1]})}const us=localStorage.getItem("bh_theme"),Br=window.matchMedia("(prefers-color-scheme: dark)").matches,Hr=us==="dark"||!us&&Br;Hr?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");Je.createRoot(document.getElementById("root")).render(e.jsx(bs.StrictMode,{children:e.jsx(zr,{})}));
//# sourceMappingURL=index-63251015.js.map
