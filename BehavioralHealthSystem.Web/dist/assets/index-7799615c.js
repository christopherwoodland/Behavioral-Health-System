var Ws=Object.defineProperty;var Js=(s,r,t)=>r in s?Ws(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t;var V=(s,r,t)=>(Js(s,typeof r!="symbol"?r+"":r,t),t);import{j as e,u as ps,Q as Ys,a as Zs}from"./query-e4af0201.js";import{a as Qs,r as o,u as Xs,L as ee,b as et,c as ys,R as bs,B as st,d as tt,e as ue}from"./vendor-99a90158.js";import{F as rt,t as as,f as at}from"./ffmpeg-c0c62554.js";import{B as it,e as nt}from"./azure-e79d136e.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const x of d)if(x.type==="childList")for(const h of x.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function t(d){const x={};return d.integrity&&(x.integrity=d.integrity),d.referrerPolicy&&(x.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?x.credentials="include":d.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function a(d){if(d.ep)return;d.ep=!0;const x=t(d);fetch(d.href,x)}})();var Je={},is=Qs;Je.createRoot=is.createRoot,Je.hydrateRoot=is.hydrateRoot;let Ue;const ot=new Uint8Array(16);function lt(){if(!Ue&&(Ue=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ue))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ue(ot)}const Q=[];for(let s=0;s<256;++s)Q.push((s+256).toString(16).slice(1));function dt(s,r=0){return Q[s[r+0]]+Q[s[r+1]]+Q[s[r+2]]+Q[s[r+3]]+"-"+Q[s[r+4]]+Q[s[r+5]]+"-"+Q[s[r+6]]+Q[s[r+7]]+"-"+Q[s[r+8]]+Q[s[r+9]]+"-"+Q[s[r+10]]+Q[s[r+11]]+Q[s[r+12]]+Q[s[r+13]]+Q[s[r+14]]+Q[s[r+15]]}const ct=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ns={randomUUID:ct};function fs(s,r,t){if(ns.randomUUID&&!r&&!s)return ns.randomUUID();s=s||{};const a=s.random||(s.rng||lt)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,r){t=t||0;for(let d=0;d<16;++d)r[t+d]=a[d];return r}return dt(a)}const ve={api:{baseUrl:"https://cwbhieastus001.azurewebsites.net/api"},azure:{blobSasUrl:"https://aistgvi.blob.core.windows.net/?sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiyx&se=2026-06-26T11:43:55Z&st=2025-09-06T03:28:55Z&spr=https&sig=jlfi75igY6qW805u%2FWErZpEu7AZSll5hJOdvSJU35%2Bo%3D",containerName:"audio-uploads"},polling:{intervalMs:parseInt("3000",10),maxAttempts:60,backoffFactor:1.2},features:{enableFFmpegWorker:!0,enableDebugLogging:!0},audio:{acceptedFormats:[".wav",".mp3",".m4a",".aac",".flac"],maxFileSizeMB:100,targetSampleRate:44100,targetChannels:1}},pe={USER_ID:"bh_user_id",THEME:"bh_theme",UPLOAD_SESSIONS:"bh_upload_sessions",PROCESSING_MODE:"bh_processing_mode",USER_ID_CUSTOM:"bh_user_id_custom"},Ae={HEALTH:"/health",SESSIONS_INITIATE:"/sessions/initiate",PREDICTIONS_SUBMIT:"/predictions/submit",PREDICTIONS_BY_USER:"/predictions",PREDICTIONS_BY_SESSION:"/predictions/sessions"},Ce={SKIP_TO_CONTENT_ID:"main-content",ANNOUNCEMENTS_ID:"a11y-announcements",FOCUS_TIMEOUT:100,DEBOUNCE_MS:300},Ie=()=>{let s=localStorage.getItem(pe.USER_ID);return(!s||s.trim().length===0)&&(s=fs(),localStorage.setItem(pe.USER_ID,s)),s},mt=s=>{if(!s||s.trim().length===0)throw new Error("User ID cannot be empty");localStorage.setItem(pe.USER_ID,s.trim())},os=()=>{const s=fs();return localStorage.setItem(pe.USER_ID,s),s},xt=()=>localStorage.getItem("bh_user_id_custom")==="true",ht=s=>{localStorage.setItem("bh_user_id_custom",s.toString())},ut=()=>{const s=localStorage.getItem(pe.THEME);return s==="light"||s==="dark"?s:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},ls=s=>{localStorage.setItem(pe.THEME,s),s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},gt=()=>{const s=localStorage.getItem(pe.PROCESSING_MODE);return s==="true"||s==="false"?s==="true":!1},pt=s=>{localStorage.setItem(pe.PROCESSING_MODE,s.toString())},_e=s=>{const r=new Date,t=new Date(s),a=r.getTime()-t.getTime(),d=Math.floor(a/(1e3*60)),x=Math.floor(a/(1e3*60*60)),h=Math.floor(a/(1e3*60*60*24));return d<1?"Just now":d<60?`${d}m ago`:x<24?`${x}h ago`:h<7?`${h}d ago`:t.toLocaleDateString()},Ne=s=>new Date(s).toLocaleString(),le=(s,r,t)=>({code:s,message:r,details:t,timestamp:new Date().toISOString()}),yt=s=>s instanceof TypeError&&s.message.includes("fetch")?!0:s instanceof Error?s.message.includes("Network")||s.message.includes("connection")||s.message.includes("timeout"):!1,de=(s,r="polite")=>{const t=document.createElement("div");t.setAttribute("aria-live",r),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.textContent=s,document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},1e3)},bt=(s,r=100)=>{setTimeout(()=>{const t=document.getElementById(s);t&&t.focus()},r)},js=o.createContext(void 0),ft=()=>{const s=o.useContext(js);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},jt=({children:s})=>{const[r,t]=o.useState(ut),a=h=>{t(h),ls(h)},d=()=>{a(r==="light"?"dark":"light")};o.useEffect(()=>{ls(r)},[r]),o.useEffect(()=>{const h=window.matchMedia("(prefers-color-scheme: dark)"),y=j=>{localStorage.getItem("bh_theme")||t(j.matches?"dark":"light")};return h.addEventListener("change",y),()=>h.removeEventListener("change",y)},[]);const x={theme:r,toggleTheme:d,setTheme:a};return e.jsx(js.Provider,{value:x,children:s})},ks=()=>{const s=o.useCallback((a,d="polite")=>{de(a,d)},[]),r=o.useCallback(a=>{s(a,"assertive")},[s]),t=o.useCallback(a=>{s(a,"polite")},[s]);return{announce:s,announceError:r,announceSuccess:t}},vs=()=>{const s=o.useCallback(t=>{const a=d=>{d.key==="Escape"&&(d.preventDefault(),t())};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[]),r=o.useCallback(t=>a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),t())},[]);return{handleEscape:s,handleEnterSpace:r}},kt=()=>({skipToMain:o.useCallback(()=>{bt(Ce.SKIP_TO_CONTENT_ID,Ce.FOCUS_TIMEOUT)},[])}),vt=({className:s=""})=>{const{theme:r,toggleTheme:t}=ft(),a=Xs(),{handleEnterSpace:d}=vs(),[x,h]=o.useState(!1),y=[{path:"/",label:"Dashboard",icon:"ðŸ "},{path:"/upload",label:"Upload & Analyze",icon:"ðŸ“¤"},{path:"/sessions",label:"Sessions",icon:"ðŸ“Š"},{path:"/predictions",label:"My Predictions",icon:"ðŸ“ˆ"},{path:"/agent-experience",label:"Agent Experience",icon:"ðŸ¤–"},{path:"/health",label:"System Health",icon:"ðŸ¥"}],j=g=>g==="/"?a.pathname==="/":a.pathname.startsWith(g),m=()=>{h(!x)},b=()=>{h(!1)};return o.useEffect(()=>{h(!1)},[a.pathname]),e.jsx("header",{className:`bg-surface-light dark:bg-surface-dark border-b border-gray-200 dark:border-gray-700 ${s}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(ee,{to:"/",className:"flex items-center space-x-3 text-xl font-bold text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 rounded-md px-2 py-1","aria-label":"Behavioral Health System - Go to Dashboard",children:[e.jsx("span",{className:"text-2xl",role:"img","aria-label":"Brain icon",children:"ðŸ§ "}),e.jsx("span",{className:"hidden sm:block",children:"Behavioral Health System"}),e.jsx("span",{className:"sm:hidden",children:"BHS"})]})}),e.jsx("nav",{className:"hidden md:flex space-x-1",role:"navigation","aria-label":"Main navigation",children:y.map(({path:g,label:v,icon:T})=>e.jsxs(ee,{to:g,className:`
                  flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors
                  focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                  ${j(g)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                `,"aria-current":j(g)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:T}),e.jsx("span",{children:v})]},g))}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:t,onKeyDown:d(t),className:`\r
                p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":`Switch to ${r==="light"?"dark":"light"} mode`,type:"button",children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:r==="light"?"ðŸŒ™":"â˜€ï¸"})}),e.jsx("button",{onClick:m,onKeyDown:d(m),className:`\r
                md:hidden p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":x?"Close mobile menu":"Open mobile menu",type:"button",...x?{"aria-expanded":!0}:{"aria-expanded":!1},children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:x?"âœ•":"â˜°"})})]})]}),x&&e.jsx("div",{className:"md:hidden border-t border-gray-200 dark:border-gray-700 pt-4 pb-3",children:e.jsx("nav",{className:"space-y-1",role:"navigation","aria-label":"Mobile navigation",children:y.map(({path:g,label:v,icon:T})=>e.jsxs(ee,{to:g,onClick:b,className:`
                    flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium transition-colors
                    focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                    ${j(g)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                  `,"aria-current":j(g)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:T}),e.jsx("span",{children:v})]},g))})})]})})},Nt=({size:s=20,className:r="",...t})=>e.jsxs("svg",{width:s,height:s,viewBox:"0 0 23 23",className:r,"aria-label":"Microsoft",...t,children:[e.jsx("rect",{x:"1",y:"1",width:"10",height:"10",fill:"#f25022"}),e.jsx("rect",{x:"12",y:"1",width:"10",height:"10",fill:"#7fba00"}),e.jsx("rect",{x:"1",y:"12",width:"10",height:"10",fill:"#00a4ef"}),e.jsx("rect",{x:"12",y:"12",width:"10",height:"10",fill:"#ffb900"})]}),wt=({children:s,className:r=""})=>{const{skipToMain:t}=kt();return e.jsxs("div",{className:"min-h-screen bg-background-light dark:bg-background-dark",children:[e.jsx("a",{href:`#${Ce.SKIP_TO_CONTENT_ID}`,className:"skip-link",onClick:a=>{a.preventDefault(),t()},children:"Skip to main content"}),e.jsx(vt,{}),e.jsx("main",{id:Ce.SKIP_TO_CONTENT_ID,className:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 ${r}`,tabIndex:-1,children:s}),e.jsx("div",{id:Ce.ANNOUNCEMENTS_ID,className:"sr-only","aria-live":"polite","aria-atomic":"true"}),e.jsx("footer",{className:"bg-surface-light dark:bg-surface-dark border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Nt,{size:24,className:"opacity-80"}),e.jsx("span",{className:"text-sm text-text-muted-light dark:text-text-muted-dark font-medium",children:"Powered by Microsoft"})]}),e.jsxs("div",{className:"text-center text-sm text-text-muted-light dark:text-text-muted-dark",children:[e.jsxs("p",{children:["Behavioral Health System Â© ",new Date().getFullYear()]}),e.jsx("p",{className:"mt-1",children:"WCAG 2.2 AA Compliant â€¢ Section 508 Compliant"})]})]})})})]})};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),At=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,t,a)=>a?a.toUpperCase():t.toLowerCase()),ds=s=>{const r=At(s);return r.charAt(0).toUpperCase()+r.slice(1)},Ns=(...s)=>s.filter((r,t,a)=>!!r&&r.trim()!==""&&a.indexOf(r)===t).join(" ").trim(),Ct=s=>{for(const r in s)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _t={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=o.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:t=2,absoluteStrokeWidth:a,className:d="",children:x,iconNode:h,...y},j)=>o.createElement("svg",{ref:j,..._t,width:r,height:r,stroke:s,strokeWidth:a?Number(t)*24/Number(r):t,className:Ns("lucide",d),...!x&&!Ct(y)&&{"aria-hidden":"true"},...y},[...h.map(([m,b])=>o.createElement(m,b)),...Array.isArray(x)?x:[x]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=(s,r)=>{const t=o.forwardRef(({className:a,...d},x)=>o.createElement(Mt,{ref:x,iconNode:r,className:Ns(`lucide-${St(ds(s))}`,`lucide-${s}`,a),...d}));return t.displayName=ds(s),t};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],He=I("activity",Rt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Et=I("arrow-left",It);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],ge=I("brain",$t);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ws=I("calendar",Dt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],cs=I("chart-column",Ft);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Lt=I("chart-pie",Tt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ss=I("chevron-down",Ut);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],As=I("chevron-up",Pt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ce=I("circle-alert",Ot);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],oe=I("circle-check-big",zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Cs=I("circle-x",Bt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],fe=I("clock",Ht);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ve=I("download",Vt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Gt=I("eye-off",qt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Me=I("eye",Kt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]],Jt=I("file-audio",Wt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Zt=I("file-text",Yt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Xt=I("file",Qt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=[["path",{d:"M15 2a2 2 0 0 1 1.414.586l4 4A2 2 0 0 1 21 8v7a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z",key:"1vo8kb"}],["path",{d:"M15 2v4a2 2 0 0 0 2 2h4",key:"sud9ri"}],["path",{d:"M5 7a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 1.732-1",key:"l4dndm"}]],sr=I("files",er);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],_s=I("funnel",tr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Ms=I("heart",rr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ye=I("info",ar);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],nr=I("languages",ir);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],lr=I("lightbulb",or);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],cr=I("loader-circle",dr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],xr=I("mic-off",mr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],Rs=I("mic",hr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Ze=I("pause",ur);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ke=I("play",gr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ms=I("plus",pr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],se=I("refresh-cw",yr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],fr=I("search",br);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],kr=I("send",jr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Is=I("settings",vr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Qe=I("shield-alert",Nr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Sr=I("target",wr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Xe=I("trash-2",Ar);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],_r=I("trending-down",Cr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],es=I("trending-up",Mr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Es=I("triangle-alert",Rr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Er=I("upload",Ir);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],xs=I("user",$r);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],Re=I("volume-2",Dr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],Tr=I("volume-x",Fr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Pe=I("x",Lr);class Ur{constructor(r){V(this,"baseUrl");this.baseUrl=r}async handleResponse(r){if(!r.ok){const t=await r.json().catch(()=>({}));throw le(`HTTP_${r.status}`,t.message||`HTTP ${r.status}: ${r.statusText}`,{status:r.status,statusText:r.statusText,data:t})}return r.json()}async request(r,t={}){try{const a=this.baseUrl.endsWith("/")?this.baseUrl.slice(0,-1):this.baseUrl,d=r.startsWith("/")?r:`/${r}`,x=`${a}${d}`,h={"Content-Type":"application/json",...t.headers},y=await fetch(x,{...t,headers:h});return this.handleResponse(y)}catch(a){throw yt(a)?le("NETWORK_ERROR","Unable to connect to the server. Please check your internet connection.",{originalError:a}):a instanceof Error&&"code"in a?a:le("UNKNOWN_ERROR","An unexpected error occurred",{originalError:a})}}async get(r){return this.request(r,{method:"GET"})}async post(r,t){return this.request(r,{method:"POST",body:t?JSON.stringify(t):void 0})}async put(r,t){return this.request(r,{method:"PUT",body:t?JSON.stringify(t):void 0})}async delete(r){return this.request(r,{method:"DELETE"})}}const ie=new Ur(ve.api.baseUrl),K={async checkHealth(){return ie.get(Ae.HEALTH)},async initiateSession(s){return ie.post(Ae.SESSIONS_INITIATE,s)},async submitPrediction(s){return ie.post(Ae.PREDICTIONS_SUBMIT,s)},async getPredictionBySessionId(s){return ie.get(`${Ae.PREDICTIONS_BY_SESSION}/${s}`)},async getUserPredictions(s){return ie.get(`${Ae.PREDICTIONS_BY_USER}/${s}`)},async saveSessionData(s){return ie.post("sessions",s)},async getSessionData(s){return ie.get(`sessions/${s}`)},async getUserSessions(s){return ie.get(`sessions/users/${s}`)},async updateSessionData(s,r){return ie.put(`sessions/${s}`,r)},async deleteSessionData(s){return ie.delete(`sessions/${s}`)},async testConnection(){try{return await this.checkHealth(),{success:!0,message:"API connection successful"}}catch(s){return{success:!1,message:s.message||"Connection test failed"}}},async submitKintsugiWorkflow(s){return ie.post("/kintsugiworkflow",s)},async generateRiskAssessment(s){return ie.post(`sessions/${s}/risk-assessment`)},async getRiskAssessment(s){return ie.get(`sessions/${s}/risk-assessment`)}};class hs{constructor(r,t={}){V(this,"sessionId");V(this,"intervalMs");V(this,"maxAttempts");V(this,"backoffFactor");V(this,"currentAttempt",0);V(this,"timeoutId",null);V(this,"isPolling",!1);this.sessionId=r,this.intervalMs=t.intervalMs||ve.polling.intervalMs,this.maxAttempts=t.maxAttempts||ve.polling.maxAttempts,this.backoffFactor=t.backoffFactor||ve.polling.backoffFactor}async start(r,t,a){if(this.isPolling)return;this.isPolling=!0,this.currentAttempt=0;const d=async()=>{try{const x=await K.getPredictionBySessionId(this.sessionId);if(r(x),x.status==="succeeded"||x.status==="success"||x.status==="failed"){this.stop(),t(x);return}if(this.currentAttempt++,this.currentAttempt>=this.maxAttempts){this.stop(),a(le("POLLING_TIMEOUT","Prediction polling timed out. Please check the session manually.",{sessionId:this.sessionId,attempts:this.currentAttempt}));return}const h=this.intervalMs*Math.pow(this.backoffFactor,this.currentAttempt);this.timeoutId=window.setTimeout(d,h)}catch(x){this.stop(),a(x)}};await d()}stop(){this.isPolling=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}getStatus(){return{isPolling:this.isPolling,attempt:this.currentAttempt,maxAttempts:this.maxAttempts}}}K.submitKintsugiWorkflow.bind(K);const $s={health:["health"],userPredictions:s=>["predictions","user",s],sessionPrediction:s=>["predictions","session",s],userSessions:s=>["sessions","user",s]},Ds=()=>ps({queryKey:$s.health,queryFn:()=>K.checkHealth(),retry:2,staleTime:3e4,refetchOnWindowFocus:!1}),Pr=s=>{const r=s||Ie();return ps({queryKey:$s.userSessions(r),queryFn:()=>K.getUserSessions(r),enabled:!!r,staleTime:3e4,refetchOnWindowFocus:!1})},Or=()=>{const s=Ie(),{announce:r}=ks(),{data:t,isLoading:a,error:d}=Ds(),{data:x,isLoading:h}=Pr(s);o.useEffect(()=>{r("Dashboard page loaded","polite")},[r]);const y=[{title:"Upload & Analyze",description:"Upload audio files for behavioral health analysis",href:"/upload",icon:"ðŸ“¤",color:"primary"},{title:"View Sessions",description:"Browse all analysis sessions and their results",href:"/sessions",icon:"ðŸ“Š",color:"secondary"},{title:"My Predictions",description:"View your complete prediction history",href:"/predictions",icon:"ðŸ“ˆ",color:"accent"},{title:"System Health",description:"Check API status and system connectivity",href:"/health",icon:"ðŸ¥",color:"warning"}],j=m=>{const b="block p-6 rounded-lg border-2 transition-all hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2";switch(m){case"primary":return`${b} border-primary-200 bg-primary-50 hover:border-primary-300 hover:bg-primary-100 dark:border-primary-800 dark:bg-primary-900 dark:hover:border-primary-700 dark:hover:bg-primary-800 focus:ring-primary-500`;case"secondary":return`${b} border-secondary-200 bg-secondary-50 hover:border-secondary-300 hover:bg-secondary-100 dark:border-secondary-800 dark:bg-secondary-900 dark:hover:border-secondary-700 dark:hover:bg-secondary-800 focus:ring-secondary-500`;case"accent":return`${b} border-accent-200 bg-accent-50 hover:border-accent-300 hover:bg-accent-100 dark:border-accent-800 dark:bg-accent-900 dark:hover:border-accent-700 dark:hover:bg-accent-800 focus:ring-accent-500`;case"warning":return`${b} border-warning-200 bg-warning-50 hover:border-warning-300 hover:bg-warning-100 dark:border-teal-600 dark:bg-teal-800 dark:hover:border-teal-500 dark:hover:bg-teal-700 focus:ring-warning-500`;default:return`${b} border-gray-200 bg-gray-50 hover:border-gray-300 hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700 focus:ring-gray-500`}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-text-primary-light dark:text-text-primary-dark",children:"Behavioral Health System"}),e.jsx("p",{className:"mt-2 text-lg text-text-secondary-light dark:text-text-secondary-dark",children:"Audio-based mental health prediction and analysis"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:"Your User ID"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded-md",children:e.jsx("code",{className:"text-sm font-mono text-text-primary-light dark:text-text-primary-dark break-all",children:s})}),e.jsx("p",{className:"mt-2 text-sm text-text-muted-light dark:text-text-muted-dark",children:"This ID is automatically generated and stored locally to track your sessions."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-6",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:y.map(m=>e.jsx(ee,{to:m.href,className:j(m.color),"aria-label":`${m.title}: ${m.description}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-3",role:"img","aria-hidden":"true",children:m.icon}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:m.title}),e.jsx("p",{className:"text-sm text-text-secondary-light dark:text-text-secondary-dark",children:m.description})]})},m.href))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Recent Activity"}),h?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Loading recent sessions..."})]}):!(x!=null&&x.sessions)||x.sessions.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",role:"img","aria-label":"No data",children:"ðŸ“­"}),e.jsxs("p",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:["No sessions yet.",e.jsx(ee,{to:"/upload",className:"text-primary-600 dark:text-primary-400 hover:underline ml-1",children:"Upload your first audio file"})," to get started."]})]}):e.jsxs("div",{className:"space-y-3",children:[x.sessions.slice(0,3).map(m=>{var b,g;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`status-${m.status||"completed"}`,children:m.status||"completed"}),e.jsx("span",{className:"text-text-primary-light dark:text-text-primary-dark",children:m.audioFileName||((b=m.sessionId)==null?void 0:b.slice(0,8))||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",title:m.createdAt,children:m.createdAt?new Date(m.createdAt).toLocaleString():""})]}),e.jsx(ee,{to:`/sessions/${m.sessionId||""}`,className:"text-primary-600 dark:text-primary-400 hover:underline text-sm flex items-center gap-1",title:"View session details","aria-label":`View details for session ${m.audioFileName||((g=m.sessionId)==null?void 0:g.slice(0,8))||"Unknown"}`,children:e.jsx(Me,{className:"w-4 h-4","aria-hidden":"true"})})]},m.sessionId)}),x.sessions.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs(ee,{to:"/sessions",className:"text-primary-600 dark:text-primary-400 hover:underline",children:["View all ",x.sessions.length," sessions â†’"]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"System Status"}),a?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Checking system health..."})]}):d?e.jsxs("div",{className:"flex items-center space-x-2 text-error-600 dark:text-error-400",children:[e.jsx("span",{role:"img","aria-label":"Error",children:"âš ï¸"}),e.jsx("span",{children:"System health check failed"})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-success-600 dark:text-success-400",children:[e.jsx("span",{role:"img","aria-label":"Healthy",children:"âœ…"}),e.jsx("span",{children:"All systems operational"}),(t==null?void 0:t.checks)&&e.jsxs("span",{className:"text-text-muted-light dark:text-text-muted-dark",children:["(",Object.keys(t.checks).length," services checked)"]})]})]})]})};class zr{constructor(){V(this,"ffmpeg",null);V(this,"isLoaded",!1);V(this,"loadingPromise",null);this.ffmpeg=new rt}async loadFFmpeg(){if(!this.isLoaded)return this.loadingPromise?this.loadingPromise:(this.loadingPromise=this.doLoadFFmpeg(),this.loadingPromise)}async doLoadFFmpeg(){if(!this.ffmpeg)throw le("FFMPEG_INIT_ERROR","Failed to initialize FFmpeg");try{const r="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";await this.ffmpeg.load({coreURL:await as(`${r}/ffmpeg-core.js`,"text/javascript"),wasmURL:await as(`${r}/ffmpeg-core.wasm`,"application/wasm")}),this.isLoaded=!0}catch(r){throw this.loadingPromise=null,le("FFMPEG_LOAD_ERROR","Failed to load FFmpeg. Please check your internet connection and try again.",{originalError:r})}}async convertAudio(r,t={outputFormat:"wav",sampleRate:44100,channels:1},a){try{if(a==null||a({stage:"loading",progress:0,message:"Loading audio processor..."}),await this.loadFFmpeg(),!this.ffmpeg)throw le("FFMPEG_NOT_LOADED","FFmpeg not properly loaded");this.ffmpeg.on("progress",({progress:b})=>{a==null||a({stage:"converting",progress:Math.round(b*100),message:`Converting audio... ${Math.round(b*100)}%`})}),a==null||a({stage:"converting",progress:0,message:"Preparing audio file..."});const d="input."+this.getFileExtension(r.name);await this.ffmpeg.writeFile(d,await at(r));const x=`output.${t.outputFormat}`,h=["-i",d,"-ac",t.channels.toString(),"-ar",t.sampleRate.toString(),"-f",t.outputFormat,x];await this.ffmpeg.exec(h);const y=await this.ffmpeg.readFile(x),j=new Blob([y],{type:`audio/${t.outputFormat}`}),m=new File([j],`${this.getFileNameWithoutExtension(r.name)}.${t.outputFormat}`,{type:`audio/${t.outputFormat}`});return await this.ffmpeg.deleteFile(d),await this.ffmpeg.deleteFile(x),a==null||a({stage:"completed",progress:100,message:"Audio conversion completed"}),m}catch(d){throw le("AUDIO_CONVERSION_ERROR","Failed to convert audio file. Please try with a different file.",{originalError:d,fileName:r.name,fileSize:r.size,fileType:r.type})}}getFileExtension(r){const t=r.lastIndexOf(".");return t!==-1?r.slice(t+1).toLowerCase():""}getFileNameWithoutExtension(r){const t=r.lastIndexOf(".");return t!==-1?r.slice(0,t):r}async isFormatSupported(r){try{await this.loadFFmpeg();const t=["wav","mp3","mp4","m4a","aac","flac","ogg"],a=this.getFileExtension(r.name);return t.includes(a)}catch{return!1}}dispose(){this.ffmpeg&&(this.ffmpeg.terminate(),this.ffmpeg=null),this.isLoaded=!1,this.loadingPromise=null}}let qe=null;const Br=()=>(qe||(qe=new zr),qe),Ge=async(s,r)=>{const a=await Br().convertAudio(s,{outputFormat:"wav",sampleRate:44100,channels:1},r?d=>r(d.progress):void 0);return new Blob([a],{type:"audio/wav"})};class Hr{constructor(r){V(this,"containerClient",null);V(this,"sasUrl");if(this.sasUrl=r||ve.azure.blobSasUrl,!this.sasUrl)throw le("AZURE_CONFIG_ERROR","Azure Blob Storage SAS URL not configured")}getContainerClient(){if(!this.containerClient)try{const r=new it(this.sasUrl);this.containerClient=r.getContainerClient(ve.azure.containerName)}catch(r){throw le("AZURE_CLIENT_ERROR","Failed to initialize Azure Blob Storage client",{originalError:r})}return this.containerClient}async uploadFile(r,t,a){try{a==null||a({progress:0,stage:"preparing",message:"Preparing upload..."});const d=this.getContainerClient(),x=t||this.generateBlobName(r.name),h=d.getBlockBlobClient(x);a==null||a({progress:10,stage:"uploading",message:"Starting upload..."}),await h.uploadData(r,{blobHTTPHeaders:{blobContentType:r.type},onProgress:j=>{const m=j.loadedBytes&&r.size?Math.round(j.loadedBytes/r.size*90)+10:50;a==null||a({progress:m,stage:"uploading",message:`Uploading... ${m}%`})}});const y=h.url;return a==null||a({progress:100,stage:"completed",message:"Upload completed"}),{url:y,fileName:x,size:r.size}}catch(d){throw le("UPLOAD_ERROR","Failed to upload file to Azure Blob Storage",{originalError:d,fileName:r.name,fileSize:r.size})}}generateBlobName(r){const t=new Date().toISOString().replace(/[:.]/g,"-"),a=Math.random().toString(36).substring(2,8),d=r.split(".").pop()||"wav";return`audio/${t}-${a}.${d}`}async testConnection(){try{return await this.getContainerClient().getProperties(),{success:!0,message:"Azure Blob Storage connection successful"}}catch{return{success:!1,message:"Failed to connect to Azure Blob Storage. Please check your SAS URL configuration."}}}async deleteFile(r){try{await this.getContainerClient().getBlockBlobClient(r).deleteIfExists()}catch(t){throw le("DELETE_ERROR","Failed to delete file from Azure Blob Storage",{originalError:t,fileName:r})}}}let Oe=null;const Vr=s=>((!Oe||s&&s!==Oe.sasUrl)&&(Oe=new Hr(s)),Oe),Ke=async(s,r,t)=>{const a=Vr(),d=s instanceof File?s:new File([s],r,{type:s.type});return(await a.uploadFile(d,r,t?h=>t(h.progress):void 0)).url},Ee=()=>{const s=o.useRef(null),r=o.useCallback(y=>{if(!s.current){const j=document.createElement("div");j.setAttribute("aria-live","polite"),j.setAttribute("aria-atomic","true"),j.style.position="absolute",j.style.left="-10000px",j.style.width="1px",j.style.height="1px",j.style.overflow="hidden",document.body.appendChild(j),s.current=j}s.current.textContent="",setTimeout(()=>{s.current&&(s.current.textContent=y)},100)},[]),t={focusById:y=>{const j=document.getElementById(y);j&&j.focus()},focusFirstInContainer:y=>{const m=y.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];m&&m.focus()},trapFocus:y=>{const j=y.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),m=j[0],b=j[j.length-1],g=v=>{v.key==="Tab"&&(v.shiftKey?document.activeElement===m&&(b.focus(),v.preventDefault()):document.activeElement===b&&(m.focus(),v.preventDefault()))};return y.addEventListener("keydown",g),()=>{y.removeEventListener("keydown",g)}}},a={handleArrowNavigation:(y,j,m,b)=>{var v;let g=m;switch(y.key){case"ArrowDown":y.preventDefault(),g=m<j.length-1?m+1:0;break;case"ArrowUp":y.preventDefault(),g=m>0?m-1:j.length-1;break;case"Home":y.preventDefault(),g=0;break;case"End":y.preventDefault(),g=j.length-1;break;default:return}b(g),(v=j[g])==null||v.focus()},handleEscape:(y,j)=>{y.key==="Escape"&&(y.preventDefault(),j())}},d=o.useCallback((y="element")=>`${y}-${Math.random().toString(36).substr(2,9)}`,[]),x=o.useCallback(()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),h=o.useCallback((y,j,m)=>{const b={};return y||(b["aria-invalid"]="true",j&&m&&(b["aria-describedby"]=m)),b},[]);return{announceToScreenReader:r,focusManagement:t,keyboardNavigation:a,generateId:d,prefersReducedMotion:x,getValidationAttributes:h}},qr=()=>{const[s,r]=o.useState([]),[t,a]=o.useState(()=>gt()),[d,x]=o.useState({}),[h,y]=o.useState({}),[j,m]=o.useState({}),[b,g]=o.useState(!1),[v,T]=o.useState(null),[M,C]=o.useState({stage:"idle",progress:0,message:""}),[N,E]=o.useState(null),[W,G]=o.useState(!1),[$,c]=o.useState(0),[S,l]=o.useState(null),[n,k]=o.useState({age:"",gender:"",race:"",ethnicity:"",language:"",weight:"",zipcode:"",sessionNotes:""}),[f,p]=o.useState(null),[_,B]=o.useState([]),[q,me]=o.useState(()=>xt()),[J,X]=o.useState(""),[te,re]=o.useState(null),A=Ie(),L=o.useRef(null),Y=o.useRef(null),{announceToScreenReader:U}=Ee(),O=o.useCallback((i,u,w)=>{const R=Date.now().toString()+Math.random().toString(36).substr(2,9),D={id:R,type:i,title:u,message:w,timestamp:Date.now()};B(Z=>[...Z,D]),setTimeout(()=>{B(Z=>Z.filter(ne=>ne.id!==R))},i==="error"?8e3:5e3)},[]),$e=o.useCallback(i=>{B(u=>u.filter(w=>w.id!==i))},[]),ye=o.useCallback(()=>{r([]),T(null),C({stage:"idle",progress:0,message:""}),E(null),y({}),x({}),p(null),G(!1),c(0),l(null),g(!1)},[]),we=o.useCallback(()=>{me(i=>{const u=!i;if(ht(u),re(null),u)X(A),U("Switched to custom User ID mode");else{X("");const w=os();U(`Switched to auto-generated mode. New User ID: ${w}`)}return u})},[A,U]),Fs=o.useCallback(i=>{X(i),re(null)},[]),Ts=o.useCallback(()=>{const i=J.trim();if(!i){re("User ID cannot be empty");return}if(i.length<3){re("User ID must be at least 3 characters long");return}if(i.length>100){re("User ID must be less than 100 characters");return}if(/[<>"/\\|?*\x00-\x1f]/.test(i)){re('User ID contains invalid characters. Please avoid special characters like < > " / \\ | ? *');return}try{mt(i),re(null),U(`Custom User ID applied: ${i}`),window.location.reload()}catch(w){const R=w instanceof Error?w.message:"Failed to set User ID";re(R)}},[J,U]),Ls=o.useCallback(()=>{const i=os();U(`New User ID generated: ${i}`),window.location.reload()},[U]),Us=()=>Date.now().toString()+Math.random().toString(36).substr(2,9),ss=o.useCallback(i=>{const u=Us(),w=URL.createObjectURL(i),R={id:u,file:i,url:w};t?(r(F=>[...F,R]),m(F=>({...F,[u]:"ready"})),x(F=>({...F,[u]:{stage:"idle",progress:0,message:"Ready to process"}}))):T(R),U(`Audio file selected: ${i.name}`);const D=new Audio(w);D.addEventListener("loadedmetadata",()=>{t?r(F=>F.map(Z=>Z.id===u?{...Z,duration:D.duration}:Z)):T(F=>F?{...F,duration:D.duration}:null)})},[t,U]),Ps=o.useCallback(i=>{t&&(r(u=>{const w=u.find(R=>R.id===i);return w&&URL.revokeObjectURL(w.url),u.filter(R=>R.id!==i)}),x(u=>{const{[i]:w,...R}=u;return R}),y(u=>{const{[i]:w,...R}=u;return R}),m(u=>{const{[i]:w,...R}=u;return R}))},[t]),De=o.useCallback(i=>{const u=i.target.files;!u||u.length===0||Array.from(u).forEach(w=>{const R=["audio/wav","audio/wave","audio/x-wav","audio/mp3","audio/mpeg","audio/mp4","audio/m4a","audio/x-m4a","audio/mp4a-latm","audio/aac","audio/x-aac","audio/flac","audio/x-flac"],D=w.name.toLowerCase(),Z=[".wav",".mp3",".m4a",".aac",".flac"].some(be=>D.endsWith(be));if(!R.includes(w.type)&&!Z){p(`Unsupported file type for ${w.name}. Please select supported audio files (WAV, MP3, M4A, AAC, or FLAC)`),O("error","Unsupported File",`${w.name} is not a supported audio file format`),U(`Error: Unsupported file format selected for ${w.name}`);return}const xe=50*1024*1024;if(w.size>xe){p(`File ${w.name} is too large. File size must be less than 50MB`),O("error","File Too Large",`${w.name} size must be less than 50MB`),U(`Error: File ${w.name} is too large`);return}ss(w),p(null)})},[U,ss,O]),Os=o.useCallback(i=>{i.preventDefault()},[]),zs=o.useCallback(i=>{i.preventDefault();const u=i.dataTransfer.files;u.length>0&&De({target:{files:u}})},[De]),Bs=o.useCallback(()=>{a(i=>{const u=!i;return pt(u),ye(),u})},[ye]),Hs=o.useCallback(()=>{L.current&&(W?(L.current.pause(),G(!1),U("Audio paused")):(L.current.play(),G(!0),U("Audio playing")))},[W,U]),Vs=o.useCallback(()=>{L.current&&c(L.current.currentTime)},[]),Fe=o.useCallback(i=>{const u=Math.floor(i/60),w=Math.floor(i%60);return`${u}:${w.toString().padStart(2,"0")}`},[]),je=o.useCallback(()=>{const i=[];if(n.age){const u=parseInt(n.age);(isNaN(u)||u<18||u>130)&&i.push("Age must be between 18 and 130")}if(n.gender&&(["male","female","non-binary","transgender female","transgender male","other","prefer"].includes(n.gender)||i.push("Invalid gender. Must be: male, female, non-binary, transgender female, transgender male, other, or prefer")),n.race&&(["white","black or african-american","asian","american indian or alaskan native","native Hawaiian or pacific islander","two or more races","other","prefer not to say"].includes(n.race)||i.push("Invalid race. Must be: white, black or african-american, asian, american indian or alaskan native, native Hawaiian or pacific islander, two or more races, other, prefer not to say")),n.ethnicity&&(["Hispanic, Latino, or Spanish Origin","Not Hispanic, Latino, or Spanish Origin"].includes(n.ethnicity)||i.push("Invalid ethnicity. Must be: Hispanic, Latino, or Spanish Origin | Not Hispanic, Latino, or Spanish Origin")),n.zipcode&&(/^[a-zA-Z0-9]{1,10}$/.test(n.zipcode)||i.push("Zipcode must be alphanumeric and contain no more than 10 characters")),n.weight){const u=parseInt(n.weight);(isNaN(u)||u<10||u>1e3)&&i.push("Weight must be between 10 and 1000 pounds (lbs)")}return i},[n]),Te=o.useCallback(()=>{const i={};let u=!1;return n.age&&(i.age=parseInt(n.age),u=!0),n.gender&&(i.gender=n.gender,u=!0),n.race&&(i.race=n.race,u=!0),n.ethnicity&&(i.ethnicity=n.ethnicity,u=!0),(n.language==="true"||n.language==="false")&&(i.language=n.language==="true",u=!0),n.weight&&(i.weight=parseInt(n.weight),u=!0),n.zipcode&&(i.zipcode=n.zipcode,u=!0),u?i:void 0},[n]),qs=o.useCallback(async()=>{if(t){if(s.length===0||!A.trim()){p("Please select audio files. User ID is automatically generated."),O("error","Missing Information","Please select audio files. User ID is automatically generated.");return}await ts()}else{if(!v||!A.trim()){p("Please select an audio file. User ID is automatically generated."),O("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}await Ks()}},[v,s,A,t]),Le=o.useCallback(async(i,u)=>{try{x(H=>({...H,[i]:{stage:"initiating",progress:5,message:"Initiating session..."}}));const w=Te(),R={userid:A.trim(),is_initiated:!0};w&&(R.metadata=w);const D=await K.initiateSession(R),F={sessionId:D.sessionId,userId:A.trim()};x(H=>({...H,[i]:{stage:"initiating",progress:10,message:"Saving session data..."}}));const Z={sessionId:D.sessionId,userId:A.trim(),userMetadata:w,audioFileName:u.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await K.saveSessionData(Z)}catch{}x(H=>({...H,[i]:{stage:"converting",progress:15,message:"Converting audio to required format..."}}));const ne=await Ge(u.file,H=>{x(P=>({...P,[i]:{stage:"converting",progress:15+H*.25,message:`Converting audio... ${Math.round(H)}%`}}))});x(H=>({...H,[i]:{stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}}));const xe=`${A}_${F.sessionId}_${Date.now()}.wav`,be=await Ke(ne,xe,H=>{x(P=>({...P,[i]:{stage:"uploading",progress:40+H*.25,message:`Uploading... ${Math.round(H)}%`}}))});x(H=>({...H,[i]:{stage:"submitting",progress:65,message:"Submitting for analysis..."}}));try{const H={...Z,audioUrl:be,audioFileName:xe,status:"processing",updatedAt:new Date().toISOString()};await K.updateSessionData(F.sessionId,H)}catch(H){console.warn("Failed to update session data with audio info:",H)}await K.submitPrediction({userId:A.trim(),sessionid:F.sessionId,audioFileUrl:be,audioFileName:xe}),x(H=>({...H,[i]:{stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}}));const ae=new hs(F.sessionId);await new Promise((H,P)=>{ae.start(z=>{const Se=z.status==="processing"?80:z.status==="success"?95:70;x(he=>({...he,[i]:{stage:"analyzing",progress:Se,message:`Analysis ${z.status}...`}})),z.predictError&&O("error","Prediction Error",`${z.predictError.error}: ${z.predictError.message}`)},z=>{if(z.predictError){O("error","Analysis Failed",`The analysis completed with an error: ${z.predictError.error} - ${z.predictError.message}`),x(he=>({...he,[i]:{stage:"error",progress:0,message:"Analysis failed with errors"}})),P(new Error(`Prediction error: ${z.predictError.error}`));return}const Se={sessionId:F.sessionId,depressionScore:z.predictedScoreDepression?parseFloat(z.predictedScoreDepression):0,riskLevel:z.predictedScoreDepression&&parseFloat(z.predictedScoreDepression)>.7?"high":z.predictedScoreDepression&&parseFloat(z.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",z.predictedScoreDepression?`Depression score: ${z.predictedScoreDepression}`:"",z.predictedScoreAnxiety?`Anxiety score: ${z.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(he=>he.trim()!==""),timestamp:z.updatedAt,audioUrl:be,rawApiResponse:z};x(he=>({...he,[i]:{stage:"complete",progress:100,message:"Analysis complete!"}})),y(he=>({...he,[i]:Se})),H()},z=>{P(z)})})}catch(w){throw x(R=>({...R,[i]:{stage:"error",progress:0,message:"Processing failed"}})),w}},[A,Te,K,Ke,Ge,O]),ts=o.useCallback(async()=>{g(!0),p(null);const i=je();if(i.length>0){p(`Validation error: ${i.join(", ")}`),O("error","Validation Error",i.join(", ")),g(!1);return}const u=s.filter(D=>j[D.id]==="ready");if(u.length===0){O("info","No Files Ready","No files are ready to process"),g(!1);return}const w=u.length;let R=0;try{for(const D of u){R++,O("info","Processing File",`Processing ${D.file.name} (${R}/${w})`),m(F=>({...F,[D.id]:"processing"}));try{await Le(D.id,D),m(F=>({...F,[D.id]:"complete"})),O("success","File Complete",`${D.file.name} processed successfully`)}catch(F){const Z=F instanceof Error?F.message:"An unexpected error occurred";O("error","File Failed",`Failed to process ${D.file.name}: ${Z}`),m(ne=>({...ne,[D.id]:"error"})),x(ne=>({...ne,[D.id]:{stage:"error",progress:0,message:`Failed: ${Z}`}}))}}O("success","Batch Complete",`Processed ${R} file${R!==1?"s":""}`),U(`Batch processing complete. ${R} files processed.`)}catch(D){const F=D instanceof Error?D.message:"An unexpected error occurred";p(F),O("error","Batch Failed",F),U(`Error: ${F}`)}finally{g(!1)}},[s,j,je,O,U,Le]),Gs=o.useCallback(async i=>{const u=s.find(R=>R.id===i);if(!u)return;const w=je();if(w.length>0){p(`Validation error: ${w.join(", ")}`),O("error","Validation Error",w.join(", "));return}m(R=>({...R,[i]:"processing"}));try{await Le(i,u),m(R=>({...R,[i]:"complete"})),O("success","File Complete",`${u.file.name} processed successfully`)}catch(R){console.error(`Error processing ${u.file.name}:`,R);const D=R instanceof Error?R.message:"An unexpected error occurred";O("error","File Failed",`Failed to process ${u.file.name}: ${D}`),m(F=>({...F,[i]:"error"})),x(F=>({...F,[i]:{stage:"error",progress:0,message:`Failed: ${D}`}}))}},[s,je,O,Le]),Ks=o.useCallback(async()=>{if(!v||!A.trim()){p("Please select an audio file. User ID is automatically generated."),O("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}const i=je();if(i.length>0){p(`Validation error: ${i.join(", ")}`),O("error","Validation Error",i.join(", "));return}try{p(null),C({stage:"initiating",progress:5,message:"Initiating session..."}),U("Starting analysis process - initiating session");const u=Te(),w={userid:A.trim(),is_initiated:!0};u&&(w.metadata=u);const R=await K.initiateSession(w),D={sessionId:R.sessionId,userId:A.trim()};C({stage:"initiating",progress:10,message:"Saving session data..."});const F={sessionId:R.sessionId,userId:A.trim(),userMetadata:u,audioFileName:v.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await K.saveSessionData(F)}catch{}C({stage:"converting",progress:15,message:"Converting audio to required format..."}),U("Session created successfully, now converting audio");const Z=await Ge(v.file,ae=>{C({stage:"converting",progress:15+ae*.25,message:`Converting audio... ${Math.round(ae)}%`})});C({stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}),U("Audio converted successfully, now uploading");const ne=`${A}_${D.sessionId}_${Date.now()}.wav`,xe=await Ke(Z,ne,ae=>{C({stage:"uploading",progress:40+ae*.25,message:`Uploading... ${Math.round(ae)}%`})});C({stage:"submitting",progress:65,message:"Submitting for analysis..."}),U("Upload complete, submitting for behavioral health analysis");try{const ae={...F,audioUrl:xe,audioFileName:ne,status:"processing",updatedAt:new Date().toISOString()};await K.updateSessionData(D.sessionId,ae)}catch(ae){console.warn("Failed to update session data with audio info:",ae)}await K.submitPrediction({userId:A.trim(),sessionid:D.sessionId,audioFileUrl:xe,audioFileName:ne}),C({stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}),U("Prediction submitted, analysis in progress");const be=new hs(D.sessionId);await new Promise((ae,H)=>{be.start(P=>{const z=P.status==="processing"?80:P.status==="success"?95:70;C({stage:"analyzing",progress:z,message:`Analysis ${P.status}...`}),P.predictError&&O("error","Prediction Error",`${P.predictError.error}: ${P.predictError.message}`)},P=>{if(P.predictError){O("error","Analysis Failed",`The analysis completed with an error: ${P.predictError.error} - ${P.predictError.message}`),C({stage:"error",progress:0,message:"Analysis failed with errors"}),H(new Error(`Prediction error: ${P.predictError.error}`));return}const z={sessionId:D.sessionId,depressionScore:P.predictedScoreDepression?parseFloat(P.predictedScoreDepression):0,riskLevel:P.predictedScoreDepression&&parseFloat(P.predictedScoreDepression)>.7?"high":P.predictedScoreDepression&&parseFloat(P.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",P.predictedScoreDepression?`Depression score: ${P.predictedScoreDepression}`:"",P.predictedScoreAnxiety?`Anxiety score: ${P.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(Se=>Se.trim()!==""),timestamp:P.updatedAt,audioUrl:xe,rawApiResponse:P};C({stage:"complete",progress:100,message:"Analysis complete!"}),E(z),O("success","Analysis Complete","Your behavioral health analysis has been completed successfully."),U("Behavioral health analysis completed successfully"),ae()},P=>{O("error","Analysis Error",P.message||"An unexpected error occurred during analysis."),H(P)})})}catch(u){console.error("Processing error:",u);const w=u instanceof Error?u.message:"An unexpected error occurred";p(w),C({stage:"error",progress:0,message:"Processing failed"}),O("error","Processing Failed",w),U(`Error: ${w}`)}},[v,A,U,je,Te]),rs=o.useCallback(i=>{switch(i){case"error":return"bg-red-500";case"complete":return"bg-green-500";default:return"bg-blue-500"}},[]);return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Processing Mode:"}),e.jsxs("div",{className:"relative inline-flex items-center",children:[e.jsx("button",{type:"button",onClick:Bs,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 ${t?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500"}`,"aria-label":`Switch to ${t?"single file":"multi-file"} mode`,children:e.jsx("span",{className:`inline-flex h-6 w-6 transform rounded-full bg-white items-center justify-center transition-transform ${t?"translate-x-9":"translate-x-1"}`,children:t?e.jsx(sr,{className:"h-3 w-3 text-blue-600"}):e.jsx(Xt,{className:"h-3 w-3 text-gray-600"})})}),e.jsxs("div",{className:"ml-3 flex items-center space-x-4",children:[e.jsx("span",{className:`text-sm font-medium ${t?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:"Single"}),e.jsx("span",{className:`text-sm font-medium ${t?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"}`,children:"Multi"})]})]})]}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${t?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:t?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),"Batch Processing"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v8H4V6z",clipRule:"evenodd"})}),"Single File"]})})]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Upload & Analyze Audio"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Upload ",t?"multiple audio files":"an audio file"," for behavioral health analysis using AI-powered speech pattern recognition"]}),e.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-lg text-sm ${t?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:t?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M9 12a1 1 0 000 2h2a1 1 0 100-2H9z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 0v12h8V4H6z",clipRule:"evenodd"})]}),"Process multiple files with individual controls and batch options"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Upload and analyze one file at a time with detailed progress tracking"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Patient Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 lg:col-span-3 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"User ID Management"}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 p-4 rounded-md border space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current User ID:"}),e.jsx("code",{className:"text-sm font-mono text-gray-900 dark:text-gray-100 break-all block bg-white dark:bg-gray-800 p-2 rounded border",children:A})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:we,className:"px-3 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors","aria-describedby":"user-id-mode-help",children:q?"Switch to Auto-Generated":"Use Custom User ID"}),!q&&e.jsx("button",{type:"button",onClick:Ls,className:"px-3 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800 transition-colors",title:"Generate a new random User ID",children:"Generate New ID"})]}),q&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:J,onChange:i=>Fs(i.target.value),placeholder:"Enter custom User ID (any unique string)",className:"flex-1 px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-describedby":"custom-user-id-help","aria-invalid":te?"true":"false"}),e.jsx("button",{type:"button",onClick:Ts,disabled:!J.trim(),className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Apply"})]}),te&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",role:"alert",children:te}),e.jsx("p",{id:"custom-user-id-help",className:"text-xs text-gray-500 dark:text-gray-400",children:'Any unique string (3-100 characters). Examples: "patient-001", "john.doe@clinic", "study-participant-42"'})]}),e.jsx("p",{id:"user-id-mode-help",className:"text-xs text-gray-500 dark:text-gray-400",children:q?"Custom mode: Use any unique identifier for tracking (e.g., patient ID, username, study code)":"Auto mode: System generates unique UUIDs automatically"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age (Optional)"}),e.jsx("input",{type:"number",id:"age",value:n.age,onChange:i=>k(u=>({...u,age:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Age in years",min:"1",max:"150"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight (Optional)"}),e.jsx("input",{type:"number",id:"weight",value:n.weight,onChange:i=>k(u=>({...u,weight:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Weight in lbs",min:"1",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender (Optional)"}),e.jsxs("select",{id:"gender",value:n.gender,onChange:i=>k(u=>({...u,gender:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"non-binary",children:"Non-binary"}),e.jsx("option",{value:"transgender female",children:"Transgender female"}),e.jsx("option",{value:"transgender male",children:"Transgender male"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer",children:"Prefer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"race",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race (Optional)"}),e.jsxs("select",{id:"race",value:n.race,onChange:i=>k(u=>({...u,race:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select race"}),e.jsx("option",{value:"white",children:"White"}),e.jsx("option",{value:"black or african-american",children:"Black or African-American"}),e.jsx("option",{value:"asian",children:"Asian"}),e.jsx("option",{value:"american indian or alaskan native",children:"American Indian or Alaskan Native"}),e.jsx("option",{value:"native Hawaiian or pacific islander",children:"Native Hawaiian or Pacific Islander"}),e.jsx("option",{value:"two or more races",children:"Two or more races"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer not to say",children:"Prefer not to say"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ethnicity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity (Optional)"}),e.jsxs("select",{id:"ethnicity",value:n.ethnicity,onChange:i=>k(u=>({...u,ethnicity:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select ethnicity"}),e.jsx("option",{value:"Hispanic, Latino, or Spanish Origin",children:"Hispanic, Latino, or Spanish Origin"}),e.jsx("option",{value:"Not Hispanic, Latino, or Spanish Origin",children:"Not Hispanic, Latino, or Spanish Origin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language (Optional)"}),e.jsxs("select",{id:"language",value:n.language,onChange:i=>k(u=>({...u,language:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select language"}),e.jsx("option",{value:"true",children:"English"}),e.jsx("option",{value:"false",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"zipcode",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code (Optional)"}),e.jsx("input",{type:"text",id:"zipcode",value:n.zipcode,onChange:i=>k(u=>({...u,zipcode:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter ZIP code",pattern:"[0-9]{5}(-[0-9]{4})?",title:"Enter a valid ZIP code (e.g., 12345 or 12345-6789)"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{htmlFor:"sessionNotes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes (Optional)"}),e.jsx("textarea",{id:"sessionNotes",value:n.sessionNotes,onChange:i=>k(u=>({...u,sessionNotes:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",rows:3,placeholder:"Additional notes about this session or patient context"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Audio File Upload ",t&&e.jsx("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:"(Multi-File Mode)"})]}),!t&&!v||t&&s.length===0?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors",onDragOver:Os,onDrop:zs,children:[e.jsx(Er,{className:"mx-auto h-12 w-12 text-gray-400 mb-4","aria-hidden":"true"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{type:"button",onClick:()=>{var i;return(i=Y.current)==null?void 0:i.click()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Select Audio File",t?"s":""]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["or drag and drop ",t?"files":"file"," here"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Supported formats: WAV, MP3, M4A, AAC, FLAC (max 50MB each)",t&&e.jsx("br",{}),t&&"You can select multiple files at once"]}),e.jsx("input",{ref:Y,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:De,multiple:t,"aria-label":`Select audio file${t?"s":""} for analysis`})]}):e.jsxs("div",{className:"space-y-4",children:[!t&&v&&e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Re,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:v.file.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(v.file.size/1024/1024).toFixed(2)," MB",v.duration&&` â€¢ ${Fe(v.duration)}`]})]})]}),e.jsx("button",{type:"button",onClick:ye,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Remove selected file",children:e.jsx(Pe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:Hs,className:"flex items-center justify-center w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800","aria-label":W?"Pause audio":"Play audio",children:W?e.jsx(Ze,{className:"h-5 w-5","aria-hidden":"true"}):e.jsx(ke,{className:"h-5 w-5 ml-0.5","aria-hidden":"true"})}),e.jsx("div",{className:"flex-1",children:v.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[Fe($)," / ",Fe(v.duration)]})})]}),v.duration&&e.jsx("div",{className:"audio-progress",children:e.jsx("div",{className:"audio-progress__fill progress-dynamic progress-animated",style:{"--progress-width":`${$/v.duration*100}%`},role:"progressbar","aria-label":"Audio playback progress","aria-valuenow":$,"aria-valuemin":0,"aria-valuemax":v.duration})})]}),e.jsx("audio",{ref:L,src:v.url,onTimeUpdate:Vs,onEnded:()=>G(!1),onPlay:()=>G(!0),onPause:()=>G(!1),className:"hidden"})]}),t&&s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Selected Files (",s.length,")"]}),e.jsxs("button",{type:"button",onClick:()=>{var i;return(i=Y.current)==null?void 0:i.click()},className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Add More Files"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(i=>{const u=j[i.id]||"ready",w=d[i.id];return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[e.jsx(Re,{className:"h-4 w-4 text-blue-500 flex-shrink-0","aria-hidden":"true"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:i.file.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(i.file.size/1024/1024).toFixed(2)," MB",i.duration&&` â€¢ ${Fe(i.duration)}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[u==="ready"&&e.jsxs("button",{type:"button",onClick:()=>Gs(i.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-offset-gray-800","aria-label":`Start processing ${i.file.name}`,children:[e.jsx(ke,{className:"h-3 w-3 mr-1"}),"Start"]}),u==="processing"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"Processing..."}),u==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Complete"]}),u==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Pe,{className:"h-3 w-3 mr-1"}),"Error"]}),e.jsx("button",{type:"button",onClick:()=>Ps(i.id),className:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400","aria-label":`Remove ${i.file.name}`,children:e.jsx(Xe,{className:"h-4 w-4"})})]})]}),w&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:w.message}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[Math.round(w.progress),"%"]})]}),e.jsx("div",{className:"processing-progress mt-1",children:e.jsx("div",{className:`processing-progress__fill progress-dynamic progress-animated ${rs(w.stage)}`,style:{"--progress-width":`${w.progress}%`}})})]})]},i.id)})}),e.jsx("input",{ref:Y,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:De,multiple:t,"aria-label":"Select additional audio files for analysis"})]})]})]}),f&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",role:"alert",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 text-red-500 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-red-700 dark:text-red-300",children:f})]})}),!t&&M.stage!=="idle"&&!N&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Processing Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:M.message}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[Math.round(M.progress),"%"]})]}),e.jsx("div",{className:"processing-progress",children:e.jsx("div",{className:`processing-progress__fill progress-dynamic progress-animated ${rs(M.stage)}`,style:{"--progress-width":`${M.progress}%`},role:"progressbar","aria-label":"Processing progress","aria-valuenow":M.progress,"aria-valuemin":0,"aria-valuemax":100})}),M.stage==="analyzing"&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(cr,{className:"h-4 w-4 animate-spin mr-2","aria-hidden":"true"}),"This may take a few minutes..."]})]})]}),N&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(oe,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Analysis Results"})]}),N.rawApiResponse&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"API Response Details"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Predicted Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.predicted_score_anxiety||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`font-mono ${N.rawApiResponse.status==="success"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:N.rawApiResponse.status||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Model Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Category:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.model_category||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Granularity:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.model_granularity||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Calibrated:"}),e.jsx("span",{className:`font-mono ${N.rawApiResponse.is_calibrated?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"}`,children:N.rawApiResponse.is_calibrated?"Yes":"No"})]})]})]}),N.rawApiResponse.actual_score&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Clinical Assessment Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[N.rawApiResponse.actual_score.depression_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.actual_score.depression_binary||"N/A"})]}),N.rawApiResponse.actual_score.anxiety_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.actual_score.anxiety_binary||"N/A"})]}),N.rawApiResponse.actual_score.phq_9&&N.rawApiResponse.actual_score.phq_9.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-9:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",N.rawApiResponse.actual_score.phq_9.join(", "),"]"]})]}),N.rawApiResponse.actual_score.phq_2&&N.rawApiResponse.actual_score.phq_2.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-2:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",N.rawApiResponse.actual_score.phq_2.join(", "),"]"]})]}),N.rawApiResponse.actual_score.gad_7&&N.rawApiResponse.actual_score.gad_7.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"GAD-7:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",N.rawApiResponse.actual_score.gad_7.join(", "),"]"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Created:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:N.rawApiResponse.created_at?new Date(N.rawApiResponse.created_at).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Updated:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:N.rawApiResponse.updated_at?new Date(N.rawApiResponse.updated_at).toLocaleString():"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Session Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:N.sessionId})]})})]}),N.rawApiResponse.predict_error&&e.jsxs("div",{className:"border-l-4 border-red-400 bg-red-50 dark:bg-red-900/20 p-3",children:[e.jsx("h5",{className:"text-sm font-medium text-red-700 dark:text-red-300 mb-1",children:"Prediction Error"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Error Type:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100",children:N.rawApiResponse.predict_error.error})]}),e.jsxs("div",{className:"text-red-700 dark:text-red-300",children:[e.jsx("span",{className:"font-medium",children:"Message:"})," ",N.rawApiResponse.predict_error.message]})]})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(N.rawApiResponse,null,2)})})]})]})})]}),N.insights&&N.insights.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Clinical Insights"}),e.jsx("ul",{className:"space-y-1",children:N.insights.map((i,u)=>e.jsxs("li",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["â€¢ ",i]},u))})]}),e.jsx("div",{className:"mt-6 flex space-x-3",children:e.jsx("button",{type:"button",onClick:ye,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:"Analyze Another File"})})]}),(t&&s.length>0||!t&&v)&&!N&&Object.keys(h).length===0&&M.stage==="idle"&&!b&&e.jsx("div",{className:"text-center",children:t?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:e.jsxs("button",{type:"button",onClick:ts,disabled:s.length===0||!A.trim()||!s.some(i=>j[i.id]==="ready"),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(ke,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start All Ready Files",s.filter(i=>j[i.id]==="ready").length>0&&` (${s.filter(i=>j[i.id]==="ready").length})`]})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'Use individual "Start" buttons on each file for selective processing, or "Start All" to process all ready files sequentially'})]}):e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:qs,disabled:!v||!A.trim(),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(ke,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start Analysis"]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"This will convert, upload, and analyze your audio file"})]})}),t&&Object.keys(h).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(oe,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Batch Analysis Results (",Object.keys(h).length," files)"]})]}),e.jsx("div",{className:"space-y-6",children:Object.entries(h).map(([i,u])=>{const w=s.find(D=>D.id===i),R=d[i];return e.jsxs("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:(w==null?void 0:w.file.name)||`File ${i}`}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(R==null?void 0:R.stage)==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Complete"]}),(R==null?void 0:R.stage)==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Pe,{className:"h-3 w-3 mr-1"}),"Error"]})]})]}),u.rawApiResponse&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3 border",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:u.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:u.rawApiResponse.predicted_score_anxiety||"N/A"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:u.sessionId})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:u.rawApiResponse.status||"N/A"})]})]})}),e.jsxs("details",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto max-h-64",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(u.rawApiResponse,null,2)})})]})]}),w&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{const D=document.getElementById(`audio-${i}`);D.paused?(document.querySelectorAll("audio").forEach(F=>F.pause()),l(i),D.play()):(D.pause(),l(null))},className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900","aria-label":S===i?"Pause audio":"Play audio",children:S===i?e.jsx(Ze,{className:"h-4 w-4"}):e.jsx(ke,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[w.file.name," â€¢ ",w.duration?`${Math.round(w.duration)}s`:"Duration unknown"]})]}),e.jsx("audio",{id:`audio-${i}`,src:w.url,onEnded:()=>l(null),className:"hidden"})]})]},i)})})]}),_.length>0&&e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:_.map(i=>e.jsx("div",{className:`max-w-sm w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg border-l-4 p-4 transition-all duration-300 transform ${i.type==="error"?"border-red-500":i.type==="warning"?"border-yellow-500":i.type==="success"?"border-green-500":"border-blue-500"}`,role:"alert",children:e.jsxs("div",{className:"flex items-start",children:[e.jsxs("div",{className:"flex-shrink-0",children:[i.type==="error"&&e.jsx(ce,{className:"h-5 w-5 text-red-500","aria-hidden":"true"}),i.type==="warning"&&e.jsx(ce,{className:"h-5 w-5 text-yellow-500","aria-hidden":"true"}),i.type==="success"&&e.jsx(oe,{className:"h-5 w-5 text-green-500","aria-hidden":"true"}),i.type==="info"&&e.jsx(ce,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"})]}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:i.message})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{type:"button",onClick:()=>$e(i.id),className:"inline-flex text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close notification",children:e.jsx(Pe,{className:"h-4 w-4"})})})]})},i.id))})]})},We={queued:{color:"yellow",icon:fe,label:"Queued"},running:{color:"blue",icon:se,label:"Processing"},processing:{color:"blue",icon:se,label:"Processing"},succeeded:{color:"green",icon:oe,label:"Completed"},success:{color:"green",icon:oe,label:"Completed"},failed:{color:"red",icon:Cs,label:"Failed"}},ze=s=>s?s.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()):"â€”",Be=s=>{if(!s)return 0;switch(s.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},Gr=()=>{const[s,r]=o.useState([]),[t,a]=o.useState(!0),[d,x]=o.useState(null),[h,y]=o.useState(new Set),[j,m]=o.useState(!1),[b,g]=o.useState({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),{announceToScreenReader:v}=Ee(),T=o.useCallback(async()=>{try{a(!0),x(null);const c=Ie(),l=(await K.getUserSessions(c)).sessions.map(n=>{var f;const k=n.prediction;return{...n,uploadedAt:n.createdAt,fileName:n.audioFileName||`Audio_${n.sessionId.slice(-8)}.wav`,fileSize:Math.floor(Math.random()*5e6)+1e6,riskLevel:((f=n.analysisResults)==null?void 0:f.riskLevel)||"unknown",depressionScore:(k==null?void 0:k.predicted_score_depression)||(k==null?void 0:k.predictedScoreDepression)||void 0,anxietyScore:(k==null?void 0:k.predicted_score_anxiety)||(k==null?void 0:k.predictedScoreAnxiety)||void 0}});r(l),v(`${l.length} sessions loaded successfully`)}catch(c){const S=c;x(S),v(`Error loading sessions: ${S.message}`)}finally{a(!1)}},[v]);o.useEffect(()=>{T()},[T]);const M=o.useMemo(()=>{let c=s;if(b.search){const S=b.search.toLowerCase();c=c.filter(l=>{var n,k;return l.sessionId.toLowerCase().includes(S)||((n=l.fileName)==null?void 0:n.toLowerCase().includes(S))||((k=We[l.status])==null?void 0:k.label.toLowerCase().includes(S))})}if(b.status!=="all"&&(c=c.filter(S=>S.status===b.status)),b.dateRange!=="all"){const S=new Date,l=new Date;switch(b.dateRange){case"today":l.setHours(0,0,0,0);break;case"week":l.setDate(S.getDate()-7);break;case"month":l.setMonth(S.getMonth()-1);break;case"year":l.setFullYear(S.getFullYear()-1);break}c=c.filter(n=>new Date(n.uploadedAt)>=l)}return c.sort((S,l)=>{let n=0;switch(b.sortBy){case"date":n=new Date(S.uploadedAt).getTime()-new Date(l.uploadedAt).getTime();break;case"status":n=S.status.localeCompare(l.status);break;case"depressionScore":const k=Be(S.depressionScore),f=Be(l.depressionScore);n=k-f;break;case"anxietyScore":const p=Be(S.anxietyScore),_=Be(l.anxietyScore);n=p-_;break}return b.sortOrder==="desc"?-n:n}),c},[s,b]),C=o.useCallback((c,S)=>{g(l=>({...l,[c]:S})),v(`Filter ${c} changed to ${S}`)},[v]),N=o.useCallback(c=>{y(S=>{const l=new Set(S);return l.has(c)?(l.delete(c),v("Session deselected")):(l.add(c),v("Session selected")),l})},[v]),E=o.useCallback(()=>{h.size===M.length?(y(new Set),v("All sessions deselected")):(y(new Set(M.map(S=>S.sessionId))),v(`All ${M.length} sessions selected`))},[h.size,M,v]),W=o.useCallback(async()=>{h.size===0||!window.confirm(`Are you sure you want to delete ${h.size} session(s)?`)||(r(S=>S.filter(l=>!h.has(l.sessionId))),y(new Set),v(`${h.size} sessions deleted`))},[h,v]),G=c=>{if(c===0)return"0 B";const S=1024,l=["B","KB","MB","GB"],n=Math.floor(Math.log(c)/Math.log(S));return`${parseFloat((c/Math.pow(S,n)).toFixed(1))} ${l[n]}`},$=({status:c})=>{const S=We[c]||We.failed,l=S.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":S.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":S.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${S.label}`,children:[e.jsx(l,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),S.label]})};return t?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(se,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading sessions..."})]})}):d?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Sessions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:d.message}),e.jsx("button",{type:"button",onClick:T,className:"mt-4 btn btn--primary","aria-label":"Retry loading sessions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Analysis Sessions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"View and manage your audio analysis sessions"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:T,disabled:t,className:"btn btn--secondary","aria-label":"Refresh sessions list",children:[e.jsx(se,{className:`w-4 h-4 mr-2 ${t?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsx(ee,{to:"/upload",className:"btn btn--primary","aria-label":"Start new analysis session",children:"New Analysis"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{htmlFor:"search-sessions",className:"sr-only",children:"Search sessions"}),e.jsxs("div",{className:"relative",children:[e.jsx(fr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400","aria-hidden":"true"}),e.jsx("input",{id:"search-sessions",type:"text",placeholder:"Search by session ID, filename, or status...",value:b.search,onChange:c=>C("search",c.target.value),className:"form__input w-full pl-10 pr-4 py-2","aria-describedby":"search-help"})]}),e.jsx("p",{id:"search-help",className:"sr-only",children:"Search through your analysis sessions by ID, filename, or status"})]}),e.jsxs("button",{type:"button",onClick:()=>m(!j),className:"btn btn--secondary flex items-center","aria-expanded":j?"true":"false","aria-controls":"filter-panel","aria-label":`${j?"Hide":"Show"} filter options`,children:[e.jsx(_s,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",j?e.jsx(As,{className:"w-4 h-4 ml-2","aria-hidden":"true"}):e.jsx(Ss,{className:"w-4 h-4 ml-2","aria-hidden":"true"})]})]}),j&&e.jsxs("div",{id:"filter-panel",className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{id:"status-filter",value:b.status,onChange:c=>C("status",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"queued",children:"Queued"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"succeeded",children:"Completed"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-filter",value:b.dateRange,onChange:c=>C("dateRange",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-by",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort By"}),e.jsxs("select",{id:"sort-by",value:b.sortBy,onChange:c=>C("sortBy",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"status",children:"Status"}),e.jsx("option",{value:"depressionScore",children:"Depression Score"}),e.jsx("option",{value:"anxietyScore",children:"Anxiety Score"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-order",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort Order"}),e.jsxs("select",{id:"sort-order",value:b.sortOrder,onChange:c=>C("sortOrder",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]}),M.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[M.length," of ",s.length," sessions",h.size>0&&` â€¢ ${h.size} selected`]})}),h.size>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{type:"button",onClick:W,className:"btn btn--danger","aria-label":`Delete ${h.size} selected sessions`,children:[e.jsx(Xe,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Delete Selected"]})})]}),M.length>0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",role:"table","aria-label":"Analysis sessions",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:h.size===M.length,onChange:E,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":"Select all sessions"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Session"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Depression Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Anxiety Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:M.map(c=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:h.has(c.sessionId),onChange:()=>N(c.sessionId),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${c.sessionId}`})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c.fileName}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID: ",c.sessionId.slice(-12)]}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:G(c.fileSize||0)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx($,{status:c.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:c.depressionScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:ze(c.depressionScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:c.anxietyScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:ze(c.anxietyScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:_e(c.uploadedAt)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ne(c.uploadedAt)})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(ee,{to:`/sessions/${c.sessionId}`,className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300","aria-label":`View details for session ${c.sessionId}`,children:e.jsx(Me,{className:"w-4 h-4","aria-hidden":"true"})}),c.status==="succeeded"&&e.jsx("button",{type:"button",className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300","aria-label":`Download results for session ${c.sessionId}`,children:e.jsx(Ve,{className:"w-4 h-4","aria-hidden":"true"})})]})})]},c.sessionId))})]})}),e.jsx("div",{className:"md:hidden space-y-4 p-4",children:M.map(c=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:h.has(c.sessionId),onChange:()=>N(c.sessionId),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${c.sessionId}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c.fileName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",c.sessionId.slice(-12)]})]})]}),e.jsx($,{status:c.status})]}),(c.depressionScore||c.anxietyScore)&&e.jsxs("div",{className:"text-sm",children:[c.depressionScore&&e.jsxs("div",{children:["Depression: ",ze(c.depressionScore)]}),c.anxietyScore&&e.jsxs("div",{children:["Anxiety: ",ze(c.anxietyScore)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:_e(c.uploadedAt)}),e.jsx("span",{children:G(c.fileSize||0)})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[e.jsxs(ee,{to:`/sessions/${c.sessionId}`,className:"btn btn--secondary text-xs","aria-label":`View details for session ${c.sessionId}`,children:[e.jsx(Me,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"View"]}),c.status==="succeeded"&&e.jsxs("button",{type:"button",className:"btn btn--secondary text-xs","aria-label":`Download results for session ${c.sessionId}`,children:[e.jsx(Ve,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Download"]})]})]},c.sessionId))})]}):e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(ce,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No sessions found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't created any analysis sessions yet.":"No sessions match your current filters."}),s.length===0?e.jsx(ee,{to:"/upload",className:"btn btn--primary",children:"Start Your First Analysis"}):e.jsx("button",{type:"button",onClick:()=>g({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),className:"btn btn--secondary",children:"Clear Filters"})]})]})},Kr={low:{color:"green",label:"Low Risk",icon:oe,description:"Low likelihood of immediate concerns"},moderate:{color:"yellow",label:"Moderate Risk",icon:Es,description:"Some concerns that warrant attention"},high:{color:"red",label:"High Risk",icon:Qe,description:"Significant concerns requiring immediate attention"},critical:{color:"red",label:"Critical Risk",icon:Qe,description:"Urgent intervention required"}},Wr=({sessionId:s,existingAssessment:r,onAssessmentUpdated:t})=>{const{announceToScreenReader:a}=Ee(),[d,x]=o.useState(r||null),[h,y]=o.useState(!1),[j,m]=o.useState(!1),[b,g]=o.useState(null),v=o.useCallback(async()=>{try{y(!0),g(null),a("Generating AI risk assessment...");const C=await K.generateRiskAssessment(s);if(C.success&&C.riskAssessment)x(C.riskAssessment),t==null||t(C.riskAssessment),a("Risk assessment generated successfully");else throw new Error(C.message||"Failed to generate risk assessment")}catch(C){const N=C;g(N),a(`Error generating assessment: ${N.message}`)}finally{y(!1)}},[s,t,a]),T=o.useCallback(async()=>{try{m(!0),g(null);const C=await K.getRiskAssessment(s);C.success&&C.riskAssessment&&(x(C.riskAssessment),t==null||t(C.riskAssessment))}catch(C){g(C)}finally{m(!1)}},[s,t]),M=({riskLevel:C,riskScore:N})=>{const E=Kr[C.toLowerCase()];if(!E)return null;const W=E.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium ${E.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":E.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Risk level: ${E.label}`,children:[e.jsx(W,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),E.label,N&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded text-xs font-bold",children:[N,"/10"]})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:E.description})]})};return!d&&!h&&!j?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Risk Assessment Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Generate an AI-powered risk assessment based on session data and clinical insights."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{type:"button",onClick:v,className:"btn btn--primary","aria-label":"Generate AI risk assessment",children:[e.jsx(ge,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Generate AI Risk Assessment"]}),e.jsxs("button",{type:"button",onClick:T,className:"btn btn--secondary","aria-label":"Check for existing assessment",children:[e.jsx(se,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Check for Existing Assessment"]})]}),b&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:b.message})})]})]}):h||j?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(se,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:h?"Generating AI risk assessment...":"Loading assessment..."})]}),h&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This may take a few moments as AI analyzes the session data..."})})]}):d?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:[d.confidenceLevel&&e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Confidence: ",(d.confidenceLevel*100).toFixed(0),"%"]}),e.jsxs("button",{type:"button",onClick:v,disabled:h,className:"btn btn--secondary text-xs","aria-label":"Regenerate risk assessment",children:[e.jsx(se,{className:`w-3 h-3 mr-1 ${h?"animate-spin":""}`,"aria-hidden":"true"}),"Regenerate"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Overall Risk Level"}),e.jsx(M,{riskLevel:d.overallRiskLevel,riskScore:d.riskScore})]}),d.generatedAt&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(ws,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Generated"]}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ne(d.generatedAt)})]})]}),d.summary&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Zt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Summary"]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsx("p",{className:"text-blue-900 dark:text-blue-100 text-sm leading-relaxed",children:d.summary})})]}),d.keyFactors&&d.keyFactors.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Es,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Key Risk Factors"]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:d.keyFactors.map((C,N)=>e.jsxs("li",{className:"text-yellow-900 dark:text-yellow-100 text-sm flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-3 flex-shrink-0","aria-hidden":"true"}),C]},N))})})]}),d.recommendations&&d.recommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(lr,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recommendations"]}),e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:e.jsx("ul",{className:"space-y-2",children:d.recommendations.map((C,N)=>e.jsxs("li",{className:"text-green-900 dark:text-green-100 text-sm flex items-start",children:[e.jsx(oe,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),C]},N))})})]}),d.immediateActions&&d.immediateActions.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Sr,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Immediate Actions Required"]}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:e.jsx("ul",{className:"space-y-2",children:d.immediateActions.map((C,N)=>e.jsxs("li",{className:"text-red-900 dark:text-red-100 text-sm flex items-start",children:[e.jsx(Qe,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),C]},N))})})]}),d.followUpRecommendations&&d.followUpRecommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(es,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Follow-up Recommendations"]}),e.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:e.jsx("ul",{className:"space-y-2",children:d.followUpRecommendations.map((C,N)=>e.jsxs("li",{className:"text-purple-900 dark:text-purple-100 text-sm flex items-start",children:[e.jsx(fe,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),C]},N))})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(fe,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),"Generated: ",Ne(d.generatedAt),d.modelVersion&&e.jsxs("span",{className:"ml-4",children:["Model: ",d.modelVersion]})]})})]}),b&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:b.message})})]}):null},us={queued:{color:"yellow",icon:fe,label:"Queued",description:"Waiting to be processed"},initiated:{color:"blue",icon:fe,label:"Initiated",description:"Session has been created"},running:{color:"blue",icon:se,label:"Processing",description:"Audio is being analyzed"},processing:{color:"blue",icon:se,label:"Processing",description:"Analysis in progress"},succeeded:{color:"green",icon:oe,label:"Completed",description:"Analysis completed successfully"},success:{color:"green",icon:oe,label:"Completed",description:"Analysis completed successfully"},failed:{color:"red",icon:Cs,label:"Failed",description:"Analysis encountered an error"}},Jr=()=>{var S,l,n,k,f,p,_,B,q,me,J,X,te,re;const{sessionId:s}=et(),r=ys(),{announceToScreenReader:t}=Ee(),[a,d]=o.useState(null),[x,h]=o.useState(!0),[y,j]=o.useState(null),[m,b]=o.useState(!1),[g,v]=o.useState(!1),[T,M]=o.useState(!1),C=o.useRef(null),N=o.useCallback(async()=>{if(s)try{h(!0),j(null);const A=await K.getSessionData(s);d(A),t(`Session ${s} loaded successfully`)}catch(A){const L=A;j(L),t(`Error loading session: ${L.message}`)}finally{h(!1)}},[s,t]),E=o.useCallback(async()=>{v(!0),await N(),v(!1),t("Session data refreshed")},[N,t]);o.useEffect(()=>{N()},[N]);const W=o.useCallback(()=>{b(A=>{const L=!A;return t(`Raw JSON view ${L?"enabled":"disabled"}`),L})},[t]),G=o.useCallback(()=>{C.current&&(T?(C.current.pause(),M(!1),t("Audio paused")):(C.current.play().catch(()=>{t("Failed to play audio")}),M(!0),t("Audio playing")))},[T,t]),$=o.useCallback(()=>{if(!a)return;const A=JSON.stringify(a,null,2),L=new Blob([A],{type:"application/json"}),Y=URL.createObjectURL(L),U=document.createElement("a");U.href=Y,U.download=`session-${a.sessionId}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(Y),t("Session data download started")},[a,t]),c=({status:A})=>{const L=us[A]||us.failed,Y=L.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${L.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":L.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":L.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${L.label}`,children:[e.jsx(Y,{className:`w-4 h-4 mr-2 ${L.color==="blue"&&A==="processing"?"animate-spin":""}`,"aria-hidden":"true"}),L.label]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:L.description})]})};return x?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(se,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading session details..."})]})}):y?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Session"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:y.message}),e.jsxs("div",{className:"mt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:N,className:"btn btn--primary","aria-label":"Retry loading session",children:"Try Again"}),e.jsx(ee,{to:"/sessions",className:"btn btn--secondary",children:"Back to Sessions"})]})]})]})})}):a?e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{type:"button",onClick:()=>r("/sessions"),className:"btn btn--secondary","aria-label":"Back to sessions list",children:[e.jsx(Et,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Back to Sessions"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Session Details"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:["ID: ",a.sessionId]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:W,className:"btn btn--secondary","aria-label":`${m?"Hide":"Show"} raw JSON data`,children:[m?e.jsx(Gt,{className:"w-4 h-4 mr-2"}):e.jsx(Me,{className:"w-4 h-4 mr-2"}),m?"Hide JSON":"Show JSON"]}),e.jsxs("button",{type:"button",onClick:E,disabled:g,className:"btn btn--secondary","aria-label":"Refresh session data",children:[e.jsx(se,{className:`w-4 h-4 mr-2 ${g?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{type:"button",onClick:$,className:"btn btn--primary","aria-label":"Download session data as JSON",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),m&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ye,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Raw Session Data"]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 overflow-auto",children:e.jsx("pre",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap break-all",children:JSON.stringify(a,null,2)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ye,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Basic Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsx(c,{status:a.status})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(ws,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Created"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:_e(a.createdAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(a.createdAt)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(fe,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Last Updated"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:_e(a.updatedAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(a.updatedAt)})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(xs,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"User ID"]}),e.jsx("div",{className:"font-mono text-sm bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded border break-all",children:a.userId})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Jt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Audio Information"]}),e.jsxs("div",{className:"space-y-4",children:[a.audioFileName&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"File Name"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-medium",children:a.audioFileName})]}),a.audioUrl&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Audio File"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:G,className:"btn btn--secondary","aria-label":`${T?"Pause":"Play"} audio`,children:T?e.jsx(Ze,{className:"w-4 h-4"}):e.jsx(ke,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:T?"Playing audio...":"Audio playback available"})]}),e.jsx("audio",{ref:C,src:a.audioUrl,onPlay:()=>M(!0),onPause:()=>M(!1),onEnded:()=>M(!1),onError:()=>{M(!1),t("Audio playback failed - file may not be accessible")},className:"hidden",preload:"metadata"})]})]})]})]}),a.userMetadata&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(xs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Patient Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.userMetadata.age&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[a.userMetadata.age," years"]})]}),a.userMetadata.gender&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:a.userMetadata.gender.replace(/[_-]/g," ")})]}),a.userMetadata.weight&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[a.userMetadata.weight," lbs"]})]}),a.userMetadata.race&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:a.userMetadata.race})]}),a.userMetadata.ethnicity&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:a.userMetadata.ethnicity})]}),a.userMetadata.zipcode&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-mono",children:a.userMetadata.zipcode})]}),a.userMetadata.language!==void 0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language English"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:a.userMetadata.language?"Yes":"No"})]}),a.userMetadata.sessionNotes&&e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded border",children:a.userMetadata.sessionNotes})]})]})]}),(a.analysisResults||a.prediction)&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(He,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Analysis Results"]}),e.jsxs("div",{className:"space-y-6",children:[(a.analysisResults||a.prediction)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Mental Health Scores"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(((S=a.analysisResults)==null?void 0:S.depressionScore)||((l=a.prediction)==null?void 0:l.predicted_score_depression))&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Depression Score"}),e.jsx(es,{className:"w-4 h-4 text-blue-600 dark:text-blue-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:((k=(n=a.analysisResults)==null?void 0:n.depressionScore)==null?void 0:k.toFixed(2))||((f=a.prediction)!=null&&f.predicted_score_depression?a.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,A=>A.toUpperCase()):"N/A")}),((p=a.analysisResults)==null?void 0:p.confidence)&&e.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["Confidence: ",(a.analysisResults.confidence*100).toFixed(1),"%"]})]}),(((_=a.analysisResults)==null?void 0:_.anxietyScore)||((B=a.prediction)==null?void 0:B.predicted_score_anxiety))&&e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Anxiety Score"}),e.jsx(Ms,{className:"w-4 h-4 text-purple-600 dark:text-purple-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:((me=(q=a.analysisResults)==null?void 0:q.anxietyScore)==null?void 0:me.toFixed(2))||((J=a.prediction)!=null&&J.predicted_score_anxiety?a.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,A=>A.toUpperCase()):"N/A")}),((X=a.analysisResults)==null?void 0:X.confidence)&&e.jsxs("div",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1",children:["Confidence: ",(a.analysisResults.confidence*100).toFixed(1),"%"]})]})]})]}),((te=a.analysisResults)==null?void 0:te.insights)&&a.analysisResults.insights.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Clinical Insights"}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:a.analysisResults.insights.map((A,L)=>e.jsxs("li",{className:"text-sm text-yellow-800 dark:text-yellow-200 flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-2 flex-shrink-0","aria-hidden":"true"}),A]},L))})})]}),((re=a.analysisResults)==null?void 0:re.completedAt)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Analysis Completion"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(oe,{className:"w-4 h-4 text-green-600 dark:text-green-400 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 mr-2",children:"Completed:"}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Ne(a.analysisResults.completedAt)})]})})]})]})]}),e.jsx(Wr,{sessionId:a.sessionId,existingAssessment:a.riskAssessment||null,onAssessmentUpdated:A=>{d(L=>L?{...L,riskAssessment:A}:null)}})]}):e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx(ce,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Session Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"The requested session could not be found."}),e.jsx(ee,{to:"/sessions",className:"btn btn--primary",children:"Back to Sessions"})]})})},Yr=()=>{const[s,r]=o.useState([]),[t,a]=o.useState(!0),[d,x]=o.useState(null),[h,y]=o.useState({dateRange:"all",scoreType:"all",showTrends:!0}),[j,m]=o.useState(!1),{announceToScreenReader:b}=Ee(),g=ys(),v=o.useCallback(l=>{g(`/sessions/${l}`),b(`Navigating to session ${l} details`)},[g,b]),T=o.useCallback(async()=>{try{a(!0),x(null);const l=Ie(),k=(await K.getUserSessions(l)).sessions.filter(f=>f.analysisResults||f.prediction);r(k),b(`${k.length} prediction sessions loaded`)}catch(l){const n=l;x(n),b(`Error loading predictions: ${n.message}`)}finally{a(!1)}},[b]);o.useEffect(()=>{T()},[T]);const M=o.useMemo(()=>{if(h.dateRange==="all")return s;const l=new Date,n=new Date;switch(h.dateRange){case"week":n.setDate(l.getDate()-7);break;case"month":n.setMonth(l.getMonth()-1);break;case"quarter":n.setMonth(l.getMonth()-3);break;case"year":n.setFullYear(l.getFullYear()-1);break}return s.filter(k=>new Date(k.createdAt)>=n)},[s,h.dateRange]),C=o.useMemo(()=>M.map(l=>{var p,_;const n=B=>{if(!B)return null;switch(B.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return null}},k=n((p=l.prediction)==null?void 0:p.predicted_score_depression),f=n((_=l.prediction)==null?void 0:_.predicted_score_anxiety);return{date:l.createdAt,depression:k,anxiety:f,overall:null,sessionId:l.sessionId}}).sort((l,n)=>new Date(l.date).getTime()-new Date(n.date).getTime()),[M]),N=o.useMemo(()=>{const l={depression:[],anxiety:[]},n=[{category:"no_to_mild",label:"No to Mild",color:"bg-green-400"},{category:"mild_to_moderate",label:"Mild to Moderate",color:"bg-yellow-500"},{category:"moderate_to_severe",label:"Moderate to Severe",color:"bg-red-600"},{category:"no_or_minimal",label:"No or Minimal",color:"bg-green-400"},{category:"moderate",label:"Moderate",color:"bg-orange-500"},{category:"moderately_severe",label:"Moderately Severe",color:"bg-red-500"},{category:"severe",label:"Severe",color:"bg-red-700"}],k=M.map(p=>{var _;return(_=p.prediction)==null?void 0:_.predicted_score_depression}).filter(p=>p!==void 0);n.forEach(p=>{const _=k.filter(q=>q===p.category).length,B=k.length>0?_/k.length*100:0;_>0&&l.depression.push({category:p.label,count:_,percentage:B,color:p.color})});const f=M.map(p=>{var _;return(_=p.prediction)==null?void 0:_.predicted_score_anxiety}).filter(p=>p!==void 0);return n.forEach(p=>{const _=f.filter(q=>q===p.category).length,B=f.length>0?_/f.length*100:0;_>0&&l.anxiety.push({category:p.label,count:_,percentage:B,color:p.color})}),l},[M]),E=o.useMemo(()=>{const l={},n=p=>{if(!p)return 0;switch(p.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},k=M.map(p=>{var _;return(_=p.prediction)==null?void 0:_.predicted_score_depression}).filter(p=>p!==void 0);if(k.length<2)l.depression={direction:"stable",change:0,period:"insufficient data"};else{const p=k.map(n),_=p.slice(0,Math.floor(p.length/2)),B=p.slice(Math.floor(p.length/2)),q=_.reduce((X,te)=>X+te,0)/_.length,J=B.reduce((X,te)=>X+te,0)/B.length-q;l.depression={direction:Math.abs(J)<.5?"stable":J<0?"improving":"worsening",change:Math.abs(J),period:`${M.length} sessions`}}const f=M.map(p=>{var _;return(_=p.prediction)==null?void 0:_.predicted_score_anxiety}).filter(p=>p!==void 0);if(f.length<2)l.anxiety={direction:"stable",change:0,period:"insufficient data"};else{const p=f.map(n),_=p.slice(0,Math.floor(p.length/2)),B=p.slice(Math.floor(p.length/2)),q=_.reduce((X,te)=>X+te,0)/_.length,J=B.reduce((X,te)=>X+te,0)/B.length-q;l.anxiety={direction:Math.abs(J)<.5?"stable":J<0?"improving":"worsening",change:Math.abs(J),period:`${M.length} sessions`}}return l.overall={direction:"stable",change:0,period:"coming soon"},l},[M]),W=o.useMemo(()=>{const l={totalSessions:M.length,avgDepression:0,avgAnxiety:0,avgOverall:0,latestSession:null,improvementSessions:0};if(M.length===0)return l;const n=M.map(f=>{var p;return(p=f.prediction)==null?void 0:p.predictedScoreDepression}).filter(f=>f!==void 0),k=M.map(f=>{var p;return(p=f.prediction)==null?void 0:p.predictedScoreAnxiety}).filter(f=>f!==void 0);if(n.length>0){const f={};n.forEach(_=>{f[_]=(f[_]||0)+1});const p=Object.entries(f).sort(([,_],[,B])=>B-_)[0][0];l.avgDepression=f[p]}if(k.length>0){const f={};k.forEach(_=>{f[_]=(f[_]||0)+1});const p=Object.entries(f).sort(([,_],[,B])=>B-_)[0][0];l.avgAnxiety=f[p]}return l.latestSession=M.sort((f,p)=>new Date(p.createdAt).getTime()-new Date(f.createdAt).getTime())[0],l.improvementSessions=0,l},[M]),G=o.useCallback((l,n)=>{y(k=>({...k,[l]:n})),b(`Filter ${l} changed to ${n}`)},[b]),$=o.useCallback(()=>{const l=JSON.stringify(M,null,2),n=new Blob([l],{type:"application/json"}),k=URL.createObjectURL(n),f=document.createElement("a");f.href=k,f.download=`predictions-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(k),b("Predictions data download started")},[M,b]),c=({trend:l,label:n})=>{const k=l.direction==="improving"?_r:l.direction==="worsening"?es:He,f=l.direction==="improving"?"text-green-600 dark:text-green-400":l.direction==="worsening"?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400";return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:`w-4 h-4 ${f}`,"aria-hidden":"true"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:n}),e.jsxs("span",{className:`text-sm font-medium ${f} capitalize`,children:[l.direction,l.period==="insufficient data"?" (need more sessions)":l.period==="coming soon"?" (analysis coming soon)":` (${l.period})`]})]})},S=({data:l,type:n,onBarClick:k})=>{const f=l.map(A=>A[n]).filter(A=>A!==null);if(f.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No data available"});const p=Math.max(...f),_=Math.min(...f),B=p-_||1,q=A=>{switch(A){case 1:return"No to Mild / No or Minimal";case 2:return"Mild to Moderate / Moderate";case 3:return"Moderate to Severe / Moderately Severe";case 4:return"Severe";default:return"Unknown"}},me=(A,L)=>{if(L==="depression")switch(A){case 1:return"bg-blue-400";case 2:return"bg-blue-600";case 3:return"bg-blue-800";default:return"bg-blue-500"}else if(L==="anxiety")switch(A){case 1:return"bg-purple-400";case 2:return"bg-purple-600";case 3:return"bg-purple-700";case 4:return"bg-purple-900";default:return"bg-purple-500"}else switch(A){case 1:return"bg-green-400";case 2:return"bg-green-600";case 3:return"bg-green-700";case 4:return"bg-green-800";default:return"bg-green-500"}},J=A=>[{score:1,label:"No/Minimal"},{score:2,label:"Mild"},{score:3,label:"Moderate"},{score:4,label:"Mod-Severe"},{score:5,label:"Severe"}].map(Y=>({...Y,color:me(Y.score,A)})),X=new Set(f),re=J(n).filter(A=>X.has(A.score));return e.jsxs("div",{children:[e.jsx("div",{className:"h-32 flex items-end space-x-1 px-4 py-2 mb-4",children:l.map((A,L)=>{const Y=A[n];if(Y===null)return null;const U=(Y-_)/B*100,O=me(Y,n),$e=q(Y),ye=new Date(A.date).toLocaleDateString();return e.jsx("div",{className:`flex-1 ${O} opacity-70 hover:opacity-100 hover:scale-105 transition-all duration-200 rounded-t cursor-pointer relative group chart-bar-dynamic`,style:{"--chart-height":`${Math.max(U,8)}%`},onClick:()=>k(A.sessionId),role:"button",tabIndex:0,onKeyDown:we=>{(we.key==="Enter"||we.key===" ")&&(we.preventDefault(),k(A.sessionId))},"aria-label":`View session details for ${$e} score on ${ye}`,children:e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-medium",children:$e}),e.jsx("div",{className:"text-gray-300",children:ye}),e.jsxs("div",{className:"text-gray-300",children:["Session: ",A.sessionId.slice(-8)]}),e.jsx("div",{className:"text-gray-400 text-xs mt-1",children:"Click to view details"}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"})]})},L)})}),re.length>0&&e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"Legend:"}),re.map(A=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-3 h-3 ${A.color} rounded`}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:A.label})]},A.score))]})})]})};return t?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(se,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading predictions..."})]})}):d?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Predictions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:d.message}),e.jsx("button",{type:"button",onClick:T,className:"mt-4 btn btn--primary","aria-label":"Retry loading predictions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Predictions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Analyze your mental health trends and insights over time"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>m(!j),className:"btn btn--secondary","aria-expanded":j?"true":"false","aria-label":`${j?"Hide":"Show"} filter options`,children:[e.jsx(_s,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",j?e.jsx(As,{className:"w-4 h-4 ml-2"}):e.jsx(Ss,{className:"w-4 h-4 ml-2"})]}),e.jsxs("button",{type:"button",onClick:T,className:"btn btn--secondary","aria-label":"Refresh predictions data",children:[e.jsx(se,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{type:"button",onClick:$,className:"btn btn--primary",disabled:M.length===0,"aria-label":"Download predictions data",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),j&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-range",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-range",value:h.dateRange,onChange:l=>G("dateRange",l.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"quarter",children:"Past Quarter"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"score-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Focus Score"}),e.jsxs("select",{id:"score-type",value:h.scoreType,onChange:l=>G("scoreType",l.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Scores"}),e.jsx("option",{value:"depression",children:"Depression"}),e.jsx("option",{value:"anxiety",children:"Anxiety"}),e.jsx("option",{value:"overall",children:"Overall"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:h.showTrends,onChange:l=>G("showTrends",l.target.checked),className:"form__input form__input--checkbox rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show trend analysis"})]})})]})}),M.length===0?e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Prediction Data Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't completed any analysis sessions yet.":"No sessions found for the selected date range."}),e.jsx(ee,{to:"/upload",className:"btn btn--primary",children:"Start Your First Analysis"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(He,{className:"w-8 h-8 text-blue-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:W.totalSessions})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ge,{className:"w-8 h-8 text-purple-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Depression (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const l=M.map(f=>{var p;return(p=f.prediction)==null?void 0:p.predicted_score_depression}).filter(f=>f!==void 0);if(l.length===0)return"â€”";const n={};return l.forEach(f=>{n[f]=(n[f]||0)+1}),Object.entries(n).sort(([,f],[,p])=>p-f)[0][0].replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase())})()})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ms,{className:"w-8 h-8 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Anxiety (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const l=M.map(f=>{var p;return(p=f.prediction)==null?void 0:p.predicted_score_anxiety}).filter(f=>f!==void 0);if(l.length===0)return"â€”";const n={};return l.forEach(f=>{n[f]=(n[f]||0)+1}),Object.entries(n).sort(([,f],[,p])=>p-f)[0][0].replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase())})()})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(h.scoreType==="all"||h.scoreType==="depression")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(cs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Depression Score Trend"]}),e.jsx(S,{data:C,type:"depression",onBarClick:v}),h.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(c,{trend:E.depression,label:"Trend:"})})]}),(h.scoreType==="all"||h.scoreType==="anxiety")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Lt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Anxiety Score Trend"]}),e.jsx(S,{data:C,type:"anxiety",onBarClick:v}),h.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(c,{trend:E.anxiety,label:"Trend:"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(cs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Score Distribution"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(N).map(([l,n])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 capitalize",children:[l," Scores"]}),e.jsx("div",{className:"space-y-2",children:n.map(k=>e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:k.category}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[k.count," (",k.percentage.toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${k.color} progress-dynamic progress-animated`,style:{"--progress-width":`${k.percentage}%`}})})]})},k.category))})]},l))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(fe,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recent Analysis Sessions"]}),e.jsx(ee,{to:"/sessions",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 text-sm",children:"View All Sessions â†’"})]}),e.jsx("div",{className:"space-y-4",children:M.slice(0,5).map(l=>{var n,k;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${l.status==="succeeded"?"bg-green-500":l.status==="processing"?"bg-blue-500":l.status==="failed"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:l.audioFileName||`Session ${l.sessionId.slice(-8)}`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:_e(l.createdAt)})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[((n=l.prediction)==null?void 0:n.predicted_score_depression)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Depression"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:l.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase())})]}),((k=l.prediction)==null?void 0:k.predicted_score_anxiety)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Anxiety"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:l.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase())})]}),e.jsx(ee,{to:`/sessions/${l.sessionId}`,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400","aria-label":`View session ${l.sessionId}`,children:e.jsx(Me,{className:"w-4 h-4","aria-hidden":"true"})})]})]},l.sessionId)})})]})]})]})};class Zr extends nt.EventEmitter{constructor(t){super();V(this,"recognition",null);V(this,"synthesis",null);V(this,"audioContext",null);V(this,"microphone",null);V(this,"analyzer",null);V(this,"vadProcessor",null);V(this,"stream",null);V(this,"isListening",!1);V(this,"isVADActive",!1);V(this,"silenceTimeout",null);V(this,"speechTimeout",null);V(this,"config",{language:"en-US",continuous:!0,interimResults:!0,maxAlternatives:3,audioTracks:!0,noiseReduction:!0,echoCancellation:!0});this.config={...this.config,...t},this.initializeServices()}async initializeServices(){try{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const t=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new t,this.setupSpeechRecognition()}"speechSynthesis"in window&&(this.synthesis=window.speechSynthesis),this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.emit("initialized",{speechRecognition:!!this.recognition,speechSynthesis:!!this.synthesis,voiceActivityDetection:!!this.audioContext})}catch(t){console.error("Error initializing speech services:",t),this.emit("error",{type:"initialization",error:t})}}setupSpeechRecognition(){this.recognition&&(this.recognition.continuous=this.config.continuous,this.recognition.interimResults=this.config.interimResults,this.recognition.lang=this.config.language,this.recognition.maxAlternatives=this.config.maxAlternatives,this.recognition.onstart=()=>{this.isListening=!0,this.emit("listening",{started:!0})},this.recognition.onresult=t=>{const a=[];for(let x=t.resultIndex;x<t.results.length;x++){const h=t.results[x],y=h[0].transcript,j=h[0].confidence,m=h.isFinal,b=[];for(let g=1;g<h.length&&g<this.config.maxAlternatives;g++)b.push(h[g].transcript);a.push({transcript:y,confidence:j,isFinal:m,alternatives:b})}this.emit("result",{results:a});const d=a.filter(x=>x.isFinal);d.length>0&&this.emit("finalResult",{results:d})},this.recognition.onerror=t=>{console.error("Speech recognition error:",t.error),this.emit("error",{type:"recognition",error:t.error}),(t.error==="no-speech"||t.error==="audio-capture")&&setTimeout(()=>this.restartRecognition(),1e3)},this.recognition.onend=()=>{this.isListening=!1,this.emit("listening",{started:!1}),this.config.continuous&&this.isVADActive&&setTimeout(()=>this.startListening(),100)})}async setupVoiceActivityDetection(){try{if(!this.audioContext)throw new Error("AudioContext not available");this.stream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:this.config.echoCancellation,noiseSuppression:this.config.noiseReduction,autoGainControl:!0,sampleRate:16e3,channelCount:1}}),this.microphone=this.audioContext.createMediaStreamSource(this.stream),this.analyzer=this.audioContext.createAnalyser(),this.vadProcessor=this.audioContext.createScriptProcessor(2048,1,1),this.analyzer.fftSize=256,this.analyzer.smoothingTimeConstant=.8,this.microphone.connect(this.analyzer),this.analyzer.connect(this.vadProcessor),this.vadProcessor.connect(this.audioContext.destination),this.vadProcessor.onaudioprocess=t=>{this.processVAD(t)},this.emit("vadReady")}catch(t){console.error("Error setting up VAD:",t),this.emit("error",{type:"vad",error:t})}}processVAD(t){if(!this.analyzer)return;const a=this.analyzer.frequencyBinCount,d=new Uint8Array(a);this.analyzer.getByteFrequencyData(d);let x=0;for(let m=0;m<a;m++)x+=d[m];const h=x/a,j=h>30;this.emit("voiceActivity",{isActive:j,volume:h,timestamp:Date.now()}),j?(this.silenceTimeout&&(clearTimeout(this.silenceTimeout),this.silenceTimeout=null),this.speechTimeout||(this.speechTimeout=setTimeout(()=>{this.emit("speechStart")},200))):(this.speechTimeout&&(clearTimeout(this.speechTimeout),this.speechTimeout=null),this.silenceTimeout||(this.silenceTimeout=setTimeout(()=>{this.emit("speechEnd")},1500)))}async startListening(){try{if(!this.recognition)throw new Error("Speech recognition not available");this.isVADActive||(await this.setupVoiceActivityDetection(),this.isVADActive=!0),this.isListening||this.recognition.start()}catch(t){console.error("Error starting speech recognition:",t),this.emit("error",{type:"start",error:t})}}stopListening(){try{this.recognition&&this.isListening&&this.recognition.stop(),this.isVADActive=!1,this.vadProcessor&&this.vadProcessor.disconnect(),this.analyzer&&this.analyzer.disconnect(),this.microphone&&this.microphone.disconnect(),this.stream&&(this.stream.getTracks().forEach(t=>t.stop()),this.stream=null),this.silenceTimeout&&(clearTimeout(this.silenceTimeout),this.silenceTimeout=null),this.speechTimeout&&(clearTimeout(this.speechTimeout),this.speechTimeout=null)}catch(t){console.error("Error stopping speech recognition:",t),this.emit("error",{type:"stop",error:t})}}restartRecognition(){this.isVADActive&&(this.stopListening(),setTimeout(()=>this.startListening(),500))}async speak(t,a){return new Promise((d,x)=>{if(!this.synthesis){x(new Error("Speech synthesis not available"));return}a!=null&&a.interrupt&&this.synthesis.cancel();const h=new SpeechSynthesisUtterance(t);h.rate=(a==null?void 0:a.rate)||.9,h.pitch=(a==null?void 0:a.pitch)||1,h.volume=(a==null?void 0:a.volume)||.8,a!=null&&a.voice&&(h.voice=a.voice),h.onend=()=>{this.emit("speechEnd",{text:t}),d()},h.onerror=y=>{this.emit("error",{type:"synthesis",error:y.error}),x(new Error(`Speech synthesis error: ${y.error}`))},h.onstart=()=>{this.emit("speechStart",{text:t})},this.synthesis.speak(h)})}getAvailableVoices(){return this.synthesis?this.synthesis.getVoices():[]}updateConfig(t){this.config={...this.config,...t},this.recognition&&(this.recognition.continuous=this.config.continuous,this.recognition.interimResults=this.config.interimResults,this.recognition.lang=this.config.language,this.recognition.maxAlternatives=this.config.maxAlternatives)}isAvailable(){return!!(this.recognition&&this.synthesis)}isCurrentlyListening(){return this.isListening}destroy(){this.stopListening(),this.audioContext&&this.audioContext.state!=="closed"&&this.audioContext.close(),this.removeAllListeners()}}const Qr=(s={})=>{const r=o.useRef(null),[t,a]=o.useState(!1),[d,x]=o.useState(!1),[h,y]=o.useState(!1),[j,m]=o.useState(0),[b,g]=o.useState(null),[v,T]=o.useState(!1),[M,C]=o.useState([]);o.useEffect(()=>{r.current=new Zr(s.config);const $=r.current;return $.on("initialized",c=>{x(c.speechRecognition&&c.speechSynthesis),T(!0),C($.getAvailableVoices())}),$.on("listening",({started:c})=>{a(c)}),$.on("result",({results:c})=>{var S;(S=s.onResult)==null||S.call(s,c)}),$.on("finalResult",({results:c})=>{var S;(S=s.onFinalResult)==null||S.call(s,c)}),$.on("voiceActivity",c=>{var S;y(c.isActive),m(c.volume),(S=s.onVoiceActivity)==null||S.call(s,c)}),$.on("speechStart",()=>{var c;(c=s.onSpeechStart)==null||c.call(s)}),$.on("speechEnd",()=>{var c;(c=s.onSpeechEnd)==null||c.call(s)}),$.on("error",({type:c,error:S})=>{var n;const l=`Speech ${c} error: ${S}`;g(l),(n=s.onError)==null||n.call(s,{type:c,error:S}),console.error(l)}),s.autoStart&&$.startListening().catch(console.error),()=>{$.destroy()}},[]);const N=o.useCallback(async()=>{try{g(null),r.current&&await r.current.startListening()}catch($){const c=$ instanceof Error?$.message:"Failed to start listening";throw g(c),$}},[]),E=o.useCallback(()=>{try{g(null),r.current&&r.current.stopListening()}catch($){const c=$ instanceof Error?$.message:"Failed to stop listening";g(c)}},[]),W=o.useCallback(async($,c)=>{try{g(null),r.current&&await r.current.speak($,c)}catch(S){const l=S instanceof Error?S.message:"Failed to speak";throw g(l),S}},[]),G=o.useCallback($=>{r.current&&r.current.updateConfig($)},[]);return o.useEffect(()=>{if(v&&r.current){const $=()=>{C(r.current.getAvailableVoices())};if($(),"speechSynthesis"in window)return window.speechSynthesis.addEventListener("voiceschanged",$),()=>{window.speechSynthesis.removeEventListener("voiceschanged",$)}}},[v]),{isListening:t,isAvailable:d,isVoiceActive:h,volume:j,startListening:N,stopListening:E,speak:W,updateConfig:G,availableVoices:M,error:b,isInitialized:v}},Xr=({volume:s,isVoiceActive:r,isListening:t,size:a="md",className:d=""})=>{const x={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16"},h=a==="sm"?3:a==="md"?5:7,y=a==="sm"?16:a==="md"?24:32,j=Math.min(s/100,1);return e.jsx("div",{className:`flex items-center justify-center ${x[a]} ${d}`,children:e.jsx("div",{className:"flex items-end space-x-1 h-full",children:Array.from({length:h}).map((m,b)=>{const g=b/h,v=t&&(r||b===0),T=j>g,M=v&&T?Math.max(4,j*y):4,C=b*100;return e.jsx("div",{className:`w-1 transition-all duration-150 rounded-sm voice-bar ${v?T?"bg-green-500 animate-pulse":"bg-gray-300 dark:bg-gray-600":"bg-gray-200 dark:bg-gray-700"}`,"data-height":M,"data-delay":C},b)})})})},ea=({config:s,availableVoices:r,selectedVoice:t,onConfigUpdate:a,onVoiceSelect:d,isOpen:x,onClose:h})=>{const[y,j]=o.useState(s),m=(g,v)=>{const T={...y,[g]:v};j(T),a({[g]:v})},b=[{code:"en-US",name:"English (US)"},{code:"en-GB",name:"English (UK)"},{code:"es-ES",name:"Spanish (Spain)"},{code:"es-MX",name:"Spanish (Mexico)"},{code:"fr-FR",name:"French (France)"},{code:"de-DE",name:"German (Germany)"},{code:"it-IT",name:"Italian (Italy)"},{code:"pt-BR",name:"Portuguese (Brazil)"},{code:"zh-CN",name:"Chinese (Simplified)"},{code:"ja-JP",name:"Japanese"},{code:"ko-KR",name:"Korean"}];return x?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"speech-settings-title",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"flex items-center justify-center min-h-full p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:h}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Is,{className:"h-6 w-6 text-primary-600 dark:text-primary-400"}),e.jsx("h2",{id:"speech-settings-title",className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Speech Settings"})]}),e.jsxs("button",{onClick:h,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Close settings",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rs,{className:"h-5 w-5 text-gray-500"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Speech Recognition"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(nr,{className:"inline h-4 w-4 mr-1"}),"Language"]}),e.jsx("select",{value:y.language,onChange:g=>m("language",g.target.value),title:"Select language for speech recognition",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",children:b.map(g=>e.jsx("option",{value:g.code,children:g.name},g.code))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Recognition Alternatives"}),e.jsxs("select",{value:y.maxAlternatives,onChange:g=>m("maxAlternatives",parseInt(g.target.value)),title:"Select number of recognition alternatives",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:1,children:"1 (fastest)"}),e.jsx("option",{value:2,children:"2 (balanced)"}),e.jsx("option",{value:3,children:"3 (best accuracy)"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:y.continuous,onChange:g=>m("continuous",g.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Continuous listening (auto-restart)"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:y.interimResults,onChange:g=>m("interimResults",g.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Show interim results (real-time transcription)"})]})]})]}),e.jsxs("div",{className:"space-y-4 border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Audio Processing"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:y.noiseReduction,onChange:g=>m("noiseReduction",g.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Noise reduction"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:y.echoCancellation,onChange:g=>m("echoCancellation",g.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Echo cancellation"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:y.audioTracks,onChange:g=>m("audioTracks",g.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Enhanced audio processing"})]})]})]}),e.jsxs("div",{className:"space-y-4 border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Re,{className:"h-5 w-5 text-gray-500"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Speech Synthesis"})]}),e.jsxs("button",{onClick:()=>window.speechSynthesis.getVoices(),className:"flex items-center space-x-1 px-3 py-1 text-sm text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors",title:"Refresh available voices",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Refresh"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Voice Selection"}),e.jsxs("select",{value:(t==null?void 0:t.name)||"",onChange:g=>{const v=r.find(T=>T.name===g.target.value);v&&d(v)},title:"Select voice for speech synthesis",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Default system voice"}),r.map((g,v)=>e.jsxs("option",{value:g.name,children:[g.name," (",g.lang,") ",g.default?"(Default)":""]},v))]}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[r.length," voices available"]})]}),t&&e.jsx("div",{children:e.jsxs("button",{onClick:()=>{const g=new SpeechSynthesisUtterance("Hello! This is a test of the selected voice.");g.voice=t,window.speechSynthesis.speak(g)},className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-primary-700 bg-primary-100 hover:bg-primary-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:bg-primary-800 dark:text-primary-200 dark:hover:bg-primary-700",children:[e.jsx(Re,{className:"h-4 w-4 mr-1"}),"Test Voice"]})})]})]}),e.jsx("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:e.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors",children:"Close"})})]})]})}):null},sa=()=>{const{handleEnterSpace:s}=vs(),[r,t]=o.useState([]),[a,d]=o.useState(""),[x,h]=o.useState(!1),[y,j]=o.useState({id:"coordinator",name:"Coordinator Agent",isActive:!0,isTyping:!1}),[m,b]=o.useState(!1),[g,v]=o.useState(!1),[T,M]=o.useState(),C=o.useRef(null),N=o.useRef(null),E=Qr({config:{continuous:!0,interimResults:!0,language:"en-US",maxAlternatives:2},onFinalResult:n=>{n.length>0&&n[0].transcript.trim()&&(d(n[0].transcript.trim()),de(`Voice input captured: ${n[0].transcript}`))},onVoiceActivity:n=>{},onError:n=>{console.error("Advanced speech error:",n),de("Voice input error occurred")}});o.useEffect(()=>{var n;(n=C.current)==null||n.scrollIntoView({behavior:"smooth"})},[r]),o.useEffect(()=>{t([{id:"1",content:"Hello! I'm your behavioral health assistant. I can help you with depression screenings, provide support, or just have a friendly conversation. What would you like to explore today?",role:"assistant",timestamp:new Date}])},[]);const W=async()=>{try{E.isListening?(E.stopListening(),de("Voice input stopped")):(await E.startListening(),de("Voice input started"))}catch(n){console.error("Error toggling speech:",n),de("Error with voice input")}},G=async n=>{if(m&&E.isAvailable)try{await E.speak(n,{rate:.9,pitch:1,volume:.8,voice:T,interrupt:!0})}catch(k){console.error("Error speaking message:",k)}},$=()=>{b(!m),m?(de("Audio output disabled"),E.isAvailable&&window.speechSynthesis&&window.speechSynthesis.cancel()):de("Audio output enabled")},c=async()=>{if(!a.trim()||x)return;const n={id:Date.now().toString(),content:a.trim(),role:"user",timestamp:new Date};t(k=>[...k,n]),d(""),h(!0),j(k=>({...k,isTyping:!0}));try{await new Promise(q=>setTimeout(q,1e3+Math.random()*2e3));let k="I understand what you're saying. Let me help you with that.",f=y.id,p=y.name;const _=n.content.toLowerCase();_.includes("phq")||_.includes("depression")||_.includes("screening")?(k="I can help you with a depression screening. I'll start with the PHQ-2, which is a quick 2-question assessment. This will help determine if a more comprehensive evaluation might be helpful. Shall we begin?",f="phq2",p="PHQ-2 Agent"):_.includes("joke")||_.includes("funny")||_.includes("humor")?(k="Hey there! ðŸ˜„ I'm here to brighten your day with some wholesome humor! I can share clean jokes, funny stories, or just have some playful banter. What sounds good to you?",f="comedian",p="Comedy Agent"):(_.includes("crisis")||_.includes("emergency")||_.includes("help"))&&(k="I'm here to help. If you're experiencing a mental health crisis, please reach out for immediate support: Call 988 (Suicide & Crisis Lifeline) or contact your local emergency services. I'm also here to provide support and connect you with appropriate resources.");const B={id:(Date.now()+1).toString(),content:k,role:"assistant",timestamp:new Date};t(q=>[...q,B]),f!==y.id&&(j({id:f,name:p,isActive:!0,isTyping:!1}),de(`Agent changed to ${p}`)),G(k)}catch(k){console.error("Error sending message:",k);const f={id:(Date.now()+1).toString(),content:"I'm sorry, I encountered an error processing your message. Please try again.",role:"assistant",timestamp:new Date};t(p=>[...p,f])}finally{h(!1),j(k=>({...k,isTyping:!1}))}},S=n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),c())},l=()=>{t([]),j({id:"coordinator",name:"Coordinator Agent",isActive:!0,isTyping:!1}),de("Conversation cleared")};return e.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 ${y.isTyping?"bg-primary-500 animate-pulse":y.isActive?"bg-green-500":"bg-gray-400"}`,children:e.jsx("span",{className:"text-white text-lg",children:"ðŸ¤–"})}),y.isActive&&e.jsx("div",{className:"absolute -inset-1 rounded-full bg-green-400 opacity-30 animate-ping"}),E.isListening&&e.jsx("div",{className:"absolute -bottom-1 -right-1",children:e.jsx(Xr,{volume:E.volume,isVoiceActive:E.isVoiceActive,isListening:E.isListening,size:"sm"})})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Agent Experience"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Current Agent: ",y.name,y.isTyping&&e.jsx("span",{className:"ml-2 text-primary-600 dark:text-primary-400",children:e.jsx("span",{className:"animate-pulse",children:"Typing..."})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>v(!0),onKeyDown:s(()=>v(!0)),className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500","aria-label":"Open speech settings",title:"Speech settings",children:e.jsx(Is,{size:20})}),e.jsx("button",{onClick:$,onKeyDown:s($),className:`p-2 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 ${m?"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"}`,"aria-label":`${m?"Disable":"Enable"} audio output`,title:`${m?"Disable":"Enable"} audio output`,children:m?e.jsx(Re,{size:20}):e.jsx(Tr,{size:20})}),e.jsx("button",{onClick:l,onKeyDown:s(l),className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500","aria-label":"Clear conversation",title:"Clear conversation",children:e.jsx(Xe,{size:20})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r.map(n=>e.jsx("div",{className:`flex ${n.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] p-3 rounded-lg ${n.role==="user"?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-100"}`,children:[e.jsx("p",{className:"text-sm",children:n.content}),e.jsx("p",{className:`text-xs mt-1 opacity-70 ${n.role==="user"?"text-primary-200":"text-gray-500 dark:text-gray-400"}`,children:n.timestamp.toLocaleTimeString()})]})},n.id)),y.isTyping&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-3 rounded-lg",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce delay-100"}),e.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce delay-200"})]})})}),e.jsx("div",{ref:C})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-end space-x-2",children:[E.isAvailable&&e.jsx("button",{onClick:W,onKeyDown:s(W),disabled:x,className:`p-3 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 ${E.isListening?"bg-red-600 text-white hover:bg-red-700":"bg-primary-600 text-white hover:bg-primary-700 disabled:bg-gray-400"}`,"aria-label":E.isListening?"Stop voice input":"Start voice input",title:E.isListening?"Stop voice input":"Start voice input",children:E.isListening?e.jsx(xr,{size:20}):e.jsx(Rs,{size:20})}),e.jsx("div",{className:"flex-1",children:e.jsx("textarea",{ref:N,value:a,onChange:n=>d(n.target.value),onKeyPress:S,placeholder:"Type your message here or use voice input...",disabled:x,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-gray-800 dark:text-gray-100 disabled:bg-gray-100 dark:disabled:bg-gray-700 min-h-[44px] max-h-[120px]",rows:1,"aria-label":"Message input"})}),e.jsx("button",{onClick:c,onKeyDown:s(c),disabled:!a.trim()||x,className:"p-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500","aria-label":"Send message",title:"Send message",children:e.jsx(kr,{size:20})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[E.isListening&&e.jsxs("span",{className:"flex items-center space-x-1 text-red-600 dark:text-red-400",children:[e.jsx("div",{className:"w-2 h-2 bg-red-600 rounded-full animate-pulse"}),e.jsx("span",{children:"Listening..."})]}),E.isVoiceActive&&e.jsxs("span",{className:"flex items-center space-x-1 text-green-600 dark:text-green-400",children:[e.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-pulse"}),e.jsx("span",{children:"Voice detected"})]}),E.isAvailable&&e.jsx("span",{className:"text-green-600 dark:text-green-400",children:"Voice input available"}),E.error&&e.jsxs("span",{className:"text-red-600 dark:text-red-400",children:["Speech error: ",E.error]}),m&&e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Audio output enabled"})]}),e.jsx("span",{children:"Press Enter to send, Shift+Enter for new line"})]})]}),e.jsx(ea,{config:{language:"en-US",continuous:!0,interimResults:!0,maxAlternatives:2,audioTracks:!0,noiseReduction:!0,echoCancellation:!0},availableVoices:E.availableVoices,selectedVoice:T,onConfigUpdate:n=>E.updateConfig(n),onVoiceSelect:n=>M(n),isOpen:g,onClose:()=>v(!1)})]})},ta=()=>{const{data:s,isLoading:r,error:t,refetch:a}=Ds(),{announce:d}=ks();bs.useEffect(()=>{d("System Health page loaded","polite")},[d]);const x=m=>{if(!m)return"Just now";try{const b=new Date(m);return isNaN(b.getTime())?"Just now":b.toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return"Just now"}},h=m=>{switch(m==null?void 0:m.toLowerCase()){case"healthy":return"text-green-600 dark:text-green-400";case"degraded":return"text-yellow-600 dark:text-yellow-400";case"unhealthy":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},y=m=>{switch(m==null?void 0:m.toLowerCase()){case"healthy":return"âœ…";case"degraded":return"âš ï¸";case"unhealthy":return"âŒ";default:return"â“"}},j=m=>{const b="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium";switch(m==null?void 0:m.toLowerCase()){case"healthy":return`${b} bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200`;case"degraded":return`${b} bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200`;case"unhealthy":return`${b} bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200`;default:return`${b} bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200`}};return e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"System Health"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Monitor API status and system connectivity"})]}),e.jsxs("button",{type:"button",onClick:()=>a(),disabled:r,className:"btn btn--secondary flex items-center space-x-2","aria-label":"Refresh system health status",children:[e.jsx(se,{className:`w-4 h-4 ${r?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),r&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(se,{className:"w-6 h-6 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Checking system health..."})]})}),t&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-6 h-6 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Health Check Failed"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:t.message||"Unable to retrieve system health status"}),e.jsx("button",{type:"button",onClick:()=>a(),className:"mt-3 text-sm text-red-800 dark:text-red-200 hover:text-red-900 dark:hover:text-red-100 underline",children:"Try again"})]})]})}),s&&!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Overall System Status"}),e.jsxs("div",{className:j(s.status),children:[e.jsx("span",{className:"mr-1",children:y(s.status)}),s.status]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:y(s.status)}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Status"}),e.jsx("div",{className:`font-medium ${h(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"â±ï¸"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Response Time"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:s.totalDuration?`${s.totalDuration}ms`:"N/A"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“…"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last Checked"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:x(s.timestamp)})]})]})]}),s.checks&&Object.keys(s.checks).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(He,{className:"w-5 h-5 mr-2"}),"Service Details"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.checks).map(([m,b])=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:y(b.status)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white capitalize",children:m.replace(/-/g," ")}),b.description&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:b.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[b.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[b.duration,"ms"]}),e.jsx("div",{className:j(b.status),children:b.status})]})]},m))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ye,{className:"w-5 h-5 mr-2"}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"API Endpoints"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Health Check:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/health"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Sessions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/sessions"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Predictions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/predictions"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Connection Status"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"API Connected"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Real-time Updates"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Auto-refresh Enabled"})]})]})]})]})]})]})]})},ra=()=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Page Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"The page you're looking for doesn't exist."}),e.jsx("a",{href:"/",className:"btn btn--primary",children:"Go to Dashboard"})]}),aa=new Ys({defaultOptions:{queries:{retry:(s,r)=>{if(r&&typeof r=="object"&&"code"in r){const t=r.code;if(t!=null&&t.startsWith("HTTP_4")&&t!=="HTTP_408")return!1}return s<3},staleTime:5*60*1e3,refetchOnWindowFocus:!1},mutations:{retry:1}}});function ia(){return e.jsxs(Zs,{client:aa,children:[e.jsx(jt,{children:e.jsx(st,{children:e.jsx(wt,{children:e.jsxs(tt,{children:[e.jsx(ue,{path:"/",element:e.jsx(Or,{})}),e.jsx(ue,{path:"/upload",element:e.jsx(qr,{})}),e.jsx(ue,{path:"/sessions",element:e.jsx(Gr,{})}),e.jsx(ue,{path:"/sessions/:sessionId",element:e.jsx(Jr,{})}),e.jsx(ue,{path:"/predictions",element:e.jsx(Yr,{})}),e.jsx(ue,{path:"/agent-experience",element:e.jsx(sa,{})}),e.jsx(ue,{path:"/health",element:e.jsx(ta,{})}),e.jsx(ue,{path:"*",element:e.jsx(ra,{})})]})})})}),!1]})}const gs=localStorage.getItem("bh_theme"),na=window.matchMedia("(prefers-color-scheme: dark)").matches,oa=gs==="dark"||!gs&&na;oa?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");Je.createRoot(document.getElementById("root")).render(e.jsx(bs.StrictMode,{children:e.jsx(ia,{})}));
//# sourceMappingURL=index-7799615c.js.map
