var qs=Object.defineProperty;var Vs=(s,t,a)=>t in s?qs(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var te=(s,t,a)=>(Vs(s,typeof t!="symbol"?t+"":t,a),a);import{j as e,u as hs,Q as Gs,a as Ws}from"./query-e4af0201.js";import{a as Ks,r as l,u as Ys,L as J,b as Js,c as us,R as ps,B as Zs,d as Qs,e as ye}from"./vendor-99a90158.js";import{F as Xs,t as ss,f as et}from"./ffmpeg-c0c62554.js";import{B as st}from"./azure-a3a2de5a.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const m of c)if(m.type==="childList")for(const p of m.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function a(c){const m={};return c.integrity&&(m.integrity=c.integrity),c.referrerPolicy&&(m.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?m.credentials="include":c.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function r(c){if(c.ep)return;c.ep=!0;const m=a(c);fetch(c.href,m)}})();var We={},ts=Ks;We.createRoot=ts.createRoot,We.hydrateRoot=ts.hydrateRoot;let Te;const tt=new Uint8Array(16);function at(){if(!Te&&(Te=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Te))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Te(tt)}const K=[];for(let s=0;s<256;++s)K.push((s+256).toString(16).slice(1));function rt(s,t=0){return K[s[t+0]]+K[s[t+1]]+K[s[t+2]]+K[s[t+3]]+"-"+K[s[t+4]]+K[s[t+5]]+"-"+K[s[t+6]]+K[s[t+7]]+"-"+K[s[t+8]]+K[s[t+9]]+"-"+K[s[t+10]]+K[s[t+11]]+K[s[t+12]]+K[s[t+13]]+K[s[t+14]]+K[s[t+15]]}const it=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),as={randomUUID:it};function ys(s,t,a){if(as.randomUUID&&!t&&!s)return as.randomUUID();s=s||{};const r=s.random||(s.rng||at)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){a=a||0;for(let c=0;c<16;++c)t[a+c]=r[c];return t}return rt(r)}const ke={api:{baseUrl:"http://localhost:7071/api"},azure:{blobSasUrl:"https://aistgvi.blob.core.windows.net/?sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiyx&se=2026-06-26T11:43:55Z&st=2025-09-06T03:28:55Z&spr=https&sig=jlfi75igY6qW805u%2FWErZpEu7AZSll5hJOdvSJU35%2Bo%3D",containerName:"audio-uploads"},polling:{intervalMs:parseInt("3000",10),maxAttempts:60,backoffFactor:1.2},features:{enableFFmpegWorker:!0,enableDebugLogging:!0},audio:{acceptedFormats:[".wav",".mp3",".m4a",".aac",".flac"],maxFileSizeMB:100,targetSampleRate:44100,targetChannels:1}},he={USER_ID:"bh_user_id",THEME:"bh_theme",UPLOAD_SESSIONS:"bh_upload_sessions",PROCESSING_MODE:"bh_processing_mode",USER_ID_CUSTOM:"bh_user_id_custom"},Se={HEALTH:"/health",SESSIONS_INITIATE:"/sessions/initiate",PREDICTIONS_SUBMIT:"/predictions/submit",PREDICTIONS_BY_USER:"/predictions",PREDICTIONS_BY_SESSION:"/predictions/sessions"},Ae={SKIP_TO_CONTENT_ID:"main-content",ANNOUNCEMENTS_ID:"a11y-announcements",FOCUS_TIMEOUT:100,DEBOUNCE_MS:300},Me=()=>{let s=localStorage.getItem(he.USER_ID);return(!s||s.trim().length===0)&&(s=ys(),localStorage.setItem(he.USER_ID,s)),s},nt=s=>{if(!s||s.trim().length===0)throw new Error("User ID cannot be empty");localStorage.setItem(he.USER_ID,s.trim())},rs=()=>{const s=ys();return localStorage.setItem(he.USER_ID,s),s},lt=()=>localStorage.getItem("bh_user_id_custom")==="true",ot=s=>{localStorage.setItem("bh_user_id_custom",s.toString())},dt=()=>{const s=localStorage.getItem(he.THEME);return s==="light"||s==="dark"?s:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},is=s=>{localStorage.setItem(he.THEME,s),s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},ct=()=>{const s=localStorage.getItem(he.PROCESSING_MODE);return s==="true"||s==="false"?s==="true":!1},mt=s=>{localStorage.setItem(he.PROCESSING_MODE,s.toString())},Ce=s=>{const t=new Date,a=new Date(s),r=t.getTime()-a.getTime(),c=Math.floor(r/(1e3*60)),m=Math.floor(r/(1e3*60*60)),p=Math.floor(r/(1e3*60*60*24));return c<1?"Just now":c<60?`${c}m ago`:m<24?`${m}h ago`:p<7?`${p}d ago`:a.toLocaleDateString()},Ne=s=>new Date(s).toLocaleString(),le=(s,t,a)=>({code:s,message:t,details:a,timestamp:new Date().toISOString()}),xt=s=>s instanceof TypeError&&s.message.includes("fetch")?!0:s instanceof Error?s.message.includes("Network")||s.message.includes("connection")||s.message.includes("timeout"):!1,gt=(s,t="polite")=>{const a=document.createElement("div");a.setAttribute("aria-live",t),a.setAttribute("aria-atomic","true"),a.className="sr-only",a.textContent=s,document.body.appendChild(a),setTimeout(()=>{document.body.removeChild(a)},1e3)},ht=(s,t=100)=>{setTimeout(()=>{const a=document.getElementById(s);a&&a.focus()},t)},bs=l.createContext(void 0),ut=()=>{const s=l.useContext(bs);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},pt=({children:s})=>{const[t,a]=l.useState(dt),r=p=>{a(p),is(p)},c=()=>{r(t==="light"?"dark":"light")};l.useEffect(()=>{is(t)},[t]),l.useEffect(()=>{const p=window.matchMedia("(prefers-color-scheme: dark)"),w=b=>{localStorage.getItem("bh_theme")||a(b.matches?"dark":"light")};return p.addEventListener("change",w),()=>p.removeEventListener("change",w)},[]);const m={theme:t,toggleTheme:c,setTheme:r};return e.jsx(bs.Provider,{value:m,children:s})},fs=()=>{const s=l.useCallback((r,c="polite")=>{gt(r,c)},[]),t=l.useCallback(r=>{s(r,"assertive")},[s]),a=l.useCallback(r=>{s(r,"polite")},[s]);return{announce:s,announceError:t,announceSuccess:a}},yt=()=>{const s=l.useCallback(a=>{const r=c=>{c.key==="Escape"&&(c.preventDefault(),a())};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),t=l.useCallback(a=>r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),a())},[]);return{handleEscape:s,handleEnterSpace:t}},bt=()=>({skipToMain:l.useCallback(()=>{ht(Ae.SKIP_TO_CONTENT_ID,Ae.FOCUS_TIMEOUT)},[])}),ft=({className:s=""})=>{const{theme:t,toggleTheme:a}=ut(),r=Ys(),{handleEnterSpace:c}=yt(),[m,p]=l.useState(!1),w=[{path:"/",label:"Dashboard",icon:"ðŸ "},{path:"/upload",label:"Upload & Analyze",icon:"ðŸ“¤"},{path:"/sessions",label:"Sessions",icon:"ðŸ“Š"},{path:"/predictions",label:"My Predictions",icon:"ðŸ“ˆ"},{path:"/health",label:"System Health",icon:"ðŸ¥"}],b=I=>I==="/"?r.pathname==="/":r.pathname.startsWith(I),x=()=>{p(!m)},y=()=>{p(!1)};return l.useEffect(()=>{p(!1)},[r.pathname]),e.jsx("header",{className:`bg-surface-light dark:bg-surface-dark border-b border-gray-200 dark:border-gray-700 ${s}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(J,{to:"/",className:"flex items-center space-x-3 text-xl font-bold text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 rounded-md px-2 py-1","aria-label":"Behavioral Health System - Go to Dashboard",children:[e.jsx("span",{className:"text-2xl",role:"img","aria-label":"Brain icon",children:"ðŸ§ "}),e.jsx("span",{className:"hidden sm:block",children:"Behavioral Health System"}),e.jsx("span",{className:"sm:hidden",children:"BHS"})]})}),e.jsx("nav",{className:"hidden md:flex space-x-1",role:"navigation","aria-label":"Main navigation",children:w.map(({path:I,label:v,icon:P})=>e.jsxs(J,{to:I,className:`
                  flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors
                  focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                  ${b(I)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                `,"aria-current":b(I)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:P}),e.jsx("span",{children:v})]},I))}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:a,onKeyDown:c(a),className:`\r
                p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":`Switch to ${t==="light"?"dark":"light"} mode`,type:"button",children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:t==="light"?"ðŸŒ™":"â˜€ï¸"})}),e.jsx("button",{onClick:x,onKeyDown:c(x),className:`\r
                md:hidden p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":m?"Close mobile menu":"Open mobile menu",type:"button",...m?{"aria-expanded":!0}:{"aria-expanded":!1},children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:m?"âœ•":"â˜°"})})]})]}),m&&e.jsx("div",{className:"md:hidden border-t border-gray-200 dark:border-gray-700 pt-4 pb-3",children:e.jsx("nav",{className:"space-y-1",role:"navigation","aria-label":"Mobile navigation",children:w.map(({path:I,label:v,icon:P})=>e.jsxs(J,{to:I,onClick:y,className:`
                    flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium transition-colors
                    focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                    ${b(I)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                  `,"aria-current":b(I)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:P}),e.jsx("span",{children:v})]},I))})})]})})},jt=({size:s=20,className:t="",...a})=>e.jsxs("svg",{width:s,height:s,viewBox:"0 0 23 23",className:t,"aria-label":"Microsoft",...a,children:[e.jsx("rect",{x:"1",y:"1",width:"10",height:"10",fill:"#f25022"}),e.jsx("rect",{x:"12",y:"1",width:"10",height:"10",fill:"#7fba00"}),e.jsx("rect",{x:"1",y:"12",width:"10",height:"10",fill:"#00a4ef"}),e.jsx("rect",{x:"12",y:"12",width:"10",height:"10",fill:"#ffb900"})]}),kt=({children:s,className:t=""})=>{const{skipToMain:a}=bt();return e.jsxs("div",{className:"min-h-screen bg-background-light dark:bg-background-dark",children:[e.jsx("a",{href:`#${Ae.SKIP_TO_CONTENT_ID}`,className:"skip-link",onClick:r=>{r.preventDefault(),a()},children:"Skip to main content"}),e.jsx(ft,{}),e.jsx("main",{id:Ae.SKIP_TO_CONTENT_ID,className:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 ${t}`,tabIndex:-1,children:s}),e.jsx("div",{id:Ae.ANNOUNCEMENTS_ID,className:"sr-only","aria-live":"polite","aria-atomic":"true"}),e.jsx("footer",{className:"bg-surface-light dark:bg-surface-dark border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(jt,{size:24,className:"opacity-80"}),e.jsx("span",{className:"text-sm text-text-muted-light dark:text-text-muted-dark font-medium",children:"Powered by Microsoft"})]}),e.jsxs("div",{className:"text-center text-sm text-text-muted-light dark:text-text-muted-dark",children:[e.jsxs("p",{children:["Behavioral Health System Â© ",new Date().getFullYear()]}),e.jsx("p",{className:"mt-1",children:"WCAG 2.2 AA Compliant â€¢ Section 508 Compliant"})]})]})})})]})};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),wt=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,r)=>r?r.toUpperCase():a.toLowerCase()),ns=s=>{const t=wt(s);return t.charAt(0).toUpperCase()+t.slice(1)},js=(...s)=>s.filter((t,a,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===a).join(" ").trim(),vt=s=>{for(const t in s)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var St={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=l.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:c="",children:m,iconNode:p,...w},b)=>l.createElement("svg",{ref:b,...St,width:t,height:t,stroke:s,strokeWidth:r?Number(a)*24/Number(t):a,className:js("lucide",c),...!m&&!vt(w)&&{"aria-hidden":"true"},...w},[...p.map(([x,y])=>l.createElement(x,y)),...Array.isArray(m)?m:[m]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=(s,t)=>{const a=l.forwardRef(({className:r,...c},m)=>l.createElement(At,{ref:m,iconNode:t,className:js(`lucide-${Nt(ns(s))}`,`lucide-${s}`,r),...c}));return a.displayName=ns(s),a};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],ze=$("activity",Ct);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Mt=$("arrow-left",_t);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],ge=$("brain",It);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ks=$("calendar",Rt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ls=$("chart-column",Et);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Ft=$("chart-pie",$t);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ns=$("chevron-down",Dt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ws=$("chevron-up",Tt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],de=$("circle-alert",Ut);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ne=$("circle-check-big",Ot);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],vs=$("circle-x",Lt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],be=$("clock",Pt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Be=$("download",zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Ht=$("eye-off",Bt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_e=$("eye",qt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]],Gt=$("file-audio",Vt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Kt=$("file-text",Wt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Jt=$("file",Yt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"M15 2a2 2 0 0 1 1.414.586l4 4A2 2 0 0 1 21 8v7a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z",key:"1vo8kb"}],["path",{d:"M15 2v4a2 2 0 0 0 2 2h4",key:"sud9ri"}],["path",{d:"M5 7a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 1.732-1",key:"l4dndm"}]],Qt=$("files",Zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ss=$("funnel",Xt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],As=$("heart",ea);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ke=$("info",sa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],aa=$("lightbulb",ta);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ia=$("loader-circle",ra);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Ye=$("pause",na);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],je=$("play",la);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],os=$("plus",oa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],X=$("refresh-cw",da);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ma=$("search",ca);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Je=$("shield-alert",xa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ha=$("target",ga);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Cs=$("trash-2",ua);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],ya=$("trending-down",pa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Ze=$("trending-up",ba);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],_s=$("triangle-alert",fa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ka=$("upload",ja);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ds=$("user",Na);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],cs=$("volume-2",wa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ue=$("x",va);class Sa{constructor(t){te(this,"baseUrl");this.baseUrl=t}async handleResponse(t){if(!t.ok){const a=await t.json().catch(()=>({}));throw le(`HTTP_${t.status}`,a.message||`HTTP ${t.status}: ${t.statusText}`,{status:t.status,statusText:t.statusText,data:a})}return t.json()}async request(t,a={}){try{const r=this.baseUrl.endsWith("/")?this.baseUrl.slice(0,-1):this.baseUrl,c=t.startsWith("/")?t:`/${t}`,m=`${r}${c}`,p={"Content-Type":"application/json",...a.headers},w=await fetch(m,{...a,headers:p});return this.handleResponse(w)}catch(r){throw xt(r)?le("NETWORK_ERROR","Unable to connect to the server. Please check your internet connection.",{originalError:r}):r instanceof Error&&"code"in r?r:le("UNKNOWN_ERROR","An unexpected error occurred",{originalError:r})}}async get(t){return this.request(t,{method:"GET"})}async post(t,a){return this.request(t,{method:"POST",body:a?JSON.stringify(a):void 0})}async put(t,a){return this.request(t,{method:"PUT",body:a?JSON.stringify(a):void 0})}async delete(t){return this.request(t,{method:"DELETE"})}}const ae=new Sa(ke.api.baseUrl),B={async checkHealth(){return ae.get(Se.HEALTH)},async initiateSession(s){return ae.post(Se.SESSIONS_INITIATE,s)},async submitPrediction(s){return ae.post(Se.PREDICTIONS_SUBMIT,s)},async getPredictionBySessionId(s){return ae.get(`${Se.PREDICTIONS_BY_SESSION}/${s}`)},async getUserPredictions(s){return ae.get(`${Se.PREDICTIONS_BY_USER}/${s}`)},async saveSessionData(s){return ae.post("sessions",s)},async getSessionData(s){return ae.get(`sessions/${s}`)},async getUserSessions(s){return ae.get(`sessions/users/${s}`)},async updateSessionData(s,t){return ae.put(`sessions/${s}`,t)},async deleteSessionData(s){return ae.delete(`sessions/${s}`)},async testConnection(){try{return await this.checkHealth(),{success:!0,message:"API connection successful"}}catch(s){return{success:!1,message:s.message||"Connection test failed"}}},async submitKintsugiWorkflow(s){return ae.post("/kintsugiworkflow",s)},async generateRiskAssessment(s){return ae.post(`sessions/${s}/risk-assessment`)},async getRiskAssessment(s){return ae.get(`sessions/${s}/risk-assessment`)}};class ms{constructor(t,a={}){te(this,"sessionId");te(this,"intervalMs");te(this,"maxAttempts");te(this,"backoffFactor");te(this,"currentAttempt",0);te(this,"timeoutId",null);te(this,"isPolling",!1);this.sessionId=t,this.intervalMs=a.intervalMs||ke.polling.intervalMs,this.maxAttempts=a.maxAttempts||ke.polling.maxAttempts,this.backoffFactor=a.backoffFactor||ke.polling.backoffFactor}async start(t,a,r){if(this.isPolling)return;this.isPolling=!0,this.currentAttempt=0;const c=async()=>{try{const m=await B.getPredictionBySessionId(this.sessionId);if(t(m),m.status==="succeeded"||m.status==="success"||m.status==="failed"){this.stop(),a(m);return}if(this.currentAttempt++,this.currentAttempt>=this.maxAttempts){this.stop(),r(le("POLLING_TIMEOUT","Prediction polling timed out. Please check the session manually.",{sessionId:this.sessionId,attempts:this.currentAttempt}));return}const p=this.intervalMs*Math.pow(this.backoffFactor,this.currentAttempt);this.timeoutId=window.setTimeout(c,p)}catch(m){this.stop(),r(m)}};await c()}stop(){this.isPolling=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}getStatus(){return{isPolling:this.isPolling,attempt:this.currentAttempt,maxAttempts:this.maxAttempts}}}B.submitKintsugiWorkflow.bind(B);const Ms={health:["health"],userPredictions:s=>["predictions","user",s],sessionPrediction:s=>["predictions","session",s],userSessions:s=>["sessions","user",s]},Is=()=>hs({queryKey:Ms.health,queryFn:()=>B.checkHealth(),retry:2,staleTime:3e4,refetchOnWindowFocus:!1}),Aa=s=>{const t=s||Me();return hs({queryKey:Ms.userSessions(t),queryFn:()=>B.getUserSessions(t),enabled:!!t,staleTime:3e4,refetchOnWindowFocus:!1})},Ca=()=>{const s=Me(),{announce:t}=fs(),{data:a,isLoading:r,error:c}=Is(),{data:m,isLoading:p}=Aa(s);l.useEffect(()=>{t("Dashboard page loaded","polite")},[t]);const w=[{title:"Upload & Analyze",description:"Upload audio files for behavioral health analysis",href:"/upload",icon:"ðŸ“¤",color:"primary"},{title:"View Sessions",description:"Browse all analysis sessions and their results",href:"/sessions",icon:"ðŸ“Š",color:"secondary"},{title:"My Predictions",description:"View your complete prediction history",href:"/predictions",icon:"ðŸ“ˆ",color:"accent"},{title:"System Health",description:"Check API status and system connectivity",href:"/health",icon:"ðŸ¥",color:"warning"}],b=x=>{const y="block p-6 rounded-lg border-2 transition-all hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2";switch(x){case"primary":return`${y} border-primary-200 bg-primary-50 hover:border-primary-300 hover:bg-primary-100 dark:border-primary-800 dark:bg-primary-900 dark:hover:border-primary-700 dark:hover:bg-primary-800 focus:ring-primary-500`;case"secondary":return`${y} border-secondary-200 bg-secondary-50 hover:border-secondary-300 hover:bg-secondary-100 dark:border-secondary-800 dark:bg-secondary-900 dark:hover:border-secondary-700 dark:hover:bg-secondary-800 focus:ring-secondary-500`;case"accent":return`${y} border-accent-200 bg-accent-50 hover:border-accent-300 hover:bg-accent-100 dark:border-accent-800 dark:bg-accent-900 dark:hover:border-accent-700 dark:hover:bg-accent-800 focus:ring-accent-500`;case"warning":return`${y} border-warning-200 bg-warning-50 hover:border-warning-300 hover:bg-warning-100 dark:border-teal-600 dark:bg-teal-800 dark:hover:border-teal-500 dark:hover:bg-teal-700 focus:ring-warning-500`;default:return`${y} border-gray-200 bg-gray-50 hover:border-gray-300 hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700 focus:ring-gray-500`}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-text-primary-light dark:text-text-primary-dark",children:"Behavioral Health System"}),e.jsx("p",{className:"mt-2 text-lg text-text-secondary-light dark:text-text-secondary-dark",children:"Audio-based mental health prediction and analysis"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:"Your User ID"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded-md",children:e.jsx("code",{className:"text-sm font-mono text-text-primary-light dark:text-text-primary-dark break-all",children:s})}),e.jsx("p",{className:"mt-2 text-sm text-text-muted-light dark:text-text-muted-dark",children:"This ID is automatically generated and stored locally to track your sessions."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-6",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:w.map(x=>e.jsx(J,{to:x.href,className:b(x.color),"aria-label":`${x.title}: ${x.description}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-3",role:"img","aria-hidden":"true",children:x.icon}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:x.title}),e.jsx("p",{className:"text-sm text-text-secondary-light dark:text-text-secondary-dark",children:x.description})]})},x.href))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Recent Activity"}),p?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Loading recent sessions..."})]}):!(m!=null&&m.sessions)||m.sessions.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",role:"img","aria-label":"No data",children:"ðŸ“­"}),e.jsxs("p",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:["No sessions yet.",e.jsx(J,{to:"/upload",className:"text-primary-600 dark:text-primary-400 hover:underline ml-1",children:"Upload your first audio file"})," to get started."]})]}):e.jsxs("div",{className:"space-y-3",children:[m.sessions.slice(0,3).map(x=>{var y,I;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`status-${x.status||"completed"}`,children:x.status||"completed"}),e.jsx("span",{className:"text-text-primary-light dark:text-text-primary-dark",children:x.audioFileName||((y=x.sessionId)==null?void 0:y.slice(0,8))||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",title:x.createdAt,children:x.createdAt?new Date(x.createdAt).toLocaleString():""})]}),e.jsx(J,{to:`/sessions/${x.sessionId||""}`,className:"text-primary-600 dark:text-primary-400 hover:underline text-sm flex items-center gap-1",title:"View session details","aria-label":`View details for session ${x.audioFileName||((I=x.sessionId)==null?void 0:I.slice(0,8))||"Unknown"}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})})]},x.sessionId)}),m.sessions.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs(J,{to:"/sessions",className:"text-primary-600 dark:text-primary-400 hover:underline",children:["View all ",m.sessions.length," sessions â†’"]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"System Status"}),r?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Checking system health..."})]}):c?e.jsxs("div",{className:"flex items-center space-x-2 text-error-600 dark:text-error-400",children:[e.jsx("span",{role:"img","aria-label":"Error",children:"âš ï¸"}),e.jsx("span",{children:"System health check failed"})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-success-600 dark:text-success-400",children:[e.jsx("span",{role:"img","aria-label":"Healthy",children:"âœ…"}),e.jsx("span",{children:"All systems operational"}),(a==null?void 0:a.checks)&&e.jsxs("span",{className:"text-text-muted-light dark:text-text-muted-dark",children:["(",Object.keys(a.checks).length," services checked)"]})]})]})]})};class _a{constructor(){te(this,"ffmpeg",null);te(this,"isLoaded",!1);te(this,"loadingPromise",null);this.ffmpeg=new Xs}async loadFFmpeg(){if(!this.isLoaded)return this.loadingPromise?this.loadingPromise:(this.loadingPromise=this.doLoadFFmpeg(),this.loadingPromise)}async doLoadFFmpeg(){if(!this.ffmpeg)throw le("FFMPEG_INIT_ERROR","Failed to initialize FFmpeg");try{const t="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";await this.ffmpeg.load({coreURL:await ss(`${t}/ffmpeg-core.js`,"text/javascript"),wasmURL:await ss(`${t}/ffmpeg-core.wasm`,"application/wasm")}),this.isLoaded=!0}catch(t){throw this.loadingPromise=null,le("FFMPEG_LOAD_ERROR","Failed to load FFmpeg. Please check your internet connection and try again.",{originalError:t})}}async convertAudio(t,a={outputFormat:"wav",sampleRate:44100,channels:1},r){try{if(r==null||r({stage:"loading",progress:0,message:"Loading audio processor..."}),await this.loadFFmpeg(),!this.ffmpeg)throw le("FFMPEG_NOT_LOADED","FFmpeg not properly loaded");this.ffmpeg.on("progress",({progress:y})=>{r==null||r({stage:"converting",progress:Math.round(y*100),message:`Converting audio... ${Math.round(y*100)}%`})}),r==null||r({stage:"converting",progress:0,message:"Preparing audio file..."});const c="input."+this.getFileExtension(t.name);await this.ffmpeg.writeFile(c,await et(t));const m=`output.${a.outputFormat}`,p=["-i",c,"-ac",a.channels.toString(),"-ar",a.sampleRate.toString(),"-f",a.outputFormat,m];await this.ffmpeg.exec(p);const w=await this.ffmpeg.readFile(m),b=new Blob([w],{type:`audio/${a.outputFormat}`}),x=new File([b],`${this.getFileNameWithoutExtension(t.name)}.${a.outputFormat}`,{type:`audio/${a.outputFormat}`});return await this.ffmpeg.deleteFile(c),await this.ffmpeg.deleteFile(m),r==null||r({stage:"completed",progress:100,message:"Audio conversion completed"}),x}catch(c){throw le("AUDIO_CONVERSION_ERROR","Failed to convert audio file. Please try with a different file.",{originalError:c,fileName:t.name,fileSize:t.size,fileType:t.type})}}getFileExtension(t){const a=t.lastIndexOf(".");return a!==-1?t.slice(a+1).toLowerCase():""}getFileNameWithoutExtension(t){const a=t.lastIndexOf(".");return a!==-1?t.slice(0,a):t}async isFormatSupported(t){try{await this.loadFFmpeg();const a=["wav","mp3","mp4","m4a","aac","flac","ogg"],r=this.getFileExtension(t.name);return a.includes(r)}catch{return!1}}dispose(){this.ffmpeg&&(this.ffmpeg.terminate(),this.ffmpeg=null),this.isLoaded=!1,this.loadingPromise=null}}let He=null;const Ma=()=>(He||(He=new _a),He),qe=async(s,t)=>{const r=await Ma().convertAudio(s,{outputFormat:"wav",sampleRate:44100,channels:1},t?c=>t(c.progress):void 0);return new Blob([r],{type:"audio/wav"})};class Ia{constructor(t){te(this,"containerClient",null);te(this,"sasUrl");if(this.sasUrl=t||ke.azure.blobSasUrl,!this.sasUrl)throw le("AZURE_CONFIG_ERROR","Azure Blob Storage SAS URL not configured")}getContainerClient(){if(!this.containerClient)try{const t=new st(this.sasUrl);this.containerClient=t.getContainerClient(ke.azure.containerName)}catch(t){throw le("AZURE_CLIENT_ERROR","Failed to initialize Azure Blob Storage client",{originalError:t})}return this.containerClient}async uploadFile(t,a,r){try{r==null||r({progress:0,stage:"preparing",message:"Preparing upload..."});const c=this.getContainerClient(),m=a||this.generateBlobName(t.name),p=c.getBlockBlobClient(m);r==null||r({progress:10,stage:"uploading",message:"Starting upload..."}),await p.uploadData(t,{blobHTTPHeaders:{blobContentType:t.type},onProgress:b=>{const x=b.loadedBytes&&t.size?Math.round(b.loadedBytes/t.size*90)+10:50;r==null||r({progress:x,stage:"uploading",message:`Uploading... ${x}%`})}});const w=p.url;return r==null||r({progress:100,stage:"completed",message:"Upload completed"}),{url:w,fileName:m,size:t.size}}catch(c){throw le("UPLOAD_ERROR","Failed to upload file to Azure Blob Storage",{originalError:c,fileName:t.name,fileSize:t.size})}}generateBlobName(t){const a=new Date().toISOString().replace(/[:.]/g,"-"),r=Math.random().toString(36).substring(2,8),c=t.split(".").pop()||"wav";return`audio/${a}-${r}.${c}`}async testConnection(){try{return await this.getContainerClient().getProperties(),{success:!0,message:"Azure Blob Storage connection successful"}}catch{return{success:!1,message:"Failed to connect to Azure Blob Storage. Please check your SAS URL configuration."}}}async deleteFile(t){try{await this.getContainerClient().getBlockBlobClient(t).deleteIfExists()}catch(a){throw le("DELETE_ERROR","Failed to delete file from Azure Blob Storage",{originalError:a,fileName:t})}}}let Oe=null;const Ra=s=>((!Oe||s&&s!==Oe.sasUrl)&&(Oe=new Ia(s)),Oe),Ve=async(s,t,a)=>{const r=Ra(),c=s instanceof File?s:new File([s],t,{type:s.type});return(await r.uploadFile(c,t,a?p=>a(p.progress):void 0)).url},Ie=()=>{const s=l.useRef(null),t=l.useCallback(w=>{if(!s.current){const b=document.createElement("div");b.setAttribute("aria-live","polite"),b.setAttribute("aria-atomic","true"),b.style.position="absolute",b.style.left="-10000px",b.style.width="1px",b.style.height="1px",b.style.overflow="hidden",document.body.appendChild(b),s.current=b}s.current.textContent="",setTimeout(()=>{s.current&&(s.current.textContent=w)},100)},[]),a={focusById:w=>{const b=document.getElementById(w);b&&b.focus()},focusFirstInContainer:w=>{const x=w.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];x&&x.focus()},trapFocus:w=>{const b=w.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),x=b[0],y=b[b.length-1],I=v=>{v.key==="Tab"&&(v.shiftKey?document.activeElement===x&&(y.focus(),v.preventDefault()):document.activeElement===y&&(x.focus(),v.preventDefault()))};return w.addEventListener("keydown",I),()=>{w.removeEventListener("keydown",I)}}},r={handleArrowNavigation:(w,b,x,y)=>{var v;let I=x;switch(w.key){case"ArrowDown":w.preventDefault(),I=x<b.length-1?x+1:0;break;case"ArrowUp":w.preventDefault(),I=x>0?x-1:b.length-1;break;case"Home":w.preventDefault(),I=0;break;case"End":w.preventDefault(),I=b.length-1;break;default:return}y(I),(v=b[I])==null||v.focus()},handleEscape:(w,b)=>{w.key==="Escape"&&(w.preventDefault(),b())}},c=l.useCallback((w="element")=>`${w}-${Math.random().toString(36).substr(2,9)}`,[]),m=l.useCallback(()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),p=l.useCallback((w,b,x)=>{const y={};return w||(y["aria-invalid"]="true",b&&x&&(y["aria-describedby"]=x)),y},[]);return{announceToScreenReader:t,focusManagement:a,keyboardNavigation:r,generateId:c,prefersReducedMotion:m,getValidationAttributes:p}},Ea=()=>{const[s,t]=l.useState([]),[a,r]=l.useState(()=>ct()),[c,m]=l.useState({}),[p,w]=l.useState({}),[b,x]=l.useState({}),[y,I]=l.useState(!1),[v,P]=l.useState(null),[S,A]=l.useState({stage:"idle",progress:0,message:""}),[N,H]=l.useState(null),[re,Z]=l.useState(!1),[oe,g]=l.useState(0),[M,n]=l.useState(null),[o,f]=l.useState({age:"",gender:"",race:"",ethnicity:"",language:"",weight:"",zipcode:"",sessionNotes:""}),[u,h]=l.useState(null),[_,z]=l.useState([]),[q,ce]=l.useState(()=>lt()),[V,Y]=l.useState(""),[Q,ee]=l.useState(null),j=Me(),F=l.useRef(null),G=l.useRef(null),{announceToScreenReader:D}=Ie(),U=l.useCallback((i,d,k)=>{const C=Date.now().toString()+Math.random().toString(36).substr(2,9),R={id:C,type:i,title:d,message:k,timestamp:Date.now()};z(W=>[...W,R]),setTimeout(()=>{z(W=>W.filter(ie=>ie.id!==C))},i==="error"?8e3:5e3)},[]),Re=l.useCallback(i=>{z(d=>d.filter(k=>k.id!==i))},[]),ue=l.useCallback(()=>{t([]),P(null),A({stage:"idle",progress:0,message:""}),H(null),w({}),m({}),h(null),Z(!1),g(0),n(null),I(!1)},[]),we=l.useCallback(()=>{ce(i=>{const d=!i;if(ot(d),ee(null),d)Y(j),D("Switched to custom User ID mode");else{Y("");const k=rs();D(`Switched to auto-generated mode. New User ID: ${k}`)}return d})},[j,D]),Rs=l.useCallback(i=>{Y(i),ee(null)},[]),Es=l.useCallback(()=>{const i=V.trim();if(!i){ee("User ID cannot be empty");return}if(i.length<3){ee("User ID must be at least 3 characters long");return}if(i.length>100){ee("User ID must be less than 100 characters");return}if(/[<>"/\\|?*\x00-\x1f]/.test(i)){ee('User ID contains invalid characters. Please avoid special characters like < > " / \\ | ? *');return}try{nt(i),ee(null),D(`Custom User ID applied: ${i}`),window.location.reload()}catch(k){const C=k instanceof Error?k.message:"Failed to set User ID";ee(C)}},[V,D]),$s=l.useCallback(()=>{const i=rs();D(`New User ID generated: ${i}`),window.location.reload()},[D]),Fs=()=>Date.now().toString()+Math.random().toString(36).substr(2,9),Qe=l.useCallback(i=>{const d=Fs(),k=URL.createObjectURL(i),C={id:d,file:i,url:k};a?(t(E=>[...E,C]),x(E=>({...E,[d]:"ready"})),m(E=>({...E,[d]:{stage:"idle",progress:0,message:"Ready to process"}}))):P(C),D(`Audio file selected: ${i.name}`);const R=new Audio(k);R.addEventListener("loadedmetadata",()=>{a?t(E=>E.map(W=>W.id===d?{...W,duration:R.duration}:W)):P(E=>E?{...E,duration:R.duration}:null)})},[a,D]),Ds=l.useCallback(i=>{a&&(t(d=>{const k=d.find(C=>C.id===i);return k&&URL.revokeObjectURL(k.url),d.filter(C=>C.id!==i)}),m(d=>{const{[i]:k,...C}=d;return C}),w(d=>{const{[i]:k,...C}=d;return C}),x(d=>{const{[i]:k,...C}=d;return C}))},[a]),Ee=l.useCallback(i=>{const d=i.target.files;!d||d.length===0||Array.from(d).forEach(k=>{const C=["audio/wav","audio/wave","audio/x-wav","audio/mp3","audio/mpeg","audio/mp4","audio/m4a","audio/x-m4a","audio/mp4a-latm","audio/aac","audio/x-aac","audio/flac","audio/x-flac"],R=k.name.toLowerCase(),W=[".wav",".mp3",".m4a",".aac",".flac"].some(pe=>R.endsWith(pe));if(!C.includes(k.type)&&!W){h(`Unsupported file type for ${k.name}. Please select supported audio files (WAV, MP3, M4A, AAC, or FLAC)`),U("error","Unsupported File",`${k.name} is not a supported audio file format`),D(`Error: Unsupported file format selected for ${k.name}`);return}const me=50*1024*1024;if(k.size>me){h(`File ${k.name} is too large. File size must be less than 50MB`),U("error","File Too Large",`${k.name} size must be less than 50MB`),D(`Error: File ${k.name} is too large`);return}Qe(k),h(null)})},[D,Qe,U]),Ts=l.useCallback(i=>{i.preventDefault()},[]),Us=l.useCallback(i=>{i.preventDefault();const d=i.dataTransfer.files;d.length>0&&Ee({target:{files:d}})},[Ee]),Os=l.useCallback(()=>{r(i=>{const d=!i;return mt(d),ue(),d})},[ue]),Ls=l.useCallback(()=>{F.current&&(re?(F.current.pause(),Z(!1),D("Audio paused")):(F.current.play(),Z(!0),D("Audio playing")))},[re,D]),Ps=l.useCallback(()=>{F.current&&g(F.current.currentTime)},[]),$e=l.useCallback(i=>{const d=Math.floor(i/60),k=Math.floor(i%60);return`${d}:${k.toString().padStart(2,"0")}`},[]),fe=l.useCallback(()=>{const i=[];if(o.age){const d=parseInt(o.age);(isNaN(d)||d<18||d>130)&&i.push("Age must be between 18 and 130")}if(o.gender&&(["male","female","non-binary","transgender female","transgender male","other","prefer"].includes(o.gender)||i.push("Invalid gender. Must be: male, female, non-binary, transgender female, transgender male, other, or prefer")),o.race&&(["white","black or african-american","asian","american indian or alaskan native","native Hawaiian or pacific islander","two or more races","other","prefer not to say"].includes(o.race)||i.push("Invalid race. Must be: white, black or african-american, asian, american indian or alaskan native, native Hawaiian or pacific islander, two or more races, other, prefer not to say")),o.ethnicity&&(["Hispanic, Latino, or Spanish Origin","Not Hispanic, Latino, or Spanish Origin"].includes(o.ethnicity)||i.push("Invalid ethnicity. Must be: Hispanic, Latino, or Spanish Origin | Not Hispanic, Latino, or Spanish Origin")),o.zipcode&&(/^[a-zA-Z0-9]{1,10}$/.test(o.zipcode)||i.push("Zipcode must be alphanumeric and contain no more than 10 characters")),o.weight){const d=parseInt(o.weight);(isNaN(d)||d<10||d>1e3)&&i.push("Weight must be between 10 and 1000 pounds (lbs)")}return i},[o]),Fe=l.useCallback(()=>{const i={};let d=!1;return o.age&&(i.age=parseInt(o.age),d=!0),o.gender&&(i.gender=o.gender,d=!0),o.race&&(i.race=o.race,d=!0),o.ethnicity&&(i.ethnicity=o.ethnicity,d=!0),(o.language==="true"||o.language==="false")&&(i.language=o.language==="true",d=!0),o.weight&&(i.weight=parseInt(o.weight),d=!0),o.zipcode&&(i.zipcode=o.zipcode,d=!0),d?i:void 0},[o]),zs=l.useCallback(async()=>{if(a){if(s.length===0||!j.trim()){h("Please select audio files. User ID is automatically generated."),U("error","Missing Information","Please select audio files. User ID is automatically generated.");return}await Xe()}else{if(!v||!j.trim()){h("Please select an audio file. User ID is automatically generated."),U("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}await Hs()}},[v,s,j,a]),De=l.useCallback(async(i,d)=>{try{m(L=>({...L,[i]:{stage:"initiating",progress:5,message:"Initiating session..."}}));const k=Fe(),C={userid:j.trim(),is_initiated:!0};k&&(C.metadata=k);const R=await B.initiateSession(C),E={sessionId:R.sessionId,userId:j.trim()};m(L=>({...L,[i]:{stage:"initiating",progress:10,message:"Saving session data..."}}));const W={sessionId:R.sessionId,userId:j.trim(),userMetadata:k,audioFileName:d.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await B.saveSessionData(W)}catch{}m(L=>({...L,[i]:{stage:"converting",progress:15,message:"Converting audio to required format..."}}));const ie=await qe(d.file,L=>{m(T=>({...T,[i]:{stage:"converting",progress:15+L*.25,message:`Converting audio... ${Math.round(L)}%`}}))});m(L=>({...L,[i]:{stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}}));const me=`${j}_${E.sessionId}_${Date.now()}.wav`,pe=await Ve(ie,me,L=>{m(T=>({...T,[i]:{stage:"uploading",progress:40+L*.25,message:`Uploading... ${Math.round(L)}%`}}))});m(L=>({...L,[i]:{stage:"submitting",progress:65,message:"Submitting for analysis..."}}));try{const L={...W,audioUrl:pe,audioFileName:me,status:"processing",updatedAt:new Date().toISOString()};await B.updateSessionData(E.sessionId,L)}catch(L){console.warn("Failed to update session data with audio info:",L)}await B.submitPrediction({userId:j.trim(),sessionid:E.sessionId,audioFileUrl:pe,audioFileName:me}),m(L=>({...L,[i]:{stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}}));const se=new ms(E.sessionId);await new Promise((L,T)=>{se.start(O=>{const ve=O.status==="processing"?80:O.status==="success"?95:70;m(xe=>({...xe,[i]:{stage:"analyzing",progress:ve,message:`Analysis ${O.status}...`}})),O.predictError&&U("error","Prediction Error",`${O.predictError.error}: ${O.predictError.message}`)},O=>{if(O.predictError){U("error","Analysis Failed",`The analysis completed with an error: ${O.predictError.error} - ${O.predictError.message}`),m(xe=>({...xe,[i]:{stage:"error",progress:0,message:"Analysis failed with errors"}})),T(new Error(`Prediction error: ${O.predictError.error}`));return}const ve={sessionId:E.sessionId,depressionScore:O.predictedScoreDepression?parseFloat(O.predictedScoreDepression):0,riskLevel:O.predictedScoreDepression&&parseFloat(O.predictedScoreDepression)>.7?"high":O.predictedScoreDepression&&parseFloat(O.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",O.predictedScoreDepression?`Depression score: ${O.predictedScoreDepression}`:"",O.predictedScoreAnxiety?`Anxiety score: ${O.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(xe=>xe.trim()!==""),timestamp:O.updatedAt,audioUrl:pe,rawApiResponse:O};m(xe=>({...xe,[i]:{stage:"complete",progress:100,message:"Analysis complete!"}})),w(xe=>({...xe,[i]:ve})),L()},O=>{T(O)})})}catch(k){throw console.error(`Processing error for file ${i}:`,k),m(C=>({...C,[i]:{stage:"error",progress:0,message:"Processing failed"}})),k}},[j,Fe,B,Ve,qe,U]),Xe=l.useCallback(async()=>{I(!0),h(null);const i=fe();if(i.length>0){h(`Validation error: ${i.join(", ")}`),U("error","Validation Error",i.join(", ")),I(!1);return}const d=s.filter(R=>b[R.id]==="ready");if(d.length===0){U("info","No Files Ready","No files are ready to process"),I(!1);return}const k=d.length;let C=0;try{for(const R of d){C++,U("info","Processing File",`Processing ${R.file.name} (${C}/${k})`),x(E=>({...E,[R.id]:"processing"}));try{await De(R.id,R),x(E=>({...E,[R.id]:"complete"})),U("success","File Complete",`${R.file.name} processed successfully`)}catch(E){console.error(`Error processing ${R.file.name}:`,E);const W=E instanceof Error?E.message:"An unexpected error occurred";U("error","File Failed",`Failed to process ${R.file.name}: ${W}`),x(ie=>({...ie,[R.id]:"error"})),m(ie=>({...ie,[R.id]:{stage:"error",progress:0,message:`Failed: ${W}`}}))}}U("success","Batch Complete",`Processed ${C} file${C!==1?"s":""}`),D(`Batch processing complete. ${C} files processed.`)}catch(R){console.error("Batch processing error:",R);const E=R instanceof Error?R.message:"An unexpected error occurred";h(E),U("error","Batch Failed",E),D(`Error: ${E}`)}finally{I(!1)}},[s,b,fe,U,D,De]),Bs=l.useCallback(async i=>{const d=s.find(C=>C.id===i);if(!d)return;const k=fe();if(k.length>0){h(`Validation error: ${k.join(", ")}`),U("error","Validation Error",k.join(", "));return}x(C=>({...C,[i]:"processing"}));try{await De(i,d),x(C=>({...C,[i]:"complete"})),U("success","File Complete",`${d.file.name} processed successfully`)}catch(C){console.error(`Error processing ${d.file.name}:`,C);const R=C instanceof Error?C.message:"An unexpected error occurred";U("error","File Failed",`Failed to process ${d.file.name}: ${R}`),x(E=>({...E,[i]:"error"})),m(E=>({...E,[i]:{stage:"error",progress:0,message:`Failed: ${R}`}}))}},[s,fe,U,De]),Hs=l.useCallback(async()=>{if(!v||!j.trim()){h("Please select an audio file. User ID is automatically generated."),U("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}const i=fe();if(i.length>0){h(`Validation error: ${i.join(", ")}`),U("error","Validation Error",i.join(", "));return}try{h(null),A({stage:"initiating",progress:5,message:"Initiating session..."}),D("Starting analysis process - initiating session");const d=Fe(),k={userid:j.trim(),is_initiated:!0};d&&(k.metadata=d);const C=await B.initiateSession(k),R={sessionId:C.sessionId,userId:j.trim()};A({stage:"initiating",progress:10,message:"Saving session data..."});const E={sessionId:C.sessionId,userId:j.trim(),userMetadata:d,audioFileName:v.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await B.saveSessionData(E)}catch{}A({stage:"converting",progress:15,message:"Converting audio to required format..."}),D("Session created successfully, now converting audio");const W=await qe(v.file,se=>{A({stage:"converting",progress:15+se*.25,message:`Converting audio... ${Math.round(se)}%`})});A({stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}),D("Audio converted successfully, now uploading");const ie=`${j}_${R.sessionId}_${Date.now()}.wav`,me=await Ve(W,ie,se=>{A({stage:"uploading",progress:40+se*.25,message:`Uploading... ${Math.round(se)}%`})});A({stage:"submitting",progress:65,message:"Submitting for analysis..."}),D("Upload complete, submitting for behavioral health analysis");try{const se={...E,audioUrl:me,audioFileName:ie,status:"processing",updatedAt:new Date().toISOString()};await B.updateSessionData(R.sessionId,se)}catch(se){console.warn("Failed to update session data with audio info:",se)}await B.submitPrediction({userId:j.trim(),sessionid:R.sessionId,audioFileUrl:me,audioFileName:ie}),A({stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}),D("Prediction submitted, analysis in progress");const pe=new ms(R.sessionId);await new Promise((se,L)=>{pe.start(T=>{const O=T.status==="processing"?80:T.status==="success"?95:70;A({stage:"analyzing",progress:O,message:`Analysis ${T.status}...`}),T.predictError&&U("error","Prediction Error",`${T.predictError.error}: ${T.predictError.message}`)},T=>{if(T.predictError){U("error","Analysis Failed",`The analysis completed with an error: ${T.predictError.error} - ${T.predictError.message}`),A({stage:"error",progress:0,message:"Analysis failed with errors"}),L(new Error(`Prediction error: ${T.predictError.error}`));return}const O={sessionId:R.sessionId,depressionScore:T.predictedScoreDepression?parseFloat(T.predictedScoreDepression):0,riskLevel:T.predictedScoreDepression&&parseFloat(T.predictedScoreDepression)>.7?"high":T.predictedScoreDepression&&parseFloat(T.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",T.predictedScoreDepression?`Depression score: ${T.predictedScoreDepression}`:"",T.predictedScoreAnxiety?`Anxiety score: ${T.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(ve=>ve.trim()!==""),timestamp:T.updatedAt,audioUrl:me,rawApiResponse:T};A({stage:"complete",progress:100,message:"Analysis complete!"}),H(O),U("success","Analysis Complete","Your behavioral health analysis has been completed successfully."),D("Behavioral health analysis completed successfully"),se()},T=>{U("error","Analysis Error",T.message||"An unexpected error occurred during analysis."),L(T)})})}catch(d){console.error("Processing error:",d);const k=d instanceof Error?d.message:"An unexpected error occurred";h(k),A({stage:"error",progress:0,message:"Processing failed"}),U("error","Processing Failed",k),D(`Error: ${k}`)}},[v,j,D,fe,Fe]),es=l.useCallback(i=>{switch(i){case"error":return"bg-red-500";case"complete":return"bg-green-500";default:return"bg-blue-500"}},[]);return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Processing Mode:"}),e.jsxs("div",{className:"relative inline-flex items-center",children:[e.jsx("button",{onClick:Os,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 ${a?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500"}`,"aria-label":`Switch to ${a?"single file":"multi-file"} mode`,children:e.jsx("span",{className:`inline-flex h-6 w-6 transform rounded-full bg-white items-center justify-center transition-transform ${a?"translate-x-9":"translate-x-1"}`,children:a?e.jsx(Qt,{className:"h-3 w-3 text-blue-600"}):e.jsx(Jt,{className:"h-3 w-3 text-gray-600"})})}),e.jsxs("div",{className:"ml-3 flex items-center space-x-4",children:[e.jsx("span",{className:`text-sm font-medium ${a?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:"Single"}),e.jsx("span",{className:`text-sm font-medium ${a?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"}`,children:"Multi"})]})]})]}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${a?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),"Batch Processing"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v8H4V6z",clipRule:"evenodd"})}),"Single File"]})})]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Upload & Analyze Audio"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Upload ",a?"multiple audio files":"an audio file"," for behavioral health analysis using AI-powered speech pattern recognition"]}),e.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-lg text-sm ${a?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M9 12a1 1 0 000 2h2a1 1 0 100-2H9z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 0v12h8V4H6z",clipRule:"evenodd"})]}),"Process multiple files with individual controls and batch options"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Upload and analyze one file at a time with detailed progress tracking"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Patient Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 lg:col-span-3 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"User ID Management"}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 p-4 rounded-md border space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current User ID:"}),e.jsx("code",{className:"text-sm font-mono text-gray-900 dark:text-gray-100 break-all block bg-white dark:bg-gray-800 p-2 rounded border",children:j})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:we,className:"px-3 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors","aria-describedby":"user-id-mode-help",children:q?"Switch to Auto-Generated":"Use Custom User ID"}),!q&&e.jsx("button",{onClick:$s,className:"px-3 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800 transition-colors",title:"Generate a new random User ID",children:"Generate New ID"})]}),q&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:V,onChange:i=>Rs(i.target.value),placeholder:"Enter custom User ID (any unique string)",className:"flex-1 px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-describedby":"custom-user-id-help","aria-invalid":Q?"true":"false"}),e.jsx("button",{onClick:Es,disabled:!V.trim(),className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Apply"})]}),Q&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",role:"alert",children:Q}),e.jsx("p",{id:"custom-user-id-help",className:"text-xs text-gray-500 dark:text-gray-400",children:'Any unique string (3-100 characters). Examples: "patient-001", "john.doe@clinic", "study-participant-42"'})]}),e.jsx("p",{id:"user-id-mode-help",className:"text-xs text-gray-500 dark:text-gray-400",children:q?"Custom mode: Use any unique identifier for tracking (e.g., patient ID, username, study code)":"Auto mode: System generates unique UUIDs automatically"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age (Optional)"}),e.jsx("input",{type:"number",id:"age",value:o.age,onChange:i=>f(d=>({...d,age:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Age in years",min:"1",max:"150"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight (Optional)"}),e.jsx("input",{type:"number",id:"weight",value:o.weight,onChange:i=>f(d=>({...d,weight:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Weight in lbs",min:"1",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender (Optional)"}),e.jsxs("select",{id:"gender",value:o.gender,onChange:i=>f(d=>({...d,gender:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"non-binary",children:"Non-binary"}),e.jsx("option",{value:"transgender female",children:"Transgender female"}),e.jsx("option",{value:"transgender male",children:"Transgender male"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer",children:"Prefer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"race",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race (Optional)"}),e.jsxs("select",{id:"race",value:o.race,onChange:i=>f(d=>({...d,race:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select race"}),e.jsx("option",{value:"white",children:"White"}),e.jsx("option",{value:"black or african-american",children:"Black or African-American"}),e.jsx("option",{value:"asian",children:"Asian"}),e.jsx("option",{value:"american indian or alaskan native",children:"American Indian or Alaskan Native"}),e.jsx("option",{value:"native Hawaiian or pacific islander",children:"Native Hawaiian or Pacific Islander"}),e.jsx("option",{value:"two or more races",children:"Two or more races"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer not to say",children:"Prefer not to say"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ethnicity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity (Optional)"}),e.jsxs("select",{id:"ethnicity",value:o.ethnicity,onChange:i=>f(d=>({...d,ethnicity:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select ethnicity"}),e.jsx("option",{value:"Hispanic, Latino, or Spanish Origin",children:"Hispanic, Latino, or Spanish Origin"}),e.jsx("option",{value:"Not Hispanic, Latino, or Spanish Origin",children:"Not Hispanic, Latino, or Spanish Origin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language (Optional)"}),e.jsxs("select",{id:"language",value:o.language,onChange:i=>f(d=>({...d,language:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select language"}),e.jsx("option",{value:"true",children:"English"}),e.jsx("option",{value:"false",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"zipcode",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code (Optional)"}),e.jsx("input",{type:"text",id:"zipcode",value:o.zipcode,onChange:i=>f(d=>({...d,zipcode:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter ZIP code",pattern:"[0-9]{5}(-[0-9]{4})?",title:"Enter a valid ZIP code (e.g., 12345 or 12345-6789)"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{htmlFor:"sessionNotes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes (Optional)"}),e.jsx("textarea",{id:"sessionNotes",value:o.sessionNotes,onChange:i=>f(d=>({...d,sessionNotes:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",rows:3,placeholder:"Additional notes about this session or patient context"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Audio File Upload ",a&&e.jsx("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:"(Multi-File Mode)"})]}),!a&&!v||a&&s.length===0?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors",onDragOver:Ts,onDrop:Us,children:[e.jsx(ka,{className:"mx-auto h-12 w-12 text-gray-400 mb-4","aria-hidden":"true"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{type:"button",onClick:()=>{var i;return(i=G.current)==null?void 0:i.click()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Select Audio File",a?"s":""]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["or drag and drop ",a?"files":"file"," here"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Supported formats: WAV, MP3, M4A, AAC, FLAC (max 50MB each)",a&&e.jsx("br",{}),a&&"You can select multiple files at once"]}),e.jsx("input",{ref:G,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:Ee,multiple:a,"aria-label":`Select audio file${a?"s":""} for analysis`})]}):e.jsxs("div",{className:"space-y-4",children:[!a&&v&&e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(cs,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:v.file.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(v.file.size/1024/1024).toFixed(2)," MB",v.duration&&` â€¢ ${$e(v.duration)}`]})]})]}),e.jsx("button",{type:"button",onClick:ue,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Remove selected file",children:e.jsx(Ue,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:Ls,className:"flex items-center justify-center w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800","aria-label":re?"Pause audio":"Play audio",children:re?e.jsx(Ye,{className:"h-5 w-5","aria-hidden":"true"}):e.jsx(je,{className:"h-5 w-5 ml-0.5","aria-hidden":"true"})}),e.jsx("div",{className:"flex-1",children:v.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[$e(oe)," / ",$e(v.duration)]})})]}),v.duration&&e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-200",style:{width:`${oe/v.duration*100}%`},role:"progressbar","aria-label":"Audio playback progress","aria-valuenow":oe,"aria-valuemin":0,"aria-valuemax":v.duration})})]}),e.jsx("audio",{ref:F,src:v.url,onTimeUpdate:Ps,onEnded:()=>Z(!1),onPlay:()=>Z(!0),onPause:()=>Z(!1),className:"hidden"})]}),a&&s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Selected Files (",s.length,")"]}),e.jsxs("button",{type:"button",onClick:()=>{var i;return(i=G.current)==null?void 0:i.click()},className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Add More Files"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(i=>{const d=b[i.id]||"ready",k=c[i.id];return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[e.jsx(cs,{className:"h-4 w-4 text-blue-500 flex-shrink-0","aria-hidden":"true"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:i.file.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(i.file.size/1024/1024).toFixed(2)," MB",i.duration&&` â€¢ ${$e(i.duration)}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d==="ready"&&e.jsxs("button",{type:"button",onClick:()=>Bs(i.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-offset-gray-800","aria-label":`Start processing ${i.file.name}`,children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),"Start"]}),d==="processing"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"Processing..."}),d==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Complete"]}),d==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]}),e.jsx("button",{type:"button",onClick:()=>Ds(i.id),className:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400","aria-label":`Remove ${i.file.name}`,children:e.jsx(Cs,{className:"h-4 w-4"})})]})]}),k&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:k.message}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[Math.round(k.progress),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 mt-1",children:e.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${es(k.stage)}`,style:{width:`${k.progress}%`}})})]})]},i.id)})}),e.jsx("input",{ref:G,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:Ee,multiple:a,"aria-label":"Select additional audio files for analysis"})]})]})]}),u&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",role:"alert",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"h-5 w-5 text-red-500 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-red-700 dark:text-red-300",children:u})]})}),!a&&S.stage!=="idle"&&!N&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Processing Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:S.message}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[Math.round(S.progress),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${es(S.stage)}`,style:{width:`${S.progress}%`},role:"progressbar","aria-label":"Processing progress","aria-valuenow":S.progress,"aria-valuemin":0,"aria-valuemax":100})}),S.stage==="analyzing"&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(ia,{className:"h-4 w-4 animate-spin mr-2","aria-hidden":"true"}),"This may take a few minutes..."]})]})]}),N&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ne,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Analysis Results"})]}),N.rawApiResponse&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"API Response Details"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Predicted Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.predicted_score_anxiety||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`font-mono ${N.rawApiResponse.status==="success"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:N.rawApiResponse.status||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Model Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Category:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.model_category||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Granularity:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.model_granularity||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Calibrated:"}),e.jsx("span",{className:`font-mono ${N.rawApiResponse.is_calibrated?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"}`,children:N.rawApiResponse.is_calibrated?"Yes":"No"})]})]})]}),N.rawApiResponse.actual_score&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Clinical Assessment Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[N.rawApiResponse.actual_score.depression_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.actual_score.depression_binary||"N/A"})]}),N.rawApiResponse.actual_score.anxiety_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:N.rawApiResponse.actual_score.anxiety_binary||"N/A"})]}),N.rawApiResponse.actual_score.phq_9&&N.rawApiResponse.actual_score.phq_9.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-9:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",N.rawApiResponse.actual_score.phq_9.join(", "),"]"]})]}),N.rawApiResponse.actual_score.phq_2&&N.rawApiResponse.actual_score.phq_2.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-2:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",N.rawApiResponse.actual_score.phq_2.join(", "),"]"]})]}),N.rawApiResponse.actual_score.gad_7&&N.rawApiResponse.actual_score.gad_7.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"GAD-7:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",N.rawApiResponse.actual_score.gad_7.join(", "),"]"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Created:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:N.rawApiResponse.created_at?new Date(N.rawApiResponse.created_at).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Updated:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:N.rawApiResponse.updated_at?new Date(N.rawApiResponse.updated_at).toLocaleString():"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Session Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:N.sessionId})]})})]}),N.rawApiResponse.predict_error&&e.jsxs("div",{className:"border-l-4 border-red-400 bg-red-50 dark:bg-red-900/20 p-3",children:[e.jsx("h5",{className:"text-sm font-medium text-red-700 dark:text-red-300 mb-1",children:"Prediction Error"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Error Type:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100",children:N.rawApiResponse.predict_error.error})]}),e.jsxs("div",{className:"text-red-700 dark:text-red-300",children:[e.jsx("span",{className:"font-medium",children:"Message:"})," ",N.rawApiResponse.predict_error.message]})]})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(N.rawApiResponse,null,2)})})]})]})})]}),N.insights&&N.insights.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Clinical Insights"}),e.jsx("ul",{className:"space-y-1",children:N.insights.map((i,d)=>e.jsxs("li",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["â€¢ ",i]},d))})]}),e.jsx("div",{className:"mt-6 flex space-x-3",children:e.jsx("button",{type:"button",onClick:ue,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:"Analyze Another File"})})]}),(a&&s.length>0||!a&&v)&&!N&&Object.keys(p).length===0&&S.stage==="idle"&&!y&&e.jsx("div",{className:"text-center",children:a?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:e.jsxs("button",{type:"button",onClick:Xe,disabled:s.length===0||!j.trim()||!s.some(i=>b[i.id]==="ready"),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start All Ready Files",s.filter(i=>b[i.id]==="ready").length>0&&` (${s.filter(i=>b[i.id]==="ready").length})`]})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'Use individual "Start" buttons on each file for selective processing, or "Start All" to process all ready files sequentially'})]}):e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:zs,disabled:!v||!j.trim(),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start Analysis"]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"This will convert, upload, and analyze your audio file"})]})}),a&&Object.keys(p).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ne,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Batch Analysis Results (",Object.keys(p).length," files)"]})]}),e.jsx("div",{className:"space-y-6",children:Object.entries(p).map(([i,d])=>{const k=s.find(R=>R.id===i),C=c[i];return e.jsxs("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:(k==null?void 0:k.file.name)||`File ${i}`}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(C==null?void 0:C.stage)==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Complete"]}),(C==null?void 0:C.stage)==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]})]})]}),d.rawApiResponse&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3 border",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.predicted_score_anxiety||"N/A"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.sessionId})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.status||"N/A"})]})]})}),e.jsxs("details",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto max-h-64",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(d.rawApiResponse,null,2)})})]})]}),k&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>{const R=document.getElementById(`audio-${i}`);R.paused?(document.querySelectorAll("audio").forEach(E=>E.pause()),n(i),R.play()):(R.pause(),n(null))},className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900","aria-label":M===i?"Pause audio":"Play audio",children:M===i?e.jsx(Ye,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[k.file.name," â€¢ ",k.duration?`${Math.round(k.duration)}s`:"Duration unknown"]})]}),e.jsx("audio",{id:`audio-${i}`,src:k.url,onEnded:()=>n(null),className:"hidden"})]})]},i)})})]}),_.length>0&&e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:_.map(i=>e.jsx("div",{className:`max-w-sm w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg border-l-4 p-4 transition-all duration-300 transform ${i.type==="error"?"border-red-500":i.type==="warning"?"border-yellow-500":i.type==="success"?"border-green-500":"border-blue-500"}`,role:"alert",children:e.jsxs("div",{className:"flex items-start",children:[e.jsxs("div",{className:"flex-shrink-0",children:[i.type==="error"&&e.jsx(de,{className:"h-5 w-5 text-red-500","aria-hidden":"true"}),i.type==="warning"&&e.jsx(de,{className:"h-5 w-5 text-yellow-500","aria-hidden":"true"}),i.type==="success"&&e.jsx(ne,{className:"h-5 w-5 text-green-500","aria-hidden":"true"}),i.type==="info"&&e.jsx(de,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"})]}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:i.message})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{type:"button",onClick:()=>Re(i.id),className:"inline-flex text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close notification",children:e.jsx(Ue,{className:"h-4 w-4"})})})]})},i.id))})]})},Ge={queued:{color:"yellow",icon:be,label:"Queued"},running:{color:"blue",icon:X,label:"Processing"},processing:{color:"blue",icon:X,label:"Processing"},succeeded:{color:"green",icon:ne,label:"Completed"},success:{color:"green",icon:ne,label:"Completed"},failed:{color:"red",icon:vs,label:"Failed"}},Le=s=>s?s.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()):"â€”",Pe=s=>{if(!s)return 0;switch(s.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},$a=()=>{const[s,t]=l.useState([]),[a,r]=l.useState(!0),[c,m]=l.useState(null),[p,w]=l.useState(new Set),[b,x]=l.useState(!1),[y,I]=l.useState({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),{announceToScreenReader:v}=Ie(),P=l.useCallback(async()=>{try{r(!0),m(null);const g=Me(),n=(await B.getUserSessions(g)).sessions.map(o=>{var u;const f=o.prediction;return{...o,uploadedAt:o.createdAt,fileName:o.audioFileName||`Audio_${o.sessionId.slice(-8)}.wav`,fileSize:Math.floor(Math.random()*5e6)+1e6,riskLevel:((u=o.analysisResults)==null?void 0:u.riskLevel)||"unknown",depressionScore:(f==null?void 0:f.predicted_score_depression)||(f==null?void 0:f.predictedScoreDepression)||void 0,anxietyScore:(f==null?void 0:f.predicted_score_anxiety)||(f==null?void 0:f.predictedScoreAnxiety)||void 0}});t(n),v(`${n.length} sessions loaded successfully`)}catch(g){const M=g;m(M),v(`Error loading sessions: ${M.message}`)}finally{r(!1)}},[v]);l.useEffect(()=>{P()},[P]);const S=l.useMemo(()=>{let g=s;if(y.search){const M=y.search.toLowerCase();g=g.filter(n=>{var o,f;return n.sessionId.toLowerCase().includes(M)||((o=n.fileName)==null?void 0:o.toLowerCase().includes(M))||((f=Ge[n.status])==null?void 0:f.label.toLowerCase().includes(M))})}if(y.status!=="all"&&(g=g.filter(M=>M.status===y.status)),y.dateRange!=="all"){const M=new Date,n=new Date;switch(y.dateRange){case"today":n.setHours(0,0,0,0);break;case"week":n.setDate(M.getDate()-7);break;case"month":n.setMonth(M.getMonth()-1);break;case"year":n.setFullYear(M.getFullYear()-1);break}g=g.filter(o=>new Date(o.uploadedAt)>=n)}return g.sort((M,n)=>{let o=0;switch(y.sortBy){case"date":o=new Date(M.uploadedAt).getTime()-new Date(n.uploadedAt).getTime();break;case"status":o=M.status.localeCompare(n.status);break;case"depressionScore":const f=Pe(M.depressionScore),u=Pe(n.depressionScore);o=f-u;break;case"anxietyScore":const h=Pe(M.anxietyScore),_=Pe(n.anxietyScore);o=h-_;break}return y.sortOrder==="desc"?-o:o}),g},[s,y]),A=l.useCallback((g,M)=>{I(n=>({...n,[g]:M})),v(`Filter ${g} changed to ${M}`)},[v]),N=l.useCallback(g=>{w(M=>{const n=new Set(M);return n.has(g)?(n.delete(g),v("Session deselected")):(n.add(g),v("Session selected")),n})},[v]),H=l.useCallback(()=>{p.size===S.length?(w(new Set),v("All sessions deselected")):(w(new Set(S.map(M=>M.sessionId))),v(`All ${S.length} sessions selected`))},[p.size,S,v]),re=l.useCallback(async()=>{p.size===0||!window.confirm(`Are you sure you want to delete ${p.size} session(s)?`)||(t(M=>M.filter(n=>!p.has(n.sessionId))),w(new Set),v(`${p.size} sessions deleted`))},[p,v]),Z=g=>{if(g===0)return"0 B";const M=1024,n=["B","KB","MB","GB"],o=Math.floor(Math.log(g)/Math.log(M));return`${parseFloat((g/Math.pow(M,o)).toFixed(1))} ${n[o]}`},oe=({status:g})=>{const M=Ge[g]||Ge.failed,n=M.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${M.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":M.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":M.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${M.label}`,children:[e.jsx(n,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),M.label]})};return a?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(X,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading sessions..."})]})}):c?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Sessions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:c.message}),e.jsx("button",{onClick:P,className:"mt-4 btn-primary","aria-label":"Retry loading sessions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Analysis Sessions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"View and manage your audio analysis sessions"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:P,disabled:a,className:"btn-secondary","aria-label":"Refresh sessions list",children:[e.jsx(X,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsx(J,{to:"/upload",className:"btn-primary","aria-label":"Start new analysis session",children:"New Analysis"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{htmlFor:"search-sessions",className:"sr-only",children:"Search sessions"}),e.jsxs("div",{className:"relative",children:[e.jsx(ma,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400","aria-hidden":"true"}),e.jsx("input",{id:"search-sessions",type:"text",placeholder:"Search by session ID, filename, or status...",value:y.search,onChange:g=>A("search",g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent","aria-describedby":"search-help"})]}),e.jsx("p",{id:"search-help",className:"sr-only",children:"Search through your analysis sessions by ID, filename, or status"})]}),e.jsxs("button",{onClick:()=>x(!b),className:"btn-secondary flex items-center","aria-expanded":b,"aria-controls":"filter-panel","aria-label":`${b?"Hide":"Show"} filter options`,children:[e.jsx(Ss,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",b?e.jsx(ws,{className:"w-4 h-4 ml-2","aria-hidden":"true"}):e.jsx(Ns,{className:"w-4 h-4 ml-2","aria-hidden":"true"})]})]}),b&&e.jsxs("div",{id:"filter-panel",className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{id:"status-filter",value:y.status,onChange:g=>A("status",g.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"queued",children:"Queued"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"succeeded",children:"Completed"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-filter",value:y.dateRange,onChange:g=>A("dateRange",g.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-by",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort By"}),e.jsxs("select",{id:"sort-by",value:y.sortBy,onChange:g=>A("sortBy",g.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"status",children:"Status"}),e.jsx("option",{value:"depressionScore",children:"Depression Score"}),e.jsx("option",{value:"anxietyScore",children:"Anxiety Score"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-order",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort Order"}),e.jsxs("select",{id:"sort-order",value:y.sortOrder,onChange:g=>A("sortOrder",g.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]}),S.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[S.length," of ",s.length," sessions",p.size>0&&` â€¢ ${p.size} selected`]})}),p.size>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:re,className:"btn-danger","aria-label":`Delete ${p.size} selected sessions`,children:[e.jsx(Cs,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Delete Selected"]})})]}),S.length>0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",role:"table","aria-label":"Analysis sessions",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:p.size===S.length,onChange:H,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":"Select all sessions"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Session"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Depression Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Anxiety Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:S.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:p.has(g.sessionId),onChange:()=>N(g.sessionId),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${g.sessionId}`})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:g.fileName}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID: ",g.sessionId.slice(-12)]}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:Z(g.fileSize||0)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(oe,{status:g.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:g.depressionScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Le(g.depressionScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:g.anxietyScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Le(g.anxietyScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ce(g.uploadedAt)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ne(g.uploadedAt)})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(J,{to:`/sessions/${g.sessionId}`,className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300","aria-label":`View details for session ${g.sessionId}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})}),g.status==="succeeded"&&e.jsx("button",{className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300","aria-label":`Download results for session ${g.sessionId}`,children:e.jsx(Be,{className:"w-4 h-4","aria-hidden":"true"})})]})})]},g.sessionId))})]})}),e.jsx("div",{className:"md:hidden space-y-4 p-4",children:S.map(g=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:p.has(g.sessionId),onChange:()=>N(g.sessionId),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${g.sessionId}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:g.fileName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",g.sessionId.slice(-12)]})]})]}),e.jsx(oe,{status:g.status})]}),(g.depressionScore||g.anxietyScore)&&e.jsxs("div",{className:"text-sm",children:[g.depressionScore&&e.jsxs("div",{children:["Depression: ",Le(g.depressionScore)]}),g.anxietyScore&&e.jsxs("div",{children:["Anxiety: ",Le(g.anxietyScore)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:Ce(g.uploadedAt)}),e.jsx("span",{children:Z(g.fileSize||0)})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[e.jsxs(J,{to:`/sessions/${g.sessionId}`,className:"btn-secondary text-xs","aria-label":`View details for session ${g.sessionId}`,children:[e.jsx(_e,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"View"]}),g.status==="succeeded"&&e.jsxs("button",{className:"btn-secondary text-xs","aria-label":`Download results for session ${g.sessionId}`,children:[e.jsx(Be,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Download"]})]})]},g.sessionId))})]}):e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No sessions found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't created any analysis sessions yet.":"No sessions match your current filters."}),s.length===0?e.jsx(J,{to:"/upload",className:"btn-primary",children:"Start Your First Analysis"}):e.jsx("button",{onClick:()=>I({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),className:"btn-secondary",children:"Clear Filters"})]})]})},Fa={low:{color:"green",label:"Low Risk",icon:ne,description:"Low likelihood of immediate concerns"},moderate:{color:"yellow",label:"Moderate Risk",icon:_s,description:"Some concerns that warrant attention"},high:{color:"red",label:"High Risk",icon:Je,description:"Significant concerns requiring immediate attention"},critical:{color:"red",label:"Critical Risk",icon:Je,description:"Urgent intervention required"}},Da=({sessionId:s,existingAssessment:t,onAssessmentUpdated:a})=>{const{announceToScreenReader:r}=Ie(),[c,m]=l.useState(t||null),[p,w]=l.useState(!1),[b,x]=l.useState(!1),[y,I]=l.useState(null),v=l.useCallback(async()=>{try{w(!0),I(null),r("Generating AI risk assessment...");const A=await B.generateRiskAssessment(s);if(A.success&&A.riskAssessment)m(A.riskAssessment),a==null||a(A.riskAssessment),r("Risk assessment generated successfully");else throw new Error(A.message||"Failed to generate risk assessment")}catch(A){const N=A;I(N),r(`Error generating assessment: ${N.message}`)}finally{w(!1)}},[s,a,r]),P=l.useCallback(async()=>{try{x(!0),I(null);const A=await B.getRiskAssessment(s);A.success&&A.riskAssessment&&(m(A.riskAssessment),a==null||a(A.riskAssessment))}catch(A){I(A)}finally{x(!1)}},[s,a]),S=({riskLevel:A,riskScore:N})=>{const H=Fa[A.toLowerCase()];if(!H)return null;const re=H.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium ${H.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":H.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Risk level: ${H.label}`,children:[e.jsx(re,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),H.label,N&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded text-xs font-bold",children:[N,"/10"]})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:H.description})]})};return!c&&!p&&!b?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Risk Assessment Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Generate an AI-powered risk assessment based on session data and clinical insights."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:v,className:"btn-primary","aria-label":"Generate AI risk assessment",children:[e.jsx(ge,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Generate AI Risk Assessment"]}),e.jsxs("button",{onClick:P,className:"btn-secondary","aria-label":"Check for existing assessment",children:[e.jsx(X,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Check for Existing Assessment"]})]}),y&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:y.message})})]})]}):p||b?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(X,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:p?"Generating AI risk assessment...":"Loading assessment..."})]}),p&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This may take a few moments as AI analyzes the session data..."})})]}):c?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:[c.confidenceLevel&&e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Confidence: ",(c.confidenceLevel*100).toFixed(0),"%"]}),e.jsxs("button",{onClick:v,disabled:p,className:"btn-secondary text-xs","aria-label":"Regenerate risk assessment",children:[e.jsx(X,{className:`w-3 h-3 mr-1 ${p?"animate-spin":""}`,"aria-hidden":"true"}),"Regenerate"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Overall Risk Level"}),e.jsx(S,{riskLevel:c.overallRiskLevel,riskScore:c.riskScore})]}),c.generatedAt&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(ks,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Generated"]}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ne(c.generatedAt)})]})]}),c.summary&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Kt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Summary"]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsx("p",{className:"text-blue-900 dark:text-blue-100 text-sm leading-relaxed",children:c.summary})})]}),c.keyFactors&&c.keyFactors.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(_s,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Key Risk Factors"]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:c.keyFactors.map((A,N)=>e.jsxs("li",{className:"text-yellow-900 dark:text-yellow-100 text-sm flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-3 flex-shrink-0","aria-hidden":"true"}),A]},N))})})]}),c.recommendations&&c.recommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(aa,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recommendations"]}),e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:e.jsx("ul",{className:"space-y-2",children:c.recommendations.map((A,N)=>e.jsxs("li",{className:"text-green-900 dark:text-green-100 text-sm flex items-start",children:[e.jsx(ne,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),A]},N))})})]}),c.immediateActions&&c.immediateActions.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(ha,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Immediate Actions Required"]}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:e.jsx("ul",{className:"space-y-2",children:c.immediateActions.map((A,N)=>e.jsxs("li",{className:"text-red-900 dark:text-red-100 text-sm flex items-start",children:[e.jsx(Je,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),A]},N))})})]}),c.followUpRecommendations&&c.followUpRecommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Follow-up Recommendations"]}),e.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:e.jsx("ul",{className:"space-y-2",children:c.followUpRecommendations.map((A,N)=>e.jsxs("li",{className:"text-purple-900 dark:text-purple-100 text-sm flex items-start",children:[e.jsx(be,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),A]},N))})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(be,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),"Generated: ",Ne(c.generatedAt),c.modelVersion&&e.jsxs("span",{className:"ml-4",children:["Model: ",c.modelVersion]})]})})]}),y&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:y.message})})]}):null},xs={queued:{color:"yellow",icon:be,label:"Queued",description:"Waiting to be processed"},initiated:{color:"blue",icon:be,label:"Initiated",description:"Session has been created"},running:{color:"blue",icon:X,label:"Processing",description:"Audio is being analyzed"},processing:{color:"blue",icon:X,label:"Processing",description:"Analysis in progress"},succeeded:{color:"green",icon:ne,label:"Completed",description:"Analysis completed successfully"},success:{color:"green",icon:ne,label:"Completed",description:"Analysis completed successfully"},failed:{color:"red",icon:vs,label:"Failed",description:"Analysis encountered an error"}},Ta=()=>{var M,n,o,f,u,h,_,z,q,ce,V,Y,Q,ee;const{sessionId:s}=Js(),t=us(),{announceToScreenReader:a}=Ie(),[r,c]=l.useState(null),[m,p]=l.useState(!0),[w,b]=l.useState(null),[x,y]=l.useState(!1),[I,v]=l.useState(!1),[P,S]=l.useState(!1),A=l.useRef(null),N=l.useCallback(async()=>{if(s)try{p(!0),b(null);const j=await B.getSessionData(s);c(j),a(`Session ${s} loaded successfully`)}catch(j){const F=j;b(F),a(`Error loading session: ${F.message}`)}finally{p(!1)}},[s,a]),H=l.useCallback(async()=>{v(!0),await N(),v(!1),a("Session data refreshed")},[N,a]);l.useEffect(()=>{N()},[N]);const re=l.useCallback(()=>{y(j=>{const F=!j;return a(`Raw JSON view ${F?"enabled":"disabled"}`),F})},[a]),Z=l.useCallback(()=>{A.current&&(P?(A.current.pause(),S(!1),a("Audio paused")):(A.current.play().catch(j=>{console.error("Failed to play audio:",j),a("Failed to play audio")}),S(!0),a("Audio playing")))},[P,a]),oe=l.useCallback(()=>{if(!r)return;const j=JSON.stringify(r,null,2),F=new Blob([j],{type:"application/json"}),G=URL.createObjectURL(F),D=document.createElement("a");D.href=G,D.download=`session-${r.sessionId}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(G),a("Session data download started")},[r,a]),g=({status:j})=>{const F=xs[j]||xs.failed,G=F.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${F.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":F.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":F.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${F.label}`,children:[e.jsx(G,{className:`w-4 h-4 mr-2 ${F.color==="blue"&&j==="processing"?"animate-spin":""}`,"aria-hidden":"true"}),F.label]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:F.description})]})};return m?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(X,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading session details..."})]})}):w?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Session"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:w.message}),e.jsxs("div",{className:"mt-4 space-x-3",children:[e.jsx("button",{onClick:N,className:"btn-primary","aria-label":"Retry loading session",children:"Try Again"}),e.jsx(J,{to:"/sessions",className:"btn-secondary",children:"Back to Sessions"})]})]})]})})}):r?e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>t("/sessions"),className:"btn-secondary","aria-label":"Back to sessions list",children:[e.jsx(Mt,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Back to Sessions"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Session Details"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:["ID: ",r.sessionId]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:re,className:"btn-secondary","aria-label":`${x?"Hide":"Show"} raw JSON data`,children:[x?e.jsx(Ht,{className:"w-4 h-4 mr-2"}):e.jsx(_e,{className:"w-4 h-4 mr-2"}),x?"Hide JSON":"Show JSON"]}),e.jsxs("button",{onClick:H,disabled:I,className:"btn-secondary","aria-label":"Refresh session data",children:[e.jsx(X,{className:`w-4 h-4 mr-2 ${I?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{onClick:oe,className:"btn-primary","aria-label":"Download session data as JSON",children:[e.jsx(Be,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),x&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ke,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Raw Session Data"]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 overflow-auto",children:e.jsx("pre",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap break-all",children:JSON.stringify(r,null,2)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ke,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Basic Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsx(g,{status:r.status})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(ks,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Created"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:Ce(r.createdAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(r.createdAt)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(be,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Last Updated"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:Ce(r.updatedAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(r.updatedAt)})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(ds,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"User ID"]}),e.jsx("div",{className:"font-mono text-sm bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded border break-all",children:r.userId})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Gt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Audio Information"]}),e.jsxs("div",{className:"space-y-4",children:[r.audioFileName&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"File Name"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-medium",children:r.audioFileName})]}),r.audioUrl&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Audio File"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:Z,className:"btn-secondary","aria-label":`${P?"Pause":"Play"} audio`,children:P?e.jsx(Ye,{className:"w-4 h-4"}):e.jsx(je,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:P?"Playing audio...":"Audio playback available"})]}),e.jsx("audio",{ref:A,src:r.audioUrl,onPlay:()=>S(!0),onPause:()=>S(!1),onEnded:()=>S(!1),onError:j=>{console.error("Audio playback error:",j),S(!1),a("Audio playback failed - file may not be accessible")},className:"hidden",preload:"metadata"})]})]})]})]}),r.userMetadata&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ds,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Patient Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.userMetadata.age&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[r.userMetadata.age," years"]})]}),r.userMetadata.gender&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:r.userMetadata.gender.replace(/[_-]/g," ")})]}),r.userMetadata.weight&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[r.userMetadata.weight," lbs"]})]}),r.userMetadata.race&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:r.userMetadata.race})]}),r.userMetadata.ethnicity&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:r.userMetadata.ethnicity})]}),r.userMetadata.zipcode&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-mono",children:r.userMetadata.zipcode})]}),r.userMetadata.language!==void 0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language English"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:r.userMetadata.language?"Yes":"No"})]}),r.userMetadata.sessionNotes&&e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded border",children:r.userMetadata.sessionNotes})]})]})]}),(r.analysisResults||r.prediction)&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ze,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Analysis Results"]}),e.jsxs("div",{className:"space-y-6",children:[(r.analysisResults||r.prediction)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Mental Health Scores"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(((M=r.analysisResults)==null?void 0:M.depressionScore)||((n=r.prediction)==null?void 0:n.predicted_score_depression))&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Depression Score"}),e.jsx(Ze,{className:"w-4 h-4 text-blue-600 dark:text-blue-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:((f=(o=r.analysisResults)==null?void 0:o.depressionScore)==null?void 0:f.toFixed(2))||((u=r.prediction)!=null&&u.predicted_score_depression?r.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase()):"N/A")}),((h=r.analysisResults)==null?void 0:h.confidence)&&e.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["Confidence: ",(r.analysisResults.confidence*100).toFixed(1),"%"]})]}),(((_=r.analysisResults)==null?void 0:_.anxietyScore)||((z=r.prediction)==null?void 0:z.predicted_score_anxiety))&&e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Anxiety Score"}),e.jsx(As,{className:"w-4 h-4 text-purple-600 dark:text-purple-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:((ce=(q=r.analysisResults)==null?void 0:q.anxietyScore)==null?void 0:ce.toFixed(2))||((V=r.prediction)!=null&&V.predicted_score_anxiety?r.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase()):"N/A")}),((Y=r.analysisResults)==null?void 0:Y.confidence)&&e.jsxs("div",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1",children:["Confidence: ",(r.analysisResults.confidence*100).toFixed(1),"%"]})]})]})]}),((Q=r.analysisResults)==null?void 0:Q.insights)&&r.analysisResults.insights.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Clinical Insights"}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:r.analysisResults.insights.map((j,F)=>e.jsxs("li",{className:"text-sm text-yellow-800 dark:text-yellow-200 flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-2 flex-shrink-0","aria-hidden":"true"}),j]},F))})})]}),((ee=r.analysisResults)==null?void 0:ee.completedAt)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Analysis Completion"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ne,{className:"w-4 h-4 text-green-600 dark:text-green-400 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 mr-2",children:"Completed:"}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Ne(r.analysisResults.completedAt)})]})})]})]})]}),e.jsx(Da,{sessionId:r.sessionId,existingAssessment:r.riskAssessment||null,onAssessmentUpdated:j=>{c(F=>F?{...F,riskAssessment:j}:null)}})]}):e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Session Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"The requested session could not be found."}),e.jsx(J,{to:"/sessions",className:"btn-primary",children:"Back to Sessions"})]})})},Ua=()=>{const[s,t]=l.useState([]),[a,r]=l.useState(!0),[c,m]=l.useState(null),[p,w]=l.useState({dateRange:"all",scoreType:"all",showTrends:!0}),[b,x]=l.useState(!1),{announceToScreenReader:y}=Ie(),I=us(),v=l.useCallback(n=>{I(`/sessions/${n}`),y(`Navigating to session ${n} details`)},[I,y]),P=l.useCallback(async()=>{try{r(!0),m(null);const n=Me(),f=(await B.getUserSessions(n)).sessions.filter(u=>u.analysisResults||u.prediction);t(f),y(`${f.length} prediction sessions loaded`)}catch(n){const o=n;console.error("Error loading predictions:",o),m(o),y(`Error loading predictions: ${o.message}`)}finally{r(!1)}},[y]);l.useEffect(()=>{P()},[P]);const S=l.useMemo(()=>{if(p.dateRange==="all")return s;const n=new Date,o=new Date;switch(p.dateRange){case"week":o.setDate(n.getDate()-7);break;case"month":o.setMonth(n.getMonth()-1);break;case"quarter":o.setMonth(n.getMonth()-3);break;case"year":o.setFullYear(n.getFullYear()-1);break}return s.filter(f=>new Date(f.createdAt)>=o)},[s,p.dateRange]),A=l.useMemo(()=>S.map(n=>{var h,_;const o=z=>{if(!z)return null;switch(z.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return null}},f=o((h=n.prediction)==null?void 0:h.predicted_score_depression),u=o((_=n.prediction)==null?void 0:_.predicted_score_anxiety);return{date:n.createdAt,depression:f,anxiety:u,overall:null,sessionId:n.sessionId}}).sort((n,o)=>new Date(n.date).getTime()-new Date(o.date).getTime()),[S]),N=l.useMemo(()=>{const n={depression:[],anxiety:[]},o=[{category:"no_to_mild",label:"No to Mild",color:"bg-green-400"},{category:"mild_to_moderate",label:"Mild to Moderate",color:"bg-yellow-500"},{category:"moderate_to_severe",label:"Moderate to Severe",color:"bg-red-600"},{category:"no_or_minimal",label:"No or Minimal",color:"bg-green-400"},{category:"moderate",label:"Moderate",color:"bg-orange-500"},{category:"moderately_severe",label:"Moderately Severe",color:"bg-red-500"},{category:"severe",label:"Severe",color:"bg-red-700"}],f=S.map(h=>{var _;return(_=h.prediction)==null?void 0:_.predicted_score_depression}).filter(h=>h!==void 0);o.forEach(h=>{const _=f.filter(q=>q===h.category).length,z=f.length>0?_/f.length*100:0;_>0&&n.depression.push({category:h.label,count:_,percentage:z,color:h.color})});const u=S.map(h=>{var _;return(_=h.prediction)==null?void 0:_.predicted_score_anxiety}).filter(h=>h!==void 0);return o.forEach(h=>{const _=u.filter(q=>q===h.category).length,z=u.length>0?_/u.length*100:0;_>0&&n.anxiety.push({category:h.label,count:_,percentage:z,color:h.color})}),n},[S]),H=l.useMemo(()=>{const n={},o=h=>{if(!h)return 0;switch(h.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},f=S.map(h=>{var _;return(_=h.prediction)==null?void 0:_.predicted_score_depression}).filter(h=>h!==void 0);if(f.length<2)n.depression={direction:"stable",change:0,period:"insufficient data"};else{const h=f.map(o),_=h.slice(0,Math.floor(h.length/2)),z=h.slice(Math.floor(h.length/2)),q=_.reduce((Y,Q)=>Y+Q,0)/_.length,V=z.reduce((Y,Q)=>Y+Q,0)/z.length-q;n.depression={direction:Math.abs(V)<.5?"stable":V<0?"improving":"worsening",change:Math.abs(V),period:`${S.length} sessions`}}const u=S.map(h=>{var _;return(_=h.prediction)==null?void 0:_.predicted_score_anxiety}).filter(h=>h!==void 0);if(u.length<2)n.anxiety={direction:"stable",change:0,period:"insufficient data"};else{const h=u.map(o),_=h.slice(0,Math.floor(h.length/2)),z=h.slice(Math.floor(h.length/2)),q=_.reduce((Y,Q)=>Y+Q,0)/_.length,V=z.reduce((Y,Q)=>Y+Q,0)/z.length-q;n.anxiety={direction:Math.abs(V)<.5?"stable":V<0?"improving":"worsening",change:Math.abs(V),period:`${S.length} sessions`}}return n.overall={direction:"stable",change:0,period:"coming soon"},n},[S]),re=l.useMemo(()=>{const n={totalSessions:S.length,avgDepression:0,avgAnxiety:0,avgOverall:0,latestSession:null,improvementSessions:0};if(S.length===0)return n;const o=S.map(u=>{var h;return(h=u.prediction)==null?void 0:h.predictedScoreDepression}).filter(u=>u!==void 0),f=S.map(u=>{var h;return(h=u.prediction)==null?void 0:h.predictedScoreAnxiety}).filter(u=>u!==void 0);if(o.length>0){const u={};o.forEach(_=>{u[_]=(u[_]||0)+1});const h=Object.entries(u).sort(([,_],[,z])=>z-_)[0][0];n.avgDepression=u[h]}if(f.length>0){const u={};f.forEach(_=>{u[_]=(u[_]||0)+1});const h=Object.entries(u).sort(([,_],[,z])=>z-_)[0][0];n.avgAnxiety=u[h]}return n.latestSession=S.sort((u,h)=>new Date(h.createdAt).getTime()-new Date(u.createdAt).getTime())[0],n.improvementSessions=0,n},[S]),Z=l.useCallback((n,o)=>{w(f=>({...f,[n]:o})),y(`Filter ${n} changed to ${o}`)},[y]),oe=l.useCallback(()=>{const n=JSON.stringify(S,null,2),o=new Blob([n],{type:"application/json"}),f=URL.createObjectURL(o),u=document.createElement("a");u.href=f,u.download=`predictions-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(f),y("Predictions data download started")},[S,y]),g=({trend:n,label:o})=>{const f=n.direction==="improving"?ya:n.direction==="worsening"?Ze:ze,u=n.direction==="improving"?"text-green-600 dark:text-green-400":n.direction==="worsening"?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400";return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{className:`w-4 h-4 ${u}`,"aria-hidden":"true"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:o}),e.jsxs("span",{className:`text-sm font-medium ${u} capitalize`,children:[n.direction,n.period==="insufficient data"?" (need more sessions)":n.period==="coming soon"?" (analysis coming soon)":` (${n.period})`]})]})},M=({data:n,type:o,onBarClick:f})=>{const u=n.map(j=>j[o]).filter(j=>j!==null);if(u.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No data available"});const h=Math.max(...u),_=Math.min(...u),z=h-_||1,q=j=>{switch(j){case 1:return"No to Mild / No or Minimal";case 2:return"Mild to Moderate / Moderate";case 3:return"Moderate to Severe / Moderately Severe";case 4:return"Severe";default:return"Unknown"}},ce=(j,F)=>{if(F==="depression")switch(j){case 1:return"bg-blue-400";case 2:return"bg-blue-600";case 3:return"bg-blue-800";default:return"bg-blue-500"}else if(F==="anxiety")switch(j){case 1:return"bg-purple-400";case 2:return"bg-purple-600";case 3:return"bg-purple-700";case 4:return"bg-purple-900";default:return"bg-purple-500"}else switch(j){case 1:return"bg-green-400";case 2:return"bg-green-600";case 3:return"bg-green-700";case 4:return"bg-green-800";default:return"bg-green-500"}},V=j=>[{score:1,label:"No/Minimal"},{score:2,label:"Mild"},{score:3,label:"Moderate"},{score:4,label:"Mod-Severe"},{score:5,label:"Severe"}].map(G=>({...G,color:ce(G.score,j)})),Y=new Set(u),ee=V(o).filter(j=>Y.has(j.score));return e.jsxs("div",{children:[e.jsx("div",{className:"h-32 flex items-end space-x-1 px-4 py-2 mb-4",children:n.map((j,F)=>{const G=j[o];if(G===null)return null;const D=(G-_)/z*100,U=ce(G,o),Re=q(G),ue=new Date(j.date).toLocaleDateString();return e.jsx("div",{className:`flex-1 ${U} opacity-70 hover:opacity-100 hover:scale-105 transition-all duration-200 rounded-t cursor-pointer relative group`,style:{height:`${Math.max(D,8)}%`},onClick:()=>f(j.sessionId),role:"button",tabIndex:0,onKeyDown:we=>{(we.key==="Enter"||we.key===" ")&&(we.preventDefault(),f(j.sessionId))},"aria-label":`View session details for ${Re} score on ${ue}`,children:e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-medium",children:Re}),e.jsx("div",{className:"text-gray-300",children:ue}),e.jsxs("div",{className:"text-gray-300",children:["Session: ",j.sessionId.slice(-8)]}),e.jsx("div",{className:"text-gray-400 text-xs mt-1",children:"Click to view details"}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"})]})},F)})}),ee.length>0&&e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"Legend:"}),ee.map(j=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-3 h-3 ${j.color} rounded`}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:j.label})]},j.score))]})})]})};return a?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(X,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading predictions..."})]})}):c?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Predictions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:c.message}),e.jsx("button",{onClick:P,className:"mt-4 btn-primary","aria-label":"Retry loading predictions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Predictions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Analyze your mental health trends and insights over time"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>x(!b),className:"btn-secondary","aria-expanded":b,"aria-label":`${b?"Hide":"Show"} filter options`,children:[e.jsx(Ss,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",b?e.jsx(ws,{className:"w-4 h-4 ml-2"}):e.jsx(Ns,{className:"w-4 h-4 ml-2"})]}),e.jsxs("button",{onClick:P,className:"btn-secondary","aria-label":"Refresh predictions data",children:[e.jsx(X,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{onClick:oe,className:"btn-primary",disabled:S.length===0,"aria-label":"Download predictions data",children:[e.jsx(Be,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),b&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-range",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-range",value:p.dateRange,onChange:n=>Z("dateRange",n.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"quarter",children:"Past Quarter"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"score-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Focus Score"}),e.jsxs("select",{id:"score-type",value:p.scoreType,onChange:n=>Z("scoreType",n.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Scores"}),e.jsx("option",{value:"depression",children:"Depression"}),e.jsx("option",{value:"anxiety",children:"Anxiety"}),e.jsx("option",{value:"overall",children:"Overall"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:p.showTrends,onChange:n=>Z("showTrends",n.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show trend analysis"})]})})]})}),S.length===0?e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Prediction Data Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't completed any analysis sessions yet.":"No sessions found for the selected date range."}),e.jsx(J,{to:"/upload",className:"btn-primary",children:"Start Your First Analysis"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ze,{className:"w-8 h-8 text-blue-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:re.totalSessions})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ge,{className:"w-8 h-8 text-purple-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Depression (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const n=S.map(u=>{var h;return(h=u.prediction)==null?void 0:h.predicted_score_depression}).filter(u=>u!==void 0);if(n.length===0)return"â€”";const o={};return n.forEach(u=>{o[u]=(o[u]||0)+1}),Object.entries(o).sort(([,u],[,h])=>h-u)[0][0].replace(/_/g," ").replace(/\b\w/g,u=>u.toUpperCase())})()})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(As,{className:"w-8 h-8 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Anxiety (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const n=S.map(u=>{var h;return(h=u.prediction)==null?void 0:h.predicted_score_anxiety}).filter(u=>u!==void 0);if(n.length===0)return"â€”";const o={};return n.forEach(u=>{o[u]=(o[u]||0)+1}),Object.entries(o).sort(([,u],[,h])=>h-u)[0][0].replace(/_/g," ").replace(/\b\w/g,u=>u.toUpperCase())})()})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(p.scoreType==="all"||p.scoreType==="depression")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ls,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Depression Score Trend"]}),e.jsx(M,{data:A,type:"depression",onBarClick:v}),p.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(g,{trend:H.depression,label:"Trend:"})})]}),(p.scoreType==="all"||p.scoreType==="anxiety")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ft,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Anxiety Score Trend"]}),e.jsx(M,{data:A,type:"anxiety",onBarClick:v}),p.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(g,{trend:H.anxiety,label:"Trend:"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ls,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Score Distribution"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(N).map(([n,o])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 capitalize",children:[n," Scores"]}),e.jsx("div",{className:"space-y-2",children:o.map(f=>e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:f.category}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[f.count," (",f.percentage.toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${f.color}`,style:{width:`${f.percentage}%`}})})]})},f.category))})]},n))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(be,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recent Analysis Sessions"]}),e.jsx(J,{to:"/sessions",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 text-sm",children:"View All Sessions â†’"})]}),e.jsx("div",{className:"space-y-4",children:S.slice(0,5).map(n=>{var o,f;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${n.status==="succeeded"?"bg-green-500":n.status==="processing"?"bg-blue-500":n.status==="failed"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n.audioFileName||`Session ${n.sessionId.slice(-8)}`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ce(n.createdAt)})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[((o=n.prediction)==null?void 0:o.predicted_score_depression)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Depression"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,u=>u.toUpperCase())})]}),((f=n.prediction)==null?void 0:f.predicted_score_anxiety)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Anxiety"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,u=>u.toUpperCase())})]}),e.jsx(J,{to:`/sessions/${n.sessionId}`,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400","aria-label":`View session ${n.sessionId}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})})]})]},n.sessionId)})})]})]})]})},Oa=()=>{const{data:s,isLoading:t,error:a,refetch:r}=Is(),{announce:c}=fs();ps.useEffect(()=>{c("System Health page loaded","polite")},[c]);const m=x=>{if(!x)return"Just now";try{const y=new Date(x);return isNaN(y.getTime())?"Just now":y.toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(y){return console.warn("Failed to parse timestamp:",x,y),"Just now"}},p=x=>{switch(x==null?void 0:x.toLowerCase()){case"healthy":return"text-green-600 dark:text-green-400";case"degraded":return"text-yellow-600 dark:text-yellow-400";case"unhealthy":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},w=x=>{switch(x==null?void 0:x.toLowerCase()){case"healthy":return"âœ…";case"degraded":return"âš ï¸";case"unhealthy":return"âŒ";default:return"â“"}},b=x=>{const y="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium";switch(x==null?void 0:x.toLowerCase()){case"healthy":return`${y} bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200`;case"degraded":return`${y} bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200`;case"unhealthy":return`${y} bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200`;default:return`${y} bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200`}};return e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"System Health"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Monitor API status and system connectivity"})]}),e.jsxs("button",{onClick:()=>r(),disabled:t,className:"btn-secondary flex items-center space-x-2","aria-label":"Refresh system health status",children:[e.jsx(X,{className:`w-4 h-4 ${t?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),t&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(X,{className:"w-6 h-6 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Checking system health..."})]})}),a&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-6 h-6 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Health Check Failed"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:a.message||"Unable to retrieve system health status"}),e.jsx("button",{onClick:()=>r(),className:"mt-3 text-sm text-red-800 dark:text-red-200 hover:text-red-900 dark:hover:text-red-100 underline",children:"Try again"})]})]})}),s&&!t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Overall System Status"}),e.jsxs("div",{className:b(s.status),children:[e.jsx("span",{className:"mr-1",children:w(s.status)}),s.status]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:w(s.status)}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Status"}),e.jsx("div",{className:`font-medium ${p(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"â±ï¸"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Response Time"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:s.totalDuration?`${s.totalDuration}ms`:"N/A"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“…"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last Checked"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:m(s.timestamp)})]})]})]}),s.checks&&Object.keys(s.checks).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ze,{className:"w-5 h-5 mr-2"}),"Service Details"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.checks).map(([x,y])=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:w(y.status)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white capitalize",children:x.replace(/-/g," ")}),y.description&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[y.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[y.duration,"ms"]}),e.jsx("div",{className:b(y.status),children:y.status})]})]},x))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ke,{className:"w-5 h-5 mr-2"}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"API Endpoints"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Health Check:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/health"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Sessions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/sessions"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Predictions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/predictions"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Connection Status"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"API Connected"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Real-time Updates"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Auto-refresh Enabled"})]})]})]})]})]})]})]})},La=()=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Page Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"The page you're looking for doesn't exist."}),e.jsx("a",{href:"/",className:"btn-primary",children:"Go to Dashboard"})]}),Pa=new Gs({defaultOptions:{queries:{retry:(s,t)=>{if(t&&typeof t=="object"&&"code"in t){const a=t.code;if(a!=null&&a.startsWith("HTTP_4")&&a!=="HTTP_408")return!1}return s<3},staleTime:5*60*1e3,refetchOnWindowFocus:!1},mutations:{retry:1}}});function za(){return e.jsxs(Ws,{client:Pa,children:[e.jsx(pt,{children:e.jsx(Zs,{children:e.jsx(kt,{children:e.jsxs(Qs,{children:[e.jsx(ye,{path:"/",element:e.jsx(Ca,{})}),e.jsx(ye,{path:"/upload",element:e.jsx(Ea,{})}),e.jsx(ye,{path:"/sessions",element:e.jsx($a,{})}),e.jsx(ye,{path:"/sessions/:sessionId",element:e.jsx(Ta,{})}),e.jsx(ye,{path:"/predictions",element:e.jsx(Ua,{})}),e.jsx(ye,{path:"/health",element:e.jsx(Oa,{})}),e.jsx(ye,{path:"*",element:e.jsx(La,{})})]})})})}),!1]})}const gs=localStorage.getItem("bh_theme"),Ba=window.matchMedia("(prefers-color-scheme: dark)").matches,Ha=gs==="dark"||!gs&&Ba;Ha?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");We.createRoot(document.getElementById("root")).render(e.jsx(ps.StrictMode,{children:e.jsx(za,{})}));
//# sourceMappingURL=index-7e177cde.js.map
