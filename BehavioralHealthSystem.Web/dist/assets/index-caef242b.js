var qs=Object.defineProperty;var Vs=(s,t,a)=>t in s?qs(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var ee=(s,t,a)=>(Vs(s,typeof t!="symbol"?t+"":t,a),a);import{j as e,u as us,Q as Gs,a as Ws}from"./query-e4af0201.js";import{a as Ks,r as o,u as Ys,L as J,b as Js,c as ps,R as ys,B as Zs,d as Qs,e as ye}from"./vendor-99a90158.js";import{F as Xs,t as ts,f as et}from"./ffmpeg-c0c62554.js";import{B as st}from"./azure-a3a2de5a.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))r(m);new MutationObserver(m=>{for(const h of m)if(h.type==="childList")for(const y of h.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&r(y)}).observe(document,{childList:!0,subtree:!0});function a(m){const h={};return m.integrity&&(h.integrity=m.integrity),m.referrerPolicy&&(h.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?h.credentials="include":m.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function r(m){if(m.ep)return;m.ep=!0;const h=a(m);fetch(m.href,h)}})();var Ke={},as=Ks;Ke.createRoot=as.createRoot,Ke.hydrateRoot=as.hydrateRoot;let Te;const tt=new Uint8Array(16);function at(){if(!Te&&(Te=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Te))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Te(tt)}const K=[];for(let s=0;s<256;++s)K.push((s+256).toString(16).slice(1));function rt(s,t=0){return K[s[t+0]]+K[s[t+1]]+K[s[t+2]]+K[s[t+3]]+"-"+K[s[t+4]]+K[s[t+5]]+"-"+K[s[t+6]]+K[s[t+7]]+"-"+K[s[t+8]]+K[s[t+9]]+"-"+K[s[t+10]]+K[s[t+11]]+K[s[t+12]]+K[s[t+13]]+K[s[t+14]]+K[s[t+15]]}const nt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),rs={randomUUID:nt};function bs(s,t,a){if(rs.randomUUID&&!t&&!s)return rs.randomUUID();s=s||{};const r=s.random||(s.rng||at)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){a=a||0;for(let m=0;m<16;++m)t[a+m]=r[m];return t}return rt(r)}const ke={api:{baseUrl:"https://cwbhieastus001.azurewebsites.net/api"},azure:{blobSasUrl:"https://aistgvi.blob.core.windows.net/?sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiyx&se=2026-06-26T11:43:55Z&st=2025-09-06T03:28:55Z&spr=https&sig=jlfi75igY6qW805u%2FWErZpEu7AZSll5hJOdvSJU35%2Bo%3D",containerName:"audio-uploads"},polling:{intervalMs:parseInt("3000",10),maxAttempts:60,backoffFactor:1.2},features:{enableFFmpegWorker:!0,enableDebugLogging:!0},audio:{acceptedFormats:[".wav",".mp3",".m4a",".aac",".flac"],maxFileSizeMB:100,targetSampleRate:44100,targetChannels:1}},he={USER_ID:"bh_user_id",THEME:"bh_theme",UPLOAD_SESSIONS:"bh_upload_sessions",PROCESSING_MODE:"bh_processing_mode",USER_ID_CUSTOM:"bh_user_id_custom"},Se={HEALTH:"/health",SESSIONS_INITIATE:"/sessions/initiate",PREDICTIONS_SUBMIT:"/predictions/submit",PREDICTIONS_BY_USER:"/predictions",PREDICTIONS_BY_SESSION:"/predictions/sessions"},Ae={SKIP_TO_CONTENT_ID:"main-content",ANNOUNCEMENTS_ID:"a11y-announcements",FOCUS_TIMEOUT:100,DEBOUNCE_MS:300},Ie=()=>{let s=localStorage.getItem(he.USER_ID);return(!s||s.trim().length===0)&&(s=bs(),localStorage.setItem(he.USER_ID,s)),s},it=s=>{if(!s||s.trim().length===0)throw new Error("User ID cannot be empty");localStorage.setItem(he.USER_ID,s.trim())},ns=()=>{const s=bs();return localStorage.setItem(he.USER_ID,s),s},lt=()=>localStorage.getItem("bh_user_id_custom")==="true",ot=s=>{localStorage.setItem("bh_user_id_custom",s.toString())},dt=()=>{const s=localStorage.getItem(he.THEME);return s==="light"||s==="dark"?s:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},is=s=>{localStorage.setItem(he.THEME,s),s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},ct=()=>{const s=localStorage.getItem(he.PROCESSING_MODE);return s==="true"||s==="false"?s==="true":!1},mt=s=>{localStorage.setItem(he.PROCESSING_MODE,s.toString())},Ce=s=>{const t=new Date,a=new Date(s),r=t.getTime()-a.getTime(),m=Math.floor(r/(1e3*60)),h=Math.floor(r/(1e3*60*60)),y=Math.floor(r/(1e3*60*60*24));return m<1?"Just now":m<60?`${m}m ago`:h<24?`${h}h ago`:y<7?`${y}d ago`:a.toLocaleDateString()},Ne=s=>new Date(s).toLocaleString(),ie=(s,t,a)=>({code:s,message:t,details:a,timestamp:new Date().toISOString()}),xt=s=>s instanceof TypeError&&s.message.includes("fetch")?!0:s instanceof Error?s.message.includes("Network")||s.message.includes("connection")||s.message.includes("timeout"):!1,gt=(s,t="polite")=>{const a=document.createElement("div");a.setAttribute("aria-live",t),a.setAttribute("aria-atomic","true"),a.className="sr-only",a.textContent=s,document.body.appendChild(a),setTimeout(()=>{document.body.removeChild(a)},1e3)},ht=(s,t=100)=>{setTimeout(()=>{const a=document.getElementById(s);a&&a.focus()},t)},fs=o.createContext(void 0),ut=()=>{const s=o.useContext(fs);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},pt=({children:s})=>{const[t,a]=o.useState(dt),r=y=>{a(y),is(y)},m=()=>{r(t==="light"?"dark":"light")};o.useEffect(()=>{is(t)},[t]),o.useEffect(()=>{const y=window.matchMedia("(prefers-color-scheme: dark)"),N=f=>{localStorage.getItem("bh_theme")||a(f.matches?"dark":"light")};return y.addEventListener("change",N),()=>y.removeEventListener("change",N)},[]);const h={theme:t,toggleTheme:m,setTheme:r};return e.jsx(fs.Provider,{value:h,children:s})},js=()=>{const s=o.useCallback((r,m="polite")=>{gt(r,m)},[]),t=o.useCallback(r=>{s(r,"assertive")},[s]),a=o.useCallback(r=>{s(r,"polite")},[s]);return{announce:s,announceError:t,announceSuccess:a}},yt=()=>{const s=o.useCallback(a=>{const r=m=>{m.key==="Escape"&&(m.preventDefault(),a())};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),t=o.useCallback(a=>r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),a())},[]);return{handleEscape:s,handleEnterSpace:t}},bt=()=>({skipToMain:o.useCallback(()=>{ht(Ae.SKIP_TO_CONTENT_ID,Ae.FOCUS_TIMEOUT)},[])}),ft=({className:s=""})=>{const{theme:t,toggleTheme:a}=ut(),r=Ys(),{handleEnterSpace:m}=yt(),[h,y]=o.useState(!1),N=[{path:"/",label:"Dashboard",icon:"ðŸ "},{path:"/upload",label:"Upload & Analyze",icon:"ðŸ“¤"},{path:"/sessions",label:"Sessions",icon:"ðŸ“Š"},{path:"/predictions",label:"My Predictions",icon:"ðŸ“ˆ"},{path:"/health",label:"System Health",icon:"ðŸ¥"}],f=I=>I==="/"?r.pathname==="/":r.pathname.startsWith(I),u=()=>{y(!h)},b=()=>{y(!1)};return o.useEffect(()=>{y(!1)},[r.pathname]),e.jsx("header",{className:`bg-surface-light dark:bg-surface-dark border-b border-gray-200 dark:border-gray-700 ${s}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(J,{to:"/",className:"flex items-center space-x-3 text-xl font-bold text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 rounded-md px-2 py-1","aria-label":"Behavioral Health System - Go to Dashboard",children:[e.jsx("span",{className:"text-2xl",role:"img","aria-label":"Brain icon",children:"ðŸ§ "}),e.jsx("span",{className:"hidden sm:block",children:"Behavioral Health System"}),e.jsx("span",{className:"sm:hidden",children:"BHS"})]})}),e.jsx("nav",{className:"hidden md:flex space-x-1",role:"navigation","aria-label":"Main navigation",children:N.map(({path:I,label:w,icon:z})=>e.jsxs(J,{to:I,className:`
                  flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors
                  focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                  ${f(I)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                `,"aria-current":f(I)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:z}),e.jsx("span",{children:w})]},I))}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:a,onKeyDown:m(a),className:`\r
                p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":`Switch to ${t==="light"?"dark":"light"} mode`,type:"button",children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:t==="light"?"ðŸŒ™":"â˜€ï¸"})}),e.jsx("button",{onClick:u,onKeyDown:m(u),className:`\r
                md:hidden p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100\r
                dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700\r
                focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\r
                transition-colors touch-target\r
              `,"aria-label":h?"Close mobile menu":"Open mobile menu",type:"button",...h?{"aria-expanded":!0}:{"aria-expanded":!1},children:e.jsx("span",{className:"text-xl",role:"img","aria-hidden":"true",children:h?"âœ•":"â˜°"})})]})]}),h&&e.jsx("div",{className:"md:hidden border-t border-gray-200 dark:border-gray-700 pt-4 pb-3",children:e.jsx("nav",{className:"space-y-1",role:"navigation","aria-label":"Mobile navigation",children:N.map(({path:I,label:w,icon:z})=>e.jsxs(J,{to:I,onClick:b,className:`
                    flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium transition-colors
                    focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2
                    ${f(I)?"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-gray-100 dark:hover:bg-gray-700"}
                  `,"aria-current":f(I)?"page":void 0,children:[e.jsx("span",{role:"img","aria-hidden":"true",children:z}),e.jsx("span",{children:w})]},I))})})]})})},jt=({size:s=20,className:t="",...a})=>e.jsxs("svg",{width:s,height:s,viewBox:"0 0 23 23",className:t,"aria-label":"Microsoft",...a,children:[e.jsx("rect",{x:"1",y:"1",width:"10",height:"10",fill:"#f25022"}),e.jsx("rect",{x:"12",y:"1",width:"10",height:"10",fill:"#7fba00"}),e.jsx("rect",{x:"1",y:"12",width:"10",height:"10",fill:"#00a4ef"}),e.jsx("rect",{x:"12",y:"12",width:"10",height:"10",fill:"#ffb900"})]}),kt=({children:s,className:t=""})=>{const{skipToMain:a}=bt();return e.jsxs("div",{className:"min-h-screen bg-background-light dark:bg-background-dark",children:[e.jsx("a",{href:`#${Ae.SKIP_TO_CONTENT_ID}`,className:"skip-link",onClick:r=>{r.preventDefault(),a()},children:"Skip to main content"}),e.jsx(ft,{}),e.jsx("main",{id:Ae.SKIP_TO_CONTENT_ID,className:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 ${t}`,tabIndex:-1,children:s}),e.jsx("div",{id:Ae.ANNOUNCEMENTS_ID,className:"sr-only","aria-live":"polite","aria-atomic":"true"}),e.jsx("footer",{className:"bg-surface-light dark:bg-surface-dark border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(jt,{size:24,className:"opacity-80"}),e.jsx("span",{className:"text-sm text-text-muted-light dark:text-text-muted-dark font-medium",children:"Powered by Microsoft"})]}),e.jsxs("div",{className:"text-center text-sm text-text-muted-light dark:text-text-muted-dark",children:[e.jsxs("p",{children:["Behavioral Health System Â© ",new Date().getFullYear()]}),e.jsx("p",{className:"mt-1",children:"WCAG 2.2 AA Compliant â€¢ Section 508 Compliant"})]})]})})})]})};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),wt=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,r)=>r?r.toUpperCase():a.toLowerCase()),ls=s=>{const t=wt(s);return t.charAt(0).toUpperCase()+t.slice(1)},ks=(...s)=>s.filter((t,a,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===a).join(" ").trim(),vt=s=>{for(const t in s)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var St={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=o.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:m="",children:h,iconNode:y,...N},f)=>o.createElement("svg",{ref:f,...St,width:t,height:t,stroke:s,strokeWidth:r?Number(a)*24/Number(t):a,className:ks("lucide",m),...!h&&!vt(N)&&{"aria-hidden":"true"},...N},[...y.map(([u,b])=>o.createElement(u,b)),...Array.isArray(h)?h:[h]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=(s,t)=>{const a=o.forwardRef(({className:r,...m},h)=>o.createElement(At,{ref:h,iconNode:t,className:ks(`lucide-${Nt(ls(s))}`,`lucide-${s}`,r),...m}));return a.displayName=ls(s),a};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Be=R("activity",Ct);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],It=R("arrow-left",_t);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],ge=R("brain",Mt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ns=R("calendar",Rt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],os=R("chart-column",$t);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Dt=R("chart-pie",Et);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ws=R("chevron-down",Ft);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],vs=R("chevron-up",Tt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],de=R("circle-alert",Ut);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ne=R("circle-check-big",Ot);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ss=R("circle-x",Lt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],be=R("clock",Pt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],He=R("download",zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Ht=R("eye-off",Bt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_e=R("eye",qt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]],Gt=R("file-audio",Vt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Kt=R("file-text",Wt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Jt=R("file",Yt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"M15 2a2 2 0 0 1 1.414.586l4 4A2 2 0 0 1 21 8v7a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z",key:"1vo8kb"}],["path",{d:"M15 2v4a2 2 0 0 0 2 2h4",key:"sud9ri"}],["path",{d:"M5 7a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 1.732-1",key:"l4dndm"}]],Qt=R("files",Zt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],As=R("funnel",Xt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Cs=R("heart",ea);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ye=R("info",sa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],aa=R("lightbulb",ta);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],na=R("loader-circle",ra);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Je=R("pause",ia);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],je=R("play",la);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ds=R("plus",oa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Z=R("refresh-cw",da);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ma=R("search",ca);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Ze=R("shield-alert",xa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ha=R("target",ga);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ze=R("trash-2",ua);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],ya=R("trending-down",pa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Qe=R("trending-up",ba);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],_s=R("triangle-alert",fa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ka=R("upload",ja);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],cs=R("user",Na);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],ms=R("volume-2",wa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ue=R("x",va);class Sa{constructor(t){ee(this,"baseUrl");this.baseUrl=t}async handleResponse(t){if(!t.ok){const a=await t.json().catch(()=>({}));throw ie(`HTTP_${t.status}`,a.message||`HTTP ${t.status}: ${t.statusText}`,{status:t.status,statusText:t.statusText,data:a})}return t.json()}async request(t,a={}){try{const r=this.baseUrl.endsWith("/")?this.baseUrl.slice(0,-1):this.baseUrl,m=t.startsWith("/")?t:`/${t}`,h=`${r}${m}`,y={"Content-Type":"application/json",...a.headers},N=await fetch(h,{...a,headers:y});return this.handleResponse(N)}catch(r){throw xt(r)?ie("NETWORK_ERROR","Unable to connect to the server. Please check your internet connection.",{originalError:r}):r instanceof Error&&"code"in r?r:ie("UNKNOWN_ERROR","An unexpected error occurred",{originalError:r})}}async get(t){return this.request(t,{method:"GET"})}async post(t,a){return this.request(t,{method:"POST",body:a?JSON.stringify(a):void 0})}async put(t,a){return this.request(t,{method:"PUT",body:a?JSON.stringify(a):void 0})}async delete(t){return this.request(t,{method:"DELETE"})}}const te=new Sa(ke.api.baseUrl),B={async checkHealth(){return te.get(Se.HEALTH)},async initiateSession(s){return te.post(Se.SESSIONS_INITIATE,s)},async submitPrediction(s){return te.post(Se.PREDICTIONS_SUBMIT,s)},async getPredictionBySessionId(s){return te.get(`${Se.PREDICTIONS_BY_SESSION}/${s}`)},async getUserPredictions(s){return te.get(`${Se.PREDICTIONS_BY_USER}/${s}`)},async saveSessionData(s){return te.post("sessions",s)},async getSessionData(s){return te.get(`sessions/${s}`)},async getUserSessions(s){return te.get(`sessions/users/${s}`)},async updateSessionData(s,t){return te.put(`sessions/${s}`,t)},async deleteSessionData(s){return te.delete(`sessions/${s}`)},async testConnection(){try{return await this.checkHealth(),{success:!0,message:"API connection successful"}}catch(s){return{success:!1,message:s.message||"Connection test failed"}}},async submitKintsugiWorkflow(s){return te.post("/kintsugiworkflow",s)},async generateRiskAssessment(s){return te.post(`sessions/${s}/risk-assessment`)},async getRiskAssessment(s){return te.get(`sessions/${s}/risk-assessment`)}};class xs{constructor(t,a={}){ee(this,"sessionId");ee(this,"intervalMs");ee(this,"maxAttempts");ee(this,"backoffFactor");ee(this,"currentAttempt",0);ee(this,"timeoutId",null);ee(this,"isPolling",!1);this.sessionId=t,this.intervalMs=a.intervalMs||ke.polling.intervalMs,this.maxAttempts=a.maxAttempts||ke.polling.maxAttempts,this.backoffFactor=a.backoffFactor||ke.polling.backoffFactor}async start(t,a,r){if(this.isPolling)return;this.isPolling=!0,this.currentAttempt=0;const m=async()=>{try{const h=await B.getPredictionBySessionId(this.sessionId);if(t(h),h.status==="succeeded"||h.status==="success"||h.status==="failed"){this.stop(),a(h);return}if(this.currentAttempt++,this.currentAttempt>=this.maxAttempts){this.stop(),r(ie("POLLING_TIMEOUT","Prediction polling timed out. Please check the session manually.",{sessionId:this.sessionId,attempts:this.currentAttempt}));return}const y=this.intervalMs*Math.pow(this.backoffFactor,this.currentAttempt);this.timeoutId=window.setTimeout(m,y)}catch(h){this.stop(),r(h)}};await m()}stop(){this.isPolling=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}getStatus(){return{isPolling:this.isPolling,attempt:this.currentAttempt,maxAttempts:this.maxAttempts}}}B.submitKintsugiWorkflow.bind(B);const Is={health:["health"],userPredictions:s=>["predictions","user",s],sessionPrediction:s=>["predictions","session",s],userSessions:s=>["sessions","user",s]},Ms=()=>us({queryKey:Is.health,queryFn:()=>B.checkHealth(),retry:2,staleTime:3e4,refetchOnWindowFocus:!1}),Aa=s=>{const t=s||Ie();return us({queryKey:Is.userSessions(t),queryFn:()=>B.getUserSessions(t),enabled:!!t,staleTime:3e4,refetchOnWindowFocus:!1})},Ca=()=>{const s=Ie(),{announce:t}=js(),{data:a,isLoading:r,error:m}=Ms(),{data:h,isLoading:y}=Aa(s);o.useEffect(()=>{t("Dashboard page loaded","polite")},[t]);const N=[{title:"Upload & Analyze",description:"Upload audio files for behavioral health analysis",href:"/upload",icon:"ðŸ“¤",color:"primary"},{title:"View Sessions",description:"Browse all analysis sessions and their results",href:"/sessions",icon:"ðŸ“Š",color:"secondary"},{title:"My Predictions",description:"View your complete prediction history",href:"/predictions",icon:"ðŸ“ˆ",color:"accent"},{title:"System Health",description:"Check API status and system connectivity",href:"/health",icon:"ðŸ¥",color:"warning"}],f=u=>{const b="block p-6 rounded-lg border-2 transition-all hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2";switch(u){case"primary":return`${b} border-primary-200 bg-primary-50 hover:border-primary-300 hover:bg-primary-100 dark:border-primary-800 dark:bg-primary-900 dark:hover:border-primary-700 dark:hover:bg-primary-800 focus:ring-primary-500`;case"secondary":return`${b} border-secondary-200 bg-secondary-50 hover:border-secondary-300 hover:bg-secondary-100 dark:border-secondary-800 dark:bg-secondary-900 dark:hover:border-secondary-700 dark:hover:bg-secondary-800 focus:ring-secondary-500`;case"accent":return`${b} border-accent-200 bg-accent-50 hover:border-accent-300 hover:bg-accent-100 dark:border-accent-800 dark:bg-accent-900 dark:hover:border-accent-700 dark:hover:bg-accent-800 focus:ring-accent-500`;case"warning":return`${b} border-warning-200 bg-warning-50 hover:border-warning-300 hover:bg-warning-100 dark:border-teal-600 dark:bg-teal-800 dark:hover:border-teal-500 dark:hover:bg-teal-700 focus:ring-warning-500`;default:return`${b} border-gray-200 bg-gray-50 hover:border-gray-300 hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700 focus:ring-gray-500`}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-text-primary-light dark:text-text-primary-dark",children:"Behavioral Health System"}),e.jsx("p",{className:"mt-2 text-lg text-text-secondary-light dark:text-text-secondary-dark",children:"Audio-based mental health prediction and analysis"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:"Your User ID"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded-md",children:e.jsx("code",{className:"text-sm font-mono text-text-primary-light dark:text-text-primary-dark break-all",children:s})}),e.jsx("p",{className:"mt-2 text-sm text-text-muted-light dark:text-text-muted-dark",children:"This ID is automatically generated and stored locally to track your sessions."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-6",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:N.map(u=>e.jsx(J,{to:u.href,className:f(u.color),"aria-label":`${u.title}: ${u.description}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-3",role:"img","aria-hidden":"true",children:u.icon}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-2",children:u.title}),e.jsx("p",{className:"text-sm text-text-secondary-light dark:text-text-secondary-dark",children:u.description})]})},u.href))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Recent Activity"}),y?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Loading recent sessions..."})]}):!(h!=null&&h.sessions)||h.sessions.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",role:"img","aria-label":"No data",children:"ðŸ“­"}),e.jsxs("p",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:["No sessions yet.",e.jsx(J,{to:"/upload",className:"text-primary-600 dark:text-primary-400 hover:underline ml-1",children:"Upload your first audio file"})," to get started."]})]}):e.jsxs("div",{className:"space-y-3",children:[h.sessions.slice(0,3).map(u=>{var b,I;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`status-${u.status||"completed"}`,children:u.status||"completed"}),e.jsx("span",{className:"text-text-primary-light dark:text-text-primary-dark",children:u.audioFileName||((b=u.sessionId)==null?void 0:b.slice(0,8))||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",title:u.createdAt,children:u.createdAt?new Date(u.createdAt).toLocaleString():""})]}),e.jsx(J,{to:`/sessions/${u.sessionId||""}`,className:"text-primary-600 dark:text-primary-400 hover:underline text-sm flex items-center gap-1",title:"View session details","aria-label":`View details for session ${u.audioFileName||((I=u.sessionId)==null?void 0:I.slice(0,8))||"Unknown"}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})})]},u.sessionId)}),h.sessions.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs(J,{to:"/sessions",className:"text-primary-600 dark:text-primary-400 hover:underline",children:["View all ",h.sessions.length," sessions â†’"]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"System Status"}),r?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"Checking system health..."})]}):m?e.jsxs("div",{className:"flex items-center space-x-2 text-error-600 dark:text-error-400",children:[e.jsx("span",{role:"img","aria-label":"Error",children:"âš ï¸"}),e.jsx("span",{children:"System health check failed"})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-success-600 dark:text-success-400",children:[e.jsx("span",{role:"img","aria-label":"Healthy",children:"âœ…"}),e.jsx("span",{children:"All systems operational"}),(a==null?void 0:a.checks)&&e.jsxs("span",{className:"text-text-muted-light dark:text-text-muted-dark",children:["(",Object.keys(a.checks).length," services checked)"]})]})]})]})};class _a{constructor(){ee(this,"ffmpeg",null);ee(this,"isLoaded",!1);ee(this,"loadingPromise",null);this.ffmpeg=new Xs}async loadFFmpeg(){if(!this.isLoaded)return this.loadingPromise?this.loadingPromise:(this.loadingPromise=this.doLoadFFmpeg(),this.loadingPromise)}async doLoadFFmpeg(){if(!this.ffmpeg)throw ie("FFMPEG_INIT_ERROR","Failed to initialize FFmpeg");try{const t="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";await this.ffmpeg.load({coreURL:await ts(`${t}/ffmpeg-core.js`,"text/javascript"),wasmURL:await ts(`${t}/ffmpeg-core.wasm`,"application/wasm")}),this.isLoaded=!0}catch(t){throw this.loadingPromise=null,ie("FFMPEG_LOAD_ERROR","Failed to load FFmpeg. Please check your internet connection and try again.",{originalError:t})}}async convertAudio(t,a={outputFormat:"wav",sampleRate:44100,channels:1},r){try{if(r==null||r({stage:"loading",progress:0,message:"Loading audio processor..."}),await this.loadFFmpeg(),!this.ffmpeg)throw ie("FFMPEG_NOT_LOADED","FFmpeg not properly loaded");this.ffmpeg.on("progress",({progress:b})=>{r==null||r({stage:"converting",progress:Math.round(b*100),message:`Converting audio... ${Math.round(b*100)}%`})}),r==null||r({stage:"converting",progress:0,message:"Preparing audio file..."});const m="input."+this.getFileExtension(t.name);await this.ffmpeg.writeFile(m,await et(t));const h=`output.${a.outputFormat}`,y=["-i",m,"-ac",a.channels.toString(),"-ar",a.sampleRate.toString(),"-f",a.outputFormat,h];await this.ffmpeg.exec(y);const N=await this.ffmpeg.readFile(h),f=new Blob([N],{type:`audio/${a.outputFormat}`}),u=new File([f],`${this.getFileNameWithoutExtension(t.name)}.${a.outputFormat}`,{type:`audio/${a.outputFormat}`});return await this.ffmpeg.deleteFile(m),await this.ffmpeg.deleteFile(h),r==null||r({stage:"completed",progress:100,message:"Audio conversion completed"}),u}catch(m){throw ie("AUDIO_CONVERSION_ERROR","Failed to convert audio file. Please try with a different file.",{originalError:m,fileName:t.name,fileSize:t.size,fileType:t.type})}}getFileExtension(t){const a=t.lastIndexOf(".");return a!==-1?t.slice(a+1).toLowerCase():""}getFileNameWithoutExtension(t){const a=t.lastIndexOf(".");return a!==-1?t.slice(0,a):t}async isFormatSupported(t){try{await this.loadFFmpeg();const a=["wav","mp3","mp4","m4a","aac","flac","ogg"],r=this.getFileExtension(t.name);return a.includes(r)}catch{return!1}}dispose(){this.ffmpeg&&(this.ffmpeg.terminate(),this.ffmpeg=null),this.isLoaded=!1,this.loadingPromise=null}}let qe=null;const Ia=()=>(qe||(qe=new _a),qe),Ve=async(s,t)=>{const r=await Ia().convertAudio(s,{outputFormat:"wav",sampleRate:44100,channels:1},t?m=>t(m.progress):void 0);return new Blob([r],{type:"audio/wav"})};class Ma{constructor(t){ee(this,"containerClient",null);ee(this,"sasUrl");if(this.sasUrl=t||ke.azure.blobSasUrl,!this.sasUrl)throw ie("AZURE_CONFIG_ERROR","Azure Blob Storage SAS URL not configured")}getContainerClient(){if(!this.containerClient)try{const t=new st(this.sasUrl);this.containerClient=t.getContainerClient(ke.azure.containerName)}catch(t){throw ie("AZURE_CLIENT_ERROR","Failed to initialize Azure Blob Storage client",{originalError:t})}return this.containerClient}async uploadFile(t,a,r){try{r==null||r({progress:0,stage:"preparing",message:"Preparing upload..."});const m=this.getContainerClient(),h=a||this.generateBlobName(t.name),y=m.getBlockBlobClient(h);r==null||r({progress:10,stage:"uploading",message:"Starting upload..."}),await y.uploadData(t,{blobHTTPHeaders:{blobContentType:t.type},onProgress:f=>{const u=f.loadedBytes&&t.size?Math.round(f.loadedBytes/t.size*90)+10:50;r==null||r({progress:u,stage:"uploading",message:`Uploading... ${u}%`})}});const N=y.url;return r==null||r({progress:100,stage:"completed",message:"Upload completed"}),{url:N,fileName:h,size:t.size}}catch(m){throw ie("UPLOAD_ERROR","Failed to upload file to Azure Blob Storage",{originalError:m,fileName:t.name,fileSize:t.size})}}generateBlobName(t){const a=new Date().toISOString().replace(/[:.]/g,"-"),r=Math.random().toString(36).substring(2,8),m=t.split(".").pop()||"wav";return`audio/${a}-${r}.${m}`}async testConnection(){try{return await this.getContainerClient().getProperties(),{success:!0,message:"Azure Blob Storage connection successful"}}catch{return{success:!1,message:"Failed to connect to Azure Blob Storage. Please check your SAS URL configuration."}}}async deleteFile(t){try{await this.getContainerClient().getBlockBlobClient(t).deleteIfExists()}catch(a){throw ie("DELETE_ERROR","Failed to delete file from Azure Blob Storage",{originalError:a,fileName:t})}}}let Oe=null;const Ra=s=>((!Oe||s&&s!==Oe.sasUrl)&&(Oe=new Ma(s)),Oe),Ge=async(s,t,a)=>{const r=Ra(),m=s instanceof File?s:new File([s],t,{type:s.type});return(await r.uploadFile(m,t,a?y=>a(y.progress):void 0)).url},Me=()=>{const s=o.useRef(null),t=o.useCallback(N=>{if(!s.current){const f=document.createElement("div");f.setAttribute("aria-live","polite"),f.setAttribute("aria-atomic","true"),f.style.position="absolute",f.style.left="-10000px",f.style.width="1px",f.style.height="1px",f.style.overflow="hidden",document.body.appendChild(f),s.current=f}s.current.textContent="",setTimeout(()=>{s.current&&(s.current.textContent=N)},100)},[]),a={focusById:N=>{const f=document.getElementById(N);f&&f.focus()},focusFirstInContainer:N=>{const u=N.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];u&&u.focus()},trapFocus:N=>{const f=N.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),u=f[0],b=f[f.length-1],I=w=>{w.key==="Tab"&&(w.shiftKey?document.activeElement===u&&(b.focus(),w.preventDefault()):document.activeElement===b&&(u.focus(),w.preventDefault()))};return N.addEventListener("keydown",I),()=>{N.removeEventListener("keydown",I)}}},r={handleArrowNavigation:(N,f,u,b)=>{var w;let I=u;switch(N.key){case"ArrowDown":N.preventDefault(),I=u<f.length-1?u+1:0;break;case"ArrowUp":N.preventDefault(),I=u>0?u-1:f.length-1;break;case"Home":N.preventDefault(),I=0;break;case"End":N.preventDefault(),I=f.length-1;break;default:return}b(I),(w=f[I])==null||w.focus()},handleEscape:(N,f)=>{N.key==="Escape"&&(N.preventDefault(),f())}},m=o.useCallback((N="element")=>`${N}-${Math.random().toString(36).substr(2,9)}`,[]),h=o.useCallback(()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),y=o.useCallback((N,f,u)=>{const b={};return N||(b["aria-invalid"]="true",f&&u&&(b["aria-describedby"]=u)),b},[]);return{announceToScreenReader:t,focusManagement:a,keyboardNavigation:r,generateId:m,prefersReducedMotion:h,getValidationAttributes:y}},$a=()=>{const[s,t]=o.useState([]),[a,r]=o.useState(()=>ct()),[m,h]=o.useState({}),[y,N]=o.useState({}),[f,u]=o.useState({}),[b,I]=o.useState(!1),[w,z]=o.useState(null),[v,S]=o.useState({stage:"idle",progress:0,message:""}),[k,q]=o.useState(null),[se,Q]=o.useState(!1),[le,oe]=o.useState(0),[x,i]=o.useState(null),[l,p]=o.useState({age:"",gender:"",race:"",ethnicity:"",language:"",weight:"",zipcode:"",sessionNotes:""}),[c,g]=o.useState(null),[A,L]=o.useState([]),[V,ce]=o.useState(()=>lt()),[G,Y]=o.useState(""),[F,E]=o.useState(null),C=Ie(),H=o.useRef(null),ae=o.useRef(null),{announceToScreenReader:O}=Me(),T=o.useCallback((n,d,j)=>{const _=Date.now().toString()+Math.random().toString(36).substr(2,9),M={id:_,type:n,title:d,message:j,timestamp:Date.now()};L(W=>[...W,M]),setTimeout(()=>{L(W=>W.filter(re=>re.id!==_))},n==="error"?8e3:5e3)},[]),Re=o.useCallback(n=>{L(d=>d.filter(j=>j.id!==n))},[]),ue=o.useCallback(()=>{t([]),z(null),S({stage:"idle",progress:0,message:""}),q(null),N({}),h({}),g(null),Q(!1),oe(0),i(null),I(!1)},[]),we=o.useCallback(()=>{ce(n=>{const d=!n;if(ot(d),E(null),d)Y(C),O("Switched to custom User ID mode");else{Y("");const j=ns();O(`Switched to auto-generated mode. New User ID: ${j}`)}return d})},[C,O]),Rs=o.useCallback(n=>{Y(n),E(null)},[]),$s=o.useCallback(()=>{const n=G.trim();if(!n){E("User ID cannot be empty");return}if(n.length<3){E("User ID must be at least 3 characters long");return}if(n.length>100){E("User ID must be less than 100 characters");return}if(/[<>"/\\|?*\x00-\x1f]/.test(n)){E('User ID contains invalid characters. Please avoid special characters like < > " / \\ | ? *');return}try{it(n),E(null),O(`Custom User ID applied: ${n}`),window.location.reload()}catch(j){const _=j instanceof Error?j.message:"Failed to set User ID";E(_)}},[G,O]),Es=o.useCallback(()=>{const n=ns();O(`New User ID generated: ${n}`),window.location.reload()},[O]),Ds=()=>Date.now().toString()+Math.random().toString(36).substr(2,9),Xe=o.useCallback(n=>{const d=Ds(),j=URL.createObjectURL(n),_={id:d,file:n,url:j};a?(t($=>[...$,_]),u($=>({...$,[d]:"ready"})),h($=>({...$,[d]:{stage:"idle",progress:0,message:"Ready to process"}}))):z(_),O(`Audio file selected: ${n.name}`);const M=new Audio(j);M.addEventListener("loadedmetadata",()=>{a?t($=>$.map(W=>W.id===d?{...W,duration:M.duration}:W)):z($=>$?{...$,duration:M.duration}:null)})},[a,O]),Fs=o.useCallback(n=>{a&&(t(d=>{const j=d.find(_=>_.id===n);return j&&URL.revokeObjectURL(j.url),d.filter(_=>_.id!==n)}),h(d=>{const{[n]:j,..._}=d;return _}),N(d=>{const{[n]:j,..._}=d;return _}),u(d=>{const{[n]:j,..._}=d;return _}))},[a]),$e=o.useCallback(n=>{const d=n.target.files;!d||d.length===0||Array.from(d).forEach(j=>{const _=["audio/wav","audio/wave","audio/x-wav","audio/mp3","audio/mpeg","audio/mp4","audio/m4a","audio/x-m4a","audio/mp4a-latm","audio/aac","audio/x-aac","audio/flac","audio/x-flac"],M=j.name.toLowerCase(),W=[".wav",".mp3",".m4a",".aac",".flac"].some(pe=>M.endsWith(pe));if(!_.includes(j.type)&&!W){g(`Unsupported file type for ${j.name}. Please select supported audio files (WAV, MP3, M4A, AAC, or FLAC)`),T("error","Unsupported File",`${j.name} is not a supported audio file format`),O(`Error: Unsupported file format selected for ${j.name}`);return}const me=50*1024*1024;if(j.size>me){g(`File ${j.name} is too large. File size must be less than 50MB`),T("error","File Too Large",`${j.name} size must be less than 50MB`),O(`Error: File ${j.name} is too large`);return}Xe(j),g(null)})},[O,Xe,T]),Ts=o.useCallback(n=>{n.preventDefault()},[]),Us=o.useCallback(n=>{n.preventDefault();const d=n.dataTransfer.files;d.length>0&&$e({target:{files:d}})},[$e]),Os=o.useCallback(()=>{r(n=>{const d=!n;return mt(d),ue(),d})},[ue]),Ls=o.useCallback(()=>{H.current&&(se?(H.current.pause(),Q(!1),O("Audio paused")):(H.current.play(),Q(!0),O("Audio playing")))},[se,O]),Ps=o.useCallback(()=>{H.current&&oe(H.current.currentTime)},[]),Ee=o.useCallback(n=>{const d=Math.floor(n/60),j=Math.floor(n%60);return`${d}:${j.toString().padStart(2,"0")}`},[]),fe=o.useCallback(()=>{const n=[];if(l.age){const d=parseInt(l.age);(isNaN(d)||d<18||d>130)&&n.push("Age must be between 18 and 130")}if(l.gender&&(["male","female","non-binary","transgender female","transgender male","other","prefer"].includes(l.gender)||n.push("Invalid gender. Must be: male, female, non-binary, transgender female, transgender male, other, or prefer")),l.race&&(["white","black or african-american","asian","american indian or alaskan native","native Hawaiian or pacific islander","two or more races","other","prefer not to say"].includes(l.race)||n.push("Invalid race. Must be: white, black or african-american, asian, american indian or alaskan native, native Hawaiian or pacific islander, two or more races, other, prefer not to say")),l.ethnicity&&(["Hispanic, Latino, or Spanish Origin","Not Hispanic, Latino, or Spanish Origin"].includes(l.ethnicity)||n.push("Invalid ethnicity. Must be: Hispanic, Latino, or Spanish Origin | Not Hispanic, Latino, or Spanish Origin")),l.zipcode&&(/^[a-zA-Z0-9]{1,10}$/.test(l.zipcode)||n.push("Zipcode must be alphanumeric and contain no more than 10 characters")),l.weight){const d=parseInt(l.weight);(isNaN(d)||d<10||d>1e3)&&n.push("Weight must be between 10 and 1000 pounds (lbs)")}return n},[l]),De=o.useCallback(()=>{const n={};let d=!1;return l.age&&(n.age=parseInt(l.age),d=!0),l.gender&&(n.gender=l.gender,d=!0),l.race&&(n.race=l.race,d=!0),l.ethnicity&&(n.ethnicity=l.ethnicity,d=!0),(l.language==="true"||l.language==="false")&&(n.language=l.language==="true",d=!0),l.weight&&(n.weight=parseInt(l.weight),d=!0),l.zipcode&&(n.zipcode=l.zipcode,d=!0),d?n:void 0},[l]),zs=o.useCallback(async()=>{if(a){if(s.length===0||!C.trim()){g("Please select audio files. User ID is automatically generated."),T("error","Missing Information","Please select audio files. User ID is automatically generated.");return}await es()}else{if(!w||!C.trim()){g("Please select an audio file. User ID is automatically generated."),T("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}await Hs()}},[w,s,C,a]),Fe=o.useCallback(async(n,d)=>{try{h(P=>({...P,[n]:{stage:"initiating",progress:5,message:"Initiating session..."}}));const j=De(),_={userid:C.trim(),is_initiated:!0};j&&(_.metadata=j);const M=await B.initiateSession(_),$={sessionId:M.sessionId,userId:C.trim()};h(P=>({...P,[n]:{stage:"initiating",progress:10,message:"Saving session data..."}}));const W={sessionId:M.sessionId,userId:C.trim(),userMetadata:j,audioFileName:d.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await B.saveSessionData(W)}catch{}h(P=>({...P,[n]:{stage:"converting",progress:15,message:"Converting audio to required format..."}}));const re=await Ve(d.file,P=>{h(D=>({...D,[n]:{stage:"converting",progress:15+P*.25,message:`Converting audio... ${Math.round(P)}%`}}))});h(P=>({...P,[n]:{stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}}));const me=`${C}_${$.sessionId}_${Date.now()}.wav`,pe=await Ge(re,me,P=>{h(D=>({...D,[n]:{stage:"uploading",progress:40+P*.25,message:`Uploading... ${Math.round(P)}%`}}))});h(P=>({...P,[n]:{stage:"submitting",progress:65,message:"Submitting for analysis..."}}));try{const P={...W,audioUrl:pe,audioFileName:me,status:"processing",updatedAt:new Date().toISOString()};await B.updateSessionData($.sessionId,P)}catch(P){console.warn("Failed to update session data with audio info:",P)}await B.submitPrediction({userId:C.trim(),sessionid:$.sessionId,audioFileUrl:pe,audioFileName:me}),h(P=>({...P,[n]:{stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}}));const X=new xs($.sessionId);await new Promise((P,D)=>{X.start(U=>{const ve=U.status==="processing"?80:U.status==="success"?95:70;h(xe=>({...xe,[n]:{stage:"analyzing",progress:ve,message:`Analysis ${U.status}...`}})),U.predictError&&T("error","Prediction Error",`${U.predictError.error}: ${U.predictError.message}`)},U=>{if(U.predictError){T("error","Analysis Failed",`The analysis completed with an error: ${U.predictError.error} - ${U.predictError.message}`),h(xe=>({...xe,[n]:{stage:"error",progress:0,message:"Analysis failed with errors"}})),D(new Error(`Prediction error: ${U.predictError.error}`));return}const ve={sessionId:$.sessionId,depressionScore:U.predictedScoreDepression?parseFloat(U.predictedScoreDepression):0,riskLevel:U.predictedScoreDepression&&parseFloat(U.predictedScoreDepression)>.7?"high":U.predictedScoreDepression&&parseFloat(U.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",U.predictedScoreDepression?`Depression score: ${U.predictedScoreDepression}`:"",U.predictedScoreAnxiety?`Anxiety score: ${U.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(xe=>xe.trim()!==""),timestamp:U.updatedAt,audioUrl:pe,rawApiResponse:U};h(xe=>({...xe,[n]:{stage:"complete",progress:100,message:"Analysis complete!"}})),N(xe=>({...xe,[n]:ve})),P()},U=>{D(U)})})}catch(j){throw h(_=>({..._,[n]:{stage:"error",progress:0,message:"Processing failed"}})),j}},[C,De,B,Ge,Ve,T]),es=o.useCallback(async()=>{I(!0),g(null);const n=fe();if(n.length>0){g(`Validation error: ${n.join(", ")}`),T("error","Validation Error",n.join(", ")),I(!1);return}const d=s.filter(M=>f[M.id]==="ready");if(d.length===0){T("info","No Files Ready","No files are ready to process"),I(!1);return}const j=d.length;let _=0;try{for(const M of d){_++,T("info","Processing File",`Processing ${M.file.name} (${_}/${j})`),u($=>({...$,[M.id]:"processing"}));try{await Fe(M.id,M),u($=>({...$,[M.id]:"complete"})),T("success","File Complete",`${M.file.name} processed successfully`)}catch($){const W=$ instanceof Error?$.message:"An unexpected error occurred";T("error","File Failed",`Failed to process ${M.file.name}: ${W}`),u(re=>({...re,[M.id]:"error"})),h(re=>({...re,[M.id]:{stage:"error",progress:0,message:`Failed: ${W}`}}))}}T("success","Batch Complete",`Processed ${_} file${_!==1?"s":""}`),O(`Batch processing complete. ${_} files processed.`)}catch(M){const $=M instanceof Error?M.message:"An unexpected error occurred";g($),T("error","Batch Failed",$),O(`Error: ${$}`)}finally{I(!1)}},[s,f,fe,T,O,Fe]),Bs=o.useCallback(async n=>{const d=s.find(_=>_.id===n);if(!d)return;const j=fe();if(j.length>0){g(`Validation error: ${j.join(", ")}`),T("error","Validation Error",j.join(", "));return}u(_=>({..._,[n]:"processing"}));try{await Fe(n,d),u(_=>({..._,[n]:"complete"})),T("success","File Complete",`${d.file.name} processed successfully`)}catch(_){console.error(`Error processing ${d.file.name}:`,_);const M=_ instanceof Error?_.message:"An unexpected error occurred";T("error","File Failed",`Failed to process ${d.file.name}: ${M}`),u($=>({...$,[n]:"error"})),h($=>({...$,[n]:{stage:"error",progress:0,message:`Failed: ${M}`}}))}},[s,fe,T,Fe]),Hs=o.useCallback(async()=>{if(!w||!C.trim()){g("Please select an audio file. User ID is automatically generated."),T("error","Missing Information","Please select an audio file. User ID is automatically generated.");return}const n=fe();if(n.length>0){g(`Validation error: ${n.join(", ")}`),T("error","Validation Error",n.join(", "));return}try{g(null),S({stage:"initiating",progress:5,message:"Initiating session..."}),O("Starting analysis process - initiating session");const d=De(),j={userid:C.trim(),is_initiated:!0};d&&(j.metadata=d);const _=await B.initiateSession(j),M={sessionId:_.sessionId,userId:C.trim()};S({stage:"initiating",progress:10,message:"Saving session data..."});const $={sessionId:_.sessionId,userId:C.trim(),userMetadata:d,audioFileName:w.file.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"initiated"};try{await B.saveSessionData($)}catch{}S({stage:"converting",progress:15,message:"Converting audio to required format..."}),O("Session created successfully, now converting audio");const W=await Ve(w.file,X=>{S({stage:"converting",progress:15+X*.25,message:`Converting audio... ${Math.round(X)}%`})});S({stage:"uploading",progress:40,message:"Uploading to Azure Blob Storage..."}),O("Audio converted successfully, now uploading");const re=`${C}_${M.sessionId}_${Date.now()}.wav`,me=await Ge(W,re,X=>{S({stage:"uploading",progress:40+X*.25,message:`Uploading... ${Math.round(X)}%`})});S({stage:"submitting",progress:65,message:"Submitting for analysis..."}),O("Upload complete, submitting for behavioral health analysis");try{const X={...$,audioUrl:me,audioFileName:re,status:"processing",updatedAt:new Date().toISOString()};await B.updateSessionData(M.sessionId,X)}catch(X){console.warn("Failed to update session data with audio info:",X)}await B.submitPrediction({userId:C.trim(),sessionid:M.sessionId,audioFileUrl:me,audioFileName:re}),S({stage:"analyzing",progress:70,message:"Analyzing audio with Kintsugi Health API..."}),O("Prediction submitted, analysis in progress");const pe=new xs(M.sessionId);await new Promise((X,P)=>{pe.start(D=>{const U=D.status==="processing"?80:D.status==="success"?95:70;S({stage:"analyzing",progress:U,message:`Analysis ${D.status}...`}),D.predictError&&T("error","Prediction Error",`${D.predictError.error}: ${D.predictError.message}`)},D=>{if(D.predictError){T("error","Analysis Failed",`The analysis completed with an error: ${D.predictError.error} - ${D.predictError.message}`),S({stage:"error",progress:0,message:"Analysis failed with errors"}),P(new Error(`Prediction error: ${D.predictError.error}`));return}const U={sessionId:M.sessionId,depressionScore:D.predictedScoreDepression?parseFloat(D.predictedScoreDepression):0,riskLevel:D.predictedScoreDepression&&parseFloat(D.predictedScoreDepression)>.7?"high":D.predictedScoreDepression&&parseFloat(D.predictedScoreDepression)>.4?"medium":"low",confidence:.85,insights:["Analysis completed using Kintsugi Health API",D.predictedScoreDepression?`Depression score: ${D.predictedScoreDepression}`:"",D.predictedScoreAnxiety?`Anxiety score: ${D.predictedScoreAnxiety}`:"","Results should be reviewed by a qualified healthcare professional"].filter(ve=>ve.trim()!==""),timestamp:D.updatedAt,audioUrl:me,rawApiResponse:D};S({stage:"complete",progress:100,message:"Analysis complete!"}),q(U),T("success","Analysis Complete","Your behavioral health analysis has been completed successfully."),O("Behavioral health analysis completed successfully"),X()},D=>{T("error","Analysis Error",D.message||"An unexpected error occurred during analysis."),P(D)})})}catch(d){console.error("Processing error:",d);const j=d instanceof Error?d.message:"An unexpected error occurred";g(j),S({stage:"error",progress:0,message:"Processing failed"}),T("error","Processing Failed",j),O(`Error: ${j}`)}},[w,C,O,fe,De]),ss=o.useCallback(n=>{switch(n){case"error":return"bg-red-500";case"complete":return"bg-green-500";default:return"bg-blue-500"}},[]);return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Processing Mode:"}),e.jsxs("div",{className:"relative inline-flex items-center",children:[e.jsx("button",{type:"button",onClick:Os,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 ${a?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500"}`,"aria-label":`Switch to ${a?"single file":"multi-file"} mode`,children:e.jsx("span",{className:`inline-flex h-6 w-6 transform rounded-full bg-white items-center justify-center transition-transform ${a?"translate-x-9":"translate-x-1"}`,children:a?e.jsx(Qt,{className:"h-3 w-3 text-blue-600"}):e.jsx(Jt,{className:"h-3 w-3 text-gray-600"})})}),e.jsxs("div",{className:"ml-3 flex items-center space-x-4",children:[e.jsx("span",{className:`text-sm font-medium ${a?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:"Single"}),e.jsx("span",{className:`text-sm font-medium ${a?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"}`,children:"Multi"})]})]})]}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${a?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),"Batch Processing"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v8H4V6z",clipRule:"evenodd"})}),"Single File"]})})]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Upload & Analyze Audio"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Upload ",a?"multiple audio files":"an audio file"," for behavioral health analysis using AI-powered speech pattern recognition"]}),e.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-lg text-sm ${a?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M9 12a1 1 0 000 2h2a1 1 0 100-2H9z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 0v12h8V4H6z",clipRule:"evenodd"})]}),"Process multiple files with individual controls and batch options"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Upload and analyze one file at a time with detailed progress tracking"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Patient Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 lg:col-span-3 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"User ID Management"}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 p-4 rounded-md border space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current User ID:"}),e.jsx("code",{className:"text-sm font-mono text-gray-900 dark:text-gray-100 break-all block bg-white dark:bg-gray-800 p-2 rounded border",children:C})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:we,className:"px-3 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors","aria-describedby":"user-id-mode-help",children:V?"Switch to Auto-Generated":"Use Custom User ID"}),!V&&e.jsx("button",{type:"button",onClick:Es,className:"px-3 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800 transition-colors",title:"Generate a new random User ID",children:"Generate New ID"})]}),V&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:G,onChange:n=>Rs(n.target.value),placeholder:"Enter custom User ID (any unique string)",className:"flex-1 px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-describedby":"custom-user-id-help","aria-invalid":F?"true":"false"}),e.jsx("button",{type:"button",onClick:$s,disabled:!G.trim(),className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Apply"})]}),F&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",role:"alert",children:F}),e.jsx("p",{id:"custom-user-id-help",className:"text-xs text-gray-500 dark:text-gray-400",children:'Any unique string (3-100 characters). Examples: "patient-001", "john.doe@clinic", "study-participant-42"'})]}),e.jsx("p",{id:"user-id-mode-help",className:"text-xs text-gray-500 dark:text-gray-400",children:V?"Custom mode: Use any unique identifier for tracking (e.g., patient ID, username, study code)":"Auto mode: System generates unique UUIDs automatically"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age (Optional)"}),e.jsx("input",{type:"number",id:"age",value:l.age,onChange:n=>p(d=>({...d,age:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Age in years",min:"1",max:"150"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight (Optional)"}),e.jsx("input",{type:"number",id:"weight",value:l.weight,onChange:n=>p(d=>({...d,weight:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Weight in lbs",min:"1",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender (Optional)"}),e.jsxs("select",{id:"gender",value:l.gender,onChange:n=>p(d=>({...d,gender:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"non-binary",children:"Non-binary"}),e.jsx("option",{value:"transgender female",children:"Transgender female"}),e.jsx("option",{value:"transgender male",children:"Transgender male"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer",children:"Prefer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"race",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race (Optional)"}),e.jsxs("select",{id:"race",value:l.race,onChange:n=>p(d=>({...d,race:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select race"}),e.jsx("option",{value:"white",children:"White"}),e.jsx("option",{value:"black or african-american",children:"Black or African-American"}),e.jsx("option",{value:"asian",children:"Asian"}),e.jsx("option",{value:"american indian or alaskan native",children:"American Indian or Alaskan Native"}),e.jsx("option",{value:"native Hawaiian or pacific islander",children:"Native Hawaiian or Pacific Islander"}),e.jsx("option",{value:"two or more races",children:"Two or more races"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer not to say",children:"Prefer not to say"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ethnicity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity (Optional)"}),e.jsxs("select",{id:"ethnicity",value:l.ethnicity,onChange:n=>p(d=>({...d,ethnicity:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select ethnicity"}),e.jsx("option",{value:"Hispanic, Latino, or Spanish Origin",children:"Hispanic, Latino, or Spanish Origin"}),e.jsx("option",{value:"Not Hispanic, Latino, or Spanish Origin",children:"Not Hispanic, Latino, or Spanish Origin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language (Optional)"}),e.jsxs("select",{id:"language",value:l.language,onChange:n=>p(d=>({...d,language:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Select language"}),e.jsx("option",{value:"true",children:"English"}),e.jsx("option",{value:"false",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"zipcode",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code (Optional)"}),e.jsx("input",{type:"text",id:"zipcode",value:l.zipcode,onChange:n=>p(d=>({...d,zipcode:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter ZIP code",pattern:"[0-9]{5}(-[0-9]{4})?",title:"Enter a valid ZIP code (e.g., 12345 or 12345-6789)"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{htmlFor:"sessionNotes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes (Optional)"}),e.jsx("textarea",{id:"sessionNotes",value:l.sessionNotes,onChange:n=>p(d=>({...d,sessionNotes:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",rows:3,placeholder:"Additional notes about this session or patient context"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Audio File Upload ",a&&e.jsx("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:"(Multi-File Mode)"})]}),!a&&!w||a&&s.length===0?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors",onDragOver:Ts,onDrop:Us,children:[e.jsx(ka,{className:"mx-auto h-12 w-12 text-gray-400 mb-4","aria-hidden":"true"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{type:"button",onClick:()=>{var n;return(n=ae.current)==null?void 0:n.click()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Select Audio File",a?"s":""]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["or drag and drop ",a?"files":"file"," here"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Supported formats: WAV, MP3, M4A, AAC, FLAC (max 50MB each)",a&&e.jsx("br",{}),a&&"You can select multiple files at once"]}),e.jsx("input",{ref:ae,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:$e,multiple:a,"aria-label":`Select audio file${a?"s":""} for analysis`})]}):e.jsxs("div",{className:"space-y-4",children:[!a&&w&&e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ms,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:w.file.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(w.file.size/1024/1024).toFixed(2)," MB",w.duration&&` â€¢ ${Ee(w.duration)}`]})]})]}),e.jsx("button",{type:"button",onClick:ue,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Remove selected file",children:e.jsx(Ue,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:Ls,className:"flex items-center justify-center w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800","aria-label":se?"Pause audio":"Play audio",children:se?e.jsx(Je,{className:"h-5 w-5","aria-hidden":"true"}):e.jsx(je,{className:"h-5 w-5 ml-0.5","aria-hidden":"true"})}),e.jsx("div",{className:"flex-1",children:w.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[Ee(le)," / ",Ee(w.duration)]})})]}),w.duration&&e.jsx("div",{className:"audio-progress",children:e.jsx("div",{className:"audio-progress__fill progress-dynamic progress-animated",style:{"--progress-width":`${le/w.duration*100}%`},role:"progressbar","aria-label":"Audio playback progress","aria-valuenow":le,"aria-valuemin":0,"aria-valuemax":w.duration})})]}),e.jsx("audio",{ref:H,src:w.url,onTimeUpdate:Ps,onEnded:()=>Q(!1),onPlay:()=>Q(!0),onPause:()=>Q(!1),className:"hidden"})]}),a&&s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Selected Files (",s.length,")"]}),e.jsxs("button",{type:"button",onClick:()=>{var n;return(n=ae.current)==null?void 0:n.click()},className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Add More Files"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(n=>{const d=f[n.id]||"ready",j=m[n.id];return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[e.jsx(ms,{className:"h-4 w-4 text-blue-500 flex-shrink-0","aria-hidden":"true"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:n.file.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(n.file.size/1024/1024).toFixed(2)," MB",n.duration&&` â€¢ ${Ee(n.duration)}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d==="ready"&&e.jsxs("button",{type:"button",onClick:()=>Bs(n.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-offset-gray-800","aria-label":`Start processing ${n.file.name}`,children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),"Start"]}),d==="processing"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"Processing..."}),d==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Complete"]}),d==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]}),e.jsx("button",{type:"button",onClick:()=>Fs(n.id),className:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400","aria-label":`Remove ${n.file.name}`,children:e.jsx(ze,{className:"h-4 w-4"})})]})]}),j&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:j.message}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[Math.round(j.progress),"%"]})]}),e.jsx("div",{className:"processing-progress mt-1",children:e.jsx("div",{className:`processing-progress__fill progress-dynamic progress-animated ${ss(j.stage)}`,style:{"--progress-width":`${j.progress}%`}})})]})]},n.id)})}),e.jsx("input",{ref:ae,type:"file",className:"hidden",accept:".wav,.mp3,.m4a,.aac,.flac,audio/*",onChange:$e,multiple:a,"aria-label":"Select additional audio files for analysis"})]})]})]}),c&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",role:"alert",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"h-5 w-5 text-red-500 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-red-700 dark:text-red-300",children:c})]})}),!a&&v.stage!=="idle"&&!k&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Processing Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:v.message}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[Math.round(v.progress),"%"]})]}),e.jsx("div",{className:"processing-progress",children:e.jsx("div",{className:`processing-progress__fill progress-dynamic progress-animated ${ss(v.stage)}`,style:{"--progress-width":`${v.progress}%`},role:"progressbar","aria-label":"Processing progress","aria-valuenow":v.progress,"aria-valuemin":0,"aria-valuemax":100})}),v.stage==="analyzing"&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(na,{className:"h-4 w-4 animate-spin mr-2","aria-hidden":"true"}),"This may take a few minutes..."]})]})]}),k&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ne,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Analysis Results"})]}),k.rawApiResponse&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"API Response Details"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Predicted Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.predicted_score_anxiety||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`font-mono ${k.rawApiResponse.status==="success"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:k.rawApiResponse.status||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Model Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Category:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.model_category||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Granularity:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.model_granularity||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Calibrated:"}),e.jsx("span",{className:`font-mono ${k.rawApiResponse.is_calibrated?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"}`,children:k.rawApiResponse.is_calibrated?"Yes":"No"})]})]})]}),k.rawApiResponse.actual_score&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Clinical Assessment Scores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[k.rawApiResponse.actual_score.depression_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.actual_score.depression_binary||"N/A"})]}),k.rawApiResponse.actual_score.anxiety_binary!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety Binary:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:k.rawApiResponse.actual_score.anxiety_binary||"N/A"})]}),k.rawApiResponse.actual_score.phq_9&&k.rawApiResponse.actual_score.phq_9.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-9:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",k.rawApiResponse.actual_score.phq_9.join(", "),"]"]})]}),k.rawApiResponse.actual_score.phq_2&&k.rawApiResponse.actual_score.phq_2.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PHQ-2:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",k.rawApiResponse.actual_score.phq_2.join(", "),"]"]})]}),k.rawApiResponse.actual_score.gad_7&&k.rawApiResponse.actual_score.gad_7.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"GAD-7:"}),e.jsxs("span",{className:"font-mono text-gray-900 dark:text-white",children:["[",k.rawApiResponse.actual_score.gad_7.join(", "),"]"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Created:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:k.rawApiResponse.created_at?new Date(k.rawApiResponse.created_at).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Updated:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:k.rawApiResponse.updated_at?new Date(k.rawApiResponse.updated_at).toLocaleString():"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Session Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white text-xs",children:k.sessionId})]})})]}),k.rawApiResponse.predict_error&&e.jsxs("div",{className:"border-l-4 border-red-400 bg-red-50 dark:bg-red-900/20 p-3",children:[e.jsx("h5",{className:"text-sm font-medium text-red-700 dark:text-red-300 mb-1",children:"Prediction Error"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Error Type:"}),e.jsx("span",{className:"font-mono text-red-900 dark:text-red-100",children:k.rawApiResponse.predict_error.error})]}),e.jsxs("div",{className:"text-red-700 dark:text-red-300",children:[e.jsx("span",{className:"font-medium",children:"Message:"})," ",k.rawApiResponse.predict_error.message]})]})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(k.rawApiResponse,null,2)})})]})]})})]}),k.insights&&k.insights.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Clinical Insights"}),e.jsx("ul",{className:"space-y-1",children:k.insights.map((n,d)=>e.jsxs("li",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["â€¢ ",n]},d))})]}),e.jsx("div",{className:"mt-6 flex space-x-3",children:e.jsx("button",{type:"button",onClick:ue,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",children:"Analyze Another File"})})]}),(a&&s.length>0||!a&&w)&&!k&&Object.keys(y).length===0&&v.stage==="idle"&&!b&&e.jsx("div",{className:"text-center",children:a?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:e.jsxs("button",{type:"button",onClick:es,disabled:s.length===0||!C.trim()||!s.some(n=>f[n.id]==="ready"),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start All Ready Files",s.filter(n=>f[n.id]==="ready").length>0&&` (${s.filter(n=>f[n.id]==="ready").length})`]})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'Use individual "Start" buttons on each file for selective processing, or "Start All" to process all ready files sequentially'})]}):e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:zs,disabled:!w||!C.trim(),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800",children:[e.jsx(je,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Start Analysis"]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"This will convert, upload, and analyze your audio file"})]})}),a&&Object.keys(y).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ne,{className:"h-6 w-6 text-green-500 mr-2","aria-hidden":"true"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Batch Analysis Results (",Object.keys(y).length," files)"]})]}),e.jsx("div",{className:"space-y-6",children:Object.entries(y).map(([n,d])=>{const j=s.find(M=>M.id===n),_=m[n];return e.jsxs("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:(j==null?void 0:j.file.name)||`File ${n}`}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(_==null?void 0:_.stage)==="complete"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Complete"]}),(_==null?void 0:_.stage)==="error"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Error"]})]})]}),d.rawApiResponse&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3 border",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Depression:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.predicted_score_depression||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Anxiety:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.predicted_score_anxiety||"N/A"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Session ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.sessionId})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.rawApiResponse.status||"N/A"})]})]})}),e.jsxs("details",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"View Raw JSON Response"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-3 overflow-auto max-h-64",children:e.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(d.rawApiResponse,null,2)})})]})]}),j&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{const M=document.getElementById(`audio-${n}`);M.paused?(document.querySelectorAll("audio").forEach($=>$.pause()),i(n),M.play()):(M.pause(),i(null))},className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900","aria-label":x===n?"Pause audio":"Play audio",children:x===n?e.jsx(Je,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[j.file.name," â€¢ ",j.duration?`${Math.round(j.duration)}s`:"Duration unknown"]})]}),e.jsx("audio",{id:`audio-${n}`,src:j.url,onEnded:()=>i(null),className:"hidden"})]})]},n)})})]}),A.length>0&&e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:A.map(n=>e.jsx("div",{className:`max-w-sm w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg border-l-4 p-4 transition-all duration-300 transform ${n.type==="error"?"border-red-500":n.type==="warning"?"border-yellow-500":n.type==="success"?"border-green-500":"border-blue-500"}`,role:"alert",children:e.jsxs("div",{className:"flex items-start",children:[e.jsxs("div",{className:"flex-shrink-0",children:[n.type==="error"&&e.jsx(de,{className:"h-5 w-5 text-red-500","aria-hidden":"true"}),n.type==="warning"&&e.jsx(de,{className:"h-5 w-5 text-yellow-500","aria-hidden":"true"}),n.type==="success"&&e.jsx(ne,{className:"h-5 w-5 text-green-500","aria-hidden":"true"}),n.type==="info"&&e.jsx(de,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"})]}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:n.message})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{type:"button",onClick:()=>Re(n.id),className:"inline-flex text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close notification",children:e.jsx(Ue,{className:"h-4 w-4"})})})]})},n.id))})]})},We={queued:{color:"yellow",icon:be,label:"Queued"},running:{color:"blue",icon:Z,label:"Processing"},processing:{color:"blue",icon:Z,label:"Processing"},succeeded:{color:"green",icon:ne,label:"Completed"},success:{color:"green",icon:ne,label:"Completed"},failed:{color:"red",icon:Ss,label:"Failed"}},Le=s=>s?s.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()):"â€”",Pe=s=>{if(!s)return 0;switch(s.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},Ea=()=>{const[s,t]=o.useState([]),[a,r]=o.useState(!0),[m,h]=o.useState(null),[y,N]=o.useState(new Set),[f,u]=o.useState(!1),[b,I]=o.useState({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),{announceToScreenReader:w}=Me(),z=o.useCallback(async()=>{try{r(!0),h(null);const x=Ie(),l=(await B.getUserSessions(x)).sessions.map(p=>{var g;const c=p.prediction;return{...p,uploadedAt:p.createdAt,fileName:p.audioFileName||`Audio_${p.sessionId.slice(-8)}.wav`,fileSize:Math.floor(Math.random()*5e6)+1e6,riskLevel:((g=p.analysisResults)==null?void 0:g.riskLevel)||"unknown",depressionScore:(c==null?void 0:c.predicted_score_depression)||(c==null?void 0:c.predictedScoreDepression)||void 0,anxietyScore:(c==null?void 0:c.predicted_score_anxiety)||(c==null?void 0:c.predictedScoreAnxiety)||void 0}});t(l),w(`${l.length} sessions loaded successfully`)}catch(x){const i=x;h(i),w(`Error loading sessions: ${i.message}`)}finally{r(!1)}},[w]);o.useEffect(()=>{z()},[z]);const v=o.useMemo(()=>{let x=s;if(b.search){const i=b.search.toLowerCase();x=x.filter(l=>{var p,c;return l.sessionId.toLowerCase().includes(i)||((p=l.fileName)==null?void 0:p.toLowerCase().includes(i))||((c=We[l.status])==null?void 0:c.label.toLowerCase().includes(i))})}if(b.status!=="all"&&(x=x.filter(i=>i.status===b.status)),b.dateRange!=="all"){const i=new Date,l=new Date;switch(b.dateRange){case"today":l.setHours(0,0,0,0);break;case"week":l.setDate(i.getDate()-7);break;case"month":l.setMonth(i.getMonth()-1);break;case"year":l.setFullYear(i.getFullYear()-1);break}x=x.filter(p=>new Date(p.uploadedAt)>=l)}return x.sort((i,l)=>{let p=0;switch(b.sortBy){case"date":p=new Date(i.uploadedAt).getTime()-new Date(l.uploadedAt).getTime();break;case"status":p=i.status.localeCompare(l.status);break;case"depressionScore":const c=Pe(i.depressionScore),g=Pe(l.depressionScore);p=c-g;break;case"anxietyScore":const A=Pe(i.anxietyScore),L=Pe(l.anxietyScore);p=A-L;break}return b.sortOrder==="desc"?-p:p}),x},[s,b]),S=o.useCallback((x,i)=>{I(l=>({...l,[x]:i})),w(`Filter ${x} changed to ${i}`)},[w]),k=o.useCallback(x=>{N(i=>{const l=new Set(i);return l.has(x)?(l.delete(x),w("Session deselected")):(l.add(x),w("Session selected")),l})},[w]),q=o.useCallback(()=>{y.size===v.length?(N(new Set),w("All sessions deselected")):(N(new Set(v.map(i=>i.sessionId))),w(`All ${v.length} sessions selected`))},[y.size,v,w]),se=o.useCallback(async x=>{if(window.confirm("Are you sure you want to delete this session? This action cannot be undone."))try{await B.deleteSessionData(x),t(l=>l.filter(p=>p.sessionId!==x)),N(l=>{const p=new Set(l);return p.delete(x),p}),w("Session deleted successfully")}catch(l){const p=l;w(`Error deleting session: ${p.message}`),alert(`Failed to delete session: ${p.message}`)}},[w]),Q=o.useCallback(async()=>{if(y.size===0||!window.confirm(`Are you sure you want to delete ${y.size} session(s)? This action cannot be undone.`))return;const i=Array.from(y);let l=0,p=[];for(const c of i)try{await B.deleteSessionData(c),l++}catch(g){const A=g;p.push(c),console.error(`Failed to delete session ${c}:`,A.message)}if(l>0&&t(c=>c.filter(g=>!(y.has(g.sessionId)&&!p.includes(g.sessionId)))),N(new Set),p.length===0)w(`${l} sessions deleted successfully`);else{const c=`${l} sessions deleted successfully, ${p.length} failed`;w(c),alert(`${c}. Failed sessions: ${p.join(", ")}`)}},[y,w]),le=x=>{if(x===0)return"0 B";const i=1024,l=["B","KB","MB","GB"],p=Math.floor(Math.log(x)/Math.log(i));return`${parseFloat((x/Math.pow(i,p)).toFixed(1))} ${l[p]}`},oe=({status:x})=>{const i=We[x]||We.failed,l=i.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":i.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":i.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${i.label}`,children:[e.jsx(l,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),i.label]})};return a?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(Z,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading sessions..."})]})}):m?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Sessions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:m.message}),e.jsx("button",{type:"button",onClick:z,className:"mt-4 btn btn--primary","aria-label":"Retry loading sessions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Analysis Sessions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"View and manage your audio analysis sessions"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:z,disabled:a,className:"btn btn--secondary","aria-label":"Refresh sessions list",children:[e.jsx(Z,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsx(J,{to:"/upload",className:"btn btn--primary","aria-label":"Start new analysis session",children:"New Analysis"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{htmlFor:"search-sessions",className:"sr-only",children:"Search sessions"}),e.jsxs("div",{className:"relative",children:[e.jsx(ma,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400","aria-hidden":"true"}),e.jsx("input",{id:"search-sessions",type:"text",placeholder:"Search by session ID, filename, or status...",value:b.search,onChange:x=>S("search",x.target.value),className:"form__input w-full pl-10 pr-4 py-2","aria-describedby":"search-help"})]}),e.jsx("p",{id:"search-help",className:"sr-only",children:"Search through your analysis sessions by ID, filename, or status"})]}),e.jsxs("button",{type:"button",onClick:()=>u(!f),className:"btn btn--secondary flex items-center","aria-expanded":f?"true":"false","aria-controls":"filter-panel","aria-label":`${f?"Hide":"Show"} filter options`,children:[e.jsx(As,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",f?e.jsx(vs,{className:"w-4 h-4 ml-2","aria-hidden":"true"}):e.jsx(ws,{className:"w-4 h-4 ml-2","aria-hidden":"true"})]})]}),f&&e.jsxs("div",{id:"filter-panel",className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{id:"status-filter",value:b.status,onChange:x=>S("status",x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"queued",children:"Queued"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"succeeded",children:"Completed"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-filter",value:b.dateRange,onChange:x=>S("dateRange",x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-by",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort By"}),e.jsxs("select",{id:"sort-by",value:b.sortBy,onChange:x=>S("sortBy",x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"status",children:"Status"}),e.jsx("option",{value:"depressionScore",children:"Depression Score"}),e.jsx("option",{value:"anxietyScore",children:"Anxiety Score"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-order",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort Order"}),e.jsxs("select",{id:"sort-order",value:b.sortOrder,onChange:x=>S("sortOrder",x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]}),v.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[v.length," of ",s.length," sessions",y.size>0&&` â€¢ ${y.size} selected`]})}),y.size>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{type:"button",onClick:Q,className:"btn btn--danger","aria-label":`Delete ${y.size} selected sessions`,children:[e.jsx(ze,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Delete Selected"]})})]}),v.length>0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",role:"table","aria-label":"Analysis sessions",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:y.size===v.length,onChange:q,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":"Select all sessions"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Session"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Depression Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Anxiety Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:v.map(x=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:y.has(x.sessionId),onChange:()=>k(x.sessionId),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${x.sessionId}`})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:x.fileName}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID: ",x.sessionId.slice(-12)]}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:le(x.fileSize||0)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(oe,{status:x.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:x.depressionScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Le(x.depressionScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm",children:x.anxietyScore?e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Le(x.anxietyScore)}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"â€”"})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ce(x.uploadedAt)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ne(x.uploadedAt)})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(J,{to:`/sessions/${x.sessionId}`,className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300","aria-label":`View details for session ${x.sessionId}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})}),x.status==="succeeded"&&e.jsx("button",{type:"button",className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300","aria-label":`Download results for session ${x.sessionId}`,children:e.jsx(He,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx("button",{type:"button",onClick:()=>se(x.sessionId),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300","aria-label":`Delete session ${x.sessionId}`,children:e.jsx(ze,{className:"w-4 h-4","aria-hidden":"true"})})]})})]},x.sessionId))})]})}),e.jsx("div",{className:"md:hidden space-y-4 p-4",children:v.map(x=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:y.has(x.sessionId),onChange:()=>k(x.sessionId),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select session ${x.sessionId}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:x.fileName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",x.sessionId.slice(-12)]})]})]}),e.jsx(oe,{status:x.status})]}),(x.depressionScore||x.anxietyScore)&&e.jsxs("div",{className:"text-sm",children:[x.depressionScore&&e.jsxs("div",{children:["Depression: ",Le(x.depressionScore)]}),x.anxietyScore&&e.jsxs("div",{children:["Anxiety: ",Le(x.anxietyScore)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:Ce(x.uploadedAt)}),e.jsx("span",{children:le(x.fileSize||0)})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[e.jsxs(J,{to:`/sessions/${x.sessionId}`,className:"btn btn--secondary text-xs","aria-label":`View details for session ${x.sessionId}`,children:[e.jsx(_e,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"View"]}),x.status==="succeeded"&&e.jsxs("button",{type:"button",className:"btn btn--secondary text-xs","aria-label":`Download results for session ${x.sessionId}`,children:[e.jsx(He,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Download"]}),e.jsxs("button",{type:"button",onClick:()=>se(x.sessionId),className:"btn btn--danger text-xs","aria-label":`Delete session ${x.sessionId}`,children:[e.jsx(ze,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Delete"]})]})]},x.sessionId))})]}):e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No sessions found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't created any analysis sessions yet.":"No sessions match your current filters."}),s.length===0?e.jsx(J,{to:"/upload",className:"btn btn--primary",children:"Start Your First Analysis"}):e.jsx("button",{type:"button",onClick:()=>I({search:"",status:"all",dateRange:"all",sortBy:"date",sortOrder:"desc"}),className:"btn btn--secondary",children:"Clear Filters"})]})]})},Da={low:{color:"green",label:"Low Risk",icon:ne,description:"Low likelihood of immediate concerns"},moderate:{color:"yellow",label:"Moderate Risk",icon:_s,description:"Some concerns that warrant attention"},high:{color:"red",label:"High Risk",icon:Ze,description:"Significant concerns requiring immediate attention"},critical:{color:"red",label:"Critical Risk",icon:Ze,description:"Urgent intervention required"}},Fa=({sessionId:s,existingAssessment:t,onAssessmentUpdated:a})=>{const{announceToScreenReader:r}=Me(),[m,h]=o.useState(t||null),[y,N]=o.useState(!1),[f,u]=o.useState(!1),[b,I]=o.useState(null),w=o.useCallback(async()=>{try{N(!0),I(null),r("Generating AI risk assessment...");const S=await B.generateRiskAssessment(s);if(S.success&&S.riskAssessment)h(S.riskAssessment),a==null||a(S.riskAssessment),r("Risk assessment generated successfully");else throw new Error(S.message||"Failed to generate risk assessment")}catch(S){const k=S;I(k),r(`Error generating assessment: ${k.message}`)}finally{N(!1)}},[s,a,r]),z=o.useCallback(async()=>{try{u(!0),I(null);const S=await B.getRiskAssessment(s);S.success&&S.riskAssessment&&(h(S.riskAssessment),a==null||a(S.riskAssessment))}catch(S){I(S)}finally{u(!1)}},[s,a]),v=({riskLevel:S,riskScore:k})=>{const q=Da[S.toLowerCase()];if(!q)return null;const se=q.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium ${q.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":q.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Risk level: ${q.label}`,children:[e.jsx(se,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),q.label,k&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded text-xs font-bold",children:[k,"/10"]})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:q.description})]})};return!m&&!y&&!f?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Risk Assessment Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Generate an AI-powered risk assessment based on session data and clinical insights."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{type:"button",onClick:w,className:"btn btn--primary","aria-label":"Generate AI risk assessment",children:[e.jsx(ge,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Generate AI Risk Assessment"]}),e.jsxs("button",{type:"button",onClick:z,className:"btn btn--secondary","aria-label":"Check for existing assessment",children:[e.jsx(Z,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Check for Existing Assessment"]})]}),b&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:b.message})})]})]}):y||f?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(Z,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:y?"Generating AI risk assessment...":"Loading assessment..."})]}),y&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This may take a few moments as AI analyzes the session data..."})})]}):m?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"AI Risk Assessment"]}),e.jsx("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:e.jsxs("button",{type:"button",onClick:w,disabled:y,className:"btn btn--secondary text-xs","aria-label":"Regenerate risk assessment",children:[e.jsx(Z,{className:`w-3 h-3 mr-1 ${y?"animate-spin":""}`,"aria-hidden":"true"}),"Regenerate"]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Overall Risk Level"}),e.jsx(v,{riskLevel:m.overallRiskLevel,riskScore:m.riskScore})]}),m.generatedAt&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(Ns,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),"Generated"]}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:Ne(m.generatedAt)})]})]}),m.summary&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Kt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Summary"]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsx("p",{className:"text-blue-900 dark:text-blue-100 text-sm leading-relaxed",children:m.summary})})]}),m.keyFactors&&m.keyFactors.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(_s,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Key Risk Factors"]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:m.keyFactors.map((S,k)=>e.jsxs("li",{className:"text-yellow-900 dark:text-yellow-100 text-sm flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-3 flex-shrink-0","aria-hidden":"true"}),S]},k))})})]}),m.recommendations&&m.recommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(aa,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recommendations"]}),e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:e.jsx("ul",{className:"space-y-2",children:m.recommendations.map((S,k)=>e.jsxs("li",{className:"text-green-900 dark:text-green-100 text-sm flex items-start",children:[e.jsx(ne,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),S]},k))})})]}),m.immediateActions&&m.immediateActions.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(ha,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Immediate Actions Required"]}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:e.jsx("ul",{className:"space-y-2",children:m.immediateActions.map((S,k)=>e.jsxs("li",{className:"text-red-900 dark:text-red-100 text-sm flex items-start",children:[e.jsx(Ze,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),S]},k))})})]}),m.followUpRecommendations&&m.followUpRecommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(Qe,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Follow-up Recommendations"]}),e.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:e.jsx("ul",{className:"space-y-2",children:m.followUpRecommendations.map((S,k)=>e.jsxs("li",{className:"text-purple-900 dark:text-purple-100 text-sm flex items-start",children:[e.jsx(be,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 mt-0.5 mr-3 flex-shrink-0","aria-hidden":"true"}),S]},k))})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(be,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),"Generated: ",Ne(m.generatedAt),m.modelVersion&&e.jsxs("span",{className:"ml-4",children:["Model: ",m.modelVersion]})]})})]}),b&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:b.message})})]}):null},gs={queued:{color:"yellow",icon:be,label:"Queued",description:"Waiting to be processed"},initiated:{color:"blue",icon:be,label:"Initiated",description:"Session has been created"},running:{color:"blue",icon:Z,label:"Processing",description:"Audio is being analyzed"},processing:{color:"blue",icon:Z,label:"Processing",description:"Analysis in progress"},succeeded:{color:"green",icon:ne,label:"Completed",description:"Analysis completed successfully"},success:{color:"green",icon:ne,label:"Completed",description:"Analysis completed successfully"},failed:{color:"red",icon:Ss,label:"Failed",description:"Analysis encountered an error"}},Ta=()=>{var x,i,l,p,c,g,A,L,V,ce,G,Y;const{sessionId:s}=Js(),t=ps(),{announceToScreenReader:a}=Me(),[r,m]=o.useState(null),[h,y]=o.useState(!0),[N,f]=o.useState(null),[u,b]=o.useState(!1),[I,w]=o.useState(!1),[z,v]=o.useState(!1),S=o.useRef(null),k=o.useCallback(async()=>{if(s)try{y(!0),f(null);const F=await B.getSessionData(s);m(F),a(`Session ${s} loaded successfully`)}catch(F){const E=F;f(E),a(`Error loading session: ${E.message}`)}finally{y(!1)}},[s,a]),q=o.useCallback(async()=>{w(!0),await k(),w(!1),a("Session data refreshed")},[k,a]);o.useEffect(()=>{k()},[k]);const se=o.useCallback(()=>{b(F=>{const E=!F;return a(`Raw JSON view ${E?"enabled":"disabled"}`),E})},[a]),Q=o.useCallback(()=>{S.current&&(z?(S.current.pause(),v(!1),a("Audio paused")):(S.current.play().catch(()=>{a("Failed to play audio")}),v(!0),a("Audio playing")))},[z,a]),le=o.useCallback(()=>{if(!r)return;const F=JSON.stringify(r,null,2),E=new Blob([F],{type:"application/json"}),C=URL.createObjectURL(E),H=document.createElement("a");H.href=C,H.download=`session-${r.sessionId}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(C),a("Session data download started")},[r,a]),oe=({status:F})=>{const E=gs[F]||gs.failed,C=E.icon;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${E.color==="green"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":E.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":E.color==="yellow"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,role:"status","aria-label":`Status: ${E.label}`,children:[e.jsx(C,{className:`w-4 h-4 mr-2 ${E.color==="blue"&&F==="processing"?"animate-spin":""}`,"aria-hidden":"true"}),E.label]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:E.description})]})};return h?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(Z,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading session details..."})]})}):N?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Session"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:N.message}),e.jsxs("div",{className:"mt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:k,className:"btn btn--primary","aria-label":"Retry loading session",children:"Try Again"}),e.jsx(J,{to:"/sessions",className:"btn btn--secondary",children:"Back to Sessions"})]})]})]})})}):r?e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{type:"button",onClick:()=>t("/sessions"),className:"btn btn--secondary","aria-label":"Back to sessions list",children:[e.jsx(It,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Back to Sessions"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Session Details"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:["ID: ",r.sessionId]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:se,className:"btn btn--secondary","aria-label":`${u?"Hide":"Show"} raw JSON data`,children:[u?e.jsx(Ht,{className:"w-4 h-4 mr-2"}):e.jsx(_e,{className:"w-4 h-4 mr-2"}),u?"Hide JSON":"Show JSON"]}),e.jsxs("button",{type:"button",onClick:q,disabled:I,className:"btn btn--secondary","aria-label":"Refresh session data",children:[e.jsx(Z,{className:`w-4 h-4 mr-2 ${I?"animate-spin":""}`,"aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{type:"button",onClick:le,className:"btn btn--primary","aria-label":"Download session data as JSON",children:[e.jsx(He,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),u&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ye,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Raw Session Data"]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 overflow-auto",children:e.jsx("pre",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap break-all",children:JSON.stringify(r,null,2)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ye,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Basic Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsx(oe,{status:r.status})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(Ns,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Created"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:Ce(r.createdAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(r.createdAt)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(be,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"Last Updated"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:Ce(r.updatedAt)}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:Ne(r.updatedAt)})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(cs,{className:"w-4 h-4 inline mr-1","aria-hidden":"true"}),"User ID"]}),e.jsx("div",{className:"font-mono text-sm bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded border break-all",children:r.userId})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Gt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Audio Information"]}),e.jsxs("div",{className:"space-y-4",children:[r.audioFileName&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"File Name"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-medium",children:r.audioFileName})]}),r.audioUrl&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Audio File"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:Q,className:"btn btn--secondary","aria-label":`${z?"Pause":"Play"} audio`,children:z?e.jsx(Je,{className:"w-4 h-4"}):e.jsx(je,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:z?"Playing audio...":"Audio playback available"})]}),e.jsx("audio",{ref:S,src:r.audioUrl,onPlay:()=>v(!0),onPause:()=>v(!1),onEnded:()=>v(!1),onError:()=>{v(!1),a("Audio playback failed - file may not be accessible")},className:"hidden",preload:"metadata"})]})]})]})]}),r.userMetadata&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(cs,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Patient Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.userMetadata.age&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[r.userMetadata.age," years"]})]}),r.userMetadata.gender&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gender"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:r.userMetadata.gender.replace(/[_-]/g," ")})]}),r.userMetadata.weight&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[r.userMetadata.weight," lbs"]})]}),r.userMetadata.race&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Race"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white capitalize",children:r.userMetadata.race})]}),r.userMetadata.ethnicity&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ethnicity"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:r.userMetadata.ethnicity})]}),r.userMetadata.zipcode&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ZIP Code"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white font-mono",children:r.userMetadata.zipcode})]}),r.userMetadata.language!==void 0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Primary Language English"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:r.userMetadata.language?"Yes":"No"})]}),r.userMetadata.sessionNotes&&e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Session Notes"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded border",children:r.userMetadata.sessionNotes})]})]})]}),(r.analysisResults||r.prediction)&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Be,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Analysis Results"]}),e.jsxs("div",{className:"space-y-6",children:[(r.analysisResults||r.prediction)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Mental Health Scores"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(((x=r.analysisResults)==null?void 0:x.depressionScore)||((i=r.prediction)==null?void 0:i.predicted_score_depression))&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Depression Score"}),e.jsx(Qe,{className:"w-4 h-4 text-blue-600 dark:text-blue-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:((p=(l=r.analysisResults)==null?void 0:l.depressionScore)==null?void 0:p.toFixed(2))||((c=r.prediction)!=null&&c.predicted_score_depression?r.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase()):"N/A")})]}),(((g=r.analysisResults)==null?void 0:g.anxietyScore)||((A=r.prediction)==null?void 0:A.predicted_score_anxiety))&&e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Anxiety Score"}),e.jsx(Cs,{className:"w-4 h-4 text-purple-600 dark:text-purple-400","aria-hidden":"true"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:((V=(L=r.analysisResults)==null?void 0:L.anxietyScore)==null?void 0:V.toFixed(2))||((ce=r.prediction)!=null&&ce.predicted_score_anxiety?r.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase()):"N/A")})]})]})]}),((G=r.analysisResults)==null?void 0:G.insights)&&r.analysisResults.insights.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Clinical Insights"}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("ul",{className:"space-y-2",children:r.analysisResults.insights.map((F,E)=>e.jsxs("li",{className:"text-sm text-yellow-800 dark:text-yellow-200 flex items-start",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-600 dark:bg-yellow-400 rounded-full mt-2 mr-2 flex-shrink-0","aria-hidden":"true"}),F]},E))})})]}),((Y=r.analysisResults)==null?void 0:Y.completedAt)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Analysis Completion"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ne,{className:"w-4 h-4 text-green-600 dark:text-green-400 mr-2","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 mr-2",children:"Completed:"}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Ne(r.analysisResults.completedAt)})]})})]})]})]}),e.jsx(Fa,{sessionId:r.sessionId,existingAssessment:r.riskAssessment||null,onAssessmentUpdated:F=>{m(E=>E?{...E,riskAssessment:F}:null)}})]}):e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Session Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"The requested session could not be found."}),e.jsx(J,{to:"/sessions",className:"btn btn--primary",children:"Back to Sessions"})]})})},Ua=()=>{const[s,t]=o.useState([]),[a,r]=o.useState(!0),[m,h]=o.useState(null),[y,N]=o.useState({dateRange:"all",scoreType:"all",showTrends:!0}),[f,u]=o.useState(!1),{announceToScreenReader:b}=Me(),I=ps(),w=o.useCallback(i=>{I(`/sessions/${i}`),b(`Navigating to session ${i} details`)},[I,b]),z=o.useCallback(async()=>{try{r(!0),h(null);const i=Ie(),p=(await B.getUserSessions(i)).sessions.filter(c=>c.analysisResults||c.prediction);t(p),b(`${p.length} prediction sessions loaded`)}catch(i){const l=i;h(l),b(`Error loading predictions: ${l.message}`)}finally{r(!1)}},[b]);o.useEffect(()=>{z()},[z]);const v=o.useMemo(()=>{if(y.dateRange==="all")return s;const i=new Date,l=new Date;switch(y.dateRange){case"week":l.setDate(i.getDate()-7);break;case"month":l.setMonth(i.getMonth()-1);break;case"quarter":l.setMonth(i.getMonth()-3);break;case"year":l.setFullYear(i.getFullYear()-1);break}return s.filter(p=>new Date(p.createdAt)>=l)},[s,y.dateRange]),S=o.useMemo(()=>v.map(i=>{var g,A;const l=L=>{if(!L)return null;switch(L.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return null}},p=l((g=i.prediction)==null?void 0:g.predicted_score_depression),c=l((A=i.prediction)==null?void 0:A.predicted_score_anxiety);return{date:i.createdAt,depression:p,anxiety:c,overall:null,sessionId:i.sessionId}}).sort((i,l)=>new Date(i.date).getTime()-new Date(l.date).getTime()),[v]),k=o.useMemo(()=>{const i={depression:[],anxiety:[]},l=[{category:"no_to_mild",label:"No to Mild",color:"bg-green-400"},{category:"mild_to_moderate",label:"Mild to Moderate",color:"bg-yellow-500"},{category:"moderate_to_severe",label:"Moderate to Severe",color:"bg-red-600"},{category:"no_or_minimal",label:"No or Minimal",color:"bg-green-400"},{category:"moderate",label:"Moderate",color:"bg-orange-500"},{category:"moderately_severe",label:"Moderately Severe",color:"bg-red-500"},{category:"severe",label:"Severe",color:"bg-red-700"}],p=v.map(g=>{var A;return(A=g.prediction)==null?void 0:A.predicted_score_depression}).filter(g=>g!==void 0);l.forEach(g=>{const A=p.filter(V=>V===g.category).length,L=p.length>0?A/p.length*100:0;A>0&&i.depression.push({category:g.label,count:A,percentage:L,color:g.color})});const c=v.map(g=>{var A;return(A=g.prediction)==null?void 0:A.predicted_score_anxiety}).filter(g=>g!==void 0);return l.forEach(g=>{const A=c.filter(V=>V===g.category).length,L=c.length>0?A/c.length*100:0;A>0&&i.anxiety.push({category:g.label,count:A,percentage:L,color:g.color})}),i},[v]),q=o.useMemo(()=>{const i={},l=g=>{if(!g)return 0;switch(g.toLowerCase()){case"no_to_mild":return 1;case"mild_to_moderate":return 2;case"moderate_to_severe":return 3;case"no_or_minimal":return 1;case"moderate":return 2;case"moderately_severe":return 3;case"severe":return 4;default:return 0}},p=v.map(g=>{var A;return(A=g.prediction)==null?void 0:A.predicted_score_depression}).filter(g=>g!==void 0);if(p.length<2)i.depression={direction:"stable",change:0,period:"insufficient data"};else{const g=p.map(l),A=g.slice(0,Math.floor(g.length/2)),L=g.slice(Math.floor(g.length/2)),V=A.reduce((Y,F)=>Y+F,0)/A.length,G=L.reduce((Y,F)=>Y+F,0)/L.length-V;i.depression={direction:Math.abs(G)<.5?"stable":G<0?"improving":"worsening",change:Math.abs(G),period:`${v.length} sessions`}}const c=v.map(g=>{var A;return(A=g.prediction)==null?void 0:A.predicted_score_anxiety}).filter(g=>g!==void 0);if(c.length<2)i.anxiety={direction:"stable",change:0,period:"insufficient data"};else{const g=c.map(l),A=g.slice(0,Math.floor(g.length/2)),L=g.slice(Math.floor(g.length/2)),V=A.reduce((Y,F)=>Y+F,0)/A.length,G=L.reduce((Y,F)=>Y+F,0)/L.length-V;i.anxiety={direction:Math.abs(G)<.5?"stable":G<0?"improving":"worsening",change:Math.abs(G),period:`${v.length} sessions`}}return i.overall={direction:"stable",change:0,period:"coming soon"},i},[v]),se=o.useMemo(()=>{const i={totalSessions:v.length,avgDepression:0,avgAnxiety:0,avgOverall:0,latestSession:null,improvementSessions:0};if(v.length===0)return i;const l=v.map(c=>{var g;return(g=c.prediction)==null?void 0:g.predictedScoreDepression}).filter(c=>c!==void 0),p=v.map(c=>{var g;return(g=c.prediction)==null?void 0:g.predictedScoreAnxiety}).filter(c=>c!==void 0);if(l.length>0){const c={};l.forEach(A=>{c[A]=(c[A]||0)+1});const g=Object.entries(c).sort(([,A],[,L])=>L-A)[0][0];i.avgDepression=c[g]}if(p.length>0){const c={};p.forEach(A=>{c[A]=(c[A]||0)+1});const g=Object.entries(c).sort(([,A],[,L])=>L-A)[0][0];i.avgAnxiety=c[g]}return i.latestSession=v.sort((c,g)=>new Date(g.createdAt).getTime()-new Date(c.createdAt).getTime())[0],i.improvementSessions=0,i},[v]),Q=o.useCallback((i,l)=>{N(p=>({...p,[i]:l})),b(`Filter ${i} changed to ${l}`)},[b]),le=o.useCallback(()=>{const i=JSON.stringify(v,null,2),l=new Blob([i],{type:"application/json"}),p=URL.createObjectURL(l),c=document.createElement("a");c.href=p,c.download=`predictions-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(p),b("Predictions data download started")},[v,b]),oe=({trend:i,label:l})=>{const p=i.direction==="improving"?ya:i.direction==="worsening"?Qe:Be,c=i.direction==="improving"?"text-green-600 dark:text-green-400":i.direction==="worsening"?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400";return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{className:`w-4 h-4 ${c}`,"aria-hidden":"true"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:l}),e.jsxs("span",{className:`text-sm font-medium ${c} capitalize`,children:[i.direction,i.period==="insufficient data"?" (need more sessions)":i.period==="coming soon"?" (analysis coming soon)":` (${i.period})`]})]})},x=({data:i,type:l,onBarClick:p})=>{const c=i.map(C=>C[l]).filter(C=>C!==null);if(c.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No data available"});const g=Math.max(...c),A=Math.min(...c),L=g-A||1,V=C=>{switch(C){case 1:return"No to Mild / No or Minimal";case 2:return"Mild to Moderate / Moderate";case 3:return"Moderate to Severe / Moderately Severe";case 4:return"Severe";default:return"Unknown"}},ce=(C,H)=>{if(H==="depression")switch(C){case 1:return"bg-blue-400";case 2:return"bg-blue-600";case 3:return"bg-blue-800";default:return"bg-blue-500"}else if(H==="anxiety")switch(C){case 1:return"bg-purple-400";case 2:return"bg-purple-600";case 3:return"bg-purple-700";case 4:return"bg-purple-900";default:return"bg-purple-500"}else switch(C){case 1:return"bg-green-400";case 2:return"bg-green-600";case 3:return"bg-green-700";case 4:return"bg-green-800";default:return"bg-green-500"}},G=C=>[{score:1,label:"No/Minimal"},{score:2,label:"Mild"},{score:3,label:"Moderate"},{score:4,label:"Mod-Severe"},{score:5,label:"Severe"}].map(ae=>({...ae,color:ce(ae.score,C)})),Y=new Set(c),E=G(l).filter(C=>Y.has(C.score));return e.jsxs("div",{children:[e.jsx("div",{className:"h-32 flex items-end space-x-1 px-4 py-2 mb-4",children:i.map((C,H)=>{const ae=C[l];if(ae===null)return null;const O=(ae-A)/L*100,T=ce(ae,l),Re=V(ae),ue=new Date(C.date).toLocaleDateString();return e.jsx("div",{className:`flex-1 ${T} opacity-70 hover:opacity-100 hover:scale-105 transition-all duration-200 rounded-t cursor-pointer relative group chart-bar-dynamic`,style:{"--chart-height":`${Math.max(O,8)}%`},onClick:()=>p(C.sessionId),role:"button",tabIndex:0,onKeyDown:we=>{(we.key==="Enter"||we.key===" ")&&(we.preventDefault(),p(C.sessionId))},"aria-label":`View session details for ${Re} score on ${ue}`,children:e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-medium",children:Re}),e.jsx("div",{className:"text-gray-300",children:ue}),e.jsxs("div",{className:"text-gray-300",children:["Session: ",C.sessionId.slice(-8)]}),e.jsx("div",{className:"text-gray-400 text-xs mt-1",children:"Click to view details"}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"})]})},H)})}),E.length>0&&e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"Legend:"}),E.map(C=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-3 h-3 ${C.color} rounded`}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:C.label})]},C.score))]})})]})};return a?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(Z,{className:"w-8 h-8 text-blue-600 animate-spin mr-3","aria-hidden":"true"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Loading predictions..."})]})}):m?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 text-red-500 mr-3","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Error Loading Predictions"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:m.message}),e.jsx("button",{type:"button",onClick:z,className:"mt-4 btn btn--primary","aria-label":"Retry loading predictions",children:"Try Again"})]})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Predictions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Analyze your mental health trends and insights over time"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>u(!f),className:"btn btn--secondary","aria-expanded":f?"true":"false","aria-label":`${f?"Hide":"Show"} filter options`,children:[e.jsx(As,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Filters",f?e.jsx(vs,{className:"w-4 h-4 ml-2"}):e.jsx(ws,{className:"w-4 h-4 ml-2"})]}),e.jsxs("button",{type:"button",onClick:z,className:"btn btn--secondary","aria-label":"Refresh predictions data",children:[e.jsx(Z,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Refresh"]}),e.jsxs("button",{type:"button",onClick:le,className:"btn btn--primary",disabled:v.length===0,"aria-label":"Download predictions data",children:[e.jsx(He,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Download"]})]})]}),f&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-range",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),e.jsxs("select",{id:"date-range",value:y.dateRange,onChange:i=>Q("dateRange",i.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"quarter",children:"Past Quarter"}),e.jsx("option",{value:"year",children:"Past Year"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"score-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Focus Score"}),e.jsxs("select",{id:"score-type",value:y.scoreType,onChange:i=>Q("scoreType",i.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Scores"}),e.jsx("option",{value:"depression",children:"Depression"}),e.jsx("option",{value:"anxiety",children:"Anxiety"}),e.jsx("option",{value:"overall",children:"Overall"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:y.showTrends,onChange:i=>Q("showTrends",i.target.checked),className:"form__input form__input--checkbox rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show trend analysis"})]})})]})}),v.length===0?e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Prediction Data Available"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.length===0?"You haven't completed any analysis sessions yet.":"No sessions found for the selected date range."}),e.jsx(J,{to:"/upload",className:"btn btn--primary",children:"Start Your First Analysis"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Be,{className:"w-8 h-8 text-blue-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:se.totalSessions})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ge,{className:"w-8 h-8 text-purple-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Depression (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const i=v.map(c=>{var g;return(g=c.prediction)==null?void 0:g.predicted_score_depression}).filter(c=>c!==void 0);if(i.length===0)return"â€”";const l={};return i.forEach(c=>{l[c]=(l[c]||0)+1}),Object.entries(l).sort(([,c],[,g])=>g-c)[0][0].replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase())})()})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Cs,{className:"w-8 h-8 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Anxiety (Most Common)"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const i=v.map(c=>{var g;return(g=c.prediction)==null?void 0:g.predicted_score_anxiety}).filter(c=>c!==void 0);if(i.length===0)return"â€”";const l={};return i.forEach(c=>{l[c]=(l[c]||0)+1}),Object.entries(l).sort(([,c],[,g])=>g-c)[0][0].replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase())})()})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(y.scoreType==="all"||y.scoreType==="depression")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(os,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Depression Score Trend"]}),e.jsx(x,{data:S,type:"depression",onBarClick:w}),y.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(oe,{trend:q.depression,label:"Trend:"})})]}),(y.scoreType==="all"||y.scoreType==="anxiety")&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Dt,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Anxiety Score Trend"]}),e.jsx(x,{data:S,type:"anxiety",onBarClick:w}),y.showTrends&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:e.jsx(oe,{trend:q.anxiety,label:"Trend:"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(os,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Score Distribution"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(k).map(([i,l])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 capitalize",children:[i," Scores"]}),e.jsx("div",{className:"space-y-2",children:l.map(p=>e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:p.category}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[p.count," (",p.percentage.toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${p.color} progress-dynamic progress-animated`,style:{"--progress-width":`${p.percentage}%`}})})]})},p.category))})]},i))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(be,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Recent Analysis Sessions"]}),e.jsx(J,{to:"/sessions",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 text-sm",children:"View All Sessions â†’"})]}),e.jsx("div",{className:"space-y-4",children:v.slice(0,5).map(i=>{var l,p;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${i.status==="succeeded"?"bg-green-500":i.status==="processing"?"bg-blue-500":i.status==="failed"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i.audioFileName||`Session ${i.sessionId.slice(-8)}`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:Ce(i.createdAt)})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[((l=i.prediction)==null?void 0:l.predicted_score_depression)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Depression"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i.prediction.predicted_score_depression.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase())})]}),((p=i.prediction)==null?void 0:p.predicted_score_anxiety)&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Anxiety"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i.prediction.predicted_score_anxiety.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase())})]}),e.jsx(J,{to:`/sessions/${i.sessionId}`,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400","aria-label":`View session ${i.sessionId}`,children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})})]})]},i.sessionId)})})]})]})]})},Oa=()=>{const{data:s,isLoading:t,error:a,refetch:r}=Ms(),{announce:m}=js();ys.useEffect(()=>{m("System Health page loaded","polite")},[m]);const h=u=>{if(!u)return"Just now";try{const b=new Date(u);return isNaN(b.getTime())?"Just now":b.toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return"Just now"}},y=u=>{switch(u==null?void 0:u.toLowerCase()){case"healthy":return"text-green-600 dark:text-green-400";case"degraded":return"text-yellow-600 dark:text-yellow-400";case"unhealthy":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},N=u=>{switch(u==null?void 0:u.toLowerCase()){case"healthy":return"âœ…";case"degraded":return"âš ï¸";case"unhealthy":return"âŒ";default:return"â“"}},f=u=>{const b="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium";switch(u==null?void 0:u.toLowerCase()){case"healthy":return`${b} bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200`;case"degraded":return`${b} bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200`;case"unhealthy":return`${b} bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200`;default:return`${b} bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200`}};return e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"System Health"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Monitor API status and system connectivity"})]}),e.jsxs("button",{type:"button",onClick:()=>r(),disabled:t,className:"btn btn--secondary flex items-center space-x-2","aria-label":"Refresh system health status",children:[e.jsx(Z,{className:`w-4 h-4 ${t?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),t&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Z,{className:"w-6 h-6 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-lg text-gray-900 dark:text-white",children:"Checking system health..."})]})}),a&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-6 h-6 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-900 dark:text-red-200",children:"Health Check Failed"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:a.message||"Unable to retrieve system health status"}),e.jsx("button",{type:"button",onClick:()=>r(),className:"mt-3 text-sm text-red-800 dark:text-red-200 hover:text-red-900 dark:hover:text-red-100 underline",children:"Try again"})]})]})}),s&&!t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Overall System Status"}),e.jsxs("div",{className:f(s.status),children:[e.jsx("span",{className:"mr-1",children:N(s.status)}),s.status]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:N(s.status)}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Status"}),e.jsx("div",{className:`font-medium ${y(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"â±ï¸"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Response Time"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:s.totalDuration?`${s.totalDuration}ms`:"N/A"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“…"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last Checked"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:h(s.timestamp)})]})]})]}),s.checks&&Object.keys(s.checks).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Be,{className:"w-5 h-5 mr-2"}),"Service Details"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.checks).map(([u,b])=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:N(b.status)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white capitalize",children:u.replace(/-/g," ")}),b.description&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:b.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[b.duration&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[b.duration,"ms"]}),e.jsx("div",{className:f(b.status),children:b.status})]})]},u))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Ye,{className:"w-5 h-5 mr-2"}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"API Endpoints"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Health Check:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/health"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Sessions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/sessions"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Predictions:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:"/predictions"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Connection Status"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"API Connected"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Real-time Updates"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Auto-refresh Enabled"})]})]})]})]})]})]})]})},La=()=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Page Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"The page you're looking for doesn't exist."}),e.jsx("a",{href:"/",className:"btn btn--primary",children:"Go to Dashboard"})]}),Pa=new Gs({defaultOptions:{queries:{retry:(s,t)=>{if(t&&typeof t=="object"&&"code"in t){const a=t.code;if(a!=null&&a.startsWith("HTTP_4")&&a!=="HTTP_408")return!1}return s<3},staleTime:5*60*1e3,refetchOnWindowFocus:!1},mutations:{retry:1}}});function za(){return e.jsxs(Ws,{client:Pa,children:[e.jsx(pt,{children:e.jsx(Zs,{children:e.jsx(kt,{children:e.jsxs(Qs,{children:[e.jsx(ye,{path:"/",element:e.jsx(Ca,{})}),e.jsx(ye,{path:"/upload",element:e.jsx($a,{})}),e.jsx(ye,{path:"/sessions",element:e.jsx(Ea,{})}),e.jsx(ye,{path:"/sessions/:sessionId",element:e.jsx(Ta,{})}),e.jsx(ye,{path:"/predictions",element:e.jsx(Ua,{})}),e.jsx(ye,{path:"/health",element:e.jsx(Oa,{})}),e.jsx(ye,{path:"*",element:e.jsx(La,{})})]})})})}),!1]})}const hs=localStorage.getItem("bh_theme"),Ba=window.matchMedia("(prefers-color-scheme: dark)").matches,Ha=hs==="dark"||!hs&&Ba;Ha?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");Ke.createRoot(document.getElementById("root")).render(e.jsx(ys.StrictMode,{children:e.jsx(za,{})}));
//# sourceMappingURL=index-caef242b.js.map
